{"version":3,"file":"main-C7lVck3B.js","sources":["../../../../src/sequence/step-ui.ts","../../../../src/sequence/parse-steps.ts","../../../../node_modules/bitecs/dist/index.mjs","../../../../src/borders/components.ts","../../../../src/borders/systems.ts","../../../../src/borders/plugin.ts","../../blog/canvases/setup.xml?raw","../../blog/canvases/problem.xml?raw","../../blog/canvases/dot-product.xml?raw","../../blog/canvases/query-key.xml?raw","../../blog/canvases/attention-weights.xml?raw","../../blog/canvases/value-output.xml?raw","../../blog/canvases/full-attention.xml?raw","../../blog/canvases/index.ts","../../blog/main.ts"],"sourcesContent":["import type { State } from 'vibegame';\nimport { StepController } from './components';\n\nexport interface StepContent {\n  title: string;\n  description: string;\n}\n\nexport interface StepUIElements {\n  btnPrev: HTMLButtonElement | null;\n  btnNext: HTMLButtonElement | null;\n  counter: HTMLElement | null;\n  title: HTMLElement | null;\n  description: HTMLElement | null;\n  info: HTMLElement | null;\n}\n\nexport interface StepUIConfig {\n  steps: StepContent[];\n  elements: StepUIElements;\n  renderDescription?: (el: HTMLElement, description: string) => void;\n}\n\nexport function findStepElements(selector: string): StepUIElements | null {\n  const container = document.querySelector(selector);\n  if (!container) return null;\n\n  return {\n    btnPrev: container.querySelector('.btn-prev'),\n    btnNext: container.querySelector('.btn-next'),\n    counter: container.querySelector('.step-counter'),\n    title: container.querySelector('.step-title'),\n    description: container.querySelector('.step-description'),\n    info: container.querySelector('.step-info'),\n  };\n}\n\nexport function setupStepUI(state: State, controllerEntity: number, config: StepUIConfig): void {\n  const { steps, elements, renderDescription } = config;\n  const { btnPrev, btnNext, counter, title, description, info } = elements;\n  const maxStep = steps.length - 1;\n\n  // Hide navigator for single-step canvases\n  if (steps.length <= 1) {\n    const navigator = btnPrev?.closest('.step-navigator') as HTMLElement | null;\n    if (navigator) navigator.style.display = 'none';\n    return;\n  }\n\n  const renderContent = (content: StepContent) => {\n    if (title) title.textContent = content.title;\n    if (description) {\n      if (renderDescription) {\n        renderDescription(description, content.description);\n      } else {\n        description.textContent = content.description;\n      }\n    }\n  };\n\n  const calculateMaxHeight = () => {\n    if (!info) return;\n\n    info.style.minHeight = '';\n\n    let maxHeight = 0;\n    for (const content of steps) {\n      renderContent(content);\n      maxHeight = Math.max(maxHeight, info.offsetHeight);\n    }\n\n    info.style.minHeight = `${maxHeight}px`;\n\n    const currentStep = StepController.target[controllerEntity];\n    renderContent(steps[currentStep] ?? { title: '', description: '' });\n  };\n\n  calculateMaxHeight();\n  window.addEventListener('resize', calculateMaxHeight);\n  document.fonts.ready.then(calculateMaxHeight);\n\n  const updateUI = () => {\n    const step = StepController.target[controllerEntity];\n\n    if (btnPrev) btnPrev.disabled = step <= 0;\n    if (btnNext) btnNext.disabled = step >= maxStep;\n\n    if (counter) counter.textContent = `Step ${step + 1} of ${steps.length}`;\n    renderContent(steps[step] ?? { title: '', description: '' });\n  };\n\n  updateUI();\n\n  btnPrev?.addEventListener('click', () => {\n    const step = StepController.target[controllerEntity];\n    if (step > 0) {\n      StepController.target[controllerEntity] = step - 1;\n    }\n  });\n\n  btnNext?.addEventListener('click', () => {\n    const step = StepController.target[controllerEntity];\n    if (step < maxStep) {\n      StepController.target[controllerEntity] = step + 1;\n    }\n  });\n\n  state.registerSystem({ group: 'simulation', update: updateUI });\n}\n","import type { StepContent } from './step-ui';\nimport type { SequenceMap } from './systems';\n\nexport interface ParsedSteps {\n  steps: StepContent[];\n  sequenceMap: SequenceMap;\n}\n\nexport function parseSteps(xml: string): ParsedSteps {\n  const parser = new DOMParser();\n  const doc = parser.parseFromString(xml, 'text/html');\n\n  const stepElements = doc.querySelectorAll('div.step');\n  const steps: StepContent[] = [];\n  const sequenceMap: SequenceMap = {};\n\n  stepElements.forEach((stepEl, index) => {\n    const title = stepEl.getAttribute('data-title') ?? '';\n    const description = stepEl.getAttribute('data-description') ?? '';\n    steps.push({ title, description });\n\n    const sequences = stepEl.getElementsByTagName('sequence');\n    if (sequences.length >= 1) {\n      const forwardName = sequences[0].getAttribute('name');\n      if (forwardName) {\n        sequenceMap[`${index - 1}-${index}`] = forwardName;\n      }\n    }\n    if (sequences.length >= 2) {\n      const reverseName = sequences[1].getAttribute('name');\n      if (reverseName) {\n        sequenceMap[`${index}-${index - 1}`] = reverseName;\n      }\n    }\n  });\n\n  return { steps, sequenceMap };\n}\n","// src/Constants.js\nvar TYPES_ENUM = {\n  i8: \"i8\",\n  ui8: \"ui8\",\n  ui8c: \"ui8c\",\n  i16: \"i16\",\n  ui16: \"ui16\",\n  i32: \"i32\",\n  ui32: \"ui32\",\n  f32: \"f32\",\n  f64: \"f64\",\n  eid: \"eid\"\n};\nvar TYPES_NAMES = {\n  i8: \"Int8\",\n  ui8: \"Uint8\",\n  ui8c: \"Uint8Clamped\",\n  i16: \"Int16\",\n  ui16: \"Uint16\",\n  i32: \"Int32\",\n  ui32: \"Uint32\",\n  eid: \"Uint32\",\n  f32: \"Float32\",\n  f64: \"Float64\"\n};\nvar TYPES = {\n  i8: Int8Array,\n  ui8: Uint8Array,\n  ui8c: Uint8ClampedArray,\n  i16: Int16Array,\n  ui16: Uint16Array,\n  i32: Int32Array,\n  ui32: Uint32Array,\n  f32: Float32Array,\n  f64: Float64Array,\n  eid: Uint32Array\n};\nvar UNSIGNED_MAX = {\n  uint8: 2 ** 8,\n  uint16: 2 ** 16,\n  uint32: 2 ** 32\n};\n\n// src/Storage.js\nvar roundToMultiple = (mul) => (x) => Math.ceil(x / mul) * mul;\nvar roundToMultiple4 = roundToMultiple(4);\nvar $storeRef = Symbol(\"storeRef\");\nvar $storeSize = Symbol(\"storeSize\");\nvar $storeMaps = Symbol(\"storeMaps\");\nvar $storeFlattened = Symbol(\"storeFlattened\");\nvar $storeBase = Symbol(\"storeBase\");\nvar $storeType = Symbol(\"storeType\");\nvar $storeArrayElementCounts = Symbol(\"storeArrayElementCounts\");\nvar $storeSubarrays = Symbol(\"storeSubarrays\");\nvar $subarrayCursors = Symbol(\"subarrayCursors\");\nvar $subarray = Symbol(\"subarray\");\nvar $subarrayFrom = Symbol(\"subarrayFrom\");\nvar $subarrayTo = Symbol(\"subarrayTo\");\nvar $parentArray = Symbol(\"parentArray\");\nvar $tagStore = Symbol(\"tagStore\");\nvar $queryShadow = Symbol(\"queryShadow\");\nvar $serializeShadow = Symbol(\"serializeShadow\");\nvar $indexType = Symbol(\"indexType\");\nvar $indexBytes = Symbol(\"indexBytes\");\nvar $isEidType = Symbol(\"isEidType\");\nvar stores = {};\nvar resize = (ta, size) => {\n  const newBuffer = new ArrayBuffer(size * ta.BYTES_PER_ELEMENT);\n  const newTa = new ta.constructor(newBuffer);\n  newTa.set(ta, 0);\n  return newTa;\n};\nvar createShadow = (store, key) => {\n  if (!ArrayBuffer.isView(store)) {\n    const shadowStore = store[$parentArray].slice(0);\n    store[key] = store.map((_, eid) => {\n      const { length } = store[eid];\n      const start = length * eid;\n      const end = start + length;\n      return shadowStore.subarray(start, end);\n    });\n  } else {\n    store[key] = store.slice(0);\n  }\n};\nvar resetStoreFor = (store, eid) => {\n  if (store[$storeFlattened]) {\n    store[$storeFlattened].forEach((ta) => {\n      if (ArrayBuffer.isView(ta))\n        ta[eid] = 0;\n      else\n        ta[eid].fill(0);\n    });\n  }\n};\nvar createTypeStore = (type, length) => {\n  const totalBytes = length * TYPES[type].BYTES_PER_ELEMENT;\n  const buffer = new ArrayBuffer(totalBytes);\n  const store = new TYPES[type](buffer);\n  store[$isEidType] = type === TYPES_ENUM.eid;\n  return store;\n};\nvar parentArray = (store) => store[$parentArray];\nvar createArrayStore = (metadata, type, length) => {\n  const storeSize = metadata[$storeSize];\n  const store = Array(storeSize).fill(0);\n  store[$storeType] = type;\n  store[$isEidType] = type === TYPES_ENUM.eid;\n  const cursors = metadata[$subarrayCursors];\n  const indexType = length <= UNSIGNED_MAX.uint8 ? TYPES_ENUM.ui8 : length <= UNSIGNED_MAX.uint16 ? TYPES_ENUM.ui16 : TYPES_ENUM.ui32;\n  if (!length)\n    throw new Error(\"bitECS - Must define component array length\");\n  if (!TYPES[type])\n    throw new Error(`bitECS - Invalid component array property type ${type}`);\n  if (!metadata[$storeSubarrays][type]) {\n    const arrayElementCount = metadata[$storeArrayElementCounts][type];\n    const array = new TYPES[type](roundToMultiple4(arrayElementCount * storeSize));\n    array[$indexType] = TYPES_NAMES[indexType];\n    array[$indexBytes] = TYPES[indexType].BYTES_PER_ELEMENT;\n    metadata[$storeSubarrays][type] = array;\n  }\n  const start = cursors[type];\n  const end = start + storeSize * length;\n  cursors[type] = end;\n  store[$parentArray] = metadata[$storeSubarrays][type].subarray(start, end);\n  for (let eid = 0; eid < storeSize; eid++) {\n    const start2 = length * eid;\n    const end2 = start2 + length;\n    store[eid] = store[$parentArray].subarray(start2, end2);\n    store[eid][$indexType] = TYPES_NAMES[indexType];\n    store[eid][$indexBytes] = TYPES[indexType].BYTES_PER_ELEMENT;\n    store[eid][$subarray] = true;\n  }\n  return store;\n};\nvar isArrayType = (x) => Array.isArray(x) && typeof x[0] === \"string\" && typeof x[1] === \"number\";\nvar createStore = (schema, size) => {\n  const $store = Symbol(\"store\");\n  if (!schema || !Object.keys(schema).length) {\n    stores[$store] = {\n      [$storeSize]: size,\n      [$tagStore]: true,\n      [$storeBase]: () => stores[$store]\n    };\n    return stores[$store];\n  }\n  schema = JSON.parse(JSON.stringify(schema));\n  const arrayElementCounts = {};\n  const collectArrayElementCounts = (s) => {\n    const keys = Object.keys(s);\n    for (const k of keys) {\n      if (isArrayType(s[k])) {\n        if (!arrayElementCounts[s[k][0]])\n          arrayElementCounts[s[k][0]] = 0;\n        arrayElementCounts[s[k][0]] += s[k][1];\n      } else if (s[k] instanceof Object) {\n        collectArrayElementCounts(s[k]);\n      }\n    }\n  };\n  collectArrayElementCounts(schema);\n  const metadata = {\n    [$storeSize]: size,\n    [$storeMaps]: {},\n    [$storeSubarrays]: {},\n    [$storeRef]: $store,\n    [$subarrayCursors]: Object.keys(TYPES).reduce((a, type) => ({ ...a, [type]: 0 }), {}),\n    [$storeFlattened]: [],\n    [$storeArrayElementCounts]: arrayElementCounts\n  };\n  if (schema instanceof Object && Object.keys(schema).length) {\n    const recursiveTransform = (a, k) => {\n      if (typeof a[k] === \"string\") {\n        a[k] = createTypeStore(a[k], size);\n        a[k][$storeBase] = () => stores[$store];\n        metadata[$storeFlattened].push(a[k]);\n      } else if (isArrayType(a[k])) {\n        const [type, length] = a[k];\n        a[k] = createArrayStore(metadata, type, length);\n        a[k][$storeBase] = () => stores[$store];\n        metadata[$storeFlattened].push(a[k]);\n      } else if (a[k] instanceof Object) {\n        a[k] = Object.keys(a[k]).reduce(recursiveTransform, a[k]);\n      }\n      return a;\n    };\n    stores[$store] = Object.assign(Object.keys(schema).reduce(recursiveTransform, schema), metadata);\n    stores[$store][$storeBase] = () => stores[$store];\n    return stores[$store];\n  }\n};\n\n// src/Util.js\nvar SparseSet = () => {\n  const dense = [];\n  const sparse = [];\n  dense.sort = function(comparator) {\n    const result = Array.prototype.sort.call(this, comparator);\n    for (let i = 0; i < dense.length; i++) {\n      sparse[dense[i]] = i;\n    }\n    return result;\n  };\n  const has = (val) => dense[sparse[val]] === val;\n  const add = (val) => {\n    if (has(val))\n      return;\n    sparse[val] = dense.push(val) - 1;\n  };\n  const remove = (val) => {\n    if (!has(val))\n      return;\n    const index = sparse[val];\n    const swapped = dense.pop();\n    if (swapped !== val) {\n      dense[index] = swapped;\n      sparse[swapped] = index;\n    }\n  };\n  const reset = () => {\n    dense.length = 0;\n    sparse.length = 0;\n  };\n  return {\n    add,\n    remove,\n    has,\n    sparse,\n    dense,\n    reset\n  };\n};\n\n// src/Serialize.js\nvar DESERIALIZE_MODE = {\n  REPLACE: 0,\n  APPEND: 1,\n  MAP: 2\n};\nvar resized = false;\nvar setSerializationResized = (v) => {\n  resized = v;\n};\nvar concat = (a, v) => a.concat(v);\nvar not = (fn) => (v) => !fn(v);\nvar storeFlattened = (c) => c[$storeFlattened];\nvar isFullComponent = storeFlattened;\nvar isProperty = not(isFullComponent);\nvar isModifier = (c) => typeof c === \"function\" && c[$modifier];\nvar isNotModifier = not(isModifier);\nvar isChangedModifier = (c) => isModifier(c) && c()[1] === \"changed\";\nvar isWorld = (w) => Object.getOwnPropertySymbols(w).includes($componentMap);\nvar fromModifierToComponent = (c) => c()[0];\nvar canonicalize = (target) => {\n  if (isWorld(target))\n    return [[], /* @__PURE__ */ new Map()];\n  const fullComponentProps = target.filter(isNotModifier).filter(isFullComponent).map(storeFlattened).reduce(concat, []);\n  const changedComponentProps = target.filter(isChangedModifier).map(fromModifierToComponent).filter(isFullComponent).map(storeFlattened).reduce(concat, []);\n  const props = target.filter(isNotModifier).filter(isProperty);\n  const changedProps = target.filter(isChangedModifier).map(fromModifierToComponent).filter(isProperty);\n  const componentProps = [...fullComponentProps, ...props, ...changedComponentProps, ...changedProps];\n  const allChangedProps = [...changedComponentProps, ...changedProps].reduce((map, prop) => {\n    const $ = Symbol();\n    createShadow(prop, $);\n    map.set(prop, $);\n    return map;\n  }, /* @__PURE__ */ new Map());\n  return [componentProps, allChangedProps];\n};\nvar defineSerializer = (target, maxBytes = 2e7) => {\n  const worldSerializer = isWorld(target);\n  let [componentProps, changedProps] = canonicalize(target);\n  const buffer = new ArrayBuffer(maxBytes);\n  const view = new DataView(buffer);\n  const entityComponentCache = /* @__PURE__ */ new Map();\n  return (ents) => {\n    if (resized) {\n      [componentProps, changedProps] = canonicalize(target);\n      resized = false;\n    }\n    if (worldSerializer) {\n      componentProps = [];\n      target[$componentMap].forEach((c, component) => {\n        if (component[$storeFlattened])\n          componentProps.push(...component[$storeFlattened]);\n        else\n          componentProps.push(component);\n      });\n    }\n    let world;\n    if (Object.getOwnPropertySymbols(ents).includes($componentMap)) {\n      world = ents;\n      ents = ents[$entityArray];\n    } else {\n      world = eidToWorld.get(ents[0]);\n    }\n    let where = 0;\n    if (!ents.length)\n      return buffer.slice(0, where);\n    const cache = /* @__PURE__ */ new Map();\n    for (let pid = 0; pid < componentProps.length; pid++) {\n      const prop = componentProps[pid];\n      const component = prop[$storeBase]();\n      const $diff = changedProps.get(prop);\n      const shadow = $diff ? prop[$diff] : null;\n      if (!cache.has(component))\n        cache.set(component, /* @__PURE__ */ new Map());\n      view.setUint8(where, pid);\n      where += 1;\n      const countWhere = where;\n      where += 4;\n      let writeCount = 0;\n      for (let i = 0; i < ents.length; i++) {\n        const eid = ents[i];\n        let componentCache = entityComponentCache.get(eid);\n        if (!componentCache)\n          componentCache = entityComponentCache.set(eid, /* @__PURE__ */ new Set()).get(eid);\n        componentCache.add(eid);\n        const newlyAddedComponent = shadow && cache.get(component).get(eid) || !componentCache.has(component) && hasComponent(world, component, eid);\n        cache.get(component).set(eid, newlyAddedComponent);\n        if (newlyAddedComponent) {\n          componentCache.add(component);\n        } else if (!hasComponent(world, component, eid)) {\n          componentCache.delete(component);\n          continue;\n        }\n        const rewindWhere = where;\n        view.setUint32(where, eid);\n        where += 4;\n        if (prop[$tagStore]) {\n          writeCount++;\n          continue;\n        }\n        if (ArrayBuffer.isView(prop[eid])) {\n          const type = prop[eid].constructor.name.replace(\"Array\", \"\");\n          const indexType = prop[eid][$indexType];\n          const indexBytes = prop[eid][$indexBytes];\n          const countWhere2 = where;\n          where += indexBytes;\n          let arrayWriteCount = 0;\n          for (let i2 = 0; i2 < prop[eid].length; i2++) {\n            if (shadow) {\n              const changed = shadow[eid][i2] !== prop[eid][i2];\n              shadow[eid][i2] = prop[eid][i2];\n              if (!changed && !newlyAddedComponent) {\n                continue;\n              }\n            }\n            view[`set${indexType}`](where, i2);\n            where += indexBytes;\n            const value = prop[eid][i2];\n            view[`set${type}`](where, value);\n            where += prop[eid].BYTES_PER_ELEMENT;\n            arrayWriteCount++;\n          }\n          if (arrayWriteCount > 0) {\n            view[`set${indexType}`](countWhere2, arrayWriteCount);\n            writeCount++;\n          } else {\n            where = rewindWhere;\n            continue;\n          }\n        } else {\n          if (shadow) {\n            const changed = shadow[eid] !== prop[eid];\n            shadow[eid] = prop[eid];\n            if (!changed && !newlyAddedComponent) {\n              where = rewindWhere;\n              continue;\n            }\n          }\n          const type = prop.constructor.name.replace(\"Array\", \"\");\n          view[`set${type}`](where, prop[eid]);\n          where += prop.BYTES_PER_ELEMENT;\n          writeCount++;\n        }\n      }\n      if (writeCount > 0) {\n        view.setUint32(countWhere, writeCount);\n      } else {\n        where -= 5;\n      }\n    }\n    return buffer.slice(0, where);\n  };\n};\nvar newEntities = /* @__PURE__ */ new Map();\nvar defineDeserializer = (target) => {\n  const isWorld2 = Object.getOwnPropertySymbols(target).includes($componentMap);\n  let [componentProps] = canonicalize(target);\n  const deserializedEntities = /* @__PURE__ */ new Set();\n  return (world, packet, mode = 0) => {\n    newEntities.clear();\n    if (resized) {\n      [componentProps] = canonicalize(target);\n      resized = false;\n    }\n    if (isWorld2) {\n      componentProps = [];\n      target[$componentMap].forEach((c, component) => {\n        if (component[$storeFlattened])\n          componentProps.push(...component[$storeFlattened]);\n        else\n          componentProps.push(component);\n      });\n    }\n    const localEntities = world[$localEntities];\n    const localEntityLookup = world[$localEntityLookup];\n    const view = new DataView(packet);\n    let where = 0;\n    while (where < packet.byteLength) {\n      const pid = view.getUint8(where);\n      where += 1;\n      const entityCount = view.getUint32(where);\n      where += 4;\n      const prop = componentProps[pid];\n      for (let i = 0; i < entityCount; i++) {\n        let eid = view.getUint32(where);\n        where += 4;\n        if (mode === DESERIALIZE_MODE.MAP) {\n          if (localEntities.has(eid)) {\n            eid = localEntities.get(eid);\n          } else if (newEntities.has(eid)) {\n            eid = newEntities.get(eid);\n          } else {\n            const newEid = addEntity(world);\n            localEntities.set(eid, newEid);\n            localEntityLookup.set(newEid, eid);\n            newEntities.set(eid, newEid);\n            eid = newEid;\n          }\n        }\n        if (mode === DESERIALIZE_MODE.APPEND || mode === DESERIALIZE_MODE.REPLACE && !world[$entitySparseSet].has(eid)) {\n          const newEid = newEntities.get(eid) || addEntity(world);\n          newEntities.set(eid, newEid);\n          eid = newEid;\n        }\n        const component = prop[$storeBase]();\n        if (!hasComponent(world, component, eid)) {\n          addComponent(world, component, eid);\n        }\n        deserializedEntities.add(eid);\n        if (component[$tagStore]) {\n          continue;\n        }\n        if (ArrayBuffer.isView(prop[eid])) {\n          const array = prop[eid];\n          const count = view[`get${array[$indexType]}`](where);\n          where += array[$indexBytes];\n          for (let i2 = 0; i2 < count; i2++) {\n            const index = view[`get${array[$indexType]}`](where);\n            where += array[$indexBytes];\n            const value = view[`get${array.constructor.name.replace(\"Array\", \"\")}`](where);\n            where += array.BYTES_PER_ELEMENT;\n            if (prop[$isEidType]) {\n              let localEid;\n              if (localEntities.has(value)) {\n                localEid = localEntities.get(value);\n              } else if (newEntities.has(value)) {\n                localEid = newEntities.get(value);\n              } else {\n                const newEid = addEntity(world);\n                localEntities.set(value, newEid);\n                localEntityLookup.set(newEid, value);\n                newEntities.set(value, newEid);\n                localEid = newEid;\n              }\n              prop[eid][index] = localEid;\n            } else\n              prop[eid][index] = value;\n          }\n        } else {\n          const value = view[`get${prop.constructor.name.replace(\"Array\", \"\")}`](where);\n          where += prop.BYTES_PER_ELEMENT;\n          if (prop[$isEidType]) {\n            let localEid;\n            if (localEntities.has(value)) {\n              localEid = localEntities.get(value);\n            } else if (newEntities.has(value)) {\n              localEid = newEntities.get(value);\n            } else {\n              const newEid = addEntity(world);\n              localEntities.set(value, newEid);\n              localEntityLookup.set(newEid, value);\n              newEntities.set(value, newEid);\n              localEid = newEid;\n            }\n            prop[eid] = localEid;\n          } else\n            prop[eid] = value;\n        }\n      }\n    }\n    const ents = Array.from(deserializedEntities);\n    deserializedEntities.clear();\n    return ents;\n  };\n};\n\n// src/Entity.js\nvar $entityMasks = Symbol(\"entityMasks\");\nvar $entityComponents = Symbol(\"entityComponents\");\nvar $entitySparseSet = Symbol(\"entitySparseSet\");\nvar $entityArray = Symbol(\"entityArray\");\nvar $entityIndices = Symbol(\"entityIndices\");\nvar $removedEntities = Symbol(\"removedEntities\");\nvar defaultSize = 1e5;\nvar globalEntityCursor = 0;\nvar globalSize = defaultSize;\nvar getGlobalSize = () => globalSize;\nvar removed = [];\nvar recycled = [];\nvar defaultRemovedReuseThreshold = 0.01;\nvar removedReuseThreshold = defaultRemovedReuseThreshold;\nvar resetGlobals = () => {\n  globalSize = defaultSize;\n  globalEntityCursor = 0;\n  removedReuseThreshold = defaultRemovedReuseThreshold;\n  removed.length = 0;\n  recycled.length = 0;\n};\nvar setDefaultSize = (newSize) => {\n  const oldSize = globalSize;\n  defaultSize = newSize;\n  resetGlobals();\n  globalSize = newSize;\n  resizeWorlds(newSize);\n  setSerializationResized(true);\n};\nvar setRemovedRecycleThreshold = (newThreshold) => {\n  removedReuseThreshold = newThreshold;\n};\nvar getEntityCursor = () => globalEntityCursor;\nvar eidToWorld = /* @__PURE__ */ new Map();\nvar flushRemovedEntities = (world) => {\n  if (!world[$manualEntityRecycling]) {\n    throw new Error(\"bitECS - cannot flush removed entities, enable feature with the enableManualEntityRecycling function\");\n  }\n  removed.push(...recycled);\n  recycled.length = 0;\n};\nvar addEntity = (world) => {\n  const eid = world[$manualEntityRecycling] ? removed.length ? removed.shift() : globalEntityCursor++ : removed.length > Math.round(globalSize * removedReuseThreshold) ? removed.shift() : globalEntityCursor++;\n  if (eid > world[$size])\n    throw new Error(\"bitECS - max entities reached\");\n  world[$entitySparseSet].add(eid);\n  eidToWorld.set(eid, world);\n  world[$notQueries].forEach((q) => {\n    const match = queryCheckEntity(world, q, eid);\n    if (match)\n      queryAddEntity(q, eid);\n  });\n  world[$entityComponents].set(eid, /* @__PURE__ */ new Set());\n  return eid;\n};\nvar removeEntity = (world, eid) => {\n  if (!world[$entitySparseSet].has(eid))\n    return;\n  world[$queries].forEach((q) => {\n    queryRemoveEntity(world, q, eid);\n  });\n  if (world[$manualEntityRecycling])\n    recycled.push(eid);\n  else\n    removed.push(eid);\n  world[$entitySparseSet].remove(eid);\n  world[$entityComponents].delete(eid);\n  world[$localEntities].delete(world[$localEntityLookup].get(eid));\n  world[$localEntityLookup].delete(eid);\n  for (let i = 0; i < world[$entityMasks].length; i++)\n    world[$entityMasks][i][eid] = 0;\n};\nvar getEntityComponents = (world, eid) => {\n  if (eid === void 0)\n    throw new Error(\"bitECS - entity is undefined.\");\n  if (!world[$entitySparseSet].has(eid))\n    throw new Error(\"bitECS - entity does not exist in the world.\");\n  return Array.from(world[$entityComponents].get(eid));\n};\nvar entityExists = (world, eid) => world[$entitySparseSet].has(eid);\n\n// src/Query.js\nvar $modifier = Symbol(\"$modifier\");\nfunction modifier(c, mod) {\n  const inner = () => [c, mod];\n  inner[$modifier] = true;\n  return inner;\n}\nvar Not = (c) => modifier(c, \"not\");\nvar Changed = (c) => modifier(c, \"changed\");\nfunction Any(...comps) {\n  return function QueryAny() {\n    return comps;\n  };\n}\nfunction All(...comps) {\n  return function QueryAll() {\n    return comps;\n  };\n}\nfunction None(...comps) {\n  return function QueryNone() {\n    return comps;\n  };\n}\nvar $queries = Symbol(\"queries\");\nvar $notQueries = Symbol(\"notQueries\");\nvar $queryAny = Symbol(\"queryAny\");\nvar $queryAll = Symbol(\"queryAll\");\nvar $queryNone = Symbol(\"queryNone\");\nvar $queryMap = Symbol(\"queryMap\");\nvar $dirtyQueries = Symbol(\"$dirtyQueries\");\nvar $queryComponents = Symbol(\"queryComponents\");\nvar $enterQuery = Symbol(\"enterQuery\");\nvar $exitQuery = Symbol(\"exitQuery\");\nvar empty = Object.freeze([]);\nvar enterQuery = (query) => (world) => {\n  if (!world[$queryMap].has(query))\n    registerQuery(world, query);\n  const q = world[$queryMap].get(query);\n  if (q.entered.dense.length === 0) {\n    return empty;\n  } else {\n    const results = q.entered.dense.slice();\n    q.entered.reset();\n    return results;\n  }\n};\nvar exitQuery = (query) => (world) => {\n  if (!world[$queryMap].has(query))\n    registerQuery(world, query);\n  const q = world[$queryMap].get(query);\n  if (q.exited.dense.length === 0) {\n    return empty;\n  } else {\n    const results = q.exited.dense.slice();\n    q.exited.reset();\n    return results;\n  }\n};\nvar registerQuery = (world, query) => {\n  const components2 = [];\n  const notComponents = [];\n  const changedComponents = [];\n  query[$queryComponents].forEach((c) => {\n    if (typeof c === \"function\" && c[$modifier]) {\n      const [comp, mod] = c();\n      if (!world[$componentMap].has(comp))\n        registerComponent(world, comp);\n      if (mod === \"not\") {\n        notComponents.push(comp);\n      }\n      if (mod === \"changed\") {\n        changedComponents.push(comp);\n        components2.push(comp);\n      }\n    } else {\n      if (!world[$componentMap].has(c))\n        registerComponent(world, c);\n      components2.push(c);\n    }\n  });\n  const mapComponents = (c) => world[$componentMap].get(c);\n  const allComponents = components2.concat(notComponents).map(mapComponents);\n  const sparseSet = SparseSet();\n  const archetypes = [];\n  const changed = [];\n  const toRemove = SparseSet();\n  const entered = SparseSet();\n  const exited = SparseSet();\n  const generations = allComponents.map((c) => c.generationId).reduce((a, v) => {\n    if (a.includes(v))\n      return a;\n    a.push(v);\n    return a;\n  }, []);\n  const reduceBitflags = (a, c) => {\n    if (!a[c.generationId])\n      a[c.generationId] = 0;\n    a[c.generationId] |= c.bitflag;\n    return a;\n  };\n  const masks = components2.map(mapComponents).reduce(reduceBitflags, {});\n  const notMasks = notComponents.map(mapComponents).reduce(reduceBitflags, {});\n  const hasMasks = allComponents.reduce(reduceBitflags, {});\n  const flatProps = components2.filter((c) => !c[$tagStore]).map((c) => Object.getOwnPropertySymbols(c).includes($storeFlattened) ? c[$storeFlattened] : [c]).reduce((a, v) => a.concat(v), []);\n  const shadows = [];\n  const q = Object.assign(sparseSet, {\n    archetypes,\n    changed,\n    components: components2,\n    notComponents,\n    changedComponents,\n    allComponents,\n    masks,\n    notMasks,\n    hasMasks,\n    generations,\n    flatProps,\n    toRemove,\n    entered,\n    exited,\n    shadows\n  });\n  world[$queryMap].set(query, q);\n  world[$queries].add(q);\n  allComponents.forEach((c) => {\n    c.queries.add(q);\n  });\n  if (notComponents.length)\n    world[$notQueries].add(q);\n  for (let eid = 0; eid < getEntityCursor(); eid++) {\n    if (!world[$entitySparseSet].has(eid))\n      continue;\n    const match = queryCheckEntity(world, q, eid);\n    if (match)\n      queryAddEntity(q, eid);\n  }\n};\nvar generateShadow = (q, pid) => {\n  const $ = Symbol();\n  const prop = q.flatProps[pid];\n  createShadow(prop, $);\n  q.shadows[pid] = prop[$];\n  return prop[$];\n};\nvar diff = (q, clearDiff) => {\n  if (clearDiff)\n    q.changed = [];\n  const { flatProps, shadows } = q;\n  for (let i = 0; i < q.dense.length; i++) {\n    const eid = q.dense[i];\n    let dirty = false;\n    for (let pid = 0; pid < flatProps.length; pid++) {\n      const prop = flatProps[pid];\n      const shadow = shadows[pid] || generateShadow(q, pid);\n      if (ArrayBuffer.isView(prop[eid])) {\n        for (let i2 = 0; i2 < prop[eid].length; i2++) {\n          if (prop[eid][i2] !== shadow[eid][i2]) {\n            dirty = true;\n            break;\n          }\n        }\n        shadow[eid].set(prop[eid]);\n      } else {\n        if (prop[eid] !== shadow[eid]) {\n          dirty = true;\n          shadow[eid] = prop[eid];\n        }\n      }\n    }\n    if (dirty)\n      q.changed.push(eid);\n  }\n  return q.changed;\n};\nvar flatten = (a, v) => a.concat(v);\nvar aggregateComponentsFor = (mod) => (x) => x.filter((f) => f.name === mod().constructor.name).reduce(flatten);\nvar getAnyComponents = aggregateComponentsFor(Any);\nvar getAllComponents = aggregateComponentsFor(All);\nvar getNoneComponents = aggregateComponentsFor(None);\nvar defineQuery = (...args) => {\n  let components2;\n  let any, all, none;\n  if (Array.isArray(args[0])) {\n    components2 = args[0];\n  } else {\n  }\n  if (components2 === void 0 || components2[$componentMap] !== void 0) {\n    return (world) => world ? world[$entityArray] : components2[$entityArray];\n  }\n  const query = function(world, clearDiff = true) {\n    if (!world[$queryMap].has(query))\n      registerQuery(world, query);\n    const q = world[$queryMap].get(query);\n    commitRemovals(world);\n    if (q.changedComponents.length)\n      return diff(q, clearDiff);\n    return q.dense;\n  };\n  query[$queryComponents] = components2;\n  query[$queryAny] = any;\n  query[$queryAll] = all;\n  query[$queryNone] = none;\n  return query;\n};\nvar queryCheckEntity = (world, q, eid) => {\n  const { masks, notMasks, generations } = q;\n  let or = 0;\n  for (let i = 0; i < generations.length; i++) {\n    const generationId = generations[i];\n    const qMask = masks[generationId];\n    const qNotMask = notMasks[generationId];\n    const eMask = world[$entityMasks][generationId][eid];\n    if (qNotMask && (eMask & qNotMask) !== 0) {\n      return false;\n    }\n    if (qMask && (eMask & qMask) !== qMask) {\n      return false;\n    }\n  }\n  return true;\n};\nvar queryAddEntity = (q, eid) => {\n  q.toRemove.remove(eid);\n  q.entered.add(eid);\n  q.add(eid);\n};\nvar queryCommitRemovals = (q) => {\n  for (let i = q.toRemove.dense.length - 1; i >= 0; i--) {\n    const eid = q.toRemove.dense[i];\n    q.toRemove.remove(eid);\n    q.remove(eid);\n  }\n};\nvar commitRemovals = (world) => {\n  if (!world[$dirtyQueries].size)\n    return;\n  world[$dirtyQueries].forEach(queryCommitRemovals);\n  world[$dirtyQueries].clear();\n};\nvar queryRemoveEntity = (world, q, eid) => {\n  if (!q.has(eid) || q.toRemove.has(eid))\n    return;\n  q.toRemove.add(eid);\n  world[$dirtyQueries].add(q);\n  q.exited.add(eid);\n};\nvar resetChangedQuery = (world, query) => {\n  const q = world[$queryMap].get(query);\n  q.changed = [];\n};\nvar removeQuery = (world, query) => {\n  const q = world[$queryMap].get(query);\n  world[$queries].delete(q);\n  world[$queryMap].delete(query);\n};\n\n// src/Component.js\nvar $componentMap = Symbol(\"componentMap\");\nvar components = [];\nvar defineComponent = (schema, size) => {\n  const component = createStore(schema, size || getGlobalSize());\n  if (schema && Object.keys(schema).length)\n    components.push(component);\n  return component;\n};\nvar incrementBitflag = (world) => {\n  world[$bitflag] *= 2;\n  if (world[$bitflag] >= 2 ** 31) {\n    world[$bitflag] = 1;\n    world[$entityMasks].push(new Uint32Array(world[$size]));\n  }\n};\nvar registerComponent = (world, component) => {\n  if (!component)\n    throw new Error(`bitECS - Cannot register null or undefined component`);\n  const queries = /* @__PURE__ */ new Set();\n  const notQueries = /* @__PURE__ */ new Set();\n  const changedQueries = /* @__PURE__ */ new Set();\n  world[$queries].forEach((q) => {\n    if (q.allComponents.includes(component)) {\n      queries.add(q);\n    }\n  });\n  world[$componentMap].set(component, {\n    generationId: world[$entityMasks].length - 1,\n    bitflag: world[$bitflag],\n    store: component,\n    queries,\n    notQueries,\n    changedQueries\n  });\n  incrementBitflag(world);\n};\nvar registerComponents = (world, components2) => {\n  components2.forEach((c) => registerComponent(world, c));\n};\nvar hasComponent = (world, component, eid) => {\n  const registeredComponent = world[$componentMap].get(component);\n  if (!registeredComponent)\n    return false;\n  const { generationId, bitflag } = registeredComponent;\n  const mask = world[$entityMasks][generationId][eid];\n  return (mask & bitflag) === bitflag;\n};\nvar addComponent = (world, component, eid, reset = false) => {\n  if (eid === void 0)\n    throw new Error(\"bitECS - entity is undefined.\");\n  if (!world[$entitySparseSet].has(eid))\n    throw new Error(\"bitECS - entity does not exist in the world.\");\n  if (!world[$componentMap].has(component))\n    registerComponent(world, component);\n  if (hasComponent(world, component, eid))\n    return;\n  const c = world[$componentMap].get(component);\n  const { generationId, bitflag, queries, notQueries } = c;\n  world[$entityMasks][generationId][eid] |= bitflag;\n  queries.forEach((q) => {\n    q.toRemove.remove(eid);\n    const match = queryCheckEntity(world, q, eid);\n    if (match) {\n      q.exited.remove(eid);\n      queryAddEntity(q, eid);\n    }\n    if (!match) {\n      q.entered.remove(eid);\n      queryRemoveEntity(world, q, eid);\n    }\n  });\n  world[$entityComponents].get(eid).add(component);\n  if (reset)\n    resetStoreFor(component, eid);\n};\nvar removeComponent = (world, component, eid, reset = true) => {\n  if (eid === void 0)\n    throw new Error(\"bitECS - entity is undefined.\");\n  if (!world[$entitySparseSet].has(eid))\n    throw new Error(\"bitECS - entity does not exist in the world.\");\n  if (!hasComponent(world, component, eid))\n    return;\n  const c = world[$componentMap].get(component);\n  const { generationId, bitflag, queries } = c;\n  world[$entityMasks][generationId][eid] &= ~bitflag;\n  queries.forEach((q) => {\n    q.toRemove.remove(eid);\n    const match = queryCheckEntity(world, q, eid);\n    if (match) {\n      q.exited.remove(eid);\n      queryAddEntity(q, eid);\n    }\n    if (!match) {\n      q.entered.remove(eid);\n      queryRemoveEntity(world, q, eid);\n    }\n  });\n  world[$entityComponents].get(eid).delete(component);\n  if (reset)\n    resetStoreFor(component, eid);\n};\n\n// src/World.js\nvar $size = Symbol(\"size\");\nvar $resizeThreshold = Symbol(\"resizeThreshold\");\nvar $bitflag = Symbol(\"bitflag\");\nvar $archetypes = Symbol(\"archetypes\");\nvar $localEntities = Symbol(\"localEntities\");\nvar $localEntityLookup = Symbol(\"localEntityLookup\");\nvar $manualEntityRecycling = Symbol(\"manualEntityRecycling\");\nvar worlds = [];\nvar resizeWorlds = (size) => {\n  worlds.forEach((world) => {\n    world[$size] = size;\n    for (let i = 0; i < world[$entityMasks].length; i++) {\n      const masks = world[$entityMasks][i];\n      world[$entityMasks][i] = resize(masks, size);\n    }\n    world[$resizeThreshold] = world[$size] - world[$size] / 5;\n  });\n};\nvar createWorld = (...args) => {\n  const world = typeof args[0] === \"object\" ? args[0] : {};\n  const size = typeof args[0] === \"number\" ? args[0] : typeof args[1] === \"number\" ? args[1] : getGlobalSize();\n  resetWorld(world, size);\n  worlds.push(world);\n  return world;\n};\nvar enableManualEntityRecycling = (world) => {\n  world[$manualEntityRecycling] = true;\n};\nvar resetWorld = (world, size = getGlobalSize()) => {\n  world[$size] = size;\n  if (world[$entityArray])\n    world[$entityArray].forEach((eid) => removeEntity(world, eid));\n  world[$entityMasks] = [new Uint32Array(size)];\n  world[$entityComponents] = /* @__PURE__ */ new Map();\n  world[$archetypes] = [];\n  world[$entitySparseSet] = SparseSet();\n  world[$entityArray] = world[$entitySparseSet].dense;\n  world[$bitflag] = 1;\n  world[$componentMap] = /* @__PURE__ */ new Map();\n  world[$queryMap] = /* @__PURE__ */ new Map();\n  world[$queries] = /* @__PURE__ */ new Set();\n  world[$notQueries] = /* @__PURE__ */ new Set();\n  world[$dirtyQueries] = /* @__PURE__ */ new Set();\n  world[$localEntities] = /* @__PURE__ */ new Map();\n  world[$localEntityLookup] = /* @__PURE__ */ new Map();\n  world[$manualEntityRecycling] = false;\n  return world;\n};\nvar deleteWorld = (world) => {\n  Object.getOwnPropertySymbols(world).forEach(($) => {\n    delete world[$];\n  });\n  Object.keys(world).forEach((key) => {\n    delete world[key];\n  });\n  worlds.splice(worlds.indexOf(world), 1);\n};\nvar getWorldComponents = (world) => Array.from(world[$componentMap].keys());\nvar getAllEntities = (world) => world[$entitySparseSet].dense.slice(0);\n\n// src/System.js\nvar defineSystem = (update) => (world, ...args) => {\n  update(world, ...args);\n  return world;\n};\n\n// src/index.js\nvar pipe = (...fns) => (input) => {\n  let tmp = input;\n  for (let i = 0; i < fns.length; i++) {\n    const fn = fns[i];\n    tmp = fn(tmp);\n  }\n  return tmp;\n};\nvar Types = TYPES_ENUM;\nexport {\n  Changed,\n  DESERIALIZE_MODE,\n  Not,\n  Types,\n  addComponent,\n  addEntity,\n  commitRemovals,\n  createWorld,\n  defineComponent,\n  defineDeserializer,\n  defineQuery,\n  defineSerializer,\n  defineSystem,\n  deleteWorld,\n  enableManualEntityRecycling,\n  enterQuery,\n  entityExists,\n  exitQuery,\n  flushRemovedEntities,\n  getAllEntities,\n  getEntityComponents,\n  getWorldComponents,\n  hasComponent,\n  parentArray,\n  pipe,\n  registerComponent,\n  registerComponents,\n  removeComponent,\n  removeEntity,\n  removeQuery,\n  resetChangedQuery,\n  resetGlobals,\n  resetWorld,\n  setDefaultSize,\n  setRemovedRecycleThreshold\n};\n//# sourceMappingURL=index.mjs.map\n","import { defineComponent, Types } from 'bitecs';\n\nexport const Border = defineComponent({\n  color: Types.ui32,\n  padding: Types.f32,\n  thickness: Types.f32,\n  transition: Types.f32,\n  initialized: Types.ui8,\n  lineTop: Types.eid,\n  lineRight: Types.eid,\n  lineBottom: Types.eid,\n  lineLeft: Types.eid,\n});\n","import { defineQuery, type State, type System } from 'vibegame';\nimport { Transform, WorldTransform } from 'vibegame/transforms';\nimport { Line } from 'vibegame/line';\nimport { Word } from 'vibegame/text';\nimport { Border } from './components';\n\nconst borderQuery = defineQuery([Border, Transform]);\n\nfunction createLineEntity(state: State, color: number, thickness: number): number {\n  const eid = state.createEntity();\n  state.addComponent(eid, Transform, { posX: 0, posY: 0, posZ: 0 });\n  state.addComponent(eid, Line, {\n    offsetX: 0,\n    offsetY: 0,\n    offsetZ: 0,\n    color,\n    thickness,\n    visible: 1,\n  });\n  return eid;\n}\n\nexport const BorderSetupSystem: System = {\n  group: 'simulation',\n  update(state) {\n    for (const eid of borderQuery(state.world)) {\n      if (Border.initialized[eid]) continue;\n\n      const color = Border.color[eid];\n      const thickness = Border.thickness[eid];\n\n      Border.lineTop[eid] = createLineEntity(state, color, thickness);\n      Border.lineRight[eid] = createLineEntity(state, color, thickness);\n      Border.lineBottom[eid] = createLineEntity(state, color, thickness);\n      Border.lineLeft[eid] = createLineEntity(state, color, thickness);\n\n      Border.initialized[eid] = 1;\n    }\n  },\n};\n\nexport const BorderLayoutSystem: System = {\n  group: 'simulation',\n  after: [BorderSetupSystem],\n  update(state) {\n    for (const eid of borderQuery(state.world)) {\n      if (!Border.initialized[eid]) continue;\n\n      let width: number;\n      let height: number;\n\n      if (state.hasComponent(eid, Word)) {\n        width = Word.width[eid];\n        height = Word.fontSize[eid];\n      } else {\n        console.warn('border: bounds not implemented for non-text entities');\n        continue;\n      }\n\n      if (width === 0) continue;\n\n      const posX = WorldTransform.posX[eid];\n      const posY = WorldTransform.posY[eid];\n      const posZ = WorldTransform.posZ[eid];\n      const padding = Border.padding[eid];\n      const transition = Math.max(0, Math.min(1, Border.transition[eid]));\n\n      const halfWidth = width / 2 + padding;\n      const halfHeight = height / 2 + padding;\n\n      const left = posX - halfWidth;\n      const right = posX + halfWidth;\n      const top = posY + halfHeight;\n      const bottom = posY - halfHeight;\n      const boxWidth = right - left;\n      const boxHeight = top - bottom;\n\n      const lineTop = Border.lineTop[eid];\n      const lineRight = Border.lineRight[eid];\n      const lineBottom = Border.lineBottom[eid];\n      const lineLeft = Border.lineLeft[eid];\n\n      Transform.posX[lineTop] = left;\n      Transform.posY[lineTop] = top;\n      Transform.posZ[lineTop] = posZ;\n      Line.offsetX[lineTop] = boxWidth * transition;\n      Line.offsetY[lineTop] = 0;\n\n      Transform.posX[lineRight] = right;\n      Transform.posY[lineRight] = top;\n      Transform.posZ[lineRight] = posZ;\n      Line.offsetX[lineRight] = 0;\n      Line.offsetY[lineRight] = -boxHeight * transition;\n\n      Transform.posX[lineBottom] = left;\n      Transform.posY[lineBottom] = bottom;\n      Transform.posZ[lineBottom] = posZ;\n      Line.offsetX[lineBottom] = boxWidth * transition;\n      Line.offsetY[lineBottom] = 0;\n\n      Transform.posX[lineLeft] = left;\n      Transform.posY[lineLeft] = bottom;\n      Transform.posZ[lineLeft] = posZ;\n      Line.offsetX[lineLeft] = 0;\n      Line.offsetY[lineLeft] = boxHeight * transition;\n    }\n  },\n};\n\nexport const BorderCleanupSystem: System = {\n  group: 'simulation',\n  after: [BorderLayoutSystem],\n  update(state) {\n    for (const eid of borderQuery(state.world)) {\n      if (!state.exists(eid)) {\n        const lineTop = Border.lineTop[eid];\n        const lineRight = Border.lineRight[eid];\n        const lineBottom = Border.lineBottom[eid];\n        const lineLeft = Border.lineLeft[eid];\n\n        if (state.exists(lineTop)) state.destroyEntity(lineTop);\n        if (state.exists(lineRight)) state.destroyEntity(lineRight);\n        if (state.exists(lineBottom)) state.destroyEntity(lineBottom);\n        if (state.exists(lineLeft)) state.destroyEntity(lineLeft);\n      }\n    }\n  },\n};\n","import type { Plugin } from 'vibegame';\nimport { Border } from './components';\nimport { BorderSetupSystem, BorderLayoutSystem, BorderCleanupSystem } from './systems';\n\nexport const BordersPlugin: Plugin = {\n  systems: [BorderSetupSystem, BorderLayoutSystem, BorderCleanupSystem],\n  components: { Border },\n  config: {\n    defaults: {\n      border: {\n        color: 0xffffff,\n        padding: 0,\n        thickness: 1.5,\n        transition: 1,\n      },\n    },\n  },\n};\n","export default \"<entity name=\\\"controller-setup\\\" step-controller></entity>\\n<entity name=\\\"camera-target-setup\\\" transform=\\\"pos: -3.17 0 0\\\"></entity>\\n<orbit-camera\\n  name=\\\"camera-setup\\\"\\n  target=\\\"camera-target-setup\\\"\\n  current-distance=\\\"12\\\"\\n  target-distance=\\\"12\\\"\\n  current-yaw=\\\"0\\\"\\n  target-yaw=\\\"0\\\"\\n  current-pitch=\\\"0\\\"\\n  target-pitch=\\\"0\\\"\\n  min-pitch=\\\"-1.57\\\"\\n  max-pitch=\\\"1.57\\\"\\n  offset-y=\\\"0\\\"\\n  main-camera=\\\"projection: orthographic; ortho-size: 11\\\"\\n></orbit-camera>\\n<entity ambient-light=\\\"intensity: 6.0\\\"></entity>\\n<entity directional-light=\\\"intensity: 5.0; direction: -1 2 1\\\"></entity>\\n\\n<paragraph name=\\\"input-tokens\\\" transform=\\\"pos: -3 0 0\\\" gap=\\\"0.7\\\" align=\\\"center\\\">\\n  <word name=\\\"token-the\\\" text=\\\"the\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-the\\\" transform=\\\"pos: 0 0.7 0; scale: 0 0 0\\\" line=\\\"offset: 0 1 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.2\\\"></entity>\\n    <entity name=\\\"pivot-the\\\" transform=\\\"pos: 0 2 0; scale: 0 0 0\\\">\\n      <renderer name=\\\"embed-the\\\" transform=\\\"pos: 0 2 0\\\" size=\\\"0.4 4 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n    </entity>\\n    <word name=\\\"label-x1\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"1\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-dog\\\" text=\\\"dog\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-dog\\\" transform=\\\"pos: 0 0.7 0; scale: 0 0 0\\\" line=\\\"offset: 0 1 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.2\\\"></entity>\\n    <entity name=\\\"pivot-dog\\\" transform=\\\"pos: 0 2 0; scale: 0 0 0\\\">\\n      <renderer name=\\\"embed-dog\\\" transform=\\\"pos: 0 2 0\\\" size=\\\"0.4 4 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n    </entity>\\n    <word name=\\\"label-x2\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"2\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-was\\\" text=\\\"was\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-was\\\" transform=\\\"pos: 0 0.7 0; scale: 0 0 0\\\" line=\\\"offset: 0 1 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.2\\\"></entity>\\n    <entity name=\\\"pivot-was\\\" transform=\\\"pos: 0 2 0; scale: 0 0 0\\\">\\n      <renderer name=\\\"embed-was\\\" transform=\\\"pos: 0 2 0\\\" size=\\\"0.4 4 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n    </entity>\\n    <word name=\\\"label-x3\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n</paragraph>\\n\\n<entity name=\\\"nn-arrow\\\" transform=\\\"pos: 0.55 0 0; scale: 0 0 0\\\" line=\\\"offset: 1.5 0 0; color: 0x3d4852; thickness: 4; arrow-end: 1; arrow-size: 0.4\\\"></entity>\\n\\n<word name=\\\"token-output\\\" text=\\\"barking\\\" font-size=\\\"0.8\\\" transform=\\\"pos: 4.2 0 0; scale: 0 0 0\\\" color=\\\"#b85a2d\\\" border=\\\"padding: 0.2; thickness: 2; color: 0x8a4221; transition: 0\\\">\\n  <word name=\\\"label-yhat\\\" text=\\\"ŷ\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#b85a2d\\\">\\n    <word text=\\\"4\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#b85a2d\\\"></word>\\n  </word>\\n</word>\\n\\n<div class=\\\"step\\\" data-title=\\\"Input tokens\\\" data-description=\\\"We start with a sequence of input tokens—&lt;span class=&quot;token-input&quot;&gt;&quot;the&quot;&lt;/span&gt;, &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt;, &lt;span class=&quot;token-input&quot;&gt;&quot;was&quot;&lt;/span&gt;.\\\"></div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Word embeddings\\\" data-description=\\\"Each token maps to a vector representing its meaning, referred to as its &lt;span class=&quot;token-embedding&quot;&gt;embedding&lt;/span&gt;. The &lt;span class=&quot;token-embedding&quot;&gt;embedding&lt;/span&gt; of &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt; contains the meaning of dog.\\\">\\n  <sequence name=\\\"show-embeddings\\\">\\n    <tween target=\\\"camera-target-setup\\\" attr=\\\"transform.posX\\\" to=\\\"-3\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-setup\\\" attr=\\\"transform.posY\\\" to=\\\"3\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-setup\\\" attr=\\\"main-camera.ortho-size\\\" to=\\\"10\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-setup\\\" attr=\\\"orbit-camera.target-pitch\\\" to=\\\"0.3\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-setup\\\" attr=\\\"orbit-camera.target-yaw\\\" to=\\\"0.5\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"arrow-the\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-the\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.08\\\"></pause>\\n    <tween target=\\\"arrow-dog\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-dog\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.08\\\"></pause>\\n    <tween target=\\\"arrow-was\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-was\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-embeddings\\\">\\n    <tween target=\\\"pivot-the\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-dog\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-was\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"arrow-the\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"arrow-dog\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"arrow-was\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"camera-target-setup\\\" attr=\\\"transform.posX\\\" to=\\\"-3.17\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-setup\\\" attr=\\\"transform.posY\\\" to=\\\"0\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-setup\\\" attr=\\\"main-camera.ortho-size\\\" to=\\\"11\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-setup\\\" attr=\\\"orbit-camera.target-pitch\\\" to=\\\"0\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-setup\\\" attr=\\\"orbit-camera.target-yaw\\\" to=\\\"0\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n</div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Next-token prediction\\\" data-description=\\\"These &lt;span class=&quot;token-embedding&quot;&gt;embeddings&lt;/span&gt; are fed to a neural network, which predicts the most likely next token. Here it outputs &lt;span class=&quot;token-output&quot;&gt;&quot;barking&quot;&lt;/span&gt;.\\\">\\n  <sequence name=\\\"show-output\\\">\\n    <tween target=\\\"pivot-the\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-dog\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-was\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"arrow-the\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"arrow-dog\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"arrow-was\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"camera-target-setup\\\" attr=\\\"transform.posX\\\" to=\\\"0.5\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-setup\\\" attr=\\\"transform.posY\\\" to=\\\"0\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-setup\\\" attr=\\\"main-camera.ortho-size\\\" to=\\\"11\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-setup\\\" attr=\\\"orbit-camera.target-pitch\\\" to=\\\"0\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-setup\\\" attr=\\\"orbit-camera.target-yaw\\\" to=\\\"0\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"nn-arrow\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"token-output\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"token-output\\\" attr=\\\"border.transition\\\" to=\\\"1\\\" duration=\\\"1.0\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-output\\\">\\n    <tween target=\\\"nn-arrow\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"token-output\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"token-output\\\" attr=\\\"border.transition\\\" to=\\\"0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"camera-target-setup\\\" attr=\\\"transform.posX\\\" to=\\\"-3\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-setup\\\" attr=\\\"transform.posY\\\" to=\\\"3\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-setup\\\" attr=\\\"main-camera.ortho-size\\\" to=\\\"10\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-setup\\\" attr=\\\"orbit-camera.target-pitch\\\" to=\\\"0.3\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-setup\\\" attr=\\\"orbit-camera.target-yaw\\\" to=\\\"0.5\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"arrow-the\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-the\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"arrow-dog\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-dog\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"arrow-was\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-was\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n</div>\\n\"","export default \"<entity name=\\\"controller-problem\\\" step-controller></entity>\\n<entity name=\\\"camera-target-problem\\\" transform=\\\"pos: -4.5 0 0\\\"></entity>\\n<orbit-camera\\n  name=\\\"camera-problem\\\"\\n  target=\\\"camera-target-problem\\\"\\n  current-distance=\\\"12\\\"\\n  target-distance=\\\"12\\\"\\n  current-yaw=\\\"0\\\"\\n  target-yaw=\\\"0\\\"\\n  current-pitch=\\\"0\\\"\\n  target-pitch=\\\"0\\\"\\n  min-pitch=\\\"-1.57\\\"\\n  max-pitch=\\\"1.57\\\"\\n  offset-y=\\\"0\\\"\\n  main-camera=\\\"projection: orthographic; ortho-size: 11\\\"\\n></orbit-camera>\\n<entity ambient-light=\\\"intensity: 6.0\\\"></entity>\\n<entity directional-light=\\\"intensity: 5.0; direction: -1 2 1\\\"></entity>\\n\\n<paragraph name=\\\"input-tokens-problem\\\" transform=\\\"pos: -4.5 0 0\\\" gap=\\\"0.7\\\" align=\\\"center\\\">\\n  <word name=\\\"token-the-p\\\" text=\\\"the\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-the-p\\\" transform=\\\"pos: 0 0.7 0; scale: 0 0 0\\\" line=\\\"offset: 0 1 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.2\\\"></entity>\\n    <entity name=\\\"pivot-the-p\\\" transform=\\\"pos: 0 2 0; scale: 0 0 0\\\">\\n      <renderer name=\\\"embed-the-p\\\" transform=\\\"pos: 0 2 0\\\" size=\\\"0.4 4 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n    </entity>\\n    <word name=\\\"label-x1-p\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"1\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-hot-p\\\" text=\\\"hot\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-hot-p\\\" transform=\\\"pos: 0 0.7 0; scale: 0 0 0\\\" line=\\\"offset: 0 1 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.2\\\"></entity>\\n    <entity name=\\\"pivot-hot-p\\\" transform=\\\"pos: 0 2 0; scale: 0 0 0\\\">\\n      <renderer name=\\\"embed-hot-p\\\" transform=\\\"pos: 0 2 0\\\" size=\\\"0.4 4 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n    </entity>\\n    <word name=\\\"label-x2-p\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"2\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-dog-p\\\" text=\\\"dog\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-dog-p\\\" transform=\\\"pos: 0 0.7 0; scale: 0 0 0\\\" line=\\\"offset: 0 1 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.2\\\"></entity>\\n    <entity name=\\\"pivot-dog-p\\\" transform=\\\"pos: 0 2 0; scale: 0 0 0\\\">\\n      <renderer name=\\\"embed-dog-p\\\" transform=\\\"pos: 0 2 0\\\" size=\\\"0.4 4 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n    </entity>\\n    <word name=\\\"label-x3-p\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-was-p\\\" text=\\\"was\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-was-p\\\" transform=\\\"pos: 0 0.7 0; scale: 0 0 0\\\" line=\\\"offset: 0 1 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.2\\\"></entity>\\n    <entity name=\\\"pivot-was-p\\\" transform=\\\"pos: 0 2 0; scale: 0 0 0\\\">\\n      <renderer name=\\\"embed-was-p\\\" transform=\\\"pos: 0 2 0\\\" size=\\\"0.4 4 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n    </entity>\\n    <word name=\\\"label-x4-p\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"4\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n</paragraph>\\n\\n<entity name=\\\"nn-arrow-p\\\" transform=\\\"pos: 0 0 0; scale: 0 0 0\\\" line=\\\"offset: 1.5 0 0; color: 0x3d4852; thickness: 4; arrow-end: 1; arrow-size: 0.4\\\"></entity>\\n\\n<word name=\\\"token-output-p\\\" text=\\\"panting?\\\" font-size=\\\"0.8\\\" transform=\\\"pos: 3.65 0 0; scale: 0 0 0\\\" color=\\\"#b85a2d\\\" border=\\\"padding: 0.2; thickness: 2; color: 0x8a4221; transition: 0\\\">\\n  <word name=\\\"label-yhat-p\\\" text=\\\"ŷ\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#b85a2d\\\">\\n    <word text=\\\"5\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#b85a2d\\\"></word>\\n  </word>\\n</word>\\n\\n<div class=\\\"step\\\" data-title=\\\"Input tokens\\\" data-description=\\\"We now have the input tokens &lt;span class=&quot;token-input&quot;&gt;&quot;the&quot;&lt;/span&gt;, &lt;span class=&quot;token-input&quot;&gt;&quot;hot&quot;&lt;/span&gt;, &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt;, &lt;span class=&quot;token-input&quot;&gt;&quot;was&quot;&lt;/span&gt;.\\\"></div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Dog embedding\\\" data-description=\\\"The &lt;span class=&quot;token-embedding&quot;&gt;embedding&lt;/span&gt; of &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt; is exactly the same as in the previous example.\\\">\\n  <sequence name=\\\"show-dog-embedding\\\">\\n    <tween target=\\\"camera-target-problem\\\" attr=\\\"transform.posY\\\" to=\\\"3\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"main-camera.ortho-size\\\" to=\\\"10\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"orbit-camera.target-pitch\\\" to=\\\"0.3\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"orbit-camera.target-yaw\\\" to=\\\"0.5\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"arrow-dog-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-dog-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-dog-embedding\\\">\\n    <tween target=\\\"pivot-dog-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"arrow-dog-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"camera-target-problem\\\" attr=\\\"transform.posY\\\" to=\\\"0\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"main-camera.ortho-size\\\" to=\\\"11\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"orbit-camera.target-pitch\\\" to=\\\"0\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"orbit-camera.target-yaw\\\" to=\\\"0\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n</div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Hot embedding\\\" data-description=\\\"The &lt;span class=&quot;token-embedding&quot;&gt;embedding&lt;/span&gt; of &lt;span class=&quot;token-input&quot;&gt;&quot;hot&quot;&lt;/span&gt; encodes the meaning of hot.\\\">\\n  <sequence name=\\\"show-hot-embedding\\\">\\n    <tween target=\\\"arrow-hot-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-hot-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-hot-embedding\\\">\\n    <tween target=\\\"pivot-hot-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"arrow-hot-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n  </sequence>\\n</div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Next-token prediction\\\" data-description=\\\"The model may naturally predict &lt;span class=&quot;token-output&quot;&gt;&quot;panting&quot;&lt;/span&gt;. But this isn't the most likely interpretation of &quot;hot dog&quot;.\\\">\\n  <sequence name=\\\"show-prediction\\\">\\n    <tween target=\\\"pivot-hot-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-dog-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"arrow-hot-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"arrow-dog-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"camera-target-problem\\\" attr=\\\"transform.posX\\\" to=\\\"-1.5\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-problem\\\" attr=\\\"transform.posY\\\" to=\\\"0\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"main-camera.ortho-size\\\" to=\\\"11\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"orbit-camera.target-pitch\\\" to=\\\"0\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"orbit-camera.target-yaw\\\" to=\\\"0\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"nn-arrow-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"token-output-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"token-output-p\\\" attr=\\\"border.transition\\\" to=\\\"1\\\" duration=\\\"1.0\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-prediction\\\">\\n    <tween target=\\\"nn-arrow-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"token-output-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"token-output-p\\\" attr=\\\"border.transition\\\" to=\\\"0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"camera-target-problem\\\" attr=\\\"transform.posX\\\" to=\\\"-4.5\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-problem\\\" attr=\\\"transform.posY\\\" to=\\\"3\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"main-camera.ortho-size\\\" to=\\\"10\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"orbit-camera.target-pitch\\\" to=\\\"0.3\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"orbit-camera.target-yaw\\\" to=\\\"0.5\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"arrow-hot-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.2\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-hot-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.25\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"arrow-dog-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.2\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-dog-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.25\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n</div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Contextual meaning\\\" data-description=\\\"The meaning of &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt; should ideally change when in the context of &quot;hot dog&quot;. This is where attention comes in.\\\">\\n  <sequence name=\\\"show-contextual\\\">\\n    <tween target=\\\"nn-arrow-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"token-output-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"token-output-p\\\" attr=\\\"border.transition\\\" to=\\\"0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"camera-target-problem\\\" attr=\\\"transform.posX\\\" to=\\\"-4.5\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-problem\\\" attr=\\\"transform.posY\\\" to=\\\"3\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"main-camera.ortho-size\\\" to=\\\"10\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"orbit-camera.target-pitch\\\" to=\\\"0.3\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"orbit-camera.target-yaw\\\" to=\\\"0.5\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"arrow-dog-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-dog-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-contextual\\\">\\n    <tween target=\\\"pivot-dog-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"arrow-dog-p\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"camera-target-problem\\\" attr=\\\"transform.posX\\\" to=\\\"-1.5\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-problem\\\" attr=\\\"transform.posY\\\" to=\\\"0\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"main-camera.ortho-size\\\" to=\\\"11\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"orbit-camera.target-pitch\\\" to=\\\"0\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-problem\\\" attr=\\\"orbit-camera.target-yaw\\\" to=\\\"0\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"nn-arrow-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"token-output-p\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"token-output-p\\\" attr=\\\"border.transition\\\" to=\\\"1\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n</div>\\n\"","export default \"<entity name=\\\"controller-dot-product\\\" step-controller></entity>\\n<entity name=\\\"camera-target-dot-product\\\" transform=\\\"pos: 0 0 0\\\"></entity>\\n<orbit-camera\\n  name=\\\"camera-dot-product\\\"\\n  target=\\\"camera-target-dot-product\\\"\\n  current-distance=\\\"12\\\"\\n  target-distance=\\\"12\\\"\\n  current-yaw=\\\"0\\\"\\n  target-yaw=\\\"0\\\"\\n  current-pitch=\\\"0\\\"\\n  target-pitch=\\\"0\\\"\\n  min-pitch=\\\"-1.57\\\"\\n  max-pitch=\\\"1.57\\\"\\n  offset-y=\\\"0\\\"\\n  main-camera=\\\"projection: orthographic; ortho-size: 11\\\"\\n></orbit-camera>\\n<entity ambient-light=\\\"intensity: 6.0\\\"></entity>\\n<entity directional-light=\\\"intensity: 5.0; direction: -1 2 1\\\"></entity>\\n\\n<!-- Vector a (green) - column layout -->\\n<entity name=\\\"vector-a\\\" transform=\\\"pos: -2 0 0\\\">\\n  <!-- Left bracket -->\\n  <entity name=\\\"bracket-a-left\\\" transform=\\\"pos: -0.6 0 0\\\">\\n    <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0 1.8 0; color: 0x107d32; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0 -1.8 0; color: 0x107d32; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 1.8 0\\\" line=\\\"offset: 0.15 0 0; color: 0x107d32; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 -1.8 0\\\" line=\\\"offset: 0.15 0 0; color: 0x107d32; thickness: 3\\\"></entity>\\n  </entity>\\n  <!-- Numbers (vertical column, centered) -->\\n  <entity name=\\\"numbers-a\\\" transform=\\\"pos: 0 0 0\\\">\\n    <word text=\\\"2\\\" font-size=\\\"0.5\\\" transform=\\\"pos: 0 1.2 0\\\" color=\\\"#107d32\\\"></word>\\n    <word text=\\\"4\\\" font-size=\\\"0.5\\\" transform=\\\"pos: 0 0.4 0\\\" color=\\\"#107d32\\\"></word>\\n    <word text=\\\"1\\\" font-size=\\\"0.5\\\" transform=\\\"pos: 0 -0.4 0\\\" color=\\\"#107d32\\\"></word>\\n    <word text=\\\"3\\\" font-size=\\\"0.5\\\" transform=\\\"pos: 0 -1.2 0\\\" color=\\\"#107d32\\\"></word>\\n  </entity>\\n  <!-- Right bracket -->\\n  <entity name=\\\"bracket-a-right\\\" transform=\\\"pos: 0.6 0 0\\\">\\n    <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0 1.8 0; color: 0x107d32; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0 -1.8 0; color: 0x107d32; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 1.8 0\\\" line=\\\"offset: -0.15 0 0; color: 0x107d32; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 -1.8 0\\\" line=\\\"offset: -0.15 0 0; color: 0x107d32; thickness: 3\\\"></entity>\\n  </entity>\\n  <!-- Label -->\\n  <word name=\\\"label-a\\\" text=\\\"a\\\" font-size=\\\"0.6\\\" transform=\\\"pos: 0 -2.5 0\\\" color=\\\"#107d32\\\"></word>\\n</entity>\\n\\n<!-- Vector b (blue) - column layout -->\\n<entity name=\\\"vector-b\\\" transform=\\\"pos: 2 0 0\\\">\\n  <!-- Left bracket -->\\n  <entity name=\\\"bracket-b-left\\\" transform=\\\"pos: -0.6 0 0\\\">\\n    <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0 1.8 0; color: 0x275af1; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0 -1.8 0; color: 0x275af1; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 1.8 0\\\" line=\\\"offset: 0.15 0 0; color: 0x275af1; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 -1.8 0\\\" line=\\\"offset: 0.15 0 0; color: 0x275af1; thickness: 3\\\"></entity>\\n  </entity>\\n  <!-- Numbers (vertical column, centered) -->\\n  <entity name=\\\"numbers-b\\\" transform=\\\"pos: 0 0 0\\\">\\n    <word text=\\\"3\\\" font-size=\\\"0.5\\\" transform=\\\"pos: 0 1.2 0\\\" color=\\\"#275af1\\\"></word>\\n    <word text=\\\"2\\\" font-size=\\\"0.5\\\" transform=\\\"pos: 0 0.4 0\\\" color=\\\"#275af1\\\"></word>\\n    <word text=\\\"4\\\" font-size=\\\"0.5\\\" transform=\\\"pos: 0 -0.4 0\\\" color=\\\"#275af1\\\"></word>\\n    <word text=\\\"2\\\" font-size=\\\"0.5\\\" transform=\\\"pos: 0 -1.2 0\\\" color=\\\"#275af1\\\"></word>\\n  </entity>\\n  <!-- Right bracket -->\\n  <entity name=\\\"bracket-b-right\\\" transform=\\\"pos: 0.6 0 0\\\">\\n    <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0 1.8 0; color: 0x275af1; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0 -1.8 0; color: 0x275af1; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 1.8 0\\\" line=\\\"offset: -0.15 0 0; color: 0x275af1; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 -1.8 0\\\" line=\\\"offset: -0.15 0 0; color: 0x275af1; thickness: 3\\\"></entity>\\n  </entity>\\n  <!-- Label -->\\n  <word name=\\\"label-b\\\" text=\\\"b\\\" font-size=\\\"0.6\\\" transform=\\\"pos: 0 -2.5 0\\\" color=\\\"#275af1\\\"></word>\\n</entity>\\n\\n<!-- Element-wise product a ⊙ b - starts hidden -->\\n<entity name=\\\"vector-product\\\" transform=\\\"pos: 6 0 0; scale: 0 0 0\\\">\\n  <!-- Left bracket -->\\n  <entity name=\\\"bracket-product-left\\\" transform=\\\"pos: -0.8 0 0\\\">\\n    <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0 1.8 0; color: 0x28282a; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0 -1.8 0; color: 0x28282a; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 1.8 0\\\" line=\\\"offset: 0.15 0 0; color: 0x28282a; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 -1.8 0\\\" line=\\\"offset: 0.15 0 0; color: 0x28282a; thickness: 3\\\"></entity>\\n  </entity>\\n  <!-- Numbers: 2*3=6, 4*2=8, 1*4=4, 3*2=6 -->\\n  <entity name=\\\"numbers-product\\\" transform=\\\"pos: 0 0 0\\\">\\n    <word text=\\\"6\\\" font-size=\\\"0.5\\\" transform=\\\"pos: 0 1.2 0\\\" color=\\\"#28282a\\\"></word>\\n    <word text=\\\"8\\\" font-size=\\\"0.5\\\" transform=\\\"pos: 0 0.4 0\\\" color=\\\"#28282a\\\"></word>\\n    <word text=\\\"4\\\" font-size=\\\"0.5\\\" transform=\\\"pos: 0 -0.4 0\\\" color=\\\"#28282a\\\"></word>\\n    <word text=\\\"6\\\" font-size=\\\"0.5\\\" transform=\\\"pos: 0 -1.2 0\\\" color=\\\"#28282a\\\"></word>\\n  </entity>\\n  <!-- Right bracket -->\\n  <entity name=\\\"bracket-product-right\\\" transform=\\\"pos: 0.8 0 0\\\">\\n    <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0 1.8 0; color: 0x28282a; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0 -1.8 0; color: 0x28282a; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 1.8 0\\\" line=\\\"offset: -0.15 0 0; color: 0x28282a; thickness: 3\\\"></entity>\\n    <entity transform=\\\"pos: 0 -1.8 0\\\" line=\\\"offset: -0.15 0 0; color: 0x28282a; thickness: 3\\\"></entity>\\n  </entity>\\n  <!-- Label -->\\n  <word name=\\\"label-product\\\" text=\\\"a ⊙ b\\\" font-size=\\\"0.6\\\" transform=\\\"pos: 0 -2.5 0\\\" color=\\\"#28282a\\\"></word>\\n</entity>\\n\\n<!-- Hadamard symbol (between a and b) - for element-wise product -->\\n<word name=\\\"hadamard-symbol\\\" text=\\\"⊙\\\" font-size=\\\"0.8\\\" transform=\\\"pos: 0 0 0; scale: 0 0 0\\\" color=\\\"#28282a\\\"></word>\\n\\n<!-- Dot symbol (between a and b) - for dot product -->\\n<word name=\\\"dot-symbol\\\" text=\\\"·\\\" font-size=\\\"0.8\\\" transform=\\\"pos: 0 0 0; scale: 0 0 0\\\" color=\\\"#28282a\\\"></word>\\n\\n<!-- Equals symbol -->\\n<word name=\\\"equals-symbol\\\" text=\\\"=\\\" font-size=\\\"0.8\\\" transform=\\\"pos: 4 0 0; scale: 0 0 0\\\" color=\\\"#28282a\\\"></word>\\n\\n<!-- Sum result: 6 + 8 + 4 + 6 = 24 -->\\n<word name=\\\"sum-result\\\" text=\\\"24\\\" font-size=\\\"0.8\\\" transform=\\\"pos: 6 0 0; scale: 0 0 0\\\" color=\\\"#28282a\\\"></word>\\n\\n<!-- Sum label -->\\n<word name=\\\"label-sum\\\" text=\\\"a · b\\\" font-size=\\\"0.6\\\" transform=\\\"pos: 6 -2.5 0; scale: 0 0 0\\\" color=\\\"#28282a\\\"></word>\\n\\n<!-- Scaled result: 24/√4 = 12 -->\\n<entity name=\\\"fraction-line\\\" transform=\\\"pos: 6 0 0; scale: 0 0 0\\\">\\n  <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: 0.6 0 0; color: 0x28282a; thickness: 2\\\"></entity>\\n  <entity transform=\\\"pos: 0 0 0\\\" line=\\\"offset: -0.6 0 0; color: 0x28282a; thickness: 2\\\"></entity>\\n</entity>\\n<word name=\\\"denominator\\\" text=\\\"√4\\\" font-size=\\\"0.6\\\" transform=\\\"pos: 6 -0.6 0; scale: 0 0 0\\\" color=\\\"#28282a\\\"></word>\\n<word name=\\\"equals-scaled\\\" text=\\\"=\\\" font-size=\\\"0.8\\\" transform=\\\"pos: 7.5 0 0; scale: 0 0 0\\\" color=\\\"#28282a\\\"></word>\\n<word name=\\\"scaled-result\\\" text=\\\"12\\\" font-size=\\\"0.8\\\" transform=\\\"pos: 9 0 0; scale: 0 0 0\\\" color=\\\"#28282a\\\"></word>\\n\\n<div class=\\\"step\\\" data-title=\\\"Vector similarity\\\" data-description=\\\"We have two vectors &lt;span class=&quot;concept-query&quot;&gt;a&lt;/span&gt; and &lt;span class=&quot;concept-key&quot;&gt;b&lt;/span&gt;, and we want to measure how similar they are. To do that, we use the dot product.\\\"></div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Element-wise product\\\" data-description=\\\"First, we multiply corresponding components: &lt;span class=&quot;concept-query&quot;&gt;a&lt;/span&gt; ⊙ &lt;span class=&quot;concept-key&quot;&gt;b&lt;/span&gt;.\\\">\\n  <sequence name=\\\"show-product\\\">\\n    <tween target=\\\"hadamard-symbol\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"equals-symbol\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"vector-product\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-dot-product\\\" attr=\\\"transform.posX\\\" to=\\\"2\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-product\\\">\\n    <tween target=\\\"vector-product\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"equals-symbol\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"hadamard-symbol\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"camera-target-dot-product\\\" attr=\\\"transform.posX\\\" to=\\\"0\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n</div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Compute the sum\\\" data-description=\\\"Then, we add up the results to get a single number, the dot product: &lt;span class=&quot;concept-query&quot;&gt;a&lt;/span&gt; · &lt;span class=&quot;concept-key&quot;&gt;b&lt;/span&gt; = 24. This can also be written as &lt;span class=&quot;concept-query&quot;&gt;a&lt;/span&gt;&lt;sup&gt;T&lt;/sup&gt;&lt;span class=&quot;concept-key&quot;&gt;b&lt;/span&gt;.\\\">\\n  <sequence name=\\\"show-sum\\\">\\n    <tween target=\\\"hadamard-symbol\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"vector-product\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"dot-symbol\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"sum-result\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"label-sum\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-sum\\\">\\n    <tween target=\\\"sum-result\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"label-sum\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"dot-symbol\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"hadamard-symbol\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"vector-product\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n</div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Scale by √d\\\" data-description=\\\"We divide by √d (where d=4 is our dimension count) to keep values manageable. This gives us 24/√4 = 12.\\\">\\n  <sequence name=\\\"show-scaled\\\">\\n    <tween target=\\\"label-sum\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"sum-result\\\" attr=\\\"transform.posY\\\" to=\\\"0.5\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"fraction-line\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"denominator\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"equals-scaled\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"scaled-result\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-dot-product\\\" attr=\\\"transform.posX\\\" to=\\\"3.5\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-scaled\\\">\\n    <tween target=\\\"scaled-result\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"equals-scaled\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"denominator\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"fraction-line\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"sum-result\\\" attr=\\\"transform.posY\\\" to=\\\"0\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"label-sum\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-dot-product\\\" attr=\\\"transform.posX\\\" to=\\\"2\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n</div>\\n\"","export default \"<entity name=\\\"controller-query-key\\\" step-controller></entity>\\n<entity name=\\\"camera-target-query-key\\\" transform=\\\"pos: -4.5 1.5 0\\\"></entity>\\n<orbit-camera\\n  name=\\\"camera-query-key\\\"\\n  target=\\\"camera-target-query-key\\\"\\n  current-distance=\\\"12\\\"\\n  target-distance=\\\"12\\\"\\n  current-yaw=\\\"0.5\\\"\\n  target-yaw=\\\"0.5\\\"\\n  current-pitch=\\\"0.3\\\"\\n  target-pitch=\\\"0.3\\\"\\n  min-pitch=\\\"-1.57\\\"\\n  max-pitch=\\\"1.57\\\"\\n  offset-y=\\\"0\\\"\\n  main-camera=\\\"projection: orthographic; ortho-size: 10\\\"\\n></orbit-camera>\\n<entity ambient-light=\\\"intensity: 6.0\\\"></entity>\\n<entity directional-light=\\\"intensity: 5.0; direction: -1 2 1\\\"></entity>\\n\\n<paragraph name=\\\"input-tokens-qk\\\" transform=\\\"pos: -4.5 0 0\\\" gap=\\\"0.7\\\" align=\\\"center\\\">\\n  <word name=\\\"token-the-qk\\\" text=\\\"the\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-the-qk\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 1 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.2\\\"></entity>\\n    <entity name=\\\"pivot-the-qk\\\" transform=\\\"pos: 0 2 0\\\">\\n      <renderer name=\\\"embed-the-qk\\\" transform=\\\"pos: 0 1.25 0\\\" size=\\\"0.4 2.5 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"k-arrow-the\\\" transform=\\\"pos: 0 2.8 0; scale: 0 0 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-the\\\" transform=\\\"pos: 0 3.8 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"k-vec-the\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"label-k1\\\" text=\\\"k\\\" transform=\\\"pos: 0 2.3 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n          <word text=\\\"1\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"v-arrow-the\\\" transform=\\\"pos: 0 2.8 0; scale: 0 0 0\\\" line=\\\"offset: 0.5 1.0 0; color: #aa4d00; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-v-the\\\" transform=\\\"pos: 0.5 4.1 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"v-vec-the\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#aa4d00\\\"></renderer>\\n        <word name=\\\"label-v1\\\" text=\\\"v\\\" transform=\\\"pos: 0 2.0 0\\\" font-size=\\\"0.5\\\" color=\\\"#aa4d00\\\">\\n          <word text=\\\"1\\\" transform=\\\"pos: 0.22 -0.14 0\\\" font-size=\\\"0.35\\\" color=\\\"#aa4d00\\\"></word>\\n        </word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x1-qk\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"1\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-hot-qk\\\" text=\\\"hot\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-hot-qk\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 1 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.2\\\"></entity>\\n    <entity name=\\\"pivot-hot-qk\\\" transform=\\\"pos: 0 2 0\\\">\\n      <renderer name=\\\"embed-hot-qk\\\" transform=\\\"pos: 0 1.25 0\\\" size=\\\"0.4 2.5 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"k-arrow-hot\\\" transform=\\\"pos: 0 2.8 0; scale: 0 0 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-hot\\\" transform=\\\"pos: 0 3.8 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"k-vec-hot\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"label-k2\\\" text=\\\"k\\\" transform=\\\"pos: 0 2.3 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n          <word text=\\\"2\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"v-arrow-hot\\\" transform=\\\"pos: 0 2.8 0; scale: 0 0 0\\\" line=\\\"offset: 0.5 1.0 0; color: #aa4d00; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-v-hot\\\" transform=\\\"pos: 0.5 4.1 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"v-vec-hot\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#aa4d00\\\"></renderer>\\n        <word name=\\\"label-v2\\\" text=\\\"v\\\" transform=\\\"pos: 0 2.0 0\\\" font-size=\\\"0.5\\\" color=\\\"#aa4d00\\\">\\n          <word text=\\\"2\\\" transform=\\\"pos: 0.22 -0.14 0\\\" font-size=\\\"0.35\\\" color=\\\"#aa4d00\\\"></word>\\n        </word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x2-qk\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"2\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-dog-qk\\\" text=\\\"dog\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-dog-qk\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 1 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.2\\\"></entity>\\n    <entity name=\\\"pivot-dog-qk\\\" transform=\\\"pos: 0 2 0\\\">\\n      <renderer name=\\\"embed-dog-qk\\\" transform=\\\"pos: 0 1.25 0\\\" size=\\\"0.4 2.5 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"q-arrow-dog\\\" transform=\\\"pos: -0.15 2.8 0; scale: 0 0 0\\\" line=\\\"offset: -0.5 0.7 0; color: #107d32; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-q-dog\\\" transform=\\\"pos: -0.8 3.8 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"q-vec-dog\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#107d32\\\"></renderer>\\n        <word name=\\\"label-q3\\\" text=\\\"q\\\" transform=\\\"pos: 0 2.3 0\\\" font-size=\\\"0.6\\\" color=\\\"#107d32\\\">\\n          <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#107d32\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"k-arrow-dog\\\" transform=\\\"pos: 0 2.8 0; scale: 0 0 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-dog\\\" transform=\\\"pos: 0 3.8 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"k-vec-dog\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"label-k3\\\" text=\\\"k\\\" transform=\\\"pos: 0 2.3 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n          <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"v-arrow-dog\\\" transform=\\\"pos: 0 2.8 0; scale: 0 0 0\\\" line=\\\"offset: 0.5 1.0 0; color: #aa4d00; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-v-dog\\\" transform=\\\"pos: 0.5 4.1 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"v-vec-dog\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#aa4d00\\\"></renderer>\\n        <word name=\\\"label-v3\\\" text=\\\"v\\\" transform=\\\"pos: 0 2.0 0\\\" font-size=\\\"0.5\\\" color=\\\"#aa4d00\\\">\\n          <word text=\\\"3\\\" transform=\\\"pos: 0.22 -0.14 0\\\" font-size=\\\"0.35\\\" color=\\\"#aa4d00\\\"></word>\\n        </word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x3-qk\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-was-qk\\\" text=\\\"was\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-was-qk\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 1 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.2\\\"></entity>\\n    <entity name=\\\"pivot-was-qk\\\" transform=\\\"pos: 0 2 0\\\">\\n      <renderer name=\\\"embed-was-qk\\\" transform=\\\"pos: 0 1.25 0\\\" size=\\\"0.4 2.5 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"k-arrow-was\\\" transform=\\\"pos: 0 2.8 0; scale: 0 0 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-was\\\" transform=\\\"pos: 0 3.8 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"k-vec-was\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"label-k4\\\" text=\\\"k\\\" transform=\\\"pos: 0 2.3 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n          <word text=\\\"4\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"v-arrow-was\\\" transform=\\\"pos: 0 2.8 0; scale: 0 0 0\\\" line=\\\"offset: 0.5 1.0 0; color: #aa4d00; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-v-was\\\" transform=\\\"pos: 0.5 4.1 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"v-vec-was\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#aa4d00\\\"></renderer>\\n        <word name=\\\"label-v4\\\" text=\\\"v\\\" transform=\\\"pos: 0 2.0 0\\\" font-size=\\\"0.5\\\" color=\\\"#aa4d00\\\">\\n          <word text=\\\"4\\\" transform=\\\"pos: 0.22 -0.14 0\\\" font-size=\\\"0.35\\\" color=\\\"#aa4d00\\\"></word>\\n        </word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x4-qk\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"4\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n</paragraph>\\n\\n<entity name=\\\"dot-product-label-qk\\\" transform=\\\"pos: -4.5 10 0; scale: 0 0 0\\\">\\n  <word text=\\\"q\\\" transform=\\\"pos: -0.9 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#107d32\\\">\\n    <word text=\\\"3\\\" transform=\\\"pos: 0.35 -0.2 0\\\" font-size=\\\"0.45\\\" color=\\\"#107d32\\\"></word>\\n  </word>\\n  <word text=\\\"·\\\" font-size=\\\"0.7\\\" color=\\\"#666666\\\"></word>\\n  <word text=\\\"k\\\" transform=\\\"pos: 0.5 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#275af1\\\">\\n    <word text=\\\"2\\\" transform=\\\"pos: 0.35 -0.2 0\\\" font-size=\\\"0.45\\\" color=\\\"#275af1\\\"></word>\\n  </word>\\n</entity>\\n\\n<entity name=\\\"full-equation-label\\\" transform=\\\"pos: -4.5 10 0; scale: 0 0 0\\\">\\n  <word text=\\\"q\\\" transform=\\\"pos: -0.5 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#107d32\\\">\\n    <word text=\\\"3\\\" transform=\\\"pos: 0.35 -0.2 0\\\" font-size=\\\"0.45\\\" color=\\\"#107d32\\\"></word>\\n  </word>\\n  <word text=\\\"K\\\" transform=\\\"pos: 0.3 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#275af1\\\">\\n    <word text=\\\"T\\\" transform=\\\"pos: 0.45 0.25 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n  </word>\\n</entity>\\n\\n<div class=\\\"step\\\" data-title=\\\"Input tokens\\\" data-description=\\\"We have our input tokens &lt;span class=&quot;token-input&quot;&gt;&quot;the&quot;&lt;/span&gt;, &lt;span class=&quot;token-input&quot;&gt;&quot;hot&quot;&lt;/span&gt;, &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt;, &lt;span class=&quot;token-input&quot;&gt;&quot;was&quot;&lt;/span&gt; with their &lt;span class=&quot;token-embedding&quot;&gt;embedding vectors&lt;/span&gt;.\\\"></div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Query projection\\\" data-description=\\\"We project &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt; (&lt;span class=&quot;katex-inline&quot;&gt;x_3&lt;/span&gt;) to a vector called &lt;span class=&quot;katex-inline concept-query&quot;&gt;q_3&lt;/span&gt;, referred to as the &lt;span class=&quot;concept-query&quot;&gt;query vector&lt;/span&gt;. This vector asks: &lt;i&gt;&quot;what am I looking for?&quot;&lt;/i&gt;\\\">\\n  <sequence name=\\\"show-q-dog\\\">\\n    <tween target=\\\"input-tokens-qk\\\" attr=\\\"paragraph.gap\\\" to=\\\"1.5\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-query-key\\\" attr=\\\"orbit-camera.targetYaw\\\" to=\\\"0\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-query-key\\\" attr=\\\"orbit-camera.targetPitch\\\" to=\\\"0\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-query-key\\\" attr=\\\"transform.posY\\\" to=\\\"5\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-query-key\\\" attr=\\\"main-camera.ortho-size\\\" to=\\\"13\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"q-arrow-dog\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-q-dog\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-q-dog\\\">\\n    <tween target=\\\"pivot-q-dog\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"q-arrow-dog\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"input-tokens-qk\\\" attr=\\\"paragraph.gap\\\" to=\\\"0.7\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-query-key\\\" attr=\\\"orbit-camera.targetYaw\\\" to=\\\"0.5\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-query-key\\\" attr=\\\"orbit-camera.targetPitch\\\" to=\\\"0.3\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-target-query-key\\\" attr=\\\"transform.posY\\\" to=\\\"1.5\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-query-key\\\" attr=\\\"main-camera.ortho-size\\\" to=\\\"10\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n</div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Key projection\\\" data-description=\\\"We project &lt;span class=&quot;token-input&quot;&gt;&quot;hot&quot;&lt;/span&gt; (&lt;span class=&quot;katex-inline&quot;&gt;x_2&lt;/span&gt;) to a vector called &lt;span class=&quot;katex-inline concept-key&quot;&gt;k_2&lt;/span&gt;, referred to as the &lt;span class=&quot;concept-key&quot;&gt;key vector&lt;/span&gt;. This vector says: &lt;i&gt;&quot;here's what I provide&quot;&lt;/i&gt;. The dot product &lt;span class=&quot;katex-inline concept-query&quot;&gt;q_3&lt;/span&gt; · &lt;span class=&quot;katex-inline concept-key&quot;&gt;k_2&lt;/span&gt; gives us an &lt;span class=&quot;concept-attention&quot;&gt;attention score&lt;/span&gt; — the amount &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt; attends to &lt;span class=&quot;token-input&quot;&gt;&quot;hot&quot;&lt;/span&gt;.\\\">\\n  <sequence name=\\\"show-k-hot\\\">\\n    <tween target=\\\"k-arrow-hot\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-k-hot\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"dot-product-label-qk\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.5\\\" easing=\\\"back-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-k-hot\\\">\\n    <tween target=\\\"dot-product-label-qk\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-k-hot\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"k-arrow-hot\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n  </sequence>\\n</div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Attention scores\\\" data-description=\\\"We do the same for every &lt;span class=&quot;concept-key&quot;&gt;key&lt;/span&gt; to get our &lt;span class=&quot;concept-attention&quot;&gt;attention scores&lt;/span&gt;, &lt;span class=&quot;katex-inline concept-query&quot;&gt;q_3&lt;/span&gt;&lt;span class=&quot;katex-inline concept-key&quot;&gt;K&lt;/span&gt;&lt;sup&gt;T&lt;/sup&gt;. This is the amount &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt; attends to every other token.\\\">\\n  <sequence name=\\\"show-all-keys\\\">\\n    <tween target=\\\"dot-product-label-qk\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"k-arrow-the\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-k-the\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"k-arrow-dog\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-k-dog\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"k-arrow-was\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-k-was\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"full-equation-label\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-all-keys\\\">\\n    <tween target=\\\"full-equation-label\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-k-was\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"k-arrow-was\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-k-dog\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"k-arrow-dog\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-k-the\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"k-arrow-the\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"dot-product-label-qk\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"back-out\\\"></tween>\\n  </sequence>\\n</div>\\n\"","export default \"<entity name=\\\"controller-attention-weights\\\" step-controller></entity>\\n<entity name=\\\"camera-target-attention-weights\\\" transform=\\\"pos: -4.5 3.5 0\\\"></entity>\\n<orbit-camera\\n  name=\\\"camera-attention-weights\\\"\\n  target=\\\"camera-target-attention-weights\\\"\\n  current-distance=\\\"12\\\"\\n  target-distance=\\\"12\\\"\\n  current-yaw=\\\"0\\\"\\n  target-yaw=\\\"0\\\"\\n  current-pitch=\\\"0\\\"\\n  target-pitch=\\\"0\\\"\\n  min-pitch=\\\"-1.57\\\"\\n  max-pitch=\\\"1.57\\\"\\n  offset-y=\\\"0\\\"\\n  main-camera=\\\"projection: orthographic; ortho-size: 11\\\"\\n></orbit-camera>\\n<entity ambient-light=\\\"intensity: 6.0\\\"></entity>\\n<entity directional-light=\\\"intensity: 5.0; direction: -1 2 1\\\"></entity>\\n\\n<paragraph name=\\\"input-tokens-aw\\\" transform=\\\"pos: -4.5 0 0\\\" gap=\\\"1.5\\\" align=\\\"center\\\">\\n  <word name=\\\"token-the-aw\\\" text=\\\"the\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-the-aw\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 0.6 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.12\\\"></entity>\\n    <entity name=\\\"pivot-the-aw\\\" transform=\\\"pos: 0 1.5 0\\\">\\n      <renderer name=\\\"embed-the-aw\\\" transform=\\\"pos: 0 0.5 0\\\" size=\\\"0.4 1.0 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"k-arrow-the-aw\\\" transform=\\\"pos: 0 1.2 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-the-aw\\\" transform=\\\"pos: 0 2.2 0\\\">\\n        <renderer name=\\\"k-vec-the-aw\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"score-k1\\\" text=\\\"8\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.7\\\" color=\\\"#c23a3a\\\"></word>\\n        <word name=\\\"scaled-k1\\\" text=\\\"1\\\" transform=\\\"pos: 0 2.35 0; scale: 0 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#c23a3a\\\"></word>\\n        <word name=\\\"weight-k1\\\" text=\\\"0.09\\\" transform=\\\"pos: 0 2.35 0; scale: 0 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#c23a3a\\\"></word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x1-aw\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"1\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-hot-aw\\\" text=\\\"hot\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-hot-aw\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 0.6 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.12\\\"></entity>\\n    <entity name=\\\"pivot-hot-aw\\\" transform=\\\"pos: 0 1.5 0\\\">\\n      <renderer name=\\\"embed-hot-aw\\\" transform=\\\"pos: 0 0.5 0\\\" size=\\\"0.4 1.0 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"k-arrow-hot-aw\\\" transform=\\\"pos: 0 1.2 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-hot-aw\\\" transform=\\\"pos: 0 2.2 0\\\">\\n        <renderer name=\\\"k-vec-hot-aw\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"score-k2\\\" text=\\\"16\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.7\\\" color=\\\"#c23a3a\\\"></word>\\n        <word name=\\\"scaled-k2\\\" text=\\\"2\\\" transform=\\\"pos: 0 2.35 0; scale: 0 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#c23a3a\\\"></word>\\n        <word name=\\\"weight-k2\\\" text=\\\"0.23\\\" transform=\\\"pos: 0 2.35 0; scale: 0 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#c23a3a\\\"></word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x2-aw\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"2\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-dog-aw\\\" text=\\\"dog\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-dog-aw\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 0.6 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.12\\\"></entity>\\n    <entity name=\\\"pivot-dog-aw\\\" transform=\\\"pos: 0 1.5 0\\\">\\n      <renderer name=\\\"embed-dog-aw\\\" transform=\\\"pos: 0 0.5 0\\\" size=\\\"0.4 1.0 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"q-arrow-dog-aw\\\" transform=\\\"pos: -0.15 1.2 0\\\" line=\\\"offset: -0.5 0.7 0; color: #107d32; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-q-dog-aw\\\" transform=\\\"pos: -0.8 2.2 0\\\">\\n        <renderer name=\\\"q-vec-dog-aw\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#107d32\\\"></renderer>\\n      </entity>\\n      <entity name=\\\"k-arrow-dog-aw\\\" transform=\\\"pos: 0 1.2 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-dog-aw\\\" transform=\\\"pos: 0 2.2 0\\\">\\n        <renderer name=\\\"k-vec-dog-aw\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"score-k3\\\" text=\\\"24\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.7\\\" color=\\\"#c23a3a\\\"></word>\\n        <word name=\\\"scaled-k3\\\" text=\\\"3\\\" transform=\\\"pos: 0 2.35 0; scale: 0 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#c23a3a\\\"></word>\\n        <word name=\\\"weight-k3\\\" text=\\\"0.63\\\" transform=\\\"pos: 0 2.35 0; scale: 0 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#c23a3a\\\"></word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x3-aw\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-was-aw\\\" text=\\\"was\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-was-aw\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 0.6 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.12\\\"></entity>\\n    <entity name=\\\"pivot-was-aw\\\" transform=\\\"pos: 0 1.5 0\\\">\\n      <renderer name=\\\"embed-was-aw\\\" transform=\\\"pos: 0 0.5 0\\\" size=\\\"0.4 1.0 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"k-arrow-was-aw\\\" transform=\\\"pos: 0 1.2 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-was-aw\\\" transform=\\\"pos: 0 2.2 0\\\">\\n        <renderer name=\\\"k-vec-was-aw\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"score-k4\\\" text=\\\"4\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.7\\\" color=\\\"#c23a3a\\\"></word>\\n        <word name=\\\"scaled-k4\\\" text=\\\"0.5\\\" transform=\\\"pos: 0 2.35 0; scale: 0 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#c23a3a\\\"></word>\\n        <word name=\\\"weight-k4\\\" text=\\\"0.05\\\" transform=\\\"pos: 0 2.35 0; scale: 0 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#c23a3a\\\"></word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x4-aw\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"4\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n</paragraph>\\n\\n<entity name=\\\"equation-label-aw\\\" transform=\\\"pos: -4.5 7.7 0\\\">\\n  <word text=\\\"q\\\" transform=\\\"pos: -0.5 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#107d32\\\">\\n    <word text=\\\"3\\\" transform=\\\"pos: 0.35 -0.2 0\\\" font-size=\\\"0.45\\\" color=\\\"#107d32\\\"></word>\\n  </word>\\n  <word text=\\\"K\\\" transform=\\\"pos: 0.3 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#275af1\\\">\\n    <word text=\\\"T\\\" transform=\\\"pos: 0.45 0.25 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n  </word>\\n</entity>\\n\\n<entity name=\\\"scaled-label-aw\\\" transform=\\\"pos: -4.5 7.7 0; scale: 0 0 0\\\">\\n  <word text=\\\"q\\\" transform=\\\"pos: -0.2 0.45 0\\\" font-size=\\\"0.6\\\" color=\\\"#107d32\\\">\\n    <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#107d32\\\"></word>\\n  </word>\\n  <word text=\\\"K\\\" transform=\\\"pos: 0.4 0.45 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n    <word text=\\\"T\\\" transform=\\\"pos: 0.35 0.2 0\\\" font-size=\\\"0.35\\\" color=\\\"#275af1\\\"></word>\\n  </word>\\n  <entity transform=\\\"pos: 0.3 0 0\\\" line=\\\"offset: 0.8 0 0; color: 0x666666; thickness: 2\\\"></entity>\\n  <entity transform=\\\"pos: 0.3 0 0\\\" line=\\\"offset: -0.8 0 0; color: 0x666666; thickness: 2\\\"></entity>\\n  <word text=\\\"√d\\\" transform=\\\"pos: 0.3 -0.5 0\\\" font-size=\\\"0.5\\\" color=\\\"#666666\\\"></word>\\n</entity>\\n\\n<entity name=\\\"softmax-label-aw\\\" transform=\\\"pos: -4.5 7.7 0; scale: 0 0 0\\\">\\n  <word text=\\\"softmax(\\\" transform=\\\"pos: -1.5 0 0\\\" font-size=\\\"0.6\\\" color=\\\"#666666\\\"></word>\\n  <word text=\\\"q\\\" transform=\\\"pos: 0.2 0.45 0\\\" font-size=\\\"0.6\\\" color=\\\"#107d32\\\">\\n    <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#107d32\\\"></word>\\n  </word>\\n  <word text=\\\"K\\\" transform=\\\"pos: 0.8 0.45 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n    <word text=\\\"T\\\" transform=\\\"pos: 0.35 0.2 0\\\" font-size=\\\"0.35\\\" color=\\\"#275af1\\\"></word>\\n  </word>\\n  <entity transform=\\\"pos: 0.6 0 0\\\" line=\\\"offset: 0.8 0 0; color: 0x666666; thickness: 2\\\"></entity>\\n  <entity transform=\\\"pos: 0.6 0 0\\\" line=\\\"offset: -0.8 0 0; color: 0x666666; thickness: 2\\\"></entity>\\n  <word text=\\\"√d\\\" transform=\\\"pos: 0.6 -0.5 0\\\" font-size=\\\"0.5\\\" color=\\\"#666666\\\"></word>\\n  <word text=\\\")\\\" transform=\\\"pos: 1.6 0 0\\\" font-size=\\\"0.6\\\" color=\\\"#666666\\\"></word>\\n</entity>\\n\\n<div class=\\\"step\\\" data-title=\\\"Raw attention scores\\\" data-description=\\\"These are the raw &lt;span class=&quot;concept-attention&quot;&gt;attention scores&lt;/span&gt; for &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt;. It attends most to itself, then &lt;span class=&quot;token-input&quot;&gt;&quot;hot&quot;&lt;/span&gt;, then &lt;span class=&quot;token-input&quot;&gt;&quot;the&quot;&lt;/span&gt;, then &lt;span class=&quot;token-input&quot;&gt;&quot;was&quot;&lt;/span&gt;.\\\"></div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Scale by √d\\\" data-description=\\\"As we saw earlier, we divide by &lt;span class=&quot;katex-inline&quot;&gt;\\\\sqrt{d}&lt;/span&gt; to keep scores in a reasonable range. With 64-dimensional vectors, &lt;span class=&quot;katex-inline&quot;&gt;\\\\sqrt{64} = 8&lt;/span&gt;.\\\">\\n  <sequence name=\\\"show-scaled\\\">\\n    <tween target=\\\"camera-attention-weights\\\" attr=\\\"orbit-camera.targetPitch\\\" to=\\\"0.3\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-attention-weights\\\" attr=\\\"orbit-camera.targetYaw\\\" to=\\\"0.5\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"equation-label-aw\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"scaled-label-aw\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"back-out\\\"></tween>\\n    <tween target=\\\"score-k1\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"score-k2\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"score-k3\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"score-k4\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"scaled-k1\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"back-out\\\"></tween>\\n    <tween target=\\\"scaled-k2\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"back-out\\\"></tween>\\n    <tween target=\\\"scaled-k3\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"back-out\\\"></tween>\\n    <tween target=\\\"scaled-k4\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"back-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-scaled\\\">\\n    <tween target=\\\"camera-attention-weights\\\" attr=\\\"orbit-camera.targetPitch\\\" to=\\\"0\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-attention-weights\\\" attr=\\\"orbit-camera.targetYaw\\\" to=\\\"0\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"scaled-k4\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"scaled-k3\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"scaled-k2\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"scaled-k1\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"score-k1\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.2\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"score-k2\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.2\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"score-k3\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.2\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"score-k4\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.2\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"scaled-label-aw\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"equation-label-aw\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"back-out\\\"></tween>\\n  </sequence>\\n</div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Softmax\\\" data-description=\\\"Finally, &lt;b&gt;softmax&lt;/b&gt; normalizes the scores so they sum to 1. These are our final &lt;span class=&quot;concept-attention&quot;&gt;attention weights&lt;/span&gt; for &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt;.\\\">\\n  <sequence name=\\\"show-softmax\\\">\\n    <tween target=\\\"camera-attention-weights\\\" attr=\\\"orbit-camera.targetPitch\\\" to=\\\"0\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-attention-weights\\\" attr=\\\"orbit-camera.targetYaw\\\" to=\\\"0\\\" duration=\\\"0.6\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"scaled-label-aw\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"softmax-label-aw\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"back-out\\\"></tween>\\n    <tween target=\\\"scaled-k1\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"scaled-k2\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"scaled-k3\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"scaled-k4\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.2\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"weight-k1\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"back-out\\\"></tween>\\n    <tween target=\\\"weight-k2\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"back-out\\\"></tween>\\n    <tween target=\\\"weight-k3\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"back-out\\\"></tween>\\n    <tween target=\\\"weight-k4\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"back-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-softmax\\\">\\n    <tween target=\\\"camera-attention-weights\\\" attr=\\\"orbit-camera.targetPitch\\\" to=\\\"0.3\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"camera-attention-weights\\\" attr=\\\"orbit-camera.targetYaw\\\" to=\\\"0.5\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"weight-k4\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"weight-k3\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"weight-k2\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"weight-k1\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"scaled-k1\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.2\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"scaled-k2\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.2\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"scaled-k3\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.2\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"scaled-k4\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.2\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"softmax-label-aw\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"scaled-label-aw\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"back-out\\\"></tween>\\n  </sequence>\\n</div>\\n\"","export default \"<entity name=\\\"controller-value-output\\\" step-controller></entity>\\n<entity name=\\\"camera-target-value-output\\\" transform=\\\"pos: -4.5 3.5 0\\\"></entity>\\n<orbit-camera\\n  name=\\\"camera-value-output\\\"\\n  target=\\\"camera-target-value-output\\\"\\n  current-distance=\\\"12\\\"\\n  target-distance=\\\"12\\\"\\n  current-yaw=\\\"0\\\"\\n  target-yaw=\\\"0\\\"\\n  current-pitch=\\\"0\\\"\\n  target-pitch=\\\"0\\\"\\n  min-pitch=\\\"-1.57\\\"\\n  max-pitch=\\\"1.57\\\"\\n  offset-y=\\\"0\\\"\\n  main-camera=\\\"projection: orthographic; ortho-size: 11\\\"\\n></orbit-camera>\\n<entity ambient-light=\\\"intensity: 6.0\\\"></entity>\\n<entity directional-light=\\\"intensity: 5.0; direction: -1 2 1\\\"></entity>\\n\\n<paragraph name=\\\"input-tokens-vo\\\" transform=\\\"pos: -4.5 0 0\\\" gap=\\\"2.0\\\" align=\\\"center\\\">\\n  <word name=\\\"token-the-vo\\\" text=\\\"the\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-the-vo\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 0.6 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.12\\\"></entity>\\n    <entity name=\\\"pivot-the-vo\\\" transform=\\\"pos: 0 1.5 0\\\">\\n      <renderer name=\\\"embed-the-vo\\\" transform=\\\"pos: 0 0.5 0\\\" size=\\\"0.4 1.0 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"k-arrow-the-vo\\\" transform=\\\"pos: 0 1.2 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-the-vo\\\" transform=\\\"pos: 0 2.2 0\\\">\\n        <renderer name=\\\"k-vec-the-vo\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"label-k1-vo\\\" text=\\\"k\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n          <word text=\\\"1\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"v-arrow-the-vo\\\" transform=\\\"pos: 0.15 1.2 0; scale: 0 0 0\\\" line=\\\"offset: 0.5 0.7 0; color: #aa4d00; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-v-the-vo\\\" transform=\\\"pos: 0.8 2.2 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"v-vec-the-vo\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#aa4d00\\\"></renderer>\\n        <word name=\\\"label-v1-vo\\\" text=\\\"v\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#aa4d00\\\">\\n          <word text=\\\"1\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#aa4d00\\\"></word>\\n        </word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x1-vo\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"1\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-hot-vo\\\" text=\\\"hot\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-hot-vo\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 0.6 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.12\\\"></entity>\\n    <entity name=\\\"pivot-hot-vo\\\" transform=\\\"pos: 0 1.5 0\\\">\\n      <renderer name=\\\"embed-hot-vo\\\" transform=\\\"pos: 0 0.5 0\\\" size=\\\"0.4 1.0 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"k-arrow-hot-vo\\\" transform=\\\"pos: 0 1.2 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-hot-vo\\\" transform=\\\"pos: 0 2.2 0\\\">\\n        <renderer name=\\\"k-vec-hot-vo\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"label-k2-vo\\\" text=\\\"k\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n          <word text=\\\"2\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"v-arrow-hot-vo\\\" transform=\\\"pos: 0.15 1.2 0; scale: 0 0 0\\\" line=\\\"offset: 0.5 0.7 0; color: #aa4d00; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-v-hot-vo\\\" transform=\\\"pos: 0.8 2.2 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"v-vec-hot-vo\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#aa4d00\\\"></renderer>\\n        <word name=\\\"label-v2-vo\\\" text=\\\"v\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#aa4d00\\\">\\n          <word text=\\\"2\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#aa4d00\\\"></word>\\n        </word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x2-vo\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"2\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-dog-vo\\\" text=\\\"dog\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-dog-vo\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 0.6 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.12\\\"></entity>\\n    <entity name=\\\"pivot-dog-vo\\\" transform=\\\"pos: 0 1.5 0\\\">\\n      <renderer name=\\\"embed-dog-vo\\\" transform=\\\"pos: 0 0.5 0\\\" size=\\\"0.4 1.0 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"q-arrow-dog-vo\\\" transform=\\\"pos: -0.15 1.2 0\\\" line=\\\"offset: -0.5 0.7 0; color: #107d32; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-q-dog-vo\\\" transform=\\\"pos: -0.8 2.2 0\\\">\\n        <renderer name=\\\"q-vec-dog-vo\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#107d32\\\"></renderer>\\n        <word name=\\\"label-q3-vo\\\" text=\\\"q\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#107d32\\\">\\n          <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#107d32\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"k-arrow-dog-vo\\\" transform=\\\"pos: 0 1.2 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-dog-vo\\\" transform=\\\"pos: 0 2.2 0\\\">\\n        <renderer name=\\\"k-vec-dog-vo\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"label-k3-vo\\\" text=\\\"k\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n          <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"v-arrow-dog-vo\\\" transform=\\\"pos: 0.15 1.2 0; scale: 0 0 0\\\" line=\\\"offset: 0.5 0.7 0; color: #aa4d00; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-v-dog-vo\\\" transform=\\\"pos: 0.8 2.2 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"v-vec-dog-vo\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#aa4d00\\\"></renderer>\\n        <word name=\\\"label-v3-vo\\\" text=\\\"v\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#aa4d00\\\">\\n          <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#aa4d00\\\"></word>\\n        </word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x3-vo\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-was-vo\\\" text=\\\"was\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-was-vo\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 0.6 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.12\\\"></entity>\\n    <entity name=\\\"pivot-was-vo\\\" transform=\\\"pos: 0 1.5 0\\\">\\n      <renderer name=\\\"embed-was-vo\\\" transform=\\\"pos: 0 0.5 0\\\" size=\\\"0.4 1.0 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"k-arrow-was-vo\\\" transform=\\\"pos: 0 1.2 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-was-vo\\\" transform=\\\"pos: 0 2.2 0\\\">\\n        <renderer name=\\\"k-vec-was-vo\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"label-k4-vo\\\" text=\\\"k\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n          <word text=\\\"4\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"v-arrow-was-vo\\\" transform=\\\"pos: 0.15 1.2 0; scale: 0 0 0\\\" line=\\\"offset: 0.5 0.7 0; color: #aa4d00; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-v-was-vo\\\" transform=\\\"pos: 0.8 2.2 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"v-vec-was-vo\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#aa4d00\\\"></renderer>\\n        <word name=\\\"label-v4-vo\\\" text=\\\"v\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#aa4d00\\\">\\n          <word text=\\\"4\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#aa4d00\\\"></word>\\n        </word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x4-vo\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"4\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n</paragraph>\\n\\n<entity name=\\\"softmax-label-vo\\\" transform=\\\"pos: -4.5 7.7 0\\\">\\n  <word text=\\\"softmax(\\\" transform=\\\"pos: -1.5 0 0\\\" font-size=\\\"0.6\\\" color=\\\"#666666\\\"></word>\\n  <word text=\\\"q\\\" transform=\\\"pos: 0.2 0.45 0\\\" font-size=\\\"0.6\\\" color=\\\"#107d32\\\">\\n    <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#107d32\\\"></word>\\n  </word>\\n  <word text=\\\"K\\\" transform=\\\"pos: 0.8 0.45 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n    <word text=\\\"T\\\" transform=\\\"pos: 0.35 0.2 0\\\" font-size=\\\"0.35\\\" color=\\\"#275af1\\\"></word>\\n  </word>\\n  <entity transform=\\\"pos: 0.6 0 0\\\" line=\\\"offset: 0.8 0 0; color: 0x666666; thickness: 2\\\"></entity>\\n  <entity transform=\\\"pos: 0.6 0 0\\\" line=\\\"offset: -0.8 0 0; color: 0x666666; thickness: 2\\\"></entity>\\n  <word text=\\\"√d\\\" transform=\\\"pos: 0.6 -0.5 0\\\" font-size=\\\"0.5\\\" color=\\\"#666666\\\"></word>\\n  <word text=\\\")\\\" transform=\\\"pos: 1.6 0 0\\\" font-size=\\\"0.6\\\" color=\\\"#666666\\\"></word>\\n  <word name=\\\"label-V-vo\\\" text=\\\"V\\\" transform=\\\"pos: 2.2 0 0; scale: 0 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#aa4d00\\\"></word>\\n</entity>\\n\\n<div class=\\\"step\\\" data-title=\\\"Attention weights\\\" data-description=\\\"We have our &lt;span class=&quot;concept-attention&quot;&gt;attention weights&lt;/span&gt;—the amount &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt; attends to every other token. But we still need to incorporate the actual &lt;i&gt;meaning&lt;/i&gt; of those tokens.\\\"></div>\\n\\n<div class=\\\"step\\\" data-title=\\\"Value projection\\\" data-description=\\\"We project each embedding to a &lt;span class=&quot;concept-value&quot;&gt;value vector&lt;/span&gt; &lt;span class=&quot;katex-inline concept-value&quot;&gt;V&lt;/span&gt;. When multiplied by our &lt;span class=&quot;concept-attention&quot;&gt;attention weights&lt;/span&gt;, this gives us the contextualized meaning of &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt;.\\\">\\n  <sequence name=\\\"show-values\\\">\\n    <tween target=\\\"v-arrow-the-vo\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-v-the-vo\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"v-arrow-hot-vo\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-v-hot-vo\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"v-arrow-dog-vo\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-v-dog-vo\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"v-arrow-was-vo\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-v-was-vo\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.1\\\"></pause>\\n    <tween target=\\\"label-V-vo\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"back-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-values\\\">\\n    <tween target=\\\"label-V-vo\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-v-was-vo\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"v-arrow-was-vo\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-v-dog-vo\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"v-arrow-dog-vo\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-v-hot-vo\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"v-arrow-hot-vo\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-v-the-vo\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"v-arrow-the-vo\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n  </sequence>\\n</div>\\n\"","export default \"<entity name=\\\"controller-full-attention\\\" step-controller></entity>\\n<entity name=\\\"camera-target-full-attention\\\" transform=\\\"pos: -4.5 3.5 0\\\"></entity>\\n<orbit-camera\\n  name=\\\"camera-full-attention\\\"\\n  target=\\\"camera-target-full-attention\\\"\\n  current-distance=\\\"12\\\"\\n  target-distance=\\\"12\\\"\\n  current-yaw=\\\"0\\\"\\n  target-yaw=\\\"0\\\"\\n  current-pitch=\\\"0\\\"\\n  target-pitch=\\\"0\\\"\\n  min-pitch=\\\"-1.57\\\"\\n  max-pitch=\\\"1.57\\\"\\n  offset-y=\\\"0\\\"\\n  main-camera=\\\"projection: orthographic; ortho-size: 11\\\"\\n></orbit-camera>\\n<entity ambient-light=\\\"intensity: 6.0\\\"></entity>\\n<entity directional-light=\\\"intensity: 5.0; direction: -1 2 1\\\"></entity>\\n\\n<paragraph name=\\\"input-tokens-fa\\\" transform=\\\"pos: -4.5 0 0\\\" gap=\\\"2.0\\\" align=\\\"center\\\">\\n  <word name=\\\"token-the-fa\\\" text=\\\"the\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-the-fa\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 0.6 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.12\\\"></entity>\\n    <entity name=\\\"pivot-the-fa\\\" transform=\\\"pos: 0 1.5 0\\\">\\n      <renderer name=\\\"embed-the-fa\\\" transform=\\\"pos: 0 0.5 0\\\" size=\\\"0.4 1.0 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"q-arrow-the-fa\\\" transform=\\\"pos: -0.15 1.2 0; scale: 0 0 0\\\" line=\\\"offset: -0.5 0.7 0; color: #107d32; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-q-the-fa\\\" transform=\\\"pos: -0.8 2.2 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"q-vec-the-fa\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#107d32\\\"></renderer>\\n        <word name=\\\"label-q1-fa\\\" text=\\\"q\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#107d32\\\">\\n          <word text=\\\"1\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#107d32\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"k-arrow-the-fa\\\" transform=\\\"pos: 0 1.2 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-the-fa\\\" transform=\\\"pos: 0 2.2 0\\\">\\n        <renderer name=\\\"k-vec-the-fa\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"label-k1-fa\\\" text=\\\"k\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n          <word text=\\\"1\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"v-arrow-the-fa\\\" transform=\\\"pos: 0.15 1.2 0\\\" line=\\\"offset: 0.5 0.7 0; color: #aa4d00; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-v-the-fa\\\" transform=\\\"pos: 0.8 2.2 0\\\">\\n        <renderer name=\\\"v-vec-the-fa\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#aa4d00\\\"></renderer>\\n        <word name=\\\"label-v1-fa\\\" text=\\\"v\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#aa4d00\\\">\\n          <word text=\\\"1\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#aa4d00\\\"></word>\\n        </word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x1-fa\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"1\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-hot-fa\\\" text=\\\"hot\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-hot-fa\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 0.6 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.12\\\"></entity>\\n    <entity name=\\\"pivot-hot-fa\\\" transform=\\\"pos: 0 1.5 0\\\">\\n      <renderer name=\\\"embed-hot-fa\\\" transform=\\\"pos: 0 0.5 0\\\" size=\\\"0.4 1.0 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"q-arrow-hot-fa\\\" transform=\\\"pos: -0.15 1.2 0; scale: 0 0 0\\\" line=\\\"offset: -0.5 0.7 0; color: #107d32; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-q-hot-fa\\\" transform=\\\"pos: -0.8 2.2 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"q-vec-hot-fa\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#107d32\\\"></renderer>\\n        <word name=\\\"label-q2-fa\\\" text=\\\"q\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#107d32\\\">\\n          <word text=\\\"2\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#107d32\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"k-arrow-hot-fa\\\" transform=\\\"pos: 0 1.2 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-hot-fa\\\" transform=\\\"pos: 0 2.2 0\\\">\\n        <renderer name=\\\"k-vec-hot-fa\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"label-k2-fa\\\" text=\\\"k\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n          <word text=\\\"2\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"v-arrow-hot-fa\\\" transform=\\\"pos: 0.15 1.2 0\\\" line=\\\"offset: 0.5 0.7 0; color: #aa4d00; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-v-hot-fa\\\" transform=\\\"pos: 0.8 2.2 0\\\">\\n        <renderer name=\\\"v-vec-hot-fa\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#aa4d00\\\"></renderer>\\n        <word name=\\\"label-v2-fa\\\" text=\\\"v\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#aa4d00\\\">\\n          <word text=\\\"2\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#aa4d00\\\"></word>\\n        </word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x2-fa\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"2\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-dog-fa\\\" text=\\\"dog\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-dog-fa\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 0.6 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.12\\\"></entity>\\n    <entity name=\\\"pivot-dog-fa\\\" transform=\\\"pos: 0 1.5 0\\\">\\n      <renderer name=\\\"embed-dog-fa\\\" transform=\\\"pos: 0 0.5 0\\\" size=\\\"0.4 1.0 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"q-arrow-dog-fa\\\" transform=\\\"pos: -0.15 1.2 0\\\" line=\\\"offset: -0.5 0.7 0; color: #107d32; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-q-dog-fa\\\" transform=\\\"pos: -0.8 2.2 0\\\">\\n        <renderer name=\\\"q-vec-dog-fa\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#107d32\\\"></renderer>\\n        <word name=\\\"label-q3-fa\\\" text=\\\"q\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#107d32\\\">\\n          <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#107d32\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"k-arrow-dog-fa\\\" transform=\\\"pos: 0 1.2 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-dog-fa\\\" transform=\\\"pos: 0 2.2 0\\\">\\n        <renderer name=\\\"k-vec-dog-fa\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"label-k3-fa\\\" text=\\\"k\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n          <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"v-arrow-dog-fa\\\" transform=\\\"pos: 0.15 1.2 0\\\" line=\\\"offset: 0.5 0.7 0; color: #aa4d00; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-v-dog-fa\\\" transform=\\\"pos: 0.8 2.2 0\\\">\\n        <renderer name=\\\"v-vec-dog-fa\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#aa4d00\\\"></renderer>\\n        <word name=\\\"label-v3-fa\\\" text=\\\"v\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#aa4d00\\\">\\n          <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#aa4d00\\\"></word>\\n        </word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x3-fa\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n  <word name=\\\"token-was-fa\\\" text=\\\"was\\\" font-size=\\\"0.8\\\" color=\\\"#2d5a8a\\\" border=\\\"padding: 0.2; color: 0x1e3d5e\\\">\\n    <entity name=\\\"arrow-was-fa\\\" transform=\\\"pos: 0 0.7 0\\\" line=\\\"offset: 0 0.6 0; color: #6b4c8a; thickness: 2; arrow-end: 1; arrow-size: 0.12\\\"></entity>\\n    <entity name=\\\"pivot-was-fa\\\" transform=\\\"pos: 0 1.5 0\\\">\\n      <renderer name=\\\"embed-was-fa\\\" transform=\\\"pos: 0 0.5 0\\\" size=\\\"0.4 1.0 0.4\\\" color=\\\"#6b4c8a\\\"></renderer>\\n      <entity name=\\\"q-arrow-was-fa\\\" transform=\\\"pos: -0.15 1.2 0; scale: 0 0 0\\\" line=\\\"offset: -0.5 0.7 0; color: #107d32; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-q-was-fa\\\" transform=\\\"pos: -0.8 2.2 0; scale: 0 0 0\\\">\\n        <renderer name=\\\"q-vec-was-fa\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#107d32\\\"></renderer>\\n        <word name=\\\"label-q4-fa\\\" text=\\\"q\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#107d32\\\">\\n          <word text=\\\"4\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#107d32\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"k-arrow-was-fa\\\" transform=\\\"pos: 0 1.2 0\\\" line=\\\"offset: 0 0.7 0; color: #275af1; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-k-was-fa\\\" transform=\\\"pos: 0 2.2 0\\\">\\n        <renderer name=\\\"k-vec-was-fa\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#275af1\\\"></renderer>\\n        <word name=\\\"label-k4-fa\\\" text=\\\"k\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n          <word text=\\\"4\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#275af1\\\"></word>\\n        </word>\\n      </entity>\\n      <entity name=\\\"v-arrow-was-fa\\\" transform=\\\"pos: 0.15 1.2 0\\\" line=\\\"offset: 0.5 0.7 0; color: #aa4d00; thickness: 2; arrow-end: 1; arrow-size: 0.15\\\"></entity>\\n      <entity name=\\\"pivot-v-was-fa\\\" transform=\\\"pos: 0.8 2.2 0\\\">\\n        <renderer name=\\\"v-vec-was-fa\\\" transform=\\\"pos: 0 0.8 0\\\" size=\\\"0.4 1.6 0.4\\\" color=\\\"#aa4d00\\\"></renderer>\\n        <word name=\\\"label-v4-fa\\\" text=\\\"v\\\" transform=\\\"pos: 0 2.35 0\\\" font-size=\\\"0.6\\\" color=\\\"#aa4d00\\\">\\n          <word text=\\\"4\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#aa4d00\\\"></word>\\n        </word>\\n      </entity>\\n    </entity>\\n    <word name=\\\"label-x4-fa\\\" text=\\\"x\\\" transform=\\\"pos: 0 -1.1 0\\\" font-size=\\\"0.6\\\" color=\\\"#2d5a8a\\\">\\n      <word text=\\\"4\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#2d5a8a\\\"></word>\\n    </word>\\n  </word>\\n</paragraph>\\n\\n<entity name=\\\"equation-fa\\\" transform=\\\"pos: -4.5 7.7 0\\\">\\n  <word text=\\\"softmax(\\\" transform=\\\"pos: -1.5 0 0\\\" font-size=\\\"0.6\\\" color=\\\"#666666\\\"></word>\\n  <entity name=\\\"query-slot-fa\\\" transform=\\\"pos: 0.2 0.45 0\\\">\\n    <word name=\\\"label-q3-eq-fa\\\" text=\\\"q\\\" font-size=\\\"0.6\\\" color=\\\"#107d32\\\">\\n      <word text=\\\"3\\\" transform=\\\"pos: 0.3 -0.18 0\\\" font-size=\\\"0.4\\\" color=\\\"#107d32\\\"></word>\\n    </word>\\n    <word name=\\\"label-Q-eq-fa\\\" text=\\\"Q\\\" transform=\\\"scale: 0 0 0\\\" font-size=\\\"0.6\\\" color=\\\"#107d32\\\"></word>\\n  </entity>\\n  <word text=\\\"K\\\" transform=\\\"pos: 0.8 0.45 0\\\" font-size=\\\"0.6\\\" color=\\\"#275af1\\\">\\n    <word text=\\\"T\\\" transform=\\\"pos: 0.35 0.2 0\\\" font-size=\\\"0.35\\\" color=\\\"#275af1\\\"></word>\\n  </word>\\n  <entity transform=\\\"pos: 0.6 0 0\\\" line=\\\"offset: 0.8 0 0; color: 0x666666; thickness: 2\\\"></entity>\\n  <entity transform=\\\"pos: 0.6 0 0\\\" line=\\\"offset: -0.8 0 0; color: 0x666666; thickness: 2\\\"></entity>\\n  <word text=\\\"√d\\\" transform=\\\"pos: 0.6 -0.5 0\\\" font-size=\\\"0.5\\\" color=\\\"#666666\\\"></word>\\n  <word text=\\\")\\\" transform=\\\"pos: 1.6 0 0\\\" font-size=\\\"0.6\\\" color=\\\"#666666\\\"></word>\\n  <word text=\\\"V\\\" transform=\\\"pos: 2.2 0 0\\\" font-size=\\\"0.7\\\" color=\\\"#aa4d00\\\"></word>\\n</entity>\\n\\n<div class=\\\"step\\\" data-title=\\\"&quot;Dog&quot; self-attention\\\" data-description=\\\"So far, we've built the full attention mechanism for &lt;span class=&quot;token-input&quot;&gt;&quot;dog&quot;&lt;/span&gt;—its &lt;span class=&quot;concept-query&quot;&gt;query&lt;/span&gt; attends to all &lt;span class=&quot;concept-key&quot;&gt;keys&lt;/span&gt;, and the weighted &lt;span class=&quot;concept-value&quot;&gt;values&lt;/span&gt; produce its contextualized meaning.\\\"></div>\\n\\n<div class=\\\"step\\\" data-title=\\\"The full picture\\\" data-description=\\\"In practice, every token does the same—each one attends to every other, computing its own contextualized meaning in parallel.\\\">\\n  <sequence name=\\\"show-self-attention\\\">\\n    <tween target=\\\"q-arrow-the-fa\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-q-the-fa\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"q-arrow-hot-fa\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-q-hot-fa\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"q-arrow-was-fa\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"expo-out\\\"></tween>\\n    <tween target=\\\"pivot-q-was-fa\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"expo-out\\\"></tween>\\n    <pause duration=\\\"0.05\\\"></pause>\\n    <tween target=\\\"label-q3-eq-fa\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.3\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"label-Q-eq-fa\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.4\\\" easing=\\\"back-out\\\"></tween>\\n  </sequence>\\n  <sequence name=\\\"hide-self-attention\\\">\\n    <tween target=\\\"label-Q-eq-fa\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"label-q3-eq-fa\\\" attr=\\\"scale\\\" to=\\\"1 1 1\\\" duration=\\\"0.3\\\" easing=\\\"back-out\\\"></tween>\\n    <tween target=\\\"pivot-q-was-fa\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"q-arrow-was-fa\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-q-hot-fa\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"q-arrow-hot-fa\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"pivot-q-the-fa\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n    <tween target=\\\"q-arrow-the-fa\\\" attr=\\\"scale\\\" to=\\\"0 0 0\\\" duration=\\\"0.15\\\" easing=\\\"sine-out\\\"></tween>\\n  </sequence>\\n</div>\\n\"","import setupCanvas from './setup.xml?raw';\nimport problemCanvas from './problem.xml?raw';\nimport dotProductCanvas from './dot-product.xml?raw';\nimport queryKeyCanvas from './query-key.xml?raw';\nimport attentionWeightsCanvas from './attention-weights.xml?raw';\nimport valueOutputCanvas from './value-output.xml?raw';\nimport fullAttentionCanvas from './full-attention.xml?raw';\n\nexport type CanvasId =\n  | 'setup'\n  | 'problem'\n  | 'dot-product'\n  | 'query-key'\n  | 'attention-weights'\n  | 'value-output'\n  | 'full-attention';\n\nexport const CANVAS_FILES: Record<CanvasId, string> = {\n  setup: setupCanvas,\n  problem: problemCanvas,\n  'dot-product': dotProductCanvas,\n  'query-key': queryKeyCanvas,\n  'attention-weights': attentionWeightsCanvas,\n  'value-output': valueOutputCanvas,\n  'full-attention': fullAttentionCanvas,\n};\n\nexport function injectCanvasWorld(worldElement: Element, canvasId: CanvasId): void {\n  const xmlContent = CANVAS_FILES[canvasId];\n  if (!xmlContent) {\n    console.warn(`No canvas definition found for: ${canvasId}`);\n    return;\n  }\n\n  const temp = document.createElement('div');\n  temp.innerHTML = xmlContent.trim();\n\n  for (const child of Array.from(temp.children)) {\n    if (child.classList.contains('step')) {\n      for (const seq of Array.from(child.children)) {\n        worldElement.appendChild(seq);\n      }\n    } else {\n      worldElement.appendChild(child);\n    }\n  }\n}\n","import './components.css';\nimport { initCanvas, type CanvasConfig, LIGHT, type Theme } from '@blog-components/canvas';\nimport { createPlugin, setupStepUI, findStepElements, parseSteps } from '@blog-components/sequence';\nimport { BordersPlugin } from '@blog-components/borders';\nimport { injectCanvasWorld, CANVAS_FILES, type CanvasId } from './canvases';\n\nconst CONCEPT_COLORS = {\n  query: LIGHT.green,\n  key: LIGHT.blue,\n  value: LIGHT.yellow,\n  attention: LIGHT.red,\n} as const;\n\nfunction toHex(color: number): string {\n  return '#' + color.toString(16).padStart(6, '0');\n}\n\nfunction injectConceptColors(): void {\n  const root = document.documentElement;\n  for (const [name, color] of Object.entries(CONCEPT_COLORS)) {\n    root.style.setProperty(`--color-${name}`, toHex(color));\n  }\n}\n\nfunction renderKatexDescription(el: HTMLElement, description: string): void {\n  el.innerHTML = description;\n  el.querySelectorAll('.katex-inline').forEach((katexEl) => {\n    const text = katexEl.textContent ?? '';\n    if (text && window.katex) {\n      katexEl.innerHTML = window.katex.renderToString(text, {\n        displayMode: false,\n        throwOnError: false,\n      });\n    }\n  });\n}\n\nfunction createCanvasConfig(canvasId: CanvasId): CanvasConfig {\n  const { steps, sequenceMap } = parseSteps(CANVAS_FILES[canvasId]);\n\n  return {\n    canvasId: `canvas-${canvasId}`,\n    theme: LIGHT,\n    createPlugin: () => [createPlugin(sequenceMap), BordersPlugin],\n    beforeInit: (worldElement) => injectCanvasWorld(worldElement, canvasId),\n    setupUI: (state: import('vibegame').State, _theme: Theme) => {\n      const controller = state.getEntityByName(`controller-${canvasId}`);\n      if (controller === null) return;\n\n      const elements = findStepElements(`.step-navigator[data-canvas=\"${canvasId}\"]`);\n      if (!elements) return;\n\n      setupStepUI(state, controller, {\n        steps,\n        elements,\n        renderDescription: renderKatexDescription,\n      });\n    },\n  };\n}\n\nconst demos: CanvasConfig[] = (Object.keys(CANVAS_FILES) as CanvasId[]).map(createCanvasConfig);\n\nfunction substituteColors(tex: string): string {\n  return tex.replace(/\\\\color\\{(\\w+)\\}/g, (_match, name) => {\n    const color = CONCEPT_COLORS[name as keyof typeof CONCEPT_COLORS];\n    return color !== undefined ? `\\\\color{${toHex(color)}}` : _match;\n  });\n}\n\nfunction renderKatex(): void {\n  if (typeof window === 'undefined' || !window.katex) return;\n\n  const render = (el: Element, displayMode: boolean) => {\n    const text = el.textContent ?? '';\n    if (!text) return;\n    const tex = substituteColors(text);\n    el.innerHTML = window.katex!.renderToString(tex, { displayMode, throwOnError: false });\n  };\n\n  document.querySelectorAll('.katex-display').forEach((el) => render(el, true));\n  document.querySelectorAll('.katex-inline').forEach((el) => render(el, false));\n}\n\ndeclare global {\n  interface Window {\n    katex?: {\n      renderToString: (\n        tex: string,\n        options?: { displayMode?: boolean; throwOnError?: boolean }\n      ) => string;\n    };\n  }\n}\n\nexport function init(): void {\n  injectConceptColors();\n  initCanvas(demos);\n\n  if (document.readyState === 'complete') {\n    renderKatex();\n  } else {\n    window.addEventListener('load', renderKatex);\n  }\n}\n\nif (typeof document !== 'undefined') {\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', init);\n  } else {\n    init();\n  }\n}\n"],"names":["findStepElements","selector","container","setupStepUI","state","controllerEntity","config","steps","elements","renderDescription","btnPrev","btnNext","counter","title","description","info","maxStep","navigator","renderContent","content","calculateMaxHeight","maxHeight","currentStep","StepController","updateUI","step","parseSteps","xml","stepElements","sequenceMap","stepEl","index","sequences","forwardName","reverseName","TYPES_ENUM","TYPES_NAMES","TYPES","UNSIGNED_MAX","roundToMultiple","mul","x","roundToMultiple4","$storeRef","$storeSize","$storeMaps","$storeFlattened","$storeBase","$storeType","$storeArrayElementCounts","$storeSubarrays","$subarrayCursors","$subarray","$parentArray","$tagStore","$indexType","$indexBytes","$isEidType","stores","createTypeStore","type","length","totalBytes","buffer","store","createArrayStore","metadata","storeSize","cursors","indexType","arrayElementCount","array","start","end","eid","start2","end2","isArrayType","createStore","schema","size","$store","arrayElementCounts","collectArrayElementCounts","s","keys","k","recursiveTransform","a","defaultSize","globalSize","getGlobalSize","defineComponent","component","Types","Border","borderQuery","defineQuery","Transform","createLineEntity","color","thickness","Line","BorderSetupSystem","BorderLayoutSystem","width","height","Word","posX","WorldTransform","posY","posZ","padding","transition","halfWidth","halfHeight","left","right","top","bottom","boxWidth","boxHeight","lineTop","lineRight","lineBottom","lineLeft","BorderCleanupSystem","BordersPlugin","setupCanvas","problemCanvas","dotProductCanvas","queryKeyCanvas","attentionWeightsCanvas","valueOutputCanvas","fullAttentionCanvas","CANVAS_FILES","injectCanvasWorld","worldElement","canvasId","xmlContent","temp","child","seq","CONCEPT_COLORS","LIGHT","toHex","injectConceptColors","root","name","renderKatexDescription","el","katexEl","text","createCanvasConfig","createPlugin","_theme","controller","demos","substituteColors","tex","_match","renderKatex","render","displayMode","init","initCanvas"],"mappings":"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AAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECAfC,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECAfC,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECAfC,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECAfC,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECAfC,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;A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","x_google_ignoreList":[2]}