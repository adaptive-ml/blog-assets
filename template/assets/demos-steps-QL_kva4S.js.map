{"version":3,"file":"demos-steps-QL_kva4S.js","sources":["../../../src/sequence/ui.ts","../../blog/demos/steps.ts"],"sourcesContent":["export interface StepContent {\n  title: string;\n  description: string;\n}\n\nexport interface StepUIOptions {\n  steps: StepContent[];\n  onStepChange: (step: number) => void;\n}\n\nexport interface StepUIElements {\n  btnPrev: HTMLButtonElement | null;\n  btnNext: HTMLButtonElement | null;\n  counter: HTMLElement | null;\n  title: HTMLElement | null;\n  description: HTMLElement | null;\n}\n\nexport function findStepElements(container: HTMLElement | string): StepUIElements {\n  const root = typeof container === 'string' ? document.querySelector(container) : container;\n  if (!root) {\n    return { btnPrev: null, btnNext: null, counter: null, title: null, description: null };\n  }\n\n  return {\n    btnPrev: root.querySelector('.btn-prev') as HTMLButtonElement | null,\n    btnNext: root.querySelector('.btn-next') as HTMLButtonElement | null,\n    counter: root.querySelector('.step-counter'),\n    title: root.querySelector('.step-title'),\n    description: root.querySelector('.step-description'),\n  };\n}\n\nexport interface StepUIController {\n  setStep: (step: number) => void;\n  getStep: () => number;\n  getMaxStep: () => number;\n  dispose: () => void;\n}\n\nexport function setupStepUI(elements: StepUIElements, options: StepUIOptions): StepUIController {\n  const { steps, onStepChange } = options;\n  const maxStep = steps.length - 1;\n  let currentStep = 0;\n\n  function updateDisplay(): void {\n    const { btnPrev, btnNext, counter, title, description } = elements;\n    const content = steps[currentStep];\n\n    if (btnPrev) btnPrev.disabled = currentStep <= 0;\n    if (btnNext) btnNext.disabled = currentStep >= maxStep;\n    if (counter) counter.textContent = `Step ${currentStep + 1} of ${steps.length}`;\n    if (title) title.textContent = content?.title ?? '';\n    if (description) description.textContent = content?.description ?? '';\n  }\n\n  function goToStep(step: number): void {\n    const clamped = Math.max(0, Math.min(maxStep, step));\n    if (clamped === currentStep) return;\n    currentStep = clamped;\n    updateDisplay();\n    onStepChange(currentStep);\n  }\n\n  const handlePrev = () => goToStep(currentStep - 1);\n  const handleNext = () => goToStep(currentStep + 1);\n  const handleKeydown = (e: KeyboardEvent) => {\n    if (e.key === 'ArrowLeft') goToStep(currentStep - 1);\n    if (e.key === 'ArrowRight') goToStep(currentStep + 1);\n  };\n\n  elements.btnPrev?.addEventListener('click', handlePrev);\n  elements.btnNext?.addEventListener('click', handleNext);\n  document.addEventListener('keydown', handleKeydown);\n\n  updateDisplay();\n\n  return {\n    setStep(step: number) {\n      currentStep = Math.max(0, Math.min(maxStep, step));\n      updateDisplay();\n    },\n    getStep: () => currentStep,\n    getMaxStep: () => maxStep,\n    dispose() {\n      elements.btnPrev?.removeEventListener('click', handlePrev);\n      elements.btnNext?.removeEventListener('click', handleNext);\n      document.removeEventListener('keydown', handleKeydown);\n    },\n  };\n}\n","import { State, TransformsPlugin, RenderPlugin, TweenPlugin, minimalLight } from 'shallot';\nimport { OrbitPlugin } from 'shallot/extras';\nimport {\n  createStepPlugin,\n  setupStepUI,\n  findStepElements,\n  StepController,\n  type SequenceMap,\n  type StepContent,\n} from '@blog-components/sequence';\nimport { setupCanvas, createVisibilityLoop } from '@blog-components/iframe';\n\nconst STEP_SEQUENCES: SequenceMap = {\n  '0-1': 'step-0-1',\n  '1-0': 'step-1-0',\n};\n\nconst STEP_CONTENT: StepContent[] = [\n  { title: 'Initial State', description: 'Camera at starting position.' },\n  { title: 'Zoomed In', description: 'Camera moves closer, cube rises up.' },\n];\n\nasync function init(): Promise<void> {\n  const canvas = document.getElementById('canvas') as HTMLCanvasElement;\n  if (!canvas) return;\n\n  setupCanvas(canvas);\n  window.addEventListener('resize', () => setupCanvas(canvas));\n\n  const state = await State.new()\n    .withCanvas(canvas)\n    .withLoading(minimalLight(canvas))\n    .withPlugins(\n      TransformsPlugin,\n      RenderPlugin,\n      OrbitPlugin,\n      TweenPlugin,\n      createStepPlugin(STEP_SEQUENCES)\n    )\n    .withScene('/scenes/steps.scene')\n    .build();\n\n  const controllers = [...state.query([StepController])];\n  const controllerEid = controllers[0];\n\n  if (controllerEid !== undefined) {\n    const elements = findStepElements(document.body);\n    setupStepUI(elements, {\n      steps: STEP_CONTENT,\n      onStepChange(step) {\n        StepController.target[controllerEid] = step;\n      },\n    });\n  }\n\n  createVisibilityLoop(state);\n}\n\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', init);\n} else {\n  init();\n}\n"],"names":["findStepElements","container","root","setupStepUI","elements","options","steps","onStepChange","maxStep","currentStep","updateDisplay","btnPrev","btnNext","counter","title","description","content","goToStep","step","clamped","handlePrev","handleNext","handleKeydown","e","STEP_SEQUENCES","STEP_CONTENT","init","canvas","setupCanvas","state","State","minimalLight","TransformsPlugin","RenderPlugin","OrbitPlugin","TweenPlugin","createStepPlugin","controllerEid","StepController","createVisibilityLoop"],"mappings":"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"}