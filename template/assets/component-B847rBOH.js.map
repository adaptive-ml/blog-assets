{"version":3,"mappings":"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AAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AA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","names":["A","pe","fe","Ke","o","z","r","a","i","s","ue","de","K","u","Ye","Je","nt","M","p","c","me","X","f","d","P","k","T","U","x","Y","y","ye","le","he","be","b","I","L","xe","ot","n","Re","rt","at","st","it","B","pt","g","ge","ve","Ce","ft","ne","Te","Z","oe","ut","$","te","Ie","J","Ee","We","Se","Me","De","Oe","H","re","W","l","R","Qe","v","D","se","He","ae","$e","qe","je","F","Pe","ie","Ue","xt","Tt","ee","E","m","h","S","_e","Ge","ze","Q","ce","O","q","V","w","Be","It","_","Fe","we","j","N","G","C","Mt","Ne","Le","CycleError","message","toposort","nodes","edges","graph","inDegree","node","from","to","detectCycle","queue","sorted","dep","newDegree","visited","stack","hasCycle","OrderingError","sortSystems","systems","allSystems","validate","first","last","normal","buildEdges","system","target","all","group","ref","checkGroup","refGroup","Time","Scheduler","state","deltaTime","fixedDt","cached","filtered","detectTarget","isWebviewResource","path","createStandaloneRuntime","response","readTextFile","readFile","callback","createWebRuntime","_runtime","createRuntime","createHeadlessRuntime","__vitePreload","_initPromise","initRuntime","toKebabCase","str","toCamelCase","letter","levenshtein","matrix","cost","findClosestMatch","input","candidates","inputKebab","bestMatch","bestScore","candidate","candidateKebab","distance","maxLen","threshold","traitsMap","setTraits","component","traits","getTraits","registry","registerComponent","name","kebabName","getRegisteredComponent","directAccessor","data","stride","offset","eid","MAX_ENTITIES","resource","key","resourceKey","State","StateBuilder","canvas","gpu","createWorld","value","runtime","now","dt","delta","pluginOrSystem","plugin","addEntity","removeEntity","entityExists","getAllEntities","terms","query","getEntityComponents","addComponent","defaults","comp","field","arr","components","removeComponent","removeComponents","hasComponent","getComponent","subject","relation","getRelationTargets","dotIndex","bindingId","componentName","fieldPath","registered","camelPath","accessor","array","device","plugins","loading","cleanup","pluginSet","allPlugins","completed","total","scenePath","loadSceneFile","loader","result","requestGPU","adapter","defineRelation","options","bitecsCreateRelation","def","getRelationDef","wrapConstructor","OriginalConstructor","modifier","args","ZeroArray","EPSILON","setEpsilon","old","degToRad","degrees","radToDeg","radians","lerp","t","inverseLerp","euclideanModulo","utils","getAPIImpl$5","Ctor","create","newDst","fromValues","set","dst","ceil","floor","round","clamp","min","max","add","addScaled","scale","angle","ax","ay","bx","by","mag1","mag2","mag","cosine","dot","subtract","sub","equalsApproximately","equals","lerpV","mulScalar","divScalar","inverse","invert","cross","length","v0","v1","len","lengthSq","lenSq","dx","dy","dist","distanceSq","distSq","normalize","negate","copy","clone","multiply","mul","divide","div","random","zero","transformMat4","transformMat3","rotate","rad","p0","p1","sinC","cosC","setLength","truncate","midpoint","cache$5","getAPI$5","api","getAPIImpl$4","az","bz","t1","t2","v2","dz","zScale","transformMat4Upper3x3","transformQuat","qx","qy","qz","w2","uvX","uvY","uvZ","getTranslation","getAxis","axis","off","getScaling","xx","xy","xz","yx","yy","yz","zx","zy","zz","rotateX","rotateY","rotateZ","cache$4","getAPI$4","getAPIImpl$3","vec2","vec3","v3","v4","v5","v6","v7","v8","fromMat4","m4","fromQuat","x2","y2","z2","wx","wy","wz","multiplyScalar","identity","transpose","m00","m01","m02","m10","m11","m12","m20","m21","m22","b01","b11","b21","invDet","determinant","a00","a01","a02","a10","a11","a12","a20","a21","a22","b00","b02","b10","b12","b20","b22","setTranslation","setAxis","get3DScaling","translation","translate","rotation","angleInRadians","rotationX","rotationY","rotationZ","scaling","scaling3D","scale3D","uniformScaling","uniformScale","uniformScaling3D","uniformScale3D","cache$3","getAPI$3","getAPIImpl$2","v9","v10","v11","v12","v13","v14","v15","fromMat3","m3","m03","m13","m23","m30","m31","m32","m33","tmp0","tmp1","tmp2","tmp3","tmp4","tmp5","tmp6","tmp7","tmp8","tmp9","tmp10","tmp11","tmp12","tmp13","tmp14","tmp15","tmp16","tmp17","tmp18","tmp19","tmp20","tmp21","tmp22","tmp23","t0","t3","a03","a13","a23","a30","a31","a32","a33","b03","b13","b23","b30","b31","b32","b33","perspective","fieldOfViewYInRadians","aspect","zNear","zFar","rangeInv","perspectiveReverseZ","ortho","left","right","bottom","top","near","far","frustum","frustumReverseZ","xAxis","yAxis","zAxis","aim","position","up","cameraAim","eye","lookAt","axisRotation","oneMinusCosine","axisRotate","r00","r01","r02","r10","r11","r12","r20","r21","r22","cache$2","getAPI$2","getAPIImpl$1","fromAxisAngle","halfAngle","toAxisAngle","aw","bw","qw","slerp","cosOmega","scale0","scale1","omega","sinOmega","a0","a1","a2","a3","invDot","conjugate","fromMat","trace","root","invRoot","fromEuler","xAngleInRadians","yAngleInRadians","zAngleInRadians","order","xHalfAngle","yHalfAngle","zHalfAngle","sx","cx","sy","cy","sz","cz","tempVec3","xUnitVec3","yUnitVec3","rotationTo","aUnit","bUnit","tempQuat1","tempQuat2","sqlerp","cache$1","getAPI$1","getAPIImpl","dw","cache","getAPI","wgpuMatrixAPI","Mat3Ctor","Mat4Ctor","QuatCtor","Vec2Ctor","Vec3Ctor","Vec4Ctor","mat4","quat","eulerToQuaternion","quaternionToEuler","ey","ex","ez","lookAtMatrix","lookAtQuat","eyeX","eyeY","eyeZ","targetX","targetY","targetZ","upX","upY","upZ","ChildOf","nameStartChar","nameChar","nameRegexp","regexName","getAllMatches","string","regex","matches","match","allmatches","index","isName","isExist","defaultOptions","xmlData","tags","tagFound","reachedRoot","readPI","tagStartPos","readCommentAndCDATA","closingTag","tagName","validateTagName","msg","getErrorObject","getLineNumberForPosition","readAttributeStr","attrStr","attrStrStart","isValid","validateAttributeString","otg","openPos","afterAmp","validateAmpersand","isWhiteSpace","char","start","tagname","angleBracketsCount","doubleQuote","singleQuote","startChar","tagClosed","validAttrStrRegxp","attrNames","getPositionFromMatch","attrName","validateAttrName","validateNumberAmpersand","count","code","lineNumber","lines","val","jPath","attrs","buildOptions","METADATA_SYMBOL","XmlNode","startIndex","DocTypeReader","processEntities","entities","hasBody","comment","exp","hasSeq","entityName","skipWhitespace","validateEntityName","entityValue","notationName","identifierType","publicIdentifier","systemIdentifier","type","identifierVal","elementName","contentModel","attributeName","attributeType","allowedNotations","notation","validTypes","defaultValue","seq","hexRegex","numRegex","consider","toNumber","trimmedStr","parse_int","resolveEnotation","sign","leadingZeros","numTrimmedByZeros","trimZeros","decimalAdjacentToLeadingZeros","num","parsedStr","eNotationRegx","eChar","eAdjacentToLeadingZeros","numStr","base","getIgnoreAttributesFn","ignoreAttributes","pattern","OrderedObjParser","addExternalEntities","parseXml","parseTextData","resolveNameSpace","buildAttributesMap","isItStopNode","replaceEntitiesValue","readStopNodeData","saveTextToParentTag","addChild","stopNodeExp","externalEntities","entKeys","ent","dontTrim","hasAttributes","isLeafNode","escapeEntities","newval","parseValue","prefix","attrsRegx","oldVal","aName","newVal","attrCollection","xmlObj","xmlNode","currentNode","textData","docTypeReader","closeIndex","findClosingIndex","colonIndex","lastTagName","propIndex","tagData","readTagExp","childNode","endIndex","tagExp","rawTagName","attrExpPresent","newTagName","lastTag","tagContent","entity","stopNodesExact","stopNodesWildcard","currentTagName","tagExpWithClosingIndex","closingChar","attrBoundary","ch","errMsg","closingIndex","removeNSPrefix","separatorIndex","openTagCount","shouldParse","prettify","compress","text","compressedObj","tagObj","property","propName","newJpath","isLeaf","isLeafTag","assignAttributes","obj","keys","attrMap","jpath","atrrName","textNodeName","propCount","XMLParser","validationOption","orderedObjParser","orderedResult","xml","errors","warnings","parser","raw","e","elements","normalizeRaw","el","child","parseEntityElement","isEntityRef","children","entityRefs","shorthands","entityId","attrValue","camel","matched","id","childEntity","item","rawAttrs","attrKey","attrVal","detectVec2","detectVec3","detectVec4","parseNumber","parseValues","valueStr","parsePropertyString","propertyString","values","properties","prop","colonIdx","rawName","parsed","nums","fieldNames","suggestion","isCSSAttrSyntax","postLoadHooks","registerPostLoadHook","hook","LoadParseContext","loadScene","parseResult","instantiateScene","entityDefs","parseErrors","context","roots","entityDef","createEntityTree","parent","Pair","applyRelation","compDef","applyComponent","childDef","relationDef","targetEid","setFieldValue","parseAttrs","err","allValues","allErrors","createCore","coreRequestGPU","format","shared","initGPU","core","createBuffer","desc","writeBuffer","buffer","createUniformBuffer","size","label","createVertexBuffer","createIndexBuffer","beginRenderPass","encoder","config","descriptor","createBoxGeometry","vertices","indices","createSphereGeometry","segments","rings","theta","phi","nx","ny","nz","vertexCount","indexCount","createPlaneGeometry","wasm","compute_transforms","get_indices_ptr","get_matrices_ptr","get_max_entities","get_no_parent","get_parents_ptr","get_pos_x_ptr","get_pos_y_ptr","get_pos_z_ptr","get_quat_w_ptr","get_quat_x_ptr","get_quat_y_ptr","get_quat_z_ptr","get_scale_x_ptr","get_scale_y_ptr","get_scale_z_ptr","init_data","EXPECTED_RESPONSE_TYPES","__wbg_load","module","imports","bytes","instance","__wbg_get_imports","__wbg_finalize_init","__wbg_init","module_or_path","posX","posY","posZ","quatX","quatY","quatZ","quatW","scaleX","scaleY","scaleZ","matrices","parents","NoParent","init","wasmInit","maxEntities","compute","eulerProxy","getValue","Transform","setValue","WorldTransform","wasm.init","wasm.posX","wasm.posY","wasm.posZ","wasm.quatX","wasm.quatY","wasm.quatZ","wasm.quatW","wasm.scaleX","wasm.scaleY","wasm.scaleZ","wasm.matrices","TransformSystem","Not","Wildcard","wasm.indices","wasm.parents","wasm.NoParent","Hierarchy","wasm.compute","TransformsPlugin","MeshShape","sizeProxy","Mesh","colorProxy","pending","initialized","observe","onAdd","registerEntity","buffers","idx","uploadEntityIds","ctx","uploadIndirectArgs","shape","geo","indirectArgs","uploadMeshData","maxEid","byteLength","uploadMatrices","MeshSyncSystem","Render","getShapeBuffers","AmbientLight","DirectionalLight","LIGHT_UNIFORM_SIZE","lightUniforms","unpackColor","color","normalizeDirection","packLightUniforms","ambient","directional","cr","cg","cb","LightSyncSystem","uniforms","LIT_SHADER","createLitPipeline","targetFormat","shaderModule","bindGroupLayout","pipelineLayout","UberShader","Tonemap","FXAA","Vignette","initPostProcess","layout","sampler","blitLayout","blitShader","pipeline","blitPipeline","RenderMode","DebugMode","Camera","WorkgroupSize","ShapeAABBs","CullingShader","extractFrustumPlanes","viewProj","planes","normalizePlane","createAABBBuffer","aabb","initCulling","uniformBuffer","uniformData","shapeAABBBuffers","viewMatrix","projMatrix","viewProjMatrix","buildViewMatrix","cameraEid","out","tx","ty","tz","ensureCullBindGroup","cull","CullingSystem","fov","resetIndirectBuffer","computePass","resetData","createGeometryBuffers","geometry","createShapeBuffers","initRenderContext","lightBuffer","matricesBuffer","meshDataBuffer","geometries","shapes","postprocess","culling","DEBUG_COLOR","DEBUG_DEPTH","DEBUG_NORMAL","DEBUG_MATERIAL","DEBUG_HIT","debugModeToNumber","mode","BVH_CONFIG_BYTES","TERRAIN_FLOATS","TERRAIN_BYTES","LIGHT_FLOATS","LIGHT_BYTES","MAX_LIGHTS","LIGHT_ARRAY_BYTES","ENTITY_DATA_FLOATS","ENTITY_DATA_BYTES","ATMOSPHERE_FLOATS","ATMOSPHERE_BYTES","CAMERA_FLOATS","CAMERA_BYTES","CONFIG_BYTES","COUNTS_BYTES","BYTES_PER_ROW_ALIGNMENT","BYTES_PER_PIXEL","PIXELS_PER_ROW_ALIGNMENT","computePaddedWidth","width","packTerrain","terrain","floats","uints","packLights","lights","packEntityData","sizes","albedo","roughness","metallic","packTransforms","transforms","packAtmosphere","atm","createDefaultAtmosphere","packCamera","camera","packConfig","packCounts","scene","BVH_NODE_FLOATS","BVH_NODE_BYTES","MAX_PRIMITIVES_PER_LEAF","MAX_BVH_DEPTH","BVH_LEAF_FLAG","createAABB","expandAABB","point","mergeAABBs","aabbCentroid","aabbExtent","aabbSurfaceArea","SAHBinCount","TraversalCost","IntersectCost","findBestSAHSplit","entityIds","getAABB","centroids","centroidAABB","parentAABB","extent","axisExtent","axisMin","bins","centroid","centroidPos","binIdx","leftAABBs","leftCounts","runningAABB","runningCount","rightAABBs","rightCounts","parentArea","bestCost","bestSplit","leftArea","rightArea","chooseSplitAxis","getCentroidComponent","buildRecursive","depth","bestSAHResult","leftIds","rightIds","splitBoundary","sortedPairs","mid","countNodes","countPrimitives","flattenBVH","nodeCount","primCount","nodesU32","primitiveIndices","nextNodeIdx","nextPrimIdx","flatten","myIdx","primStart","leftIdx","rightIdx","buildBVH","floatBits","buf","hashEntities","hash","RAYTRACE_CORE","HARNESS_ENTRY_POINT","RAYCAST_ENTRY_POINT","HARNESS_SHADER","RAYCAST_SHADER","initRTHarness","createEmptyGraph","declareTexture","height","usage","defaultUsage","addNode","resourceWriters","output","adjList","writerId","nodeMap","neighbor","degree","allocateResources","texture","deallocateResources","executeGraph","canvasWidth","canvasHeight","canvasFormat","canvasView","unpackClearColor","ensureBindGroup","createRasterNode","cameraData","sceneColorId","sceneDepthId","graphCtx","sceneColorView","sceneDepthView","renderPass","WorkgroupSizeX","WorkgroupSizeY","ShapeSphere","createSphereAABBLookup","radius","findMaxEntityId","createBuffers","entityCount","sparseSize","uploadSceneData","harness","entityData","sphereIds","useBVH","bvh","cacheHit","currentHash","bvhConfigData","destroyBuffers","needsBufferResize","createRaycastNode","nodeConfig","outputId","bindGroup","lastTextureView","gctx","textureView","pass","Lines","lineUniforms","drawLines","cameraPos","Text","textUniforms","drawText","createOverlayNode","inputColorId","outputColorId","colorView","FLAG_TONEMAP","FLAG_FXAA","FLAG_VIGNETTE","createPostProcessNode","pp","inputId","hasEffects","flags","inputView","outputView","createBlitNode","tempViewMatrix","tempProjMatrix","tempViewProjMatrix","extractCameraData","cameraPosition","findActiveCamera","collectEffectConfig","hasTonemap","hasFxaa","hasVignette","collectGraphBuilderInput","renderMode","effects","buildGraph","hasOverlays","sceneColorFormat","sceneColorUsage","postProcessedId","buildRenderGraph","Material","Atmosphere","Terrain","terrainHeights","getTerrainHeights","collectCamera","collectEntityIds","ids","collectLights","direction","collectAtmosphere","collectTerrain","heights","collectScene","atmosphere","DebugModes","collectConfig","debug","RenderSystem","GraphRenderMode","render","RenderPlugin","Input","keysPressed","keysReleased","mouse","inputState","handleKeyDown","handleKeyUp","handleMouseDown","handleMouseUp","handleMouseMove","handleWheel","handleContextMenu","resetFrameState","clearAllState","InputSystem","InputResetSystem","InputPlugin","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","easeOutSine","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","easeInCirc","easeOutCirc","easeInOutCirc","easeInBack","easeOutBack","easeInOutBack","easeInElastic","easeOutElastic","easeInOutElastic","easeOutBounce","easeInBounce","easeInOutBounce","EASING_FUNCTIONS","EASING_INDEX","getEasingIndex","getEasing","Pause","SequenceState","Sequence","updateSequencePlayheads","seqEid","prevElapsed","elapsed","childEid","Tween","TweenState","delay","shouldStart","wasStarted","captureFromValue","ensureSequenceResolved","tweens","duration","ensureResolved","ensureSequencesResolved","checkSequenceCompletion","allComplete","hasChildren","updateSequences","parseTweenAttrs","part","setupTweenFromXml","TweenTarget","parseTargetPath","rest","firstDot","pendingXmlTweens","_state","_context","tweenEid","finalizePendingTweens","targets","binding","updateTweens","tweenState","rawProgress","easedProgress","TweenSystem","TweenPlugin","dark","light","LOGO_SVG","createOverlay","bg","overlay","createProgressBar","theme","track","bar","shallotLoading","logo","progressBar","progress","minimalLoading","shallotDark","minimalLight","DEFAULT_PLUGINS","canvasLoading","Tau","Orbit","smoothLerp","smoothness","normalizeAngle","angleDiff","diff","OrbitSystem","sensitivity","zoomSpeed","minPitch","maxPitch","minDistance","maxDistance","currentDistance","distanceScale","zoomDelta","yaw","pitch","camX","camY","camZ","OrbitPlugin","Line"],"ignoreList":[0,15,18,19,20,21,22,23,24,25,26,27],"sources":["../../../../shallot/node_modules/bitecs/dist/core/index.min.mjs","../../../../shallot/src/core/ecs/toposort.ts","../../../../shallot/src/core/ecs/ordering.ts","../../../../shallot/src/core/scheduler.ts","../../../../shallot/src/core/runtime/detect.ts","../../../../shallot/src/core/runtime/standalone.ts","../../../../shallot/src/core/runtime/web.ts","../../../../shallot/src/core/runtime/index.ts","../../../../shallot/src/core/ecs/naming.ts","../../../../shallot/src/core/component.ts","../../../../shallot/src/core/constants.ts","../../../../shallot/src/core/resource.ts","../../../../shallot/src/core/state.ts","../../../../shallot/src/core/gpu.ts","../../../../shallot/src/core/relation.ts","../../../../shallot/node_modules/wgpu-matrix/dist/3.x/wgpu-matrix.module.js","../../../../shallot/src/core/math.ts","../../../../shallot/src/core/hierarchy.ts","../../../../shallot/node_modules/fast-xml-parser/src/util.js","../../../../shallot/node_modules/fast-xml-parser/src/validator.js","../../../../shallot/node_modules/fast-xml-parser/src/xmlparser/OptionsBuilder.js","../../../../shallot/node_modules/fast-xml-parser/src/xmlparser/xmlNode.js","../../../../shallot/node_modules/fast-xml-parser/src/xmlparser/DocTypeReader.js","../../../../shallot/node_modules/strnum/strnum.js","../../../../shallot/node_modules/fast-xml-parser/src/ignoreAttributes.js","../../../../shallot/node_modules/fast-xml-parser/src/xmlparser/OrderedObjParser.js","../../../../shallot/node_modules/fast-xml-parser/src/xmlparser/node2json.js","../../../../shallot/node_modules/fast-xml-parser/src/xmlparser/XMLParser.js","../../../../shallot/src/core/xml/parser.ts","../../../../shallot/src/core/xml/property-parser.ts","../../../../shallot/src/core/xml/loader.ts","../../../../shallot/src/standard/render/gpu/device.ts","../../../../shallot/src/standard/render/gpu/buffer.ts","../../../../shallot/src/standard/render/gpu/pass.ts","../../../../shallot/src/standard/render/geometry/box.ts","../../../../shallot/src/standard/render/geometry/sphere.ts","../../../../shallot/src/standard/render/geometry/plane.ts","../../../../shallot/rust/transforms/pkg/shallot_transforms.js","../../../../shallot/src/standard/transforms/wasm.ts","../../../../shallot/src/standard/transforms/index.ts","../../../../shallot/src/standard/render/mesh.ts","../../../../shallot/src/standard/render/lighting.ts","../../../../shallot/src/standard/render/shaders/index.ts","../../../../shallot/src/standard/render/pipeline.ts","../../../../shallot/src/standard/render/postprocess.ts","../../../../shallot/src/standard/render/camera.ts","../../../../shallot/src/standard/render/culling.ts","../../../../shallot/src/standard/render/context.ts","../../../../shallot/src/standard/render/raytracing/model.ts","../../../../shallot/src/standard/render/raytracing/bvh.ts","../../../../shallot/src/standard/render/raytracing/shaders/index.ts","../../../../shallot/src/standard/render/raytracing/harness.ts","../../../../shallot/src/standard/render/graph/graph.ts","../../../../shallot/src/standard/render/graph/executor.ts","../../../../shallot/src/standard/render/nodes/raster.ts","../../../../shallot/src/standard/render/nodes/raycast.ts","../../../../shallot/src/extras/lines/context.ts","../../../../shallot/src/extras/lines/draw.ts","../../../../shallot/src/extras/text/context.ts","../../../../shallot/src/extras/text/draw.ts","../../../../shallot/src/standard/render/nodes/overlay.ts","../../../../shallot/src/standard/render/nodes/postprocess.ts","../../../../shallot/src/standard/render/nodes/blit.ts","../../../../shallot/src/standard/render/camera-data.ts","../../../../shallot/src/standard/render/graph/builder.ts","../../../../shallot/src/standard/render/material.ts","../../../../shallot/src/standard/render/atmosphere.ts","../../../../shallot/src/standard/render/terrain.ts","../../../../shallot/src/standard/render/adapter/scene.ts","../../../../shallot/src/standard/render/adapter/config.ts","../../../../shallot/src/standard/render/system.ts","../../../../shallot/src/standard/render/index.ts","../../../../shallot/src/standard/input/input.ts","../../../../shallot/src/standard/tween/easing.ts","../../../../shallot/src/standard/tween/sequence.ts","../../../../shallot/src/standard/tween/tween.ts","../../../../shallot/src/standard/loading/canvas.ts","../../../../shallot/src/standard/defaults.ts","../../../../shallot/src/extras/orbit/orbit.ts","../../../../shallot/src/extras/lines/component.ts","../../../../shallot/src/extras/text/component.ts"],"sourcesContent":["var A=(e,t,n)=>Object.defineProperty(e,t,{value:n,enumerable:!1,writable:!0,configurable:!0});var pe=(e,t)=>t&e.entityMask,fe=(e,t)=>t>>>e.versionShift&(1<<e.versionBits)-1,Ke=(e,t)=>{let o=fe(e,t)+1&(1<<e.versionBits)-1;return t&e.entityMask|o<<e.versionShift},Xe=e=>({versioning:!0,versionBits:e}),z=e=>{let t=e?typeof e==\"function\"?e():e:{versioning:!1,versionBits:8},n=t.versionBits??8,o=t.versioning??!1,r=32-n,a=(1<<r)-1,i=r,s=(1<<n)-1<<i;return{aliveCount:0,dense:[],sparse:[],maxId:0,versioning:o,versionBits:n,entityMask:a,versionShift:i,versionMask:s}},ue=e=>{if(e.aliveCount<e.dense.length){let n=e.dense[e.aliveCount],o=n;return e.sparse[o]=e.aliveCount,e.aliveCount++,n}let t=++e.maxId;return e.dense.push(t),e.sparse[t]=e.aliveCount,e.aliveCount++,t},de=(e,t)=>{let n=e.sparse[t];if(n===void 0||n>=e.aliveCount)return;let o=e.aliveCount-1,r=e.dense[o];if(e.sparse[r]=n,e.dense[n]=r,e.sparse[t]=o,e.dense[o]=t,e.versioning){let a=Ke(e,t);e.dense[o]=a}e.aliveCount--},K=(e,t)=>{let n=pe(e,t),o=e.sparse[n];return o!==void 0&&o<e.aliveCount&&e.dense[o]===t};var u=Symbol.for(\"bitecs_internal\"),Ye=(e,t)=>A(e||{},u,{entityIndex:t||z(),entityMasks:[[]],entityComponents:new Map,bitflag:1,componentMap:new Map,componentCount:0,queries:new Set,queriesHashMap:new Map,notQueries:new Set,dirtyQueries:new Set,entitiesWithRelations:new Set,hierarchyData:new Map,hierarchyActiveRelations:new Set,hierarchyQueryCache:new Map});function Je(...e){let t,n;return e.forEach(o=>{typeof o==\"object\"&&\"dense\"in o&&\"sparse\"in o&&\"aliveCount\"in o?t=o:typeof o==\"object\"&&(n=o)}),Ye(n,t)}var Ze=e=>{let t=e[u];return t.entityIndex=z(),t.entityMasks=[[]],t.entityComponents=new Map,t.bitflag=1,t.componentMap=new Map,t.componentCount=0,t.queries=new Set,t.queriesHashMap=new Map,t.notQueries=new Set,t.dirtyQueries=new Set,t.entitiesWithRelations=new Set,t.hierarchyData=new Map,t.hierarchyActiveRelations=new Set,t.hierarchyQueryCache=new Map,e},et=e=>{delete e[u]},tt=e=>Array.from(e[u].componentMap.keys()),nt=e=>Array.from(e[u].entityComponents.keys());var M=()=>{let e=[],t=[],n=s=>e[t[s]]===s;return{add:s=>{n(s)||(t[s]=e.push(s)-1)},remove:s=>{if(!n(s))return;let p=t[s],c=e.pop();c!==s&&(e[p]=c,t[c]=p)},has:n,sparse:t,dense:e,reset:()=>{e.length=0,t.length=0},sort:s=>{e.sort(s);for(let p=0;p<e.length;p++)t[e[p]]=p}}},me=typeof SharedArrayBuffer<\"u\"?SharedArrayBuffer:ArrayBuffer,X=(e=1e3)=>{let t=[],n=0,o=new Uint32Array(new me(e*4)),r=c=>c<t.length&&t[c]<n&&o[t[c]]===c;return{add:c=>{if(!r(c)){if(n>=o.length){let f=new Uint32Array(new me(o.length*2*4));f.set(o),o=f}o[n]=c,t[c]=n,n++}},remove:c=>{if(!r(c))return;n--;let f=t[c],d=o[n];o[f]=d,t[d]=f},has:r,sparse:t,get dense(){return new Uint32Array(o.buffer,0,n)},reset:()=>{n=0,t.length=0},sort:c=>{let f=Array.from(o.subarray(0,n));f.sort(c);for(let d=0;d<f.length;d++)o[d]=f[d];for(let d=0;d<n;d++)t[o[d]]=d}}};var P=()=>{let e=new Set;return{subscribe:o=>(e.add(o),()=>{e.delete(o)}),notify:(o,...r)=>Array.from(e).reduce((a,i)=>{let s=i(o,...r);return s&&typeof s==\"object\"?{...a,...s}:a},{})}};var k=Symbol.for(\"bitecs-relation\"),T=Symbol.for(\"bitecs-pairTarget\"),U=Symbol.for(\"bitecs-isPairComponent\"),x=Symbol.for(\"bitecs-relationData\"),Y=()=>{let e={pairsMap:new Map,initStore:void 0,exclusiveRelation:!1,autoRemoveSubject:!1,onTargetRemoved:void 0},t=n=>{if(n===void 0)throw Error(\"Relation target is undefined\");let o=n===\"*\"?y:n;if(!e.pairsMap.has(o)){let r=e.initStore?e.initStore(n):{};A(r,k,t),A(r,T,o),A(r,U,!0),e.pairsMap.set(o,r)}return e.pairsMap.get(o)};return A(t,x,e),t},ye=e=>t=>{let n=t[x];return n.initStore=e,t},le=e=>{let t=e[x];return t.exclusiveRelation=!0,e},he=e=>{let t=e[x];return t.autoRemoveSubject=!0,e},be=e=>t=>{let n=t[x];return n.onTargetRemoved=e,t};var b=(e,t)=>{if(e===void 0)throw Error(\"Relation is undefined\");return e(t)},I=(e,t,n)=>{let o=L(e,t),r=[];for(let a of o)a[k]===n&&a[T]!==y&&!xe(a[T])&&r.push(a[T]);return r};function ot(...e){if(e.length===1&&typeof e[0]==\"object\"){let{store:t,exclusive:n,autoRemoveSubject:o,onTargetRemoved:r}=e[0];return[t&&ye(t),n&&le,o&&he,r&&be(r)].filter(Boolean).reduce((i,s)=>s(i),Y())}else return e.reduce((n,o)=>o(n),Y())}var Re=Symbol.for(\"bitecs-wildcard\");function rt(){let e=Y();return Object.defineProperty(e,Re,{value:!0,enumerable:!1,writable:!1,configurable:!1}),e}function at(){let e=Symbol.for(\"bitecs-global-wildcard\");return globalThis[e]||(globalThis[e]=rt()),globalThis[e]}var y=at();function st(){return Y()}function it(){let e=Symbol.for(\"bitecs-global-isa\");return globalThis[e]||(globalThis[e]=st()),globalThis[e]}var B=it();function ct(e){return e?Object.getOwnPropertySymbols(e).includes(Re):!1}function xe(e){return e?Object.getOwnPropertySymbols(e).includes(x):!1}var pt=64,g=4294967295,ge=1024;function ve(e,t){let{depths:n}=e;if(t<n.length)return n;let o=Math.max(t+1,n.length*2,n.length+ge),r=new Uint32Array(o);return r.fill(g),r.set(n),e.depths=r,r}function Ce(e,t,n,o){let{depthToEntities:r}=e;if(o!==void 0&&o!==g){let a=r.get(o);a&&(a.remove(t),a.dense.length===0&&r.delete(o))}n!==g&&(r.has(n)||r.set(n,X()),r.get(n).add(t))}function ft(e,t){t>e.maxDepth&&(e.maxDepth=t)}function ne(e,t,n,o){e.depths[t]=n,Ce(e,t,n,o),ft(e,n)}function Te(e,t){e[u].hierarchyQueryCache.delete(t)}function Z(e,t){let n=e[u];return n.hierarchyActiveRelations.has(t)||(n.hierarchyActiveRelations.add(t),oe(e,t),ut(e,t)),n.hierarchyData.get(t)}function ut(e,t){let n=$(e,[b(t,y)]);for(let r of n)te(e,t,r);let o=new Set;for(let r of n)for(let a of I(e,r,t))o.has(a)||(o.add(a),te(e,t,a))}function oe(e,t){let n=e[u];if(!n.hierarchyData.has(t)){let o=Math.max(ge,n.entityIndex.dense.length*2),r=new Uint32Array(o);r.fill(g),n.hierarchyData.set(t,{depths:r,dirty:M(),depthToEntities:new Map,maxDepth:0})}}function Ie(e,t,n,o=new Set){if(o.has(n))return 0;o.add(n);let r=I(e,n,t);if(r.length===0)return 0;if(r.length===1)return J(e,t,r[0],o)+1;let a=1/0;for(let i of r){let s=J(e,t,i,o);if(s<a&&(a=s,a===0))break}return a===1/0?0:a+1}function J(e,t,n,o){let r=e[u];oe(e,t);let a=r.hierarchyData.get(t),{depths:i}=a;if(i=ve(a,n),i[n]===g){let s=Ie(e,t,n,o);return ne(a,n,s),s}return i[n]}function te(e,t,n){return J(e,t,n,new Set)}function Ee(e,t,n,o,r=M()){if(r.has(n))return;r.add(n);let a=$(e,[t(n)]);for(let i of a)o.add(i),Ee(e,t,i,o,r)}function We(e,t,n,o,r=new Set){let a=e[u];if(!a.hierarchyActiveRelations.has(t))return;oe(e,t);let i=a.hierarchyData.get(t);if(r.has(n)){i.dirty.add(n);return}r.add(n);let{depths:s,dirty:p}=i,c=o!==void 0?te(e,t,o)+1:0;if(c>pt)return;let f=s[n];ne(i,n,c,f===g?void 0:f),f!==c&&(Ee(e,t,n,p,M()),Te(e,t))}function Se(e,t,n){let o=e[u];if(!o.hierarchyActiveRelations.has(t))return;let r=o.hierarchyData.get(t),{depths:a}=r;a=ve(r,n),Me(e,t,n,a,M()),Te(e,t)}function Me(e,t,n,o,r){if(r.has(n))return;r.add(n);let i=e[u].hierarchyData.get(t);if(n<o.length){let p=o[n];p!==g&&(i.depths[n]=g,Ce(i,n,g,p))}let s=$(e,[t(n)]);for(let p of s)Me(e,t,p,o,r)}function De(e,t){let o=e[u].hierarchyData.get(t);if(!o)return;let{dirty:r,depths:a}=o;if(r.dense.length!==0){for(let i of r.dense)if(a[i]===g){let s=Ie(e,t,i);ne(o,i,s)}r.reset()}}function Oe(e,t,n,o={}){let r=e[u];Z(e,t);let a=H(e,[t,...n]),i=r.hierarchyQueryCache.get(t);if(i&&i.hash===a)return i.result;De(e,t),re(e,n,o);let s=r.queriesHashMap.get(H(e,n)),p=r.hierarchyData.get(t),{depths:c}=p;s.sort((d,W)=>{let l=c[d],R=c[W];return l!==R?l-R:d-W});let f=(o.buffered,s.dense);return r.hierarchyQueryCache.set(t,{hash:a,result:f}),f}function Qe(e,t,n,o={}){let r=Z(e,t);De(e,t);let a=r.depthToEntities.get(n);return a?(o.buffered,a.dense):o.buffered?new Uint32Array(0):[]}function dt(e,t,n){return Z(e,n),J(e,n,t,new Set)}function mt(e,t){return Z(e,t).maxDepth}var v=Symbol.for(\"bitecs-opType\"),D=Symbol.for(\"bitecs-opTerms\"),se=e=>(...t)=>({[v]:e,[D]:t}),Ae=se(\"Or\"),ke=se(\"And\"),He=se(\"Not\"),yt=Ae,lt=ke,ht=He,ae=Symbol.for(\"bitecs-hierarchyType\"),$e=Symbol.for(\"bitecs-hierarchyRel\"),qe=Symbol.for(\"bitecs-hierarchyDepth\"),je=(e,t)=>({[ae]:\"Hierarchy\",[$e]:e,[qe]:t}),bt=je,F=Symbol.for(\"bitecs-modifierType\"),Rt={[F]:\"buffer\"},Pe={[F]:\"nested\"},ie=Pe,Ue=e=>(...t)=>({[v]:e,[D]:t}),xt=Ue(\"add\"),gt=Ue(\"remove\"),vt=e=>({[v]:\"set\",[D]:[e]}),Ct=e=>({[v]:\"get\",[D]:[e]});function Tt(e,t,n){let o=e[u],{[v]:r,[D]:a}=t;if(r===\"add\"||r===\"remove\")return(o.queriesHashMap.get(H(e,a))||ee(e,a))[r===\"add\"?\"addObservable\":\"removeObservable\"].subscribe(n);if(r===\"set\"||r===\"get\"){if(a.length!==1)throw new Error(\"Set and Get hooks can only observe a single component\");return(o.componentMap.get(a[0])||E(e,a[0]))[r===\"set\"?\"setObservable\":\"getObservable\"].subscribe(n)}throw new Error(`Invalid hook type: ${r}`)}var H=(e,t)=>{let n=e[u],o=a=>(n.componentMap.has(a)||E(e,a),n.componentMap.get(a).id),r=a=>v in a?`${a[v].toLowerCase()}(${a[D].map(r).sort().join(\",\")})`:o(a).toString();return t.map(r).sort().join(\"-\")},ee=(e,t,n={})=>{let o=e[u],r=H(e,t),a=[],i=m=>{v in m?m[D].forEach(i):(o.componentMap.has(m)||E(e,m),a.push(m))};t.forEach(i);let s=[],p=[],c=[],f=(m,h)=>{h.forEach(S=>{o.componentMap.has(S)||E(e,S),m.push(S)})};t.forEach(m=>{if(v in m){let{[v]:h,[D]:S}=m;if(h===\"Not\")f(p,S);else if(h===\"Or\")f(c,S);else if(h===\"And\")f(s,S);else throw new Error(`Nested combinator ${h} not supported yet - use simple queries for best performance`)}else o.componentMap.has(m)||E(e,m),s.push(m)});let d=a.map(m=>o.componentMap.get(m)),W=[...new Set(d.map(m=>m.generationId))],l=(m,h)=>(m[h.generationId]=(m[h.generationId]||0)|h.bitflag,m),R=s.map(m=>o.componentMap.get(m)).reduce(l,{}),_e=p.map(m=>o.componentMap.get(m)).reduce(l,{}),Ge=c.map(m=>o.componentMap.get(m)).reduce(l,{}),ze=d.reduce(l,{}),Q=Object.assign(n.buffered?X():M(),{allComponents:a,orComponents:c,notComponents:p,masks:R,notMasks:_e,orMasks:Ge,hasMasks:ze,generations:W,toRemove:M(),addObservable:P(),removeObservable:P(),queues:{}});o.queries.add(Q),o.queriesHashMap.set(r,Q),d.forEach(m=>{m.queries.add(Q)}),p.length&&o.notQueries.add(Q);let ce=o.entityIndex;for(let m=0;m<ce.aliveCount;m++){let h=ce.dense[m];if(O(e,h,q))continue;V(e,Q,h)&&w(Q,h)}return Q};function re(e,t,n={}){let o=e[u],r=H(e,t),a=o.queriesHashMap.get(r);return a?n.buffered&&!(\"buffer\"in a.dense)&&(a=ee(e,t,{buffered:!0})):a=ee(e,t,n),n.buffered,a.dense}function $(e,t,...n){let o=t.find(p=>p&&typeof p==\"object\"&&ae in p),r=t.filter(p=>!(p&&typeof p==\"object\"&&ae in p)),a=!1,i=!0,s=n.some(p=>p&&typeof p==\"object\"&&F in p);for(let p of n)if(s&&p&&typeof p==\"object\"&&F in p){let c=p;c[F]===\"buffer\"&&(a=!0),c[F]===\"nested\"&&(i=!1)}else if(!s){let c=p;c.buffered!==void 0&&(a=c.buffered),c.commit!==void 0&&(i=c.commit)}if(o){let{[$e]:p,[qe]:c}=o;return c!==void 0?Qe(e,p,c,{buffered:a}):Oe(e,p,r,{buffered:a})}return i&&Be(e),re(e,r,{buffered:a})}function V(e,t,n){let o=e[u],{masks:r,notMasks:a,orMasks:i,generations:s}=t,p=Object.keys(i).length===0;for(let c=0;c<s.length;c++){let f=s[c],d=r[f],W=a[f],l=i[f],R=o.entityMasks[f][n];if(W&&R&W||d&&(R&d)!==d)return!1;l&&R&l&&(p=!0)}return p}var w=(e,t)=>{if(e.toRemove.has(t)){e.toRemove.remove(t),e.addObservable.notify(t);return}e.has(t)||(e.add(t),e.addObservable.notify(t))},It=e=>{for(let t=0;t<e.toRemove.dense.length;t++){let n=e.toRemove.dense[t];e.remove(n)}e.toRemove.reset()},Be=e=>{let t=e[u];t.dirtyQueries.size&&(t.dirtyQueries.forEach(It),t.dirtyQueries.clear())},_=(e,t,n)=>{let o=e[u];!t.has(n)||t.toRemove.has(n)||(t.toRemove.add(n),o.dirtyQueries.add(t),t.removeObservable.notify(n))},Et=(e,t)=>{let n=e[u],o=H(e,t),r=n.queriesHashMap.get(o);r&&(n.queries.delete(r),n.queriesHashMap.delete(o))};var E=(e,t)=>{if(!t)throw new Error(\"bitECS - Cannot register null or undefined component\");let n=e[u],o=new Set,r={id:n.componentCount++,generationId:n.entityMasks.length-1,bitflag:n.bitflag,ref:t,queries:o,setObservable:P(),getObservable:P()};return n.componentMap.set(t,r),n.bitflag*=2,n.bitflag>=2**31&&(n.bitflag=1,n.entityMasks.push([])),r},Wt=(e,t)=>{t.forEach(n=>E(e,n))},O=(e,t,n)=>{let o=e[u],r=o.componentMap.get(n);if(!r)return!1;let{generationId:a,bitflag:i}=r;return(o.entityMasks[a][t]&i)===i},Fe=(e,t,n)=>{let r=e[u].componentMap.get(n);if(r&&O(e,t,n))return r.getObservable.notify(t)},Ve=(e,t)=>({component:e,data:t}),we=(e,t,n,o,r=new Set)=>{if(!r.has(o)){r.add(o),j(t,n,B(o));for(let a of L(t,o))if(a!==q&&!O(t,n,a)){j(t,n,a);let i=e.componentMap.get(a);if(i?.setObservable){let s=Fe(t,o,a);i.setObservable.notify(n,s)}}for(let a of I(t,o,B))we(e,t,n,a,r)}},St=(e,t,n,o)=>{j(e,t,Ve(n,o))},j=(e,t,n)=>{if(!N(e,t))throw new Error(`Cannot add component - entity ${t} does not exist in the world.`);let o=e[u],r=\"component\"in n?n.component:n,a=\"data\"in n?n.data:void 0;o.componentMap.has(r)||E(e,r);let i=o.componentMap.get(r);if(O(e,t,r))return a!==void 0&&i.setObservable.notify(t,a),!1;let{generationId:s,bitflag:p,queries:c}=i;if(o.entityMasks[s][t]|=p,O(e,t,q)||c.forEach(f=>{V(e,f,t)?w(f,t):_(e,f,t)}),o.entityComponents.get(t).add(r),a!==void 0&&i.setObservable.notify(t,a),r[U]){let f=r[k],d=r[T];if(G(e,t,b(f,y),b(y,d)),typeof d==\"number\"&&(G(e,d,b(y,t),b(y,f)),o.entitiesWithRelations.add(d),o.entitiesWithRelations.add(t)),o.entitiesWithRelations.add(d),f[x].exclusiveRelation===!0&&d!==y){let l=I(e,t,f)[0];l!=null&&l!==d&&C(e,t,f(l))}if(f===B){let l=I(e,t,B);for(let R of l)we(o,e,t,R)}We(e,f,t,typeof d==\"number\"?d:void 0)}return!0};function G(e,t,...n){(Array.isArray(n[0])?n[0]:n).forEach(r=>{j(e,t,r)})}var C=(e,t,...n)=>{let o=e[u];if(!N(e,t))throw new Error(`Cannot remove component - entity ${t} does not exist in the world.`);n.forEach(r=>{if(!O(e,t,r))return;let a=o.componentMap.get(r),{generationId:i,bitflag:s,queries:p}=a;if(o.entityMasks[i][t]&=~s,p.forEach(c=>{c.toRemove.remove(t),V(e,c,t)?w(c,t):_(e,c,t)}),o.entityComponents.get(t).delete(r),r[U]){let c=r[T],f=r[k];Se(e,f,t),C(e,t,b(y,c)),typeof c==\"number\"&&N(e,c)&&(C(e,c,b(y,t)),C(e,c,b(y,f))),I(e,t,f).length===0&&C(e,t,b(f,y))}})},Mt=C;var q={},Dt=e=>{let t=Ne(e);return j(e,t,q),t};function Ne(e,...t){let n=e[u],o=ue(n.entityIndex);return n.notQueries.forEach(r=>{V(e,r,o)&&w(r,o)}),n.entityComponents.set(o,new Set),t.length>0&&G(e,o,t),o}var Le=(e,t)=>{let n=e[u];if(!K(n.entityIndex,t))return;let o=[t],r=new Set;for(;o.length>0;){let a=o.shift();if(r.has(a))continue;r.add(a);let i=[];if(n.entitiesWithRelations.has(a)){for(let s of $(e,[y(a)],ie))if(N(e,s))for(let p of n.entityComponents.get(s)){if(!p[U])continue;let f=p[k][x];i.push(()=>C(e,s,b(y,a))),p[T]===a&&(i.push(()=>C(e,s,p)),f.autoRemoveSubject&&o.push(s),f.onTargetRemoved&&i.push(()=>f.onTargetRemoved(e,s,a)))}n.entitiesWithRelations.delete(a)}for(let s of i)s();for(let s of o)Le(e,s);for(let s of n.queries)_(e,s,a);de(n.entityIndex,a),n.entityComponents.delete(a);for(let s=0;s<n.entityMasks.length;s++)n.entityMasks[s][a]=0}},L=(e,t)=>{let n=e[u];if(t===void 0)throw new Error(\"getEntityComponents: entity id is undefined.\");if(!K(n.entityIndex,t))throw new Error(`getEntityComponents: entity ${t} does not exist in the world.`);return Array.from(n.entityComponents.get(t))},N=(e,t)=>K(e[u].entityIndex,t);var Ot=(...e)=>(...t)=>e.reduce((n,o)=>[o(...n)],t)[0];var Qt=e=>e;function At(e){let t=[];return e?Object.assign(t,e):t}export{u as $internal,lt as All,ke as And,yt as Any,bt as Cascade,je as Hierarchy,B as IsA,ht as None,He as Not,Ae as Or,b as Pair,q as Prefab,y as Wildcard,j as addComponent,G as addComponents,Ne as addEntity,Dt as addPrefab,At as aos,Rt as asBuffer,Be as commitRemovals,z as createEntityIndex,ot as createRelation,Je as createWorld,et as deleteWorld,N as entityExists,nt as getAllEntities,Fe as getComponent,L as getEntityComponents,dt as getHierarchyDepth,pe as getId,mt as getMaxHierarchyDepth,I as getRelationTargets,fe as getVersion,tt as getWorldComponents,O as hasComponent,Pe as isNested,xe as isRelation,ct as isWildcard,le as makeExclusive,ie as noCommit,Tt as observe,xt as onAdd,Ct as onGet,gt as onRemove,vt as onSet,Ot as pipe,$ as query,E as registerComponent,Wt as registerComponents,ee as registerQuery,C as removeComponent,Mt as removeComponents,Le as removeEntity,Et as removeQuery,Ze as resetWorld,Ve as set,St as setComponent,Qt as soa,he as withAutoRemoveSubject,be as withOnTargetRemoved,ye as withStore,Xe as withVersioning};\n//# sourceMappingURL=index.min.mjs.map\n","export class CycleError extends Error {\n    constructor(message = \"Circular dependency detected\") {\n        super(message);\n        this.name = \"CycleError\";\n    }\n}\n\nexport function toposort<T>(nodes: T[], edges: [T, T][]): T[] {\n    if (nodes.length === 0) return [];\n\n    const graph = new Map<T, Set<T>>();\n    const inDegree = new Map<T, number>();\n\n    for (const node of nodes) {\n        graph.set(node, new Set());\n        inDegree.set(node, 0);\n    }\n\n    for (const [from, to] of edges) {\n        if (!graph.has(from) || !graph.has(to)) continue;\n        graph.get(from)!.add(to);\n        inDegree.set(to, inDegree.get(to)! + 1);\n    }\n\n    detectCycle(nodes, graph);\n\n    const queue: T[] = [];\n    const sorted: T[] = [];\n\n    for (const node of nodes) {\n        if (inDegree.get(node) === 0) queue.push(node);\n    }\n\n    while (queue.length > 0) {\n        const node = queue.shift()!;\n        sorted.push(node);\n\n        for (const dep of graph.get(node)!) {\n            const newDegree = inDegree.get(dep)! - 1;\n            inDegree.set(dep, newDegree);\n            if (newDegree === 0) queue.push(dep);\n        }\n    }\n\n    return sorted;\n}\n\nfunction detectCycle<T>(nodes: T[], graph: Map<T, Set<T>>): void {\n    const visited = new Set<T>();\n    const stack = new Set<T>();\n\n    function hasCycle(node: T): boolean {\n        if (stack.has(node)) return true;\n        if (visited.has(node)) return false;\n\n        visited.add(node);\n        stack.add(node);\n\n        for (const dep of graph.get(node)!) {\n            if (hasCycle(dep)) return true;\n        }\n\n        stack.delete(node);\n        return false;\n    }\n\n    for (const node of nodes) {\n        if (hasCycle(node)) throw new CycleError();\n    }\n}\n","import { toposort, CycleError } from \"./toposort\";\nimport type { System } from \"../scheduler\";\n\nexport { CycleError };\n\nexport class OrderingError extends Error {\n    constructor(message: string) {\n        super(message);\n        this.name = \"OrderingError\";\n    }\n}\n\nexport function sortSystems(systems: System[], allSystems?: System[]): System[] {\n    const all = allSystems ?? systems;\n    validate(systems, all);\n\n    const first = systems.filter((s) => s.first);\n    const last = systems.filter((s) => s.last);\n    const normal = systems.filter((s) => !s.first && !s.last);\n\n    return [\n        ...toposort(first, buildEdges(first)),\n        ...toposort(normal, buildEdges(normal)),\n        ...toposort(last, buildEdges(last)),\n    ];\n}\n\nfunction buildEdges(systems: System[]): [System, System][] {\n    const edges: [System, System][] = [];\n    for (const system of systems) {\n        for (const target of system.before ?? []) {\n            if (systems.includes(target)) edges.push([system, target]);\n        }\n        for (const target of system.after ?? []) {\n            if (systems.includes(target)) edges.push([target, system]);\n        }\n    }\n    return edges;\n}\n\nfunction validate(systems: System[], all: System[]): void {\n    for (const s of systems) {\n        if (s.first && s.last) {\n            throw new OrderingError(\"System cannot have both first and last constraints\");\n        }\n\n        const group = s.group ?? \"simulation\";\n        for (const ref of s.before ?? []) checkGroup(ref, group, all);\n        for (const ref of s.after ?? []) checkGroup(ref, group, all);\n    }\n}\n\nfunction checkGroup(ref: System, group: string, all: System[]): void {\n    if (!all.includes(ref)) return;\n    const refGroup = ref.group ?? \"simulation\";\n    if (refGroup !== group) {\n        throw new OrderingError(`Cross-group constraint: ${group} references ${refGroup}`);\n    }\n}\n","import { sortSystems } from \"./ecs/ordering\";\nimport type { State } from \"./state\";\n\nexport const Time = {\n    FIXED_DT: 1 / 50,\n    DEFAULT_DT: 1 / 60,\n} as const;\n\nexport type SystemGroup = \"setup\" | \"fixed\" | \"simulation\" | \"draw\";\n\nexport interface System {\n    readonly update?: (state: State) => void;\n    readonly setup?: (state: State) => void;\n    readonly dispose?: (state: State) => void;\n    readonly group?: SystemGroup;\n    readonly first?: boolean;\n    readonly last?: boolean;\n    readonly before?: readonly System[];\n    readonly after?: readonly System[];\n}\n\nexport class Scheduler {\n    private readonly _systems = new Set<System>();\n    private _systemsVersion = 0;\n    private _accumulator = 0;\n    private readonly _initialized = new WeakSet<System>();\n    private _cache = new Map<SystemGroup, System[]>();\n    private _cacheVersion = -1;\n\n    get systems(): ReadonlySet<System> {\n        return this._systems;\n    }\n\n    get systemsVersion(): number {\n        return this._systemsVersion;\n    }\n\n    get accumulator(): number {\n        return this._accumulator;\n    }\n\n    register(system: System): void {\n        this._systems.add(system);\n        this._systemsVersion++;\n    }\n\n    unregister(system: System): void {\n        if (this._systems.delete(system)) {\n            this._systemsVersion++;\n        }\n    }\n\n    step(state: State, deltaTime = Time.DEFAULT_DT): void {\n        const fixedDt = Time.FIXED_DT;\n\n        state.setDeltaTime(deltaTime);\n        state.addElapsed(deltaTime);\n        this._accumulator += deltaTime;\n\n        this.runGroup(state, \"setup\");\n\n        while (this._accumulator >= fixedDt) {\n            state.setDeltaTime(fixedDt);\n            this.runGroup(state, \"fixed\");\n            this._accumulator -= fixedDt;\n        }\n\n        state.setDeltaTime(deltaTime);\n        this.runGroup(state, \"simulation\");\n        this.runGroup(state, \"draw\");\n    }\n\n    private runGroup(state: State, group: SystemGroup): void {\n        for (const system of this.getSorted(group)) {\n            if (!this._initialized.has(system)) {\n                system.setup?.(state);\n                this._initialized.add(system);\n            }\n            system.update?.(state);\n        }\n    }\n\n    private getSorted(group: SystemGroup): System[] {\n        if (this._systemsVersion !== this._cacheVersion) {\n            this._cache.clear();\n            this._cacheVersion = this._systemsVersion;\n        }\n\n        const cached = this._cache.get(group);\n        if (cached) return cached;\n\n        const all = Array.from(this._systems);\n        const filtered = all.filter((s) => (s.group ?? \"simulation\") === group);\n        const sorted = sortSystems(filtered, all);\n        this._cache.set(group, sorted);\n        return sorted;\n    }\n}\n","import type { RuntimeTarget } from \"./index\";\n\ndeclare const __TAURI_INTERNALS__: unknown;\ndeclare const Bun: unknown;\n\nexport function detectTarget(): RuntimeTarget {\n    if (typeof __TAURI_INTERNALS__ !== \"undefined\") {\n        return \"standalone\";\n    }\n\n    if (typeof Bun !== \"undefined\") {\n        return \"headless\";\n    }\n\n    if (typeof window !== \"undefined\" && typeof fetch === \"function\") {\n        return \"web\";\n    }\n\n    throw new Error(\"Unknown runtime environment\");\n}\n","import type { Runtime } from \"./index\";\n\nfunction isWebviewResource(path: string): boolean {\n    return path.startsWith(\"/\") || path.startsWith(\"./\") || path.startsWith(\"../\");\n}\n\nexport function createStandaloneRuntime(): Runtime {\n    return {\n        target: \"standalone\",\n\n        async readFile(path: string): Promise<string> {\n            if (isWebviewResource(path)) {\n                const response = await fetch(path);\n                if (!response.ok) {\n                    throw new Error(`Failed to load ${path}: ${response.status}`);\n                }\n                return response.text();\n            }\n            const { readTextFile } = await import(/* @vite-ignore */ \"@tauri-apps/plugin-fs\");\n            return readTextFile(path);\n        },\n\n        async readBinary(path: string): Promise<ArrayBuffer> {\n            if (isWebviewResource(path)) {\n                const response = await fetch(path);\n                if (!response.ok) {\n                    throw new Error(`Failed to load ${path}: ${response.status}`);\n                }\n                return response.arrayBuffer();\n            }\n            const { readFile } = await import(/* @vite-ignore */ \"@tauri-apps/plugin-fs\");\n            const bytes = await readFile(path);\n            return bytes.buffer;\n        },\n\n        requestFrame(callback: () => void): void {\n            requestAnimationFrame(callback);\n        },\n\n        now(): number {\n            return performance.now();\n        },\n    };\n}\n","import type { Runtime } from \"./index\";\n\nexport function createWebRuntime(): Runtime {\n    return {\n        target: \"web\",\n\n        async readFile(path: string): Promise<string> {\n            const response = await fetch(path);\n            if (!response.ok) {\n                throw new Error(`Failed to load ${path}: ${response.status}`);\n            }\n            return response.text();\n        },\n\n        async readBinary(path: string): Promise<ArrayBuffer> {\n            const response = await fetch(path);\n            if (!response.ok) {\n                throw new Error(`Failed to load ${path}: ${response.status}`);\n            }\n            return response.arrayBuffer();\n        },\n\n        requestFrame(callback: () => void): void {\n            requestAnimationFrame(callback);\n        },\n\n        now(): number {\n            return performance.now();\n        },\n    };\n}\n","import { detectTarget } from \"./detect\";\nimport { createStandaloneRuntime } from \"./standalone\";\nimport { createWebRuntime } from \"./web\";\n\nexport type RuntimeTarget = \"headless\" | \"standalone\" | \"web\";\n\nexport interface Runtime {\n    readonly target: RuntimeTarget;\n    readFile(path: string): Promise<string>;\n    readBinary(path: string): Promise<ArrayBuffer>;\n    requestFrame(callback: () => void): void;\n    now(): number;\n}\n\nlet _runtime: Runtime | undefined;\n\nasync function createRuntime(): Promise<Runtime> {\n    const target = detectTarget();\n\n    switch (target) {\n        case \"headless\": {\n            const { createHeadlessRuntime } = await import(\"./headless\");\n            return createHeadlessRuntime();\n        }\n        case \"standalone\": {\n            return createStandaloneRuntime();\n        }\n        case \"web\": {\n            return createWebRuntime();\n        }\n    }\n}\n\nlet _initPromise: Promise<Runtime> | undefined;\n\nexport function getRuntime(): Runtime {\n    if (_runtime) return _runtime;\n\n    if (!_initPromise) {\n        _initPromise = createRuntime().then((r) => {\n            _runtime = r;\n            return r;\n        });\n    }\n\n    throw new Error(\"Runtime not initialized. Call initRuntime() first.\");\n}\n\nexport async function initRuntime(): Promise<Runtime> {\n    if (_runtime) return _runtime;\n\n    if (!_initPromise) {\n        _initPromise = createRuntime();\n    }\n\n    _runtime = await _initPromise;\n    return _runtime;\n}\n\nexport function resetRuntime(): void {\n    _runtime = undefined;\n    _initPromise = undefined;\n}\n","export function toKebabCase(str: string): string {\n    return str\n        .replace(/([a-z])([A-Z])/g, \"$1-$2\")\n        .replace(/[\\s_]+/g, \"-\")\n        .toLowerCase();\n}\n\nexport function toCamelCase(str: string): string {\n    return str.replace(/-([a-z])/g, (_, letter) => letter.toUpperCase());\n}\n\nfunction levenshtein(a: string, b: string): number {\n    if (a.length === 0) return b.length;\n    if (b.length === 0) return a.length;\n\n    const matrix: number[][] = [];\n    for (let i = 0; i <= b.length; i++) {\n        matrix[i] = [i];\n    }\n    for (let j = 0; j <= a.length; j++) {\n        matrix[0][j] = j;\n    }\n\n    for (let i = 1; i <= b.length; i++) {\n        for (let j = 1; j <= a.length; j++) {\n            const cost = a[j - 1] === b[i - 1] ? 0 : 1;\n            matrix[i][j] = Math.min(\n                matrix[i - 1][j] + 1,\n                matrix[i][j - 1] + 1,\n                matrix[i - 1][j - 1] + cost\n            );\n        }\n    }\n\n    return matrix[b.length][a.length];\n}\n\nexport function findClosestMatch(input: string, candidates: string[]): string | null {\n    const inputKebab = toKebabCase(input);\n\n    let bestMatch: string | null = null;\n    let bestScore = Infinity;\n\n    for (const candidate of candidates) {\n        const candidateKebab = toKebabCase(candidate);\n\n        if (inputKebab === candidateKebab) {\n            return candidate;\n        }\n\n        if (inputKebab.endsWith(candidateKebab) || inputKebab.endsWith(\"-\" + candidateKebab)) {\n            return candidate;\n        }\n\n        const distance = levenshtein(inputKebab, candidateKebab);\n        const maxLen = Math.max(inputKebab.length, candidateKebab.length);\n        const threshold = Math.ceil(maxLen * 0.5);\n\n        if (distance < bestScore && distance <= threshold) {\n            bestScore = distance;\n            bestMatch = candidate;\n        }\n    }\n\n    return bestMatch;\n}\n","import { toKebabCase } from \"./ecs/naming\";\nimport type { State } from \"./state\";\n\nexport type ComponentArray = number[] | Float32Array | Uint32Array;\nexport type ComponentData = Record<string, ComponentArray>;\n\nexport interface ParseContext {\n    readonly currentEid: number;\n    getEntityByName(name: string): number | null;\n    setName(name: string, eid: number): void;\n}\n\nexport interface FieldAccessor {\n    get(eid: number): number;\n    set(eid: number, value: number): void;\n}\n\nexport interface ComponentTraits {\n    defaults?: () => Record<string, number>;\n    adapter?: (\n        attrs: Record<string, string>,\n        state: State,\n        context: ParseContext\n    ) => Record<string, number>;\n    accessors?: Record<string, FieldAccessor>;\n}\n\nconst traitsMap = new WeakMap<ComponentData, ComponentTraits>();\n\nexport function setTraits(component: ComponentData, traits: ComponentTraits): void {\n    traitsMap.set(component, traits);\n}\n\nexport function getTraits(component: ComponentData): ComponentTraits | undefined {\n    return traitsMap.get(component);\n}\n\nexport interface RegisteredComponent {\n    readonly component: ComponentData;\n    readonly name: string;\n    readonly traits?: ComponentTraits;\n}\n\nconst registry = new Map<string, RegisteredComponent>();\n\nexport function registerComponent(name: string, component: ComponentData): void {\n    const kebabName = toKebabCase(name);\n    const traits = traitsMap.get(component);\n    registry.set(kebabName, { component, name: kebabName, traits });\n}\n\nexport function getRegisteredComponent(name: string): RegisteredComponent | undefined {\n    return registry.get(toKebabCase(name));\n}\n\nexport function clearRegistry(): void {\n    registry.clear();\n}\n\nexport function directAccessor(\n    data: ComponentArray,\n    stride: number,\n    offset: number\n): FieldAccessor {\n    return {\n        get: (eid) => data[eid * stride + offset],\n        set: (eid, v) => {\n            data[eid * stride + offset] = v;\n        },\n    };\n}\n","export const MAX_ENTITIES = 65536;\n","export interface ResourceContainer {\n    getResource<T>(key: ResourceKey<T>): T | undefined;\n}\n\nexport type ResourceKey<T> = symbol & {\n    __type?: T;\n    from(state: ResourceContainer): T | undefined;\n};\n\nexport function resource<T>(name: string): ResourceKey<T> {\n    const key = Symbol(name) as symbol;\n    const resourceKey = Object.assign(key, {\n        from(state: ResourceContainer): T | undefined {\n            return state.getResource(resourceKey);\n        },\n    });\n    return resourceKey as ResourceKey<T>;\n}\n","import {\n    addComponent,\n    addEntity,\n    createWorld,\n    entityExists,\n    getAllEntities,\n    getComponent,\n    getEntityComponents,\n    getRelationTargets,\n    hasComponent,\n    query,\n    removeComponent,\n    removeComponents,\n    removeEntity,\n    type ComponentRef,\n    type World,\n} from \"bitecs\";\nimport { Scheduler, Time, type System } from \"./scheduler\";\nimport type { RelationDef } from \"./relation\";\nimport type { Plugin } from \"./plugin\";\nimport { initRuntime, type Runtime } from \"./runtime\";\nimport type { Loading } from \"./loading\";\nimport { toposort } from \"./ecs/toposort\";\nimport {\n    registerComponent,\n    getTraits,\n    getRegisteredComponent,\n    directAccessor,\n    type ComponentData,\n    type FieldAccessor,\n} from \"./component\";\nimport { toCamelCase } from \"./ecs/naming\";\nimport { MAX_ENTITIES } from \"./constants\";\nimport { type ResourceKey } from \"./resource\";\n\nexport interface GameTime {\n    deltaTime: number;\n    fixedDeltaTime: number;\n    elapsed: number;\n}\n\nexport class State {\n    readonly world: World;\n    readonly scheduler = new Scheduler();\n    readonly canvas: HTMLCanvasElement | null;\n    readonly gpu: GPUDevice | null;\n\n    private _resources = new Map<symbol, unknown>();\n    private _disposed = false;\n    private _running = false;\n    private _runtime: Runtime | null = null;\n    private _lastTime = 0;\n    private _time: GameTime = {\n        deltaTime: 0,\n        fixedDeltaTime: Time.FIXED_DT,\n        elapsed: 0,\n    };\n    private _fieldAccessors: Map<number, FieldAccessor> | null = null;\n\n    get time(): Readonly<GameTime> {\n        return this._time;\n    }\n\n    get running(): boolean {\n        return this._running;\n    }\n\n    static new(): StateBuilder {\n        return new StateBuilder();\n    }\n\n    constructor(canvas: HTMLCanvasElement | null = null, gpu: GPUDevice | null = null) {\n        this.world = createWorld();\n        this.canvas = canvas;\n        this.gpu = gpu;\n    }\n\n    setResource<T>(key: ResourceKey<T>, value: T): void {\n        this._resources.set(key, value);\n    }\n\n    getResource<T>(key: ResourceKey<T>): T | undefined {\n        return this._resources.get(key) as T | undefined;\n    }\n\n    deleteResource<T>(key: ResourceKey<T>): boolean {\n        return this._resources.delete(key);\n    }\n\n    async start(runtime?: Runtime): Promise<void> {\n        if (this._running) return;\n        this._runtime = runtime ?? (await initRuntime());\n        this._running = true;\n        this._lastTime = this._runtime.now();\n        this.scheduleFrame();\n    }\n\n    stop(): void {\n        this._running = false;\n    }\n\n    private scheduleFrame(): void {\n        if (!this._running || !this._runtime) return;\n        this._runtime.requestFrame(() => this.tick());\n    }\n\n    private tick(): void {\n        if (!this._running || !this._runtime) return;\n        const now = this._runtime.now();\n        const dt = (now - this._lastTime) / 1000;\n        this._lastTime = now;\n        this.step(dt);\n        this.scheduleFrame();\n    }\n\n    setDeltaTime(delta: number): void {\n        this._time.deltaTime = delta;\n    }\n\n    addElapsed(delta: number): void {\n        this._time.elapsed += delta;\n    }\n\n    register(pluginOrSystem: Plugin | System): void {\n        if (\n            \"update\" in pluginOrSystem ||\n            \"setup\" in pluginOrSystem ||\n            \"dispose\" in pluginOrSystem\n        ) {\n            this.scheduler.register(pluginOrSystem as System);\n        } else {\n            const plugin = pluginOrSystem as Plugin;\n            if (plugin.components) {\n                for (const [name, component] of Object.entries(plugin.components)) {\n                    registerComponent(name, component);\n                }\n            }\n            if (plugin.systems) {\n                for (const system of plugin.systems) {\n                    this.scheduler.register(system);\n                }\n            }\n        }\n    }\n\n    unregister(system: System): void {\n        this.scheduler.unregister(system);\n    }\n\n    step(deltaTime = Time.DEFAULT_DT): void {\n        this.scheduler.step(this, deltaTime);\n    }\n\n    addEntity(): number {\n        const eid = addEntity(this.world);\n        if (eid >= MAX_ENTITIES) {\n            throw new Error(`Entity limit exceeded: ${eid} >= ${MAX_ENTITIES}`);\n        }\n        return eid;\n    }\n\n    removeEntity(eid: number): void {\n        this._fieldAccessors?.delete(eid);\n        removeEntity(this.world, eid);\n    }\n\n    entityExists(eid: number): boolean {\n        return entityExists(this.world, eid);\n    }\n\n    getAllEntities(): readonly number[] {\n        return getAllEntities(this.world);\n    }\n\n    query(terms: ComponentRef[]): Iterable<number> {\n        return query(this.world, terms);\n    }\n\n    getEntityComponents(eid: number): ComponentRef[] {\n        return getEntityComponents(this.world, eid);\n    }\n\n    addComponent<T extends ComponentRef>(eid: number, component: T): void {\n        addComponent(this.world, eid, component);\n\n        const traits = getTraits(component as ComponentData);\n        if (traits?.defaults) {\n            const defaults = traits.defaults();\n            const comp = component as ComponentData;\n            for (const [field, value] of Object.entries(defaults)) {\n                const arr = comp[field];\n                if (arr != null) {\n                    arr[eid] = value;\n                }\n            }\n        }\n    }\n\n    addComponents(eid: number, ...components: ComponentRef[]): void {\n        for (const component of components) {\n            this.addComponent(eid, component);\n        }\n    }\n\n    removeComponent(eid: number, ...components: ComponentRef[]): void {\n        removeComponent(this.world, eid, ...components);\n    }\n\n    removeComponents(eid: number, ...components: ComponentRef[]): void {\n        removeComponents(this.world, eid, ...components);\n    }\n\n    hasComponent<T extends ComponentRef>(eid: number, component: T): boolean {\n        return hasComponent(this.world, eid, component);\n    }\n\n    getComponent<T extends ComponentRef>(eid: number, component: T) {\n        return getComponent(this.world, eid, component);\n    }\n\n    setComponent<T extends ComponentRef>(\n        eid: number,\n        component: T,\n        data: Record<string, number>\n    ): void {\n        this.addComponent(eid, component);\n        const comp = component as Record<string, number[]>;\n        for (const [field, value] of Object.entries(data)) {\n            const arr = comp[field];\n            if (arr != null) {\n                arr[eid] = value;\n            }\n        }\n    }\n\n    addRelation(subject: number, relation: RelationDef, target: number): void {\n        addComponent(this.world, subject, relation.relation(target));\n    }\n\n    hasRelation(subject: number, relation: RelationDef, target: number): boolean {\n        return hasComponent(this.world, subject, relation.relation(target));\n    }\n\n    getRelationTargets(subject: number, relation: RelationDef): number[] {\n        return getRelationTargets(this.world, subject, relation.relation);\n    }\n\n    private ensureFieldAccessors(): Map<number, FieldAccessor> {\n        if (!this._fieldAccessors) {\n            this._fieldAccessors = new Map();\n        }\n        return this._fieldAccessors;\n    }\n\n    resolveFieldPath(path: string): { component: string; field: string } | null {\n        const dotIndex = path.lastIndexOf(\".\");\n        if (dotIndex === -1) return null;\n        return {\n            component: path.slice(0, dotIndex),\n            field: path.slice(dotIndex + 1),\n        };\n    }\n\n    bindFieldAccessor(\n        bindingId: number,\n        componentName: string,\n        fieldPath: string\n    ): FieldAccessor | null {\n        const registered = getRegisteredComponent(componentName);\n        if (!registered) return null;\n\n        const camelPath = toCamelCase(fieldPath);\n\n        const traits = getTraits(registered.component);\n        if (traits?.accessors?.[camelPath]) {\n            const accessor = traits.accessors[camelPath];\n            this.ensureFieldAccessors().set(bindingId, accessor);\n            return accessor;\n        }\n\n        const array = registered.component[camelPath];\n        if (array == null) return null;\n\n        const accessor = directAccessor(array, 1, 0);\n        this.ensureFieldAccessors().set(bindingId, accessor);\n        return accessor;\n    }\n\n    getFieldAccessor(bindingId: number): FieldAccessor | undefined {\n        return this._fieldAccessors?.get(bindingId);\n    }\n\n    removeFieldAccessor(bindingId: number): boolean {\n        return this._fieldAccessors?.delete(bindingId) ?? false;\n    }\n\n    dispose(): void {\n        if (this._disposed) return;\n        this.stop();\n        this._fieldAccessors = null;\n        for (const system of this.scheduler.systems) {\n            system.dispose?.(this);\n        }\n        this._disposed = true;\n    }\n}\n\nexport class StateBuilder {\n    static defaultPlugins: readonly Plugin[] = [];\n    static loading: ((canvas: HTMLCanvasElement) => Loading) | null = null;\n\n    private readonly _plugins: Plugin[] = [];\n    private readonly _systems: System[] = [];\n    private readonly _scenes: string[] = [];\n    private readonly _excludedPlugins = new Set<Plugin>();\n    private _useDefaultPlugins = true;\n    private _canvas: HTMLCanvasElement | null = null;\n    private _gpu: GPUDevice | null = null;\n    private _loading: Loading | null | undefined = undefined;\n\n    withCanvas(canvas: HTMLCanvasElement): this {\n        this._canvas = canvas;\n        return this;\n    }\n\n    withGPU(device: GPUDevice): this {\n        this._gpu = device;\n        return this;\n    }\n\n    withPlugins(...plugins: Plugin[]): this {\n        this._plugins.push(...plugins);\n        return this;\n    }\n\n    withoutPlugin(plugin: Plugin): this {\n        this._excludedPlugins.add(plugin);\n        return this;\n    }\n\n    withoutPlugins(...plugins: Plugin[]): this {\n        for (const p of plugins) this._excludedPlugins.add(p);\n        return this;\n    }\n\n    withoutDefaultPlugins(): this {\n        this._useDefaultPlugins = false;\n        return this;\n    }\n\n    withSystems(...systems: System[]): this {\n        this._systems.push(...systems);\n        return this;\n    }\n\n    withScene(path: string): this {\n        this._scenes.push(path);\n        return this;\n    }\n\n    withLoading(loading: Loading | null): this {\n        this._loading = loading;\n        return this;\n    }\n\n    async build(): Promise<State> {\n        const loading =\n            this._loading === undefined && this._canvas\n                ? (StateBuilder.loading?.(this._canvas) ?? null)\n                : this._loading;\n\n        const cleanup = loading?.show();\n\n        const state = new State(this._canvas, this._gpu);\n\n        const pluginSet = new Set<Plugin>();\n\n        if (this._useDefaultPlugins) {\n            for (const plugin of StateBuilder.defaultPlugins) {\n                if (!this._excludedPlugins.has(plugin)) {\n                    pluginSet.add(plugin);\n                }\n            }\n        }\n\n        for (const plugin of this._plugins) {\n            pluginSet.add(plugin);\n        }\n\n        const allPlugins = [...pluginSet];\n\n        for (const plugin of allPlugins) {\n            state.register(plugin);\n        }\n\n        const edges: [Plugin, Plugin][] = [];\n        for (const plugin of allPlugins) {\n            for (const dep of plugin.dependencies ?? []) {\n                if (allPlugins.includes(dep)) {\n                    edges.push([dep, plugin]);\n                }\n            }\n        }\n        const sorted = toposort(allPlugins, edges);\n\n        let completed = 0;\n        const total = sorted.length;\n\n        for (const plugin of sorted) {\n            await plugin.initialize?.(state);\n            completed++;\n            loading?.update(completed / total);\n        }\n\n        for (const system of this._systems) {\n            state.scheduler.register(system);\n        }\n\n        for (const scenePath of this._scenes) {\n            const { loadSceneFile } = await import(\"./xml/loader\");\n            const result = await loadSceneFile(state, scenePath);\n            if (result.errors.length > 0) {\n                console.warn(`Scene \"${scenePath}\" loaded with errors:`, result.errors);\n            }\n        }\n\n        cleanup?.();\n\n        return state;\n    }\n\n    async run(): Promise<State> {\n        const state = await this.build();\n        await state.start();\n        return state;\n    }\n}\n","export async function requestGPU(): Promise<GPUDevice> {\n    if (!navigator.gpu) {\n        throw new Error(\"WebGPU not supported\");\n    }\n\n    const adapter = await navigator.gpu.requestAdapter();\n    if (!adapter) {\n        throw new Error(\"No GPU adapter found\");\n    }\n\n    return adapter.requestDevice();\n}\n","import { createRelation as bitecsCreateRelation, type Relation } from \"bitecs\";\nimport { toKebabCase } from \"./ecs/naming\";\n\nexport interface RelationOptions {\n    readonly exclusive?: boolean;\n    readonly autoRemoveSubject?: boolean;\n}\n\nexport interface RelationDef {\n    readonly name: string;\n    readonly relation: Relation<unknown>;\n    readonly exclusive?: boolean;\n    readonly autoRemoveSubject?: boolean;\n}\n\nconst registry = new Map<string, RelationDef>();\n\nexport function defineRelation(name: string, options?: RelationOptions): RelationDef {\n    const relation = bitecsCreateRelation({\n        exclusive: options?.exclusive,\n        autoRemoveSubject: options?.autoRemoveSubject,\n    });\n\n    const def: RelationDef = {\n        name: toKebabCase(name),\n        relation,\n        exclusive: options?.exclusive,\n        autoRemoveSubject: options?.autoRemoveSubject,\n    };\n\n    registry.set(def.name, def);\n    return def;\n}\n\nexport function getRelationDef(name: string): RelationDef | undefined {\n    return registry.get(toKebabCase(name));\n}\n\nexport function clearRelationDefs(): void {\n    registry.clear();\n}\n","/* wgpu-matrix@3.4.0, license MIT */\nfunction wrapConstructor(OriginalConstructor, modifier) {\n    return class extends OriginalConstructor {\n        constructor(...args) {\n            super(...args);\n            modifier(this);\n        }\n    }; // Type assertion is necessary here\n}\nconst ZeroArray = wrapConstructor((Array), a => a.fill(0));\n\n/*\n * Copyright 2022 Gregg Tavares\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL\n * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nlet EPSILON = 0.000001;\n/**\n * Set the value for EPSILON for various checks\n * @param v - Value to use for EPSILON.\n * @returns previous value of EPSILON;\n */\nfunction setEpsilon(v) {\n    const old = EPSILON;\n    EPSILON = v;\n    return old;\n}\n/**\n * Convert degrees to radians\n * @param degrees - Angle in degrees\n * @returns angle converted to radians\n */\nfunction degToRad(degrees) {\n    return degrees * Math.PI / 180;\n}\n/**\n * Convert radians to degrees\n * @param radians - Angle in radians\n * @returns angle converted to degrees\n */\nfunction radToDeg(radians) {\n    return radians * 180 / Math.PI;\n}\n/**\n * Lerps between a and b via t\n * @param a - starting value\n * @param b - ending value\n * @param t - value where 0 = a and 1 = b\n * @returns a + (b - a) * t\n */\nfunction lerp(a, b, t) {\n    return a + (b - a) * t;\n}\n/**\n * Compute the opposite of lerp. Given a and b and a value between\n * a and b returns a value between 0 and 1. 0 if a, 1 if b.\n * Note: no clamping is done.\n * @param a - start value\n * @param b - end value\n * @param v - value between a and b\n * @returns (v - a) / (b - a)\n */\nfunction inverseLerp(a, b, v) {\n    const d = b - a;\n    return (Math.abs(b - a) < EPSILON)\n        ? a\n        : (v - a) / d;\n}\n/**\n * Compute the euclidean modulo\n *\n * ```\n * // table for n / 3\n * -5, -4, -3, -2, -1,  0,  1,  2,  3,  4,  5   <- n\n * ------------------------------------\n * -2  -1  -0  -2  -1   0,  1,  2,  0,  1,  2   <- n % 3\n *  1   2   0   1   2   0,  1,  2,  0,  1,  2   <- euclideanModule(n, 3)\n * ```\n *\n * @param n - dividend\n * @param m - divisor\n * @returns the euclidean modulo of n / m\n */\nfunction euclideanModulo(n, m) {\n    return ((n % m) + m) % m;\n}\n\nvar utils = {\n    __proto__: null,\n    get EPSILON () { return EPSILON; },\n    degToRad: degToRad,\n    euclideanModulo: euclideanModulo,\n    inverseLerp: inverseLerp,\n    lerp: lerp,\n    radToDeg: radToDeg,\n    setEpsilon: setEpsilon\n};\n\n/*\n * Copyright 2022 Gregg Tavares\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL\n * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n * Generates am typed API for Vec3\n */\nfunction getAPIImpl$5(Ctor) {\n    /**\n     * Creates a Vec2; may be called with x, y, z to set initial values.\n     *\n     * Note: Since passing in a raw JavaScript array\n     * is valid in all circumstances, if you want to\n     * force a JavaScript array into a Vec2's specified type\n     * it would be faster to use\n     *\n     * ```\n     * const v = vec2.clone(someJSArray);\n     * ```\n     *\n     * @param x - Initial x value.\n     * @param y - Initial y value.\n     * @returns the created vector\n     */\n    function create(x = 0, y = 0) {\n        const newDst = new Ctor(2);\n        if (x !== undefined) {\n            newDst[0] = x;\n            if (y !== undefined) {\n                newDst[1] = y;\n            }\n        }\n        return newDst;\n    }\n    /**\n     * Creates a Vec2; may be called with x, y, z to set initial values. (same as create)\n     * @param x - Initial x value.\n     * @param y - Initial y value.\n     * @returns the created vector\n     */\n    const fromValues = create;\n    /**\n     * Sets the values of a Vec2\n     * Also see {@link vec2.create} and {@link vec2.copy}\n     *\n     * @param x first value\n     * @param y second value\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector with its elements set.\n     */\n    function set(x, y, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = x;\n        newDst[1] = y;\n        return newDst;\n    }\n    /**\n     * Applies Math.ceil to each element of vector\n     * @param v - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the ceil of each element of v.\n     */\n    function ceil(v, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = Math.ceil(v[0]);\n        newDst[1] = Math.ceil(v[1]);\n        return newDst;\n    }\n    /**\n     * Applies Math.floor to each element of vector\n     * @param v - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the floor of each element of v.\n     */\n    function floor(v, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = Math.floor(v[0]);\n        newDst[1] = Math.floor(v[1]);\n        return newDst;\n    }\n    /**\n     * Applies Math.round to each element of vector\n     * @param v - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the round of each element of v.\n     */\n    function round(v, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = Math.round(v[0]);\n        newDst[1] = Math.round(v[1]);\n        return newDst;\n    }\n    /**\n     * Clamp each element of vector between min and max\n     * @param v - Operand vector.\n     * @param max - Min value, default 0\n     * @param min - Max value, default 1\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that the clamped value of each element of v.\n     */\n    function clamp(v, min = 0, max = 1, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = Math.min(max, Math.max(min, v[0]));\n        newDst[1] = Math.min(max, Math.max(min, v[1]));\n        return newDst;\n    }\n    /**\n     * Adds two vectors; assumes a and b have the same dimension.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the sum of a and b.\n     */\n    function add(a, b, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = a[0] + b[0];\n        newDst[1] = a[1] + b[1];\n        return newDst;\n    }\n    /**\n     * Adds two vectors, scaling the 2nd; assumes a and b have the same dimension.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param scale - Amount to scale b\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the sum of a + b * scale.\n     */\n    function addScaled(a, b, scale, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = a[0] + b[0] * scale;\n        newDst[1] = a[1] + b[1] * scale;\n        return newDst;\n    }\n    /**\n     * Returns the angle in radians between two vectors.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @returns The angle in radians between the 2 vectors.\n     */\n    function angle(a, b) {\n        const ax = a[0];\n        const ay = a[1];\n        const bx = b[0];\n        const by = b[1];\n        const mag1 = Math.sqrt(ax * ax + ay * ay);\n        const mag2 = Math.sqrt(bx * bx + by * by);\n        const mag = mag1 * mag2;\n        const cosine = mag && dot(a, b) / mag;\n        return Math.acos(cosine);\n    }\n    /**\n     * Subtracts two vectors.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the difference of a and b.\n     */\n    function subtract(a, b, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = a[0] - b[0];\n        newDst[1] = a[1] - b[1];\n        return newDst;\n    }\n    /**\n     * Subtracts two vectors.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the difference of a and b.\n     */\n    const sub = subtract;\n    /**\n     * Check if 2 vectors are approximately equal\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @returns true if vectors are approximately equal\n     */\n    function equalsApproximately(a, b) {\n        return Math.abs(a[0] - b[0]) < EPSILON &&\n            Math.abs(a[1] - b[1]) < EPSILON;\n    }\n    /**\n     * Check if 2 vectors are exactly equal\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @returns true if vectors are exactly equal\n     */\n    function equals(a, b) {\n        return a[0] === b[0] && a[1] === b[1];\n    }\n    /**\n     * Performs linear interpolation on two vectors.\n     * Given vectors a and b and interpolation coefficient t, returns\n     * a + t * (b - a).\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param t - Interpolation coefficient.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The linear interpolated result.\n     */\n    function lerp(a, b, t, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = a[0] + t * (b[0] - a[0]);\n        newDst[1] = a[1] + t * (b[1] - a[1]);\n        return newDst;\n    }\n    /**\n     * Performs linear interpolation on two vectors.\n     * Given vectors a and b and interpolation coefficient vector t, returns\n     * a + t * (b - a).\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param t - Interpolation coefficients vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns the linear interpolated result.\n     */\n    function lerpV(a, b, t, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = a[0] + t[0] * (b[0] - a[0]);\n        newDst[1] = a[1] + t[1] * (b[1] - a[1]);\n        return newDst;\n    }\n    /**\n     * Return max values of two vectors.\n     * Given vectors a and b returns\n     * [max(a[0], b[0]), max(a[1], b[1]), max(a[2], b[2])].\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The max components vector.\n     */\n    function max(a, b, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = Math.max(a[0], b[0]);\n        newDst[1] = Math.max(a[1], b[1]);\n        return newDst;\n    }\n    /**\n     * Return min values of two vectors.\n     * Given vectors a and b returns\n     * [min(a[0], b[0]), min(a[1], b[1]), min(a[2], b[2])].\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The min components vector.\n     */\n    function min(a, b, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = Math.min(a[0], b[0]);\n        newDst[1] = Math.min(a[1], b[1]);\n        return newDst;\n    }\n    /**\n     * Multiplies a vector by a scalar.\n     * @param v - The vector.\n     * @param k - The scalar.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The scaled vector.\n     */\n    function mulScalar(v, k, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = v[0] * k;\n        newDst[1] = v[1] * k;\n        return newDst;\n    }\n    /**\n     * Multiplies a vector by a scalar. (same as mulScalar)\n     * @param v - The vector.\n     * @param k - The scalar.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The scaled vector.\n     */\n    const scale = mulScalar;\n    /**\n     * Divides a vector by a scalar.\n     * @param v - The vector.\n     * @param k - The scalar.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The scaled vector.\n     */\n    function divScalar(v, k, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = v[0] / k;\n        newDst[1] = v[1] / k;\n        return newDst;\n    }\n    /**\n     * Inverse a vector.\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The inverted vector.\n     */\n    function inverse(v, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = 1 / v[0];\n        newDst[1] = 1 / v[1];\n        return newDst;\n    }\n    /**\n     * Invert a vector. (same as inverse)\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The inverted vector.\n     */\n    const invert = inverse;\n    /**\n     * Computes the cross product of two vectors; assumes both vectors have\n     * three entries.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of a cross b.\n     */\n    function cross(a, b, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const z = a[0] * b[1] - a[1] * b[0];\n        newDst[0] = 0;\n        newDst[1] = 0;\n        newDst[2] = z;\n        return newDst;\n    }\n    /**\n     * Computes the dot product of two vectors; assumes both vectors have\n     * three entries.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @returns dot product\n     */\n    function dot(a, b) {\n        return a[0] * b[0] + a[1] * b[1];\n    }\n    /**\n     * Computes the length of vector\n     * @param v - vector.\n     * @returns length of vector.\n     */\n    function length(v) {\n        const v0 = v[0];\n        const v1 = v[1];\n        return Math.sqrt(v0 * v0 + v1 * v1);\n    }\n    /**\n     * Computes the length of vector (same as length)\n     * @param v - vector.\n     * @returns length of vector.\n     */\n    const len = length;\n    /**\n     * Computes the square of the length of vector\n     * @param v - vector.\n     * @returns square of the length of vector.\n     */\n    function lengthSq(v) {\n        const v0 = v[0];\n        const v1 = v[1];\n        return v0 * v0 + v1 * v1;\n    }\n    /**\n     * Computes the square of the length of vector (same as lengthSq)\n     * @param v - vector.\n     * @returns square of the length of vector.\n     */\n    const lenSq = lengthSq;\n    /**\n     * Computes the distance between 2 points\n     * @param a - vector.\n     * @param b - vector.\n     * @returns distance between a and b\n     */\n    function distance(a, b) {\n        const dx = a[0] - b[0];\n        const dy = a[1] - b[1];\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n    /**\n     * Computes the distance between 2 points (same as distance)\n     * @param a - vector.\n     * @param b - vector.\n     * @returns distance between a and b\n     */\n    const dist = distance;\n    /**\n     * Computes the square of the distance between 2 points\n     * @param a - vector.\n     * @param b - vector.\n     * @returns square of the distance between a and b\n     */\n    function distanceSq(a, b) {\n        const dx = a[0] - b[0];\n        const dy = a[1] - b[1];\n        return dx * dx + dy * dy;\n    }\n    /**\n     * Computes the square of the distance between 2 points (same as distanceSq)\n     * @param a - vector.\n     * @param b - vector.\n     * @returns square of the distance between a and b\n     */\n    const distSq = distanceSq;\n    /**\n     * Divides a vector by its Euclidean length and returns the quotient.\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The normalized vector.\n     */\n    function normalize(v, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        const v0 = v[0];\n        const v1 = v[1];\n        const len = Math.sqrt(v0 * v0 + v1 * v1);\n        if (len > 0.00001) {\n            newDst[0] = v0 / len;\n            newDst[1] = v1 / len;\n        }\n        else {\n            newDst[0] = 0;\n            newDst[1] = 0;\n        }\n        return newDst;\n    }\n    /**\n     * Negates a vector.\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns -v.\n     */\n    function negate(v, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = -v[0];\n        newDst[1] = -v[1];\n        return newDst;\n    }\n    /**\n     * Copies a vector. (same as {@link vec2.clone})\n     * Also see {@link vec2.create} and {@link vec2.set}\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A copy of v.\n     */\n    function copy(v, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = v[0];\n        newDst[1] = v[1];\n        return newDst;\n    }\n    /**\n     * Clones a vector. (same as {@link vec2.copy})\n     * Also see {@link vec2.create} and {@link vec2.set}\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A copy of v.\n     */\n    const clone = copy;\n    /**\n     * Multiplies a vector by another vector (component-wise); assumes a and\n     * b have the same length.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of products of entries of a and b.\n     */\n    function multiply(a, b, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = a[0] * b[0];\n        newDst[1] = a[1] * b[1];\n        return newDst;\n    }\n    /**\n     * Multiplies a vector by another vector (component-wise); assumes a and\n     * b have the same length. (same as mul)\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of products of entries of a and b.\n     */\n    const mul = multiply;\n    /**\n     * Divides a vector by another vector (component-wise); assumes a and\n     * b have the same length.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of quotients of entries of a and b.\n     */\n    function divide(a, b, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = a[0] / b[0];\n        newDst[1] = a[1] / b[1];\n        return newDst;\n    }\n    /**\n     * Divides a vector by another vector (component-wise); assumes a and\n     * b have the same length. (same as divide)\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of quotients of entries of a and b.\n     */\n    const div = divide;\n    /**\n     * Creates a random unit vector * scale\n     * @param scale - Default 1\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The random vector.\n     */\n    function random(scale = 1, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        const angle = Math.random() * 2 * Math.PI;\n        newDst[0] = Math.cos(angle) * scale;\n        newDst[1] = Math.sin(angle) * scale;\n        return newDst;\n    }\n    /**\n     * Zero's a vector\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The zeroed vector.\n     */\n    function zero(dst) {\n        const newDst = (dst ?? new Ctor(2));\n        newDst[0] = 0;\n        newDst[1] = 0;\n        return newDst;\n    }\n    /**\n     * Transform Vec2 by 4x4 matrix\n     * @param v - the vector\n     * @param m - The matrix.\n     * @param dst - optional Vec2 to store result. If not passed a new one is created.\n     * @returns the transformed vector\n     */\n    function transformMat4(v, m, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        const x = v[0];\n        const y = v[1];\n        newDst[0] = x * m[0] + y * m[4] + m[12];\n        newDst[1] = x * m[1] + y * m[5] + m[13];\n        return newDst;\n    }\n    /**\n     * Transform Vec2 by 3x3 matrix\n     *\n     * @param v - the vector\n     * @param m - The matrix.\n     * @param dst - optional Vec2 to store result. If not passed a new one is created.\n     * @returns the transformed vector\n     */\n    function transformMat3(v, m, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        const x = v[0];\n        const y = v[1];\n        newDst[0] = m[0] * x + m[4] * y + m[8];\n        newDst[1] = m[1] * x + m[5] * y + m[9];\n        return newDst;\n    }\n    /**\n     * Rotate a 2D vector\n     *\n     * @param a The vec2 point to rotate\n     * @param b The origin of the rotation\n     * @param rad The angle of rotation in radians\n     * @returns the rotated vector\n     */\n    function rotate(a, b, rad, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        // Translate point to the origin\n        const p0 = a[0] - b[0];\n        const p1 = a[1] - b[1];\n        const sinC = Math.sin(rad);\n        const cosC = Math.cos(rad);\n        //perform rotation and translate to correct position\n        newDst[0] = p0 * cosC - p1 * sinC + b[0];\n        newDst[1] = p0 * sinC + p1 * cosC + b[1];\n        return newDst;\n    }\n    /**\n     * Treat a 2D vector as a direction and set it's length\n     *\n     * @param a The vec2 to lengthen\n     * @param len The length of the resulting vector\n     * @returns The lengthened vector\n     */\n    function setLength(a, len, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        normalize(a, newDst);\n        return mulScalar(newDst, len, newDst);\n    }\n    /**\n     * Ensure a vector is not longer than a max length\n     *\n     * @param a The vec2 to limit\n     * @param maxLen The longest length of the resulting vector\n     * @returns The vector, shortened to maxLen if it's too long\n     */\n    function truncate(a, maxLen, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        if (length(a) > maxLen) {\n            return setLength(a, maxLen, newDst);\n        }\n        return copy(a, newDst);\n    }\n    /**\n     * Return the vector exactly between 2 endpoint vectors\n     *\n     * @param a Endpoint 1\n     * @param b Endpoint 2\n     * @returns The vector exactly residing between endpoints 1 and 2\n     */\n    function midpoint(a, b, dst) {\n        const newDst = (dst ?? new Ctor(2));\n        return lerp(a, b, 0.5, newDst);\n    }\n    return {\n        create,\n        fromValues,\n        set,\n        ceil,\n        floor,\n        round,\n        clamp,\n        add,\n        addScaled,\n        angle,\n        subtract,\n        sub,\n        equalsApproximately,\n        equals,\n        lerp,\n        lerpV,\n        max,\n        min,\n        mulScalar,\n        scale,\n        divScalar,\n        inverse,\n        invert,\n        cross,\n        dot,\n        length,\n        len,\n        lengthSq,\n        lenSq,\n        distance,\n        dist,\n        distanceSq,\n        distSq,\n        normalize,\n        negate,\n        copy,\n        clone,\n        multiply,\n        mul,\n        divide,\n        div,\n        random,\n        zero,\n        transformMat4,\n        transformMat3,\n        rotate,\n        setLength,\n        truncate,\n        midpoint,\n    };\n}\nconst cache$5 = new Map();\nfunction getAPI$5(Ctor) {\n    let api = cache$5.get(Ctor);\n    if (!api) {\n        api = getAPIImpl$5(Ctor);\n        cache$5.set(Ctor, api);\n    }\n    return api;\n}\n\n/*\n * Copyright 2022 Gregg Tavares\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL\n * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n * Generates am typed API for Vec3\n * */\nfunction getAPIImpl$4(Ctor) {\n    /**\n     * Creates a vec3; may be called with x, y, z to set initial values.\n     * @param x - Initial x value.\n     * @param y - Initial y value.\n     * @param z - Initial z value.\n     * @returns the created vector\n     */\n    function create(x, y, z) {\n        const newDst = new Ctor(3);\n        if (x !== undefined) {\n            newDst[0] = x;\n            if (y !== undefined) {\n                newDst[1] = y;\n                if (z !== undefined) {\n                    newDst[2] = z;\n                }\n            }\n        }\n        return newDst;\n    }\n    /**\n     * Creates a vec3; may be called with x, y, z to set initial values. (same as create)\n     * @param x - Initial x value.\n     * @param y - Initial y value.\n     * @param z - Initial z value.\n     * @returns the created vector\n     */\n    const fromValues = create;\n    /**\n     * Sets the values of a Vec3\n     * Also see {@link vec3.create} and {@link vec3.copy}\n     *\n     * @param x first value\n     * @param y second value\n     * @param z third value\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector with its elements set.\n     */\n    function set(x, y, z, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = x;\n        newDst[1] = y;\n        newDst[2] = z;\n        return newDst;\n    }\n    /**\n     * Applies Math.ceil to each element of vector\n     * @param v - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the ceil of each element of v.\n     */\n    function ceil(v, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = Math.ceil(v[0]);\n        newDst[1] = Math.ceil(v[1]);\n        newDst[2] = Math.ceil(v[2]);\n        return newDst;\n    }\n    /**\n     * Applies Math.floor to each element of vector\n     * @param v - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the floor of each element of v.\n     */\n    function floor(v, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = Math.floor(v[0]);\n        newDst[1] = Math.floor(v[1]);\n        newDst[2] = Math.floor(v[2]);\n        return newDst;\n    }\n    /**\n     * Applies Math.round to each element of vector\n     * @param v - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the round of each element of v.\n     */\n    function round(v, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = Math.round(v[0]);\n        newDst[1] = Math.round(v[1]);\n        newDst[2] = Math.round(v[2]);\n        return newDst;\n    }\n    /**\n     * Clamp each element of vector between min and max\n     * @param v - Operand vector.\n     * @param max - Min value, default 0\n     * @param min - Max value, default 1\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that the clamped value of each element of v.\n     */\n    function clamp(v, min = 0, max = 1, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = Math.min(max, Math.max(min, v[0]));\n        newDst[1] = Math.min(max, Math.max(min, v[1]));\n        newDst[2] = Math.min(max, Math.max(min, v[2]));\n        return newDst;\n    }\n    /**\n     * Adds two vectors; assumes a and b have the same dimension.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the sum of a and b.\n     */\n    function add(a, b, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = a[0] + b[0];\n        newDst[1] = a[1] + b[1];\n        newDst[2] = a[2] + b[2];\n        return newDst;\n    }\n    /**\n     * Adds two vectors, scaling the 2nd; assumes a and b have the same dimension.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param scale - Amount to scale b\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the sum of a + b * scale.\n     */\n    function addScaled(a, b, scale, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = a[0] + b[0] * scale;\n        newDst[1] = a[1] + b[1] * scale;\n        newDst[2] = a[2] + b[2] * scale;\n        return newDst;\n    }\n    /**\n     * Returns the angle in radians between two vectors.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @returns The angle in radians between the 2 vectors.\n     */\n    function angle(a, b) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const bx = b[0];\n        const by = b[1];\n        const bz = b[2];\n        const mag1 = Math.sqrt(ax * ax + ay * ay + az * az);\n        const mag2 = Math.sqrt(bx * bx + by * by + bz * bz);\n        const mag = mag1 * mag2;\n        const cosine = mag && dot(a, b) / mag;\n        return Math.acos(cosine);\n    }\n    /**\n     * Subtracts two vectors.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the difference of a and b.\n     */\n    function subtract(a, b, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = a[0] - b[0];\n        newDst[1] = a[1] - b[1];\n        newDst[2] = a[2] - b[2];\n        return newDst;\n    }\n    /**\n     * Subtracts two vectors.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the difference of a and b.\n     */\n    const sub = subtract;\n    /**\n     * Check if 2 vectors are approximately equal\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @returns true if vectors are approximately equal\n     */\n    function equalsApproximately(a, b) {\n        return Math.abs(a[0] - b[0]) < EPSILON &&\n            Math.abs(a[1] - b[1]) < EPSILON &&\n            Math.abs(a[2] - b[2]) < EPSILON;\n    }\n    /**\n     * Check if 2 vectors are exactly equal\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @returns true if vectors are exactly equal\n     */\n    function equals(a, b) {\n        return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n    }\n    /**\n     * Performs linear interpolation on two vectors.\n     * Given vectors a and b and interpolation coefficient t, returns\n     * a + t * (b - a).\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param t - Interpolation coefficient.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The linear interpolated result.\n     */\n    function lerp(a, b, t, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = a[0] + t * (b[0] - a[0]);\n        newDst[1] = a[1] + t * (b[1] - a[1]);\n        newDst[2] = a[2] + t * (b[2] - a[2]);\n        return newDst;\n    }\n    /**\n     * Performs linear interpolation on two vectors.\n     * Given vectors a and b and interpolation coefficient vector t, returns\n     * a + t * (b - a).\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param t - Interpolation coefficients vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns the linear interpolated result.\n     */\n    function lerpV(a, b, t, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = a[0] + t[0] * (b[0] - a[0]);\n        newDst[1] = a[1] + t[1] * (b[1] - a[1]);\n        newDst[2] = a[2] + t[2] * (b[2] - a[2]);\n        return newDst;\n    }\n    /**\n     * Return max values of two vectors.\n     * Given vectors a and b returns\n     * [max(a[0], b[0]), max(a[1], b[1]), max(a[2], b[2])].\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The max components vector.\n     */\n    function max(a, b, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = Math.max(a[0], b[0]);\n        newDst[1] = Math.max(a[1], b[1]);\n        newDst[2] = Math.max(a[2], b[2]);\n        return newDst;\n    }\n    /**\n     * Return min values of two vectors.\n     * Given vectors a and b returns\n     * [min(a[0], b[0]), min(a[1], b[1]), min(a[2], b[2])].\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The min components vector.\n     */\n    function min(a, b, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = Math.min(a[0], b[0]);\n        newDst[1] = Math.min(a[1], b[1]);\n        newDst[2] = Math.min(a[2], b[2]);\n        return newDst;\n    }\n    /**\n     * Multiplies a vector by a scalar.\n     * @param v - The vector.\n     * @param k - The scalar.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The scaled vector.\n     */\n    function mulScalar(v, k, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = v[0] * k;\n        newDst[1] = v[1] * k;\n        newDst[2] = v[2] * k;\n        return newDst;\n    }\n    /**\n     * Multiplies a vector by a scalar. (same as mulScalar)\n     * @param v - The vector.\n     * @param k - The scalar.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The scaled vector.\n     */\n    const scale = mulScalar;\n    /**\n     * Divides a vector by a scalar.\n     * @param v - The vector.\n     * @param k - The scalar.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The scaled vector.\n     */\n    function divScalar(v, k, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = v[0] / k;\n        newDst[1] = v[1] / k;\n        newDst[2] = v[2] / k;\n        return newDst;\n    }\n    /**\n     * Inverse a vector.\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The inverted vector.\n     */\n    function inverse(v, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = 1 / v[0];\n        newDst[1] = 1 / v[1];\n        newDst[2] = 1 / v[2];\n        return newDst;\n    }\n    /**\n     * Invert a vector. (same as inverse)\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The inverted vector.\n     */\n    const invert = inverse;\n    /**\n     * Computes the cross product of two vectors; assumes both vectors have\n     * three entries.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of a cross b.\n     */\n    function cross(a, b, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const t1 = a[2] * b[0] - a[0] * b[2];\n        const t2 = a[0] * b[1] - a[1] * b[0];\n        newDst[0] = a[1] * b[2] - a[2] * b[1];\n        newDst[1] = t1;\n        newDst[2] = t2;\n        return newDst;\n    }\n    /**\n     * Computes the dot product of two vectors; assumes both vectors have\n     * three entries.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @returns dot product\n     */\n    function dot(a, b) {\n        return (a[0] * b[0]) + (a[1] * b[1]) + (a[2] * b[2]);\n    }\n    /**\n     * Computes the length of vector\n     * @param v - vector.\n     * @returns length of vector.\n     */\n    function length(v) {\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        return Math.sqrt(v0 * v0 + v1 * v1 + v2 * v2);\n    }\n    /**\n     * Computes the length of vector (same as length)\n     * @param v - vector.\n     * @returns length of vector.\n     */\n    const len = length;\n    /**\n     * Computes the square of the length of vector\n     * @param v - vector.\n     * @returns square of the length of vector.\n     */\n    function lengthSq(v) {\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        return v0 * v0 + v1 * v1 + v2 * v2;\n    }\n    /**\n     * Computes the square of the length of vector (same as lengthSq)\n     * @param v - vector.\n     * @returns square of the length of vector.\n     */\n    const lenSq = lengthSq;\n    /**\n     * Computes the distance between 2 points\n     * @param a - vector.\n     * @param b - vector.\n     * @returns distance between a and b\n     */\n    function distance(a, b) {\n        const dx = a[0] - b[0];\n        const dy = a[1] - b[1];\n        const dz = a[2] - b[2];\n        return Math.sqrt(dx * dx + dy * dy + dz * dz);\n    }\n    /**\n     * Computes the distance between 2 points (same as distance)\n     * @param a - vector.\n     * @param b - vector.\n     * @returns distance between a and b\n     */\n    const dist = distance;\n    /**\n     * Computes the square of the distance between 2 points\n     * @param a - vector.\n     * @param b - vector.\n     * @returns square of the distance between a and b\n     */\n    function distanceSq(a, b) {\n        const dx = a[0] - b[0];\n        const dy = a[1] - b[1];\n        const dz = a[2] - b[2];\n        return dx * dx + dy * dy + dz * dz;\n    }\n    /**\n     * Computes the square of the distance between 2 points (same as distanceSq)\n     * @param a - vector.\n     * @param b - vector.\n     * @returns square of the distance between a and b\n     */\n    const distSq = distanceSq;\n    /**\n     * Divides a vector by its Euclidean length and returns the quotient.\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The normalized vector.\n     */\n    function normalize(v, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        const len = Math.sqrt(v0 * v0 + v1 * v1 + v2 * v2);\n        if (len > 0.00001) {\n            newDst[0] = v0 / len;\n            newDst[1] = v1 / len;\n            newDst[2] = v2 / len;\n        }\n        else {\n            newDst[0] = 0;\n            newDst[1] = 0;\n            newDst[2] = 0;\n        }\n        return newDst;\n    }\n    /**\n     * Negates a vector.\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns -v.\n     */\n    function negate(v, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = -v[0];\n        newDst[1] = -v[1];\n        newDst[2] = -v[2];\n        return newDst;\n    }\n    /**\n     * Copies a vector. (same as {@link vec3.clone})\n     * Also see {@link vec3.create} and {@link vec3.set}\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A copy of v.\n     */\n    function copy(v, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = v[0];\n        newDst[1] = v[1];\n        newDst[2] = v[2];\n        return newDst;\n    }\n    /**\n     * Clones a vector. (same as {@link vec3.copy})\n     * Also see {@link vec3.create} and {@link vec3.set}\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A copy of v.\n     */\n    const clone = copy;\n    /**\n     * Multiplies a vector by another vector (component-wise); assumes a and\n     * b have the same length.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of products of entries of a and b.\n     */\n    function multiply(a, b, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = a[0] * b[0];\n        newDst[1] = a[1] * b[1];\n        newDst[2] = a[2] * b[2];\n        return newDst;\n    }\n    /**\n     * Multiplies a vector by another vector (component-wise); assumes a and\n     * b have the same length. (same as mul)\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of products of entries of a and b.\n     */\n    const mul = multiply;\n    /**\n     * Divides a vector by another vector (component-wise); assumes a and\n     * b have the same length.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of quotients of entries of a and b.\n     */\n    function divide(a, b, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = a[0] / b[0];\n        newDst[1] = a[1] / b[1];\n        newDst[2] = a[2] / b[2];\n        return newDst;\n    }\n    /**\n     * Divides a vector by another vector (component-wise); assumes a and\n     * b have the same length. (same as divide)\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of quotients of entries of a and b.\n     */\n    const div = divide;\n    /**\n     * Creates a random vector\n     * @param scale - Default 1\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The random vector.\n     */\n    function random(scale = 1, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const angle = Math.random() * 2 * Math.PI;\n        const z = Math.random() * 2 - 1;\n        const zScale = Math.sqrt(1 - z * z) * scale;\n        newDst[0] = Math.cos(angle) * zScale;\n        newDst[1] = Math.sin(angle) * zScale;\n        newDst[2] = z * scale;\n        return newDst;\n    }\n    /**\n     * Zero's a vector\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The zeroed vector.\n     */\n    function zero(dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = 0;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        return newDst;\n    }\n    /**\n     * transform vec3 by 4x4 matrix\n     * @param v - the vector\n     * @param m - The matrix.\n     * @param dst - optional vec3 to store result. If not passed a new one is created.\n     * @returns the transformed vector\n     */\n    function transformMat4(v, m, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const x = v[0];\n        const y = v[1];\n        const z = v[2];\n        const w = (m[3] * x + m[7] * y + m[11] * z + m[15]) || 1;\n        newDst[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n        newDst[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n        newDst[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n        return newDst;\n    }\n    /**\n     * Transform vec3 by upper 3x3 matrix inside 4x4 matrix.\n     * @param v - The direction.\n     * @param m - The matrix.\n     * @param dst - optional vec3 to store result. If not passed a new one is created.\n     * @returns The transformed vector.\n     */\n    function transformMat4Upper3x3(v, m, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        newDst[0] = v0 * m[0 * 4 + 0] + v1 * m[1 * 4 + 0] + v2 * m[2 * 4 + 0];\n        newDst[1] = v0 * m[0 * 4 + 1] + v1 * m[1 * 4 + 1] + v2 * m[2 * 4 + 1];\n        newDst[2] = v0 * m[0 * 4 + 2] + v1 * m[1 * 4 + 2] + v2 * m[2 * 4 + 2];\n        return newDst;\n    }\n    /**\n     * Transforms vec3 by 3x3 matrix\n     *\n     * @param v - the vector\n     * @param m - The matrix.\n     * @param dst - optional vec3 to store result. If not passed a new one is created.\n     * @returns the transformed vector\n     */\n    function transformMat3(v, m, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const x = v[0];\n        const y = v[1];\n        const z = v[2];\n        newDst[0] = x * m[0] + y * m[4] + z * m[8];\n        newDst[1] = x * m[1] + y * m[5] + z * m[9];\n        newDst[2] = x * m[2] + y * m[6] + z * m[10];\n        return newDst;\n    }\n    /**\n     * Transforms vec3 by Quaternion\n     * @param v - the vector to transform\n     * @param q - the quaternion to transform by\n     * @param dst - optional vec3 to store result. If not passed a new one is created.\n     * @returns the transformed\n     */\n    function transformQuat(v, q, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const w2 = q[3] * 2;\n        const x = v[0];\n        const y = v[1];\n        const z = v[2];\n        const uvX = qy * z - qz * y;\n        const uvY = qz * x - qx * z;\n        const uvZ = qx * y - qy * x;\n        newDst[0] = x + uvX * w2 + (qy * uvZ - qz * uvY) * 2;\n        newDst[1] = y + uvY * w2 + (qz * uvX - qx * uvZ) * 2;\n        newDst[2] = z + uvZ * w2 + (qx * uvY - qy * uvX) * 2;\n        return newDst;\n    }\n    /**\n     * Returns the translation component of a 4-by-4 matrix as a vector with 3\n     * entries.\n     * @param m - The matrix.\n     * @param dst - vector to hold result. If not passed a new one is created.\n     * @returns The translation component of m.\n     */\n    function getTranslation(m, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        newDst[0] = m[12];\n        newDst[1] = m[13];\n        newDst[2] = m[14];\n        return newDst;\n    }\n    /**\n     * Returns an axis of a 4x4 matrix as a vector with 3 entries\n     * @param m - The matrix.\n     * @param axis - The axis 0 = x, 1 = y, 2 = z;\n     * @returns The axis component of m.\n     */\n    function getAxis(m, axis, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const off = axis * 4;\n        newDst[0] = m[off + 0];\n        newDst[1] = m[off + 1];\n        newDst[2] = m[off + 2];\n        return newDst;\n    }\n    /**\n     * Returns the scaling component of the matrix\n     * @param m - The Matrix\n     * @param dst - The vector to set. If not passed a new one is created.\n     */\n    function getScaling(m, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const xx = m[0];\n        const xy = m[1];\n        const xz = m[2];\n        const yx = m[4];\n        const yy = m[5];\n        const yz = m[6];\n        const zx = m[8];\n        const zy = m[9];\n        const zz = m[10];\n        newDst[0] = Math.sqrt(xx * xx + xy * xy + xz * xz);\n        newDst[1] = Math.sqrt(yx * yx + yy * yy + yz * yz);\n        newDst[2] = Math.sqrt(zx * zx + zy * zy + zz * zz);\n        return newDst;\n    }\n    /**\n     * Rotate a 3D vector around the x-axis\n     *\n     * @param {ReadonlyVec3} a The vec3 point to rotate\n     * @param {ReadonlyVec3} b The origin of the rotation\n     * @param {Number} rad The angle of rotation in radians\n     * @param dst - The vector to set. If not passed a new one is created.\n     * @returns the rotated vector\n     */\n    function rotateX(a, b, rad, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const p = [];\n        const r = [];\n        //Translate point to the origin\n        p[0] = a[0] - b[0];\n        p[1] = a[1] - b[1];\n        p[2] = a[2] - b[2];\n        //perform rotation\n        r[0] = p[0];\n        r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n        r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad);\n        //translate to correct position\n        newDst[0] = r[0] + b[0];\n        newDst[1] = r[1] + b[1];\n        newDst[2] = r[2] + b[2];\n        return newDst;\n    }\n    /**\n     * Rotate a 3D vector around the y-axis\n     *\n     * @param {ReadonlyVec3} a The vec3 point to rotate\n     * @param {ReadonlyVec3} b The origin of the rotation\n     * @param {Number} rad The angle of rotation in radians\n     * @param dst - The vector to set. If not passed a new one is created.\n     * @returns the rotated vector\n     */\n    function rotateY(a, b, rad, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const p = [];\n        const r = [];\n        // translate point to the origin\n        p[0] = a[0] - b[0];\n        p[1] = a[1] - b[1];\n        p[2] = a[2] - b[2];\n        // perform rotation\n        r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n        r[1] = p[1];\n        r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad);\n        // translate to correct position\n        newDst[0] = r[0] + b[0];\n        newDst[1] = r[1] + b[1];\n        newDst[2] = r[2] + b[2];\n        return newDst;\n    }\n    /**\n     * Rotate a 3D vector around the z-axis\n     *\n     * @param {ReadonlyVec3} a The vec3 point to rotate\n     * @param {ReadonlyVec3} b The origin of the rotation\n     * @param {Number} rad The angle of rotation in radians\n     * @param dst - The vector to set. If not passed a new one is created.\n     * @returns {vec3} out\n     */\n    function rotateZ(a, b, rad, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        const p = [];\n        const r = [];\n        // translate point to the origin\n        p[0] = a[0] - b[0];\n        p[1] = a[1] - b[1];\n        p[2] = a[2] - b[2];\n        // perform rotation\n        r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n        r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n        r[2] = p[2];\n        // translate to correct position\n        newDst[0] = r[0] + b[0];\n        newDst[1] = r[1] + b[1];\n        newDst[2] = r[2] + b[2];\n        return newDst;\n    }\n    /**\n     * Treat a 3D vector as a direction and set it's length\n     *\n     * @param a The vec3 to lengthen\n     * @param len The length of the resulting vector\n     * @returns The lengthened vector\n     */\n    function setLength(a, len, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        normalize(a, newDst);\n        return mulScalar(newDst, len, newDst);\n    }\n    /**\n     * Ensure a vector is not longer than a max length\n     *\n     * @param a The vec3 to limit\n     * @param maxLen The longest length of the resulting vector\n     * @returns The vector, shortened to maxLen if it's too long\n     */\n    function truncate(a, maxLen, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        if (length(a) > maxLen) {\n            return setLength(a, maxLen, newDst);\n        }\n        return copy(a, newDst);\n    }\n    /**\n     * Return the vector exactly between 2 endpoint vectors\n     *\n     * @param a Endpoint 1\n     * @param b Endpoint 2\n     * @returns The vector exactly residing between endpoints 1 and 2\n     */\n    function midpoint(a, b, dst) {\n        const newDst = (dst ?? new Ctor(3));\n        return lerp(a, b, 0.5, newDst);\n    }\n    return {\n        create,\n        fromValues,\n        set,\n        ceil,\n        floor,\n        round,\n        clamp,\n        add,\n        addScaled,\n        angle,\n        subtract,\n        sub,\n        equalsApproximately,\n        equals,\n        lerp,\n        lerpV,\n        max,\n        min,\n        mulScalar,\n        scale,\n        divScalar,\n        inverse,\n        invert,\n        cross,\n        dot,\n        length,\n        len,\n        lengthSq,\n        lenSq,\n        distance,\n        dist,\n        distanceSq,\n        distSq,\n        normalize,\n        negate,\n        copy,\n        clone,\n        multiply,\n        mul,\n        divide,\n        div,\n        random,\n        zero,\n        transformMat4,\n        transformMat4Upper3x3,\n        transformMat3,\n        transformQuat,\n        getTranslation,\n        getAxis,\n        getScaling,\n        rotateX,\n        rotateY,\n        rotateZ,\n        setLength,\n        truncate,\n        midpoint,\n    };\n}\nconst cache$4 = new Map();\nfunction getAPI$4(Ctor) {\n    let api = cache$4.get(Ctor);\n    if (!api) {\n        api = getAPIImpl$4(Ctor);\n        cache$4.set(Ctor, api);\n    }\n    return api;\n}\n\n/*\n * Copyright 2022 Gregg Tavares\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL\n * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n * Generates a typed API for Mat3\n * */\nfunction getAPIImpl$3(Ctor) {\n    const vec2 = getAPI$5(Ctor);\n    const vec3 = getAPI$4(Ctor);\n    /**\n     * Create a Mat3 from values\n     *\n     * Note: Since passing in a raw JavaScript array\n     * is valid in all circumstances, if you want to\n     * force a JavaScript array into a Mat3's specified type\n     * it would be faster to use\n     *\n     * ```\n     * const m = mat3.clone(someJSArray);\n     * ```\n     *\n     * @param v0 - value for element 0\n     * @param v1 - value for element 1\n     * @param v2 - value for element 2\n     * @param v3 - value for element 3\n     * @param v4 - value for element 4\n     * @param v5 - value for element 5\n     * @param v6 - value for element 6\n     * @param v7 - value for element 7\n     * @param v8 - value for element 8\n     * @returns matrix created from values.\n     */\n    function create(v0, v1, v2, v3, v4, v5, v6, v7, v8) {\n        const newDst = new Ctor(12);\n        // to make the array homogenous\n        newDst[3] = 0;\n        newDst[7] = 0;\n        newDst[11] = 0;\n        if (v0 !== undefined) {\n            newDst[0] = v0;\n            if (v1 !== undefined) {\n                newDst[1] = v1;\n                if (v2 !== undefined) {\n                    newDst[2] = v2;\n                    if (v3 !== undefined) {\n                        newDst[4] = v3;\n                        if (v4 !== undefined) {\n                            newDst[5] = v4;\n                            if (v5 !== undefined) {\n                                newDst[6] = v5;\n                                if (v6 !== undefined) {\n                                    newDst[8] = v6;\n                                    if (v7 !== undefined) {\n                                        newDst[9] = v7;\n                                        if (v8 !== undefined) {\n                                            newDst[10] = v8;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return newDst;\n    }\n    /**\n     * Sets the values of a Mat3\n     * Also see {@link mat3.create} and {@link mat3.copy}\n     *\n     * @param v0 - value for element 0\n     * @param v1 - value for element 1\n     * @param v2 - value for element 2\n     * @param v3 - value for element 3\n     * @param v4 - value for element 4\n     * @param v5 - value for element 5\n     * @param v6 - value for element 6\n     * @param v7 - value for element 7\n     * @param v8 - value for element 8\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns Mat3 set from values.\n     */\n    function set(v0, v1, v2, v3, v4, v5, v6, v7, v8, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = v0;\n        newDst[1] = v1;\n        newDst[2] = v2;\n        newDst[3] = 0;\n        newDst[4] = v3;\n        newDst[5] = v4;\n        newDst[6] = v5;\n        newDst[7] = 0;\n        newDst[8] = v6;\n        newDst[9] = v7;\n        newDst[10] = v8;\n        newDst[11] = 0;\n        return newDst;\n    }\n    /**\n     * Creates a Mat3 from the upper left 3x3 part of a Mat4\n     * @param m4 - source matrix\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns Mat3 made from m4\n     */\n    function fromMat4(m4, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = m4[0];\n        newDst[1] = m4[1];\n        newDst[2] = m4[2];\n        newDst[3] = 0;\n        newDst[4] = m4[4];\n        newDst[5] = m4[5];\n        newDst[6] = m4[6];\n        newDst[7] = 0;\n        newDst[8] = m4[8];\n        newDst[9] = m4[9];\n        newDst[10] = m4[10];\n        newDst[11] = 0;\n        return newDst;\n    }\n    /**\n     * Creates a Mat3 rotation matrix from a quaternion\n     * @param q - quaternion to create matrix from\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns Mat3 made from q\n     */\n    function fromQuat(q, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const yx = y * x2;\n        const yy = y * y2;\n        const zx = z * x2;\n        const zy = z * y2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        newDst[0] = 1 - yy - zz;\n        newDst[1] = yx + wz;\n        newDst[2] = zx - wy;\n        newDst[3] = 0;\n        newDst[4] = yx - wz;\n        newDst[5] = 1 - xx - zz;\n        newDst[6] = zy + wx;\n        newDst[7] = 0;\n        newDst[8] = zx + wy;\n        newDst[9] = zy - wx;\n        newDst[10] = 1 - xx - yy;\n        newDst[11] = 0;\n        return newDst;\n    }\n    /**\n     * Negates a matrix.\n     * @param m - The matrix.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns -m.\n     */\n    function negate(m, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = -m[0];\n        newDst[1] = -m[1];\n        newDst[2] = -m[2];\n        newDst[4] = -m[4];\n        newDst[5] = -m[5];\n        newDst[6] = -m[6];\n        newDst[8] = -m[8];\n        newDst[9] = -m[9];\n        newDst[10] = -m[10];\n        return newDst;\n    }\n    /**\n     * multiply a matrix by a scalar matrix.\n     * @param m - The matrix.\n     * @param s - the scalar\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns m * s.\n     */\n    function multiplyScalar(m, s, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = m[0] * s;\n        newDst[1] = m[1] * s;\n        newDst[2] = m[2] * s;\n        newDst[4] = m[4] * s;\n        newDst[5] = m[5] * s;\n        newDst[6] = m[6] * s;\n        newDst[8] = m[8] * s;\n        newDst[9] = m[9] * s;\n        newDst[10] = m[10] * s;\n        return newDst;\n    }\n    /**\n     * multiply a matrix by a scalar matrix.\n     * @param m - The matrix.\n     * @param s - the scalar\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns m * s.\n     */\n    const mulScalar = multiplyScalar;\n    /**\n     * add 2 matrices.\n     * @param a - matrix 1.\n     * @param b - matrix 2.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns a + b.\n     */\n    function add(a, b, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = a[0] + b[0];\n        newDst[1] = a[1] + b[1];\n        newDst[2] = a[2] + b[2];\n        newDst[4] = a[4] + b[4];\n        newDst[5] = a[5] + b[5];\n        newDst[6] = a[6] + b[6];\n        newDst[8] = a[8] + b[8];\n        newDst[9] = a[9] + b[9];\n        newDst[10] = a[10] + b[10];\n        return newDst;\n    }\n    /**\n     * Copies a matrix. (same as {@link mat3.clone})\n     * Also see {@link mat3.create} and {@link mat3.set}\n     * @param m - The matrix.\n     * @param dst - The matrix. If not passed a new one is created.\n     * @returns A copy of m.\n     */\n    function copy(m, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = m[0];\n        newDst[1] = m[1];\n        newDst[2] = m[2];\n        newDst[4] = m[4];\n        newDst[5] = m[5];\n        newDst[6] = m[6];\n        newDst[8] = m[8];\n        newDst[9] = m[9];\n        newDst[10] = m[10];\n        return newDst;\n    }\n    /**\n     * Copies a matrix (same as {@link mat3.copy})\n     * Also see {@link mat3.create} and {@link mat3.set}\n     * @param m - The matrix.\n     * @param dst - The matrix. If not passed a new one is created.\n     * @returns A copy of m.\n     */\n    const clone = copy;\n    /**\n     * Check if 2 matrices are approximately equal\n     * @param a Operand matrix.\n     * @param b Operand matrix.\n     * @returns true if matrices are approximately equal\n     */\n    function equalsApproximately(a, b) {\n        return Math.abs(a[0] - b[0]) < EPSILON &&\n            Math.abs(a[1] - b[1]) < EPSILON &&\n            Math.abs(a[2] - b[2]) < EPSILON &&\n            Math.abs(a[4] - b[4]) < EPSILON &&\n            Math.abs(a[5] - b[5]) < EPSILON &&\n            Math.abs(a[6] - b[6]) < EPSILON &&\n            Math.abs(a[8] - b[8]) < EPSILON &&\n            Math.abs(a[9] - b[9]) < EPSILON &&\n            Math.abs(a[10] - b[10]) < EPSILON;\n    }\n    /**\n     * Check if 2 matrices are exactly equal\n     * @param a Operand matrix.\n     * @param b Operand matrix.\n     * @returns true if matrices are exactly equal\n     */\n    function equals(a, b) {\n        return a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[4] === b[4] &&\n            a[5] === b[5] &&\n            a[6] === b[6] &&\n            a[8] === b[8] &&\n            a[9] === b[9] &&\n            a[10] === b[10];\n    }\n    /**\n     * Creates a 3-by-3 identity matrix.\n     *\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns A 3-by-3 identity matrix.\n     */\n    function identity(dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = 1;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[4] = 0;\n        newDst[5] = 1;\n        newDst[6] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[10] = 1;\n        return newDst;\n    }\n    /**\n     * Takes the transpose of a matrix.\n     * @param m - The matrix.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The transpose of m.\n     */\n    function transpose(m, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        if (newDst === m) {\n            let t;\n            // 0 1 2\n            // 4 5 6\n            // 8 9 10\n            t = m[1];\n            m[1] = m[4];\n            m[4] = t;\n            t = m[2];\n            m[2] = m[8];\n            m[8] = t;\n            t = m[6];\n            m[6] = m[9];\n            m[9] = t;\n            return newDst;\n        }\n        const m00 = m[0 * 4 + 0];\n        const m01 = m[0 * 4 + 1];\n        const m02 = m[0 * 4 + 2];\n        const m10 = m[1 * 4 + 0];\n        const m11 = m[1 * 4 + 1];\n        const m12 = m[1 * 4 + 2];\n        const m20 = m[2 * 4 + 0];\n        const m21 = m[2 * 4 + 1];\n        const m22 = m[2 * 4 + 2];\n        newDst[0] = m00;\n        newDst[1] = m10;\n        newDst[2] = m20;\n        newDst[4] = m01;\n        newDst[5] = m11;\n        newDst[6] = m21;\n        newDst[8] = m02;\n        newDst[9] = m12;\n        newDst[10] = m22;\n        return newDst;\n    }\n    /**\n     * Computes the inverse of a 3-by-3 matrix.\n     * @param m - The matrix.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The inverse of m.\n     */\n    function inverse(m, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        const m00 = m[0 * 4 + 0];\n        const m01 = m[0 * 4 + 1];\n        const m02 = m[0 * 4 + 2];\n        const m10 = m[1 * 4 + 0];\n        const m11 = m[1 * 4 + 1];\n        const m12 = m[1 * 4 + 2];\n        const m20 = m[2 * 4 + 0];\n        const m21 = m[2 * 4 + 1];\n        const m22 = m[2 * 4 + 2];\n        const b01 = m22 * m11 - m12 * m21;\n        const b11 = -m22 * m10 + m12 * m20;\n        const b21 = m21 * m10 - m11 * m20;\n        const invDet = 1 / (m00 * b01 + m01 * b11 + m02 * b21);\n        newDst[0] = b01 * invDet;\n        newDst[1] = (-m22 * m01 + m02 * m21) * invDet;\n        newDst[2] = (m12 * m01 - m02 * m11) * invDet;\n        newDst[4] = b11 * invDet;\n        newDst[5] = (m22 * m00 - m02 * m20) * invDet;\n        newDst[6] = (-m12 * m00 + m02 * m10) * invDet;\n        newDst[8] = b21 * invDet;\n        newDst[9] = (-m21 * m00 + m01 * m20) * invDet;\n        newDst[10] = (m11 * m00 - m01 * m10) * invDet;\n        return newDst;\n    }\n    /**\n     * Compute the determinant of a matrix\n     * @param m - the matrix\n     * @returns the determinant\n     */\n    function determinant(m) {\n        const m00 = m[0 * 4 + 0];\n        const m01 = m[0 * 4 + 1];\n        const m02 = m[0 * 4 + 2];\n        const m10 = m[1 * 4 + 0];\n        const m11 = m[1 * 4 + 1];\n        const m12 = m[1 * 4 + 2];\n        const m20 = m[2 * 4 + 0];\n        const m21 = m[2 * 4 + 1];\n        const m22 = m[2 * 4 + 2];\n        return m00 * (m11 * m22 - m21 * m12) -\n            m10 * (m01 * m22 - m21 * m02) +\n            m20 * (m01 * m12 - m11 * m02);\n    }\n    /**\n     * Computes the inverse of a 3-by-3 matrix. (same as inverse)\n     * @param m - The matrix.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The inverse of m.\n     */\n    const invert = inverse;\n    /**\n     * Multiplies two 3-by-3 matrices with a on the left and b on the right\n     * @param a - The matrix on the left.\n     * @param b - The matrix on the right.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The matrix product of a and b.\n     */\n    function multiply(a, b, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a10 = a[4 + 0];\n        const a11 = a[4 + 1];\n        const a12 = a[4 + 2];\n        const a20 = a[8 + 0];\n        const a21 = a[8 + 1];\n        const a22 = a[8 + 2];\n        const b00 = b[0];\n        const b01 = b[1];\n        const b02 = b[2];\n        const b10 = b[4 + 0];\n        const b11 = b[4 + 1];\n        const b12 = b[4 + 2];\n        const b20 = b[8 + 0];\n        const b21 = b[8 + 1];\n        const b22 = b[8 + 2];\n        newDst[0] = a00 * b00 + a10 * b01 + a20 * b02;\n        newDst[1] = a01 * b00 + a11 * b01 + a21 * b02;\n        newDst[2] = a02 * b00 + a12 * b01 + a22 * b02;\n        newDst[4] = a00 * b10 + a10 * b11 + a20 * b12;\n        newDst[5] = a01 * b10 + a11 * b11 + a21 * b12;\n        newDst[6] = a02 * b10 + a12 * b11 + a22 * b12;\n        newDst[8] = a00 * b20 + a10 * b21 + a20 * b22;\n        newDst[9] = a01 * b20 + a11 * b21 + a21 * b22;\n        newDst[10] = a02 * b20 + a12 * b21 + a22 * b22;\n        return newDst;\n    }\n    /**\n     * Multiplies two 3-by-3 matrices with a on the left and b on the right (same as multiply)\n     * @param a - The matrix on the left.\n     * @param b - The matrix on the right.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The matrix product of a and b.\n     */\n    const mul = multiply;\n    /**\n     * Sets the translation component of a 3-by-3 matrix to the given\n     * vector.\n     * @param a - The matrix.\n     * @param v - The vector.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The matrix with translation set.\n     */\n    function setTranslation(a, v, dst) {\n        const newDst = (dst ?? identity());\n        if (a !== newDst) {\n            newDst[0] = a[0];\n            newDst[1] = a[1];\n            newDst[2] = a[2];\n            newDst[4] = a[4];\n            newDst[5] = a[5];\n            newDst[6] = a[6];\n        }\n        newDst[8] = v[0];\n        newDst[9] = v[1];\n        newDst[10] = 1;\n        return newDst;\n    }\n    /**\n     * Returns the translation component of a 3-by-3 matrix as a vector with 3\n     * entries.\n     * @param m - The matrix.\n     * @param dst - vector to hold result. If not passed a new one is created.\n     * @returns The translation component of m.\n     */\n    function getTranslation(m, dst) {\n        const newDst = (dst ?? vec2.create());\n        newDst[0] = m[8];\n        newDst[1] = m[9];\n        return newDst;\n    }\n    /**\n     * Returns an axis of a 3x3 matrix as a vector with 2 entries\n     * @param m - The matrix.\n     * @param axis - The axis 0 = x, 1 = y,\n     * @returns The axis component of m.\n     */\n    function getAxis(m, axis, dst) {\n        const newDst = (dst ?? vec2.create());\n        const off = axis * 4;\n        newDst[0] = m[off + 0];\n        newDst[1] = m[off + 1];\n        return newDst;\n    }\n    /**\n     * Sets an axis of a 3x3 matrix as a vector with 2 entries\n     * @param m - The matrix.\n     * @param v - the axis vector\n     * @param axis - The axis  0 = x, 1 = y;\n     * @param dst - The matrix to set. If not passed a new one is created.\n     * @returns The matrix with axis set.\n     */\n    function setAxis(m, v, axis, dst) {\n        const newDst = (dst === m ? m : copy(m, dst));\n        const off = axis * 4;\n        newDst[off + 0] = v[0];\n        newDst[off + 1] = v[1];\n        return newDst;\n    }\n    /**\n     * Returns the \"2d\" scaling component of the matrix\n     * @param m - The Matrix\n     * @param dst - The vector to set. If not passed a new one is created.\n     */\n    function getScaling(m, dst) {\n        const newDst = (dst ?? vec2.create());\n        const xx = m[0];\n        const xy = m[1];\n        const yx = m[4];\n        const yy = m[5];\n        newDst[0] = Math.sqrt(xx * xx + xy * xy);\n        newDst[1] = Math.sqrt(yx * yx + yy * yy);\n        return newDst;\n    }\n    /**\n     * Returns the \"3d\" scaling component of the matrix\n     * @param m - The Matrix\n     * @param dst - The vector to set. If not passed a new one is created.\n     */\n    function get3DScaling(m, dst) {\n        const newDst = (dst ?? vec3.create());\n        const xx = m[0];\n        const xy = m[1];\n        const xz = m[2];\n        const yx = m[4];\n        const yy = m[5];\n        const yz = m[6];\n        const zx = m[8];\n        const zy = m[9];\n        const zz = m[10];\n        newDst[0] = Math.sqrt(xx * xx + xy * xy + xz * xz);\n        newDst[1] = Math.sqrt(yx * yx + yy * yy + yz * yz);\n        newDst[2] = Math.sqrt(zx * zx + zy * zy + zz * zz);\n        return newDst;\n    }\n    /**\n     * Creates a 3-by-3 matrix which translates by the given vector v.\n     * @param v - The vector by which to translate.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The translation matrix.\n     */\n    function translation(v, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = 1;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[4] = 0;\n        newDst[5] = 1;\n        newDst[6] = 0;\n        newDst[8] = v[0];\n        newDst[9] = v[1];\n        newDst[10] = 1;\n        return newDst;\n    }\n    /**\n     * Translates the given 3-by-3 matrix by the given vector v.\n     * @param m - The matrix.\n     * @param v - The vector by which to translate.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The translated matrix.\n     */\n    function translate(m, v, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        const v0 = v[0];\n        const v1 = v[1];\n        const m00 = m[0];\n        const m01 = m[1];\n        const m02 = m[2];\n        const m10 = m[1 * 4 + 0];\n        const m11 = m[1 * 4 + 1];\n        const m12 = m[1 * 4 + 2];\n        const m20 = m[2 * 4 + 0];\n        const m21 = m[2 * 4 + 1];\n        const m22 = m[2 * 4 + 2];\n        if (m !== newDst) {\n            newDst[0] = m00;\n            newDst[1] = m01;\n            newDst[2] = m02;\n            newDst[4] = m10;\n            newDst[5] = m11;\n            newDst[6] = m12;\n        }\n        newDst[8] = m00 * v0 + m10 * v1 + m20;\n        newDst[9] = m01 * v0 + m11 * v1 + m21;\n        newDst[10] = m02 * v0 + m12 * v1 + m22;\n        return newDst;\n    }\n    /**\n     * Creates a 3-by-3 matrix which rotates  by the given angle.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotation matrix.\n     */\n    function rotation(angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        newDst[0] = c;\n        newDst[1] = s;\n        newDst[2] = 0;\n        newDst[4] = -s;\n        newDst[5] = c;\n        newDst[6] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[10] = 1;\n        return newDst;\n    }\n    /**\n     * Rotates the given 3-by-3 matrix  by the given angle.\n     * @param m - The matrix.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotated matrix.\n     */\n    function rotate(m, angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        const m00 = m[0 * 4 + 0];\n        const m01 = m[0 * 4 + 1];\n        const m02 = m[0 * 4 + 2];\n        const m10 = m[1 * 4 + 0];\n        const m11 = m[1 * 4 + 1];\n        const m12 = m[1 * 4 + 2];\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        newDst[0] = c * m00 + s * m10;\n        newDst[1] = c * m01 + s * m11;\n        newDst[2] = c * m02 + s * m12;\n        newDst[4] = c * m10 - s * m00;\n        newDst[5] = c * m11 - s * m01;\n        newDst[6] = c * m12 - s * m02;\n        if (m !== newDst) {\n            newDst[8] = m[8];\n            newDst[9] = m[9];\n            newDst[10] = m[10];\n        }\n        return newDst;\n    }\n    /**\n     * Creates a 3-by-3 matrix which rotates around the x-axis by the given angle.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotation matrix.\n     */\n    function rotationX(angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        newDst[0] = 1;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[4] = 0;\n        newDst[5] = c;\n        newDst[6] = s;\n        newDst[8] = 0;\n        newDst[9] = -s;\n        newDst[10] = c;\n        return newDst;\n    }\n    /**\n     * Rotates the given 3-by-3 matrix around the x-axis by the given\n     * angle.\n     * @param m - The matrix.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotated matrix.\n     */\n    function rotateX(m, angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        const m10 = m[4];\n        const m11 = m[5];\n        const m12 = m[6];\n        const m20 = m[8];\n        const m21 = m[9];\n        const m22 = m[10];\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        newDst[4] = c * m10 + s * m20;\n        newDst[5] = c * m11 + s * m21;\n        newDst[6] = c * m12 + s * m22;\n        newDst[8] = c * m20 - s * m10;\n        newDst[9] = c * m21 - s * m11;\n        newDst[10] = c * m22 - s * m12;\n        if (m !== newDst) {\n            newDst[0] = m[0];\n            newDst[1] = m[1];\n            newDst[2] = m[2];\n        }\n        return newDst;\n    }\n    /**\n     * Creates a 3-by-3 matrix which rotates around the y-axis by the given angle.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotation matrix.\n     */\n    function rotationY(angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        newDst[0] = c;\n        newDst[1] = 0;\n        newDst[2] = -s;\n        newDst[4] = 0;\n        newDst[5] = 1;\n        newDst[6] = 0;\n        newDst[8] = s;\n        newDst[9] = 0;\n        newDst[10] = c;\n        return newDst;\n    }\n    /**\n     * Rotates the given 3-by-3 matrix around the y-axis by the given\n     * angle.\n     * @param m - The matrix.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotated matrix.\n     */\n    function rotateY(m, angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        const m00 = m[0 * 4 + 0];\n        const m01 = m[0 * 4 + 1];\n        const m02 = m[0 * 4 + 2];\n        const m20 = m[2 * 4 + 0];\n        const m21 = m[2 * 4 + 1];\n        const m22 = m[2 * 4 + 2];\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        newDst[0] = c * m00 - s * m20;\n        newDst[1] = c * m01 - s * m21;\n        newDst[2] = c * m02 - s * m22;\n        newDst[8] = c * m20 + s * m00;\n        newDst[9] = c * m21 + s * m01;\n        newDst[10] = c * m22 + s * m02;\n        if (m !== newDst) {\n            newDst[4] = m[4];\n            newDst[5] = m[5];\n            newDst[6] = m[6];\n        }\n        return newDst;\n    }\n    /**\n     * Creates a 3-by-3 matrix which rotates around the z-axis by the given angle.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotation matrix.\n     */\n    const rotationZ = rotation;\n    /**\n     * Rotates the given 3-by-3 matrix around the z-axis by the given\n     * angle.\n     * @param m - The matrix.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotated matrix.\n     */\n    const rotateZ = rotate;\n    /**\n     * Creates a 3-by-3 matrix which scales in each dimension by an amount given by\n     * the corresponding entry in the given vector; assumes the vector has two\n     * entries.\n     * @param v - A vector of\n     *     2 entries specifying the factor by which to scale in each dimension.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The scaling matrix.\n     */\n    function scaling(v, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = v[0];\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[4] = 0;\n        newDst[5] = v[1];\n        newDst[6] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[10] = 1;\n        return newDst;\n    }\n    /**\n     * Scales the given 3-by-3 matrix in each dimension by an amount\n     * given by the corresponding entry in the given vector; assumes the vector has\n     * two entries.\n     * @param m - The matrix to be modified.\n     * @param v - A vector of 2 entries specifying the\n     *     factor by which to scale in each dimension.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The scaled matrix.\n     */\n    function scale(m, v, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        const v0 = v[0];\n        const v1 = v[1];\n        newDst[0] = v0 * m[0 * 4 + 0];\n        newDst[1] = v0 * m[0 * 4 + 1];\n        newDst[2] = v0 * m[0 * 4 + 2];\n        newDst[4] = v1 * m[1 * 4 + 0];\n        newDst[5] = v1 * m[1 * 4 + 1];\n        newDst[6] = v1 * m[1 * 4 + 2];\n        if (m !== newDst) {\n            newDst[8] = m[8];\n            newDst[9] = m[9];\n            newDst[10] = m[10];\n        }\n        return newDst;\n    }\n    /**\n     * Creates a 3-by-3 matrix which scales in each dimension by an amount given by\n     * the corresponding entry in the given vector; assumes the vector has three\n     * entries.\n     * @param v - A vector of\n     *     3 entries specifying the factor by which to scale in each dimension.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The scaling matrix.\n     */\n    function scaling3D(v, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = v[0];\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[4] = 0;\n        newDst[5] = v[1];\n        newDst[6] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[10] = v[2];\n        return newDst;\n    }\n    /**\n     * Scales the given 3-by-3 matrix in each dimension by an amount\n     * given by the corresponding entry in the given vector; assumes the vector has\n     * three entries.\n     * @param m - The matrix to be modified.\n     * @param v - A vector of 3 entries specifying the\n     *     factor by which to scale in each dimension.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The scaled matrix.\n     */\n    function scale3D(m, v, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        newDst[0] = v0 * m[0 * 4 + 0];\n        newDst[1] = v0 * m[0 * 4 + 1];\n        newDst[2] = v0 * m[0 * 4 + 2];\n        newDst[4] = v1 * m[1 * 4 + 0];\n        newDst[5] = v1 * m[1 * 4 + 1];\n        newDst[6] = v1 * m[1 * 4 + 2];\n        newDst[8] = v2 * m[2 * 4 + 0];\n        newDst[9] = v2 * m[2 * 4 + 1];\n        newDst[10] = v2 * m[2 * 4 + 2];\n        return newDst;\n    }\n    /**\n     * Creates a 3-by-3 matrix which scales uniformly in the X and Y dimensions\n     * @param s - Amount to scale\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The scaling matrix.\n     */\n    function uniformScaling(s, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = s;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[4] = 0;\n        newDst[5] = s;\n        newDst[6] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[10] = 1;\n        return newDst;\n    }\n    /**\n     * Scales the given 3-by-3 matrix in the X and Y dimension by an amount\n     * given.\n     * @param m - The matrix to be modified.\n     * @param s - Amount to scale.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The scaled matrix.\n     */\n    function uniformScale(m, s, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = s * m[0 * 4 + 0];\n        newDst[1] = s * m[0 * 4 + 1];\n        newDst[2] = s * m[0 * 4 + 2];\n        newDst[4] = s * m[1 * 4 + 0];\n        newDst[5] = s * m[1 * 4 + 1];\n        newDst[6] = s * m[1 * 4 + 2];\n        if (m !== newDst) {\n            newDst[8] = m[8];\n            newDst[9] = m[9];\n            newDst[10] = m[10];\n        }\n        return newDst;\n    }\n    /**\n     * Creates a 3-by-3 matrix which scales uniformly in each dimension\n     * @param s - Amount to scale\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The scaling matrix.\n     */\n    function uniformScaling3D(s, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = s;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[4] = 0;\n        newDst[5] = s;\n        newDst[6] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[10] = s;\n        return newDst;\n    }\n    /**\n     * Scales the given 3-by-3 matrix in each dimension by an amount\n     * given.\n     * @param m - The matrix to be modified.\n     * @param s - Amount to scale.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The scaled matrix.\n     */\n    function uniformScale3D(m, s, dst) {\n        const newDst = (dst ?? new Ctor(12));\n        newDst[0] = s * m[0 * 4 + 0];\n        newDst[1] = s * m[0 * 4 + 1];\n        newDst[2] = s * m[0 * 4 + 2];\n        newDst[4] = s * m[1 * 4 + 0];\n        newDst[5] = s * m[1 * 4 + 1];\n        newDst[6] = s * m[1 * 4 + 2];\n        newDst[8] = s * m[2 * 4 + 0];\n        newDst[9] = s * m[2 * 4 + 1];\n        newDst[10] = s * m[2 * 4 + 2];\n        return newDst;\n    }\n    return {\n        add,\n        clone,\n        copy,\n        create,\n        determinant,\n        equals,\n        equalsApproximately,\n        fromMat4,\n        fromQuat,\n        get3DScaling,\n        getAxis,\n        getScaling,\n        getTranslation,\n        identity,\n        inverse,\n        invert,\n        mul,\n        mulScalar,\n        multiply,\n        multiplyScalar,\n        negate,\n        rotate,\n        rotateX,\n        rotateY,\n        rotateZ,\n        rotation,\n        rotationX,\n        rotationY,\n        rotationZ,\n        scale,\n        scale3D,\n        scaling,\n        scaling3D,\n        set,\n        setAxis,\n        setTranslation,\n        translate,\n        translation,\n        transpose,\n        uniformScale,\n        uniformScale3D,\n        uniformScaling,\n        uniformScaling3D,\n    };\n}\nconst cache$3 = new Map();\nfunction getAPI$3(Ctor) {\n    let api = cache$3.get(Ctor);\n    if (!api) {\n        api = getAPIImpl$3(Ctor);\n        cache$3.set(Ctor, api);\n    }\n    return api;\n}\n\n/**\n * Generates a typed API for Mat4\n * */\nfunction getAPIImpl$2(Ctor) {\n    const vec3 = getAPI$4(Ctor);\n    /**\n     * 4x4 Matrix math math functions.\n     *\n     * Almost all functions take an optional `newDst` argument. If it is not passed in the\n     * functions will create a new matrix. In other words you can do this\n     *\n     *     const mat = mat4.translation([1, 2, 3]);  // Creates a new translation matrix\n     *\n     * or\n     *\n     *     const mat = mat4.create();\n     *     mat4.translation([1, 2, 3], mat);  // Puts translation matrix in mat.\n     *\n     * The first style is often easier but depending on where it's used it generates garbage where\n     * as there is almost never allocation with the second style.\n     *\n     * It is always save to pass any matrix as the destination. So for example\n     *\n     *     const mat = mat4.identity();\n     *     const trans = mat4.translation([1, 2, 3]);\n     *     mat4.multiply(mat, trans, mat);  // Multiplies mat * trans and puts result in mat.\n     *\n     */\n    /**\n     * Create a Mat4 from values\n     *\n     * Note: Since passing in a raw JavaScript array\n     * is valid in all circumstances, if you want to\n     * force a JavaScript array into a Mat4's specified type\n     * it would be faster to use\n     *\n     * ```\n     * const m = mat4.clone(someJSArray);\n     * ```\n     *\n     * @param v0 - value for element 0\n     * @param v1 - value for element 1\n     * @param v2 - value for element 2\n     * @param v3 - value for element 3\n     * @param v4 - value for element 4\n     * @param v5 - value for element 5\n     * @param v6 - value for element 6\n     * @param v7 - value for element 7\n     * @param v8 - value for element 8\n     * @param v9 - value for element 9\n     * @param v10 - value for element 10\n     * @param v11 - value for element 11\n     * @param v12 - value for element 12\n     * @param v13 - value for element 13\n     * @param v14 - value for element 14\n     * @param v15 - value for element 15\n     * @returns created from values.\n     */\n    function create(v0, v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15) {\n        const newDst = new Ctor(16);\n        if (v0 !== undefined) {\n            newDst[0] = v0;\n            if (v1 !== undefined) {\n                newDst[1] = v1;\n                if (v2 !== undefined) {\n                    newDst[2] = v2;\n                    if (v3 !== undefined) {\n                        newDst[3] = v3;\n                        if (v4 !== undefined) {\n                            newDst[4] = v4;\n                            if (v5 !== undefined) {\n                                newDst[5] = v5;\n                                if (v6 !== undefined) {\n                                    newDst[6] = v6;\n                                    if (v7 !== undefined) {\n                                        newDst[7] = v7;\n                                        if (v8 !== undefined) {\n                                            newDst[8] = v8;\n                                            if (v9 !== undefined) {\n                                                newDst[9] = v9;\n                                                if (v10 !== undefined) {\n                                                    newDst[10] = v10;\n                                                    if (v11 !== undefined) {\n                                                        newDst[11] = v11;\n                                                        if (v12 !== undefined) {\n                                                            newDst[12] = v12;\n                                                            if (v13 !== undefined) {\n                                                                newDst[13] = v13;\n                                                                if (v14 !== undefined) {\n                                                                    newDst[14] = v14;\n                                                                    if (v15 !== undefined) {\n                                                                        newDst[15] = v15;\n                                                                    }\n                                                                }\n                                                            }\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return newDst;\n    }\n    /**\n     * Sets the values of a Mat4\n     * Also see {@link mat4.create} and {@link mat4.copy}\n     *\n     * @param v0 - value for element 0\n     * @param v1 - value for element 1\n     * @param v2 - value for element 2\n     * @param v3 - value for element 3\n     * @param v4 - value for element 4\n     * @param v5 - value for element 5\n     * @param v6 - value for element 6\n     * @param v7 - value for element 7\n     * @param v8 - value for element 8\n     * @param v9 - value for element 9\n     * @param v10 - value for element 10\n     * @param v11 - value for element 11\n     * @param v12 - value for element 12\n     * @param v13 - value for element 13\n     * @param v14 - value for element 14\n     * @param v15 - value for element 15\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns Mat4 created from values.\n     */\n    function set(v0, v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        newDst[0] = v0;\n        newDst[1] = v1;\n        newDst[2] = v2;\n        newDst[3] = v3;\n        newDst[4] = v4;\n        newDst[5] = v5;\n        newDst[6] = v6;\n        newDst[7] = v7;\n        newDst[8] = v8;\n        newDst[9] = v9;\n        newDst[10] = v10;\n        newDst[11] = v11;\n        newDst[12] = v12;\n        newDst[13] = v13;\n        newDst[14] = v14;\n        newDst[15] = v15;\n        return newDst;\n    }\n    /**\n     * Creates a Mat4 from a Mat3\n     * @param m3 - source matrix\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns Mat4 made from m3\n     */\n    function fromMat3(m3, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        newDst[0] = m3[0];\n        newDst[1] = m3[1];\n        newDst[2] = m3[2];\n        newDst[3] = 0;\n        newDst[4] = m3[4];\n        newDst[5] = m3[5];\n        newDst[6] = m3[6];\n        newDst[7] = 0;\n        newDst[8] = m3[8];\n        newDst[9] = m3[9];\n        newDst[10] = m3[10];\n        newDst[11] = 0;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[14] = 0;\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Creates a Mat4 rotation matrix from a quaternion\n     * @param q - quaternion to create matrix from\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns Mat4 made from q\n     */\n    function fromQuat(q, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const yx = y * x2;\n        const yy = y * y2;\n        const zx = z * x2;\n        const zy = z * y2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        newDst[0] = 1 - yy - zz;\n        newDst[1] = yx + wz;\n        newDst[2] = zx - wy;\n        newDst[3] = 0;\n        newDst[4] = yx - wz;\n        newDst[5] = 1 - xx - zz;\n        newDst[6] = zy + wx;\n        newDst[7] = 0;\n        newDst[8] = zx + wy;\n        newDst[9] = zy - wx;\n        newDst[10] = 1 - xx - yy;\n        newDst[11] = 0;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[14] = 0;\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Negates a matrix.\n     * @param m - The matrix.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns -m.\n     */\n    function negate(m, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        newDst[0] = -m[0];\n        newDst[1] = -m[1];\n        newDst[2] = -m[2];\n        newDst[3] = -m[3];\n        newDst[4] = -m[4];\n        newDst[5] = -m[5];\n        newDst[6] = -m[6];\n        newDst[7] = -m[7];\n        newDst[8] = -m[8];\n        newDst[9] = -m[9];\n        newDst[10] = -m[10];\n        newDst[11] = -m[11];\n        newDst[12] = -m[12];\n        newDst[13] = -m[13];\n        newDst[14] = -m[14];\n        newDst[15] = -m[15];\n        return newDst;\n    }\n    /**\n     * add 2 matrices.\n     * @param a - matrix 1.\n     * @param b - matrix 2.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns a + b.\n     */\n    function add(a, b, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        newDst[0] = a[0] + b[0];\n        newDst[1] = a[1] + b[1];\n        newDst[2] = a[2] + b[2];\n        newDst[3] = a[3] + b[3];\n        newDst[4] = a[4] + b[4];\n        newDst[5] = a[5] + b[5];\n        newDst[6] = a[6] + b[6];\n        newDst[7] = a[7] + b[7];\n        newDst[8] = a[8] + b[8];\n        newDst[9] = a[9] + b[9];\n        newDst[10] = a[10] + b[10];\n        newDst[11] = a[11] + b[11];\n        newDst[12] = a[12] + b[12];\n        newDst[13] = a[13] + b[13];\n        newDst[14] = a[14] + b[14];\n        newDst[15] = a[15] + b[15];\n        return newDst;\n    }\n    /**\n     * Multiplies a matrix by a scalar\n     * @param m - The matrix.\n     * @param s - The scalar\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns m * s.\n     */\n    function multiplyScalar(m, s, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        newDst[0] = m[0] * s;\n        newDst[1] = m[1] * s;\n        newDst[2] = m[2] * s;\n        newDst[3] = m[3] * s;\n        newDst[4] = m[4] * s;\n        newDst[5] = m[5] * s;\n        newDst[6] = m[6] * s;\n        newDst[7] = m[7] * s;\n        newDst[8] = m[8] * s;\n        newDst[9] = m[9] * s;\n        newDst[10] = m[10] * s;\n        newDst[11] = m[11] * s;\n        newDst[12] = m[12] * s;\n        newDst[13] = m[13] * s;\n        newDst[14] = m[14] * s;\n        newDst[15] = m[15] * s;\n        return newDst;\n    }\n    /**\n     * Multiplies a matrix by a scalar\n     * @param m - The matrix.\n     * @param s - The scalar\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns m * s.\n     */\n    const mulScalar = multiplyScalar;\n    /**\n     * Copies a matrix. (same as {@link mat4.clone})\n     * Also see {@link mat4.create} and {@link mat4.set}\n     * @param m - The matrix.\n     * @param dst - The matrix. If not passed a new one is created.\n     * @returns A copy of m.\n     */\n    function copy(m, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        newDst[0] = m[0];\n        newDst[1] = m[1];\n        newDst[2] = m[2];\n        newDst[3] = m[3];\n        newDst[4] = m[4];\n        newDst[5] = m[5];\n        newDst[6] = m[6];\n        newDst[7] = m[7];\n        newDst[8] = m[8];\n        newDst[9] = m[9];\n        newDst[10] = m[10];\n        newDst[11] = m[11];\n        newDst[12] = m[12];\n        newDst[13] = m[13];\n        newDst[14] = m[14];\n        newDst[15] = m[15];\n        return newDst;\n    }\n    /**\n     * Copies a matrix (same as {@link mat4.copy})\n     * Also see {@link mat4.create} and {@link mat4.set}\n     * @param m - The matrix.\n     * @param dst - The matrix. If not passed a new one is created.\n     * @returns A copy of m.\n     */\n    const clone = copy;\n    /**\n     * Check if 2 matrices are approximately equal\n     * @param a - Operand matrix.\n     * @param b - Operand matrix.\n     * @returns true if matrices are approximately equal\n     */\n    function equalsApproximately(a, b) {\n        return Math.abs(a[0] - b[0]) < EPSILON &&\n            Math.abs(a[1] - b[1]) < EPSILON &&\n            Math.abs(a[2] - b[2]) < EPSILON &&\n            Math.abs(a[3] - b[3]) < EPSILON &&\n            Math.abs(a[4] - b[4]) < EPSILON &&\n            Math.abs(a[5] - b[5]) < EPSILON &&\n            Math.abs(a[6] - b[6]) < EPSILON &&\n            Math.abs(a[7] - b[7]) < EPSILON &&\n            Math.abs(a[8] - b[8]) < EPSILON &&\n            Math.abs(a[9] - b[9]) < EPSILON &&\n            Math.abs(a[10] - b[10]) < EPSILON &&\n            Math.abs(a[11] - b[11]) < EPSILON &&\n            Math.abs(a[12] - b[12]) < EPSILON &&\n            Math.abs(a[13] - b[13]) < EPSILON &&\n            Math.abs(a[14] - b[14]) < EPSILON &&\n            Math.abs(a[15] - b[15]) < EPSILON;\n    }\n    /**\n     * Check if 2 matrices are exactly equal\n     * @param a - Operand matrix.\n     * @param b - Operand matrix.\n     * @returns true if matrices are exactly equal\n     */\n    function equals(a, b) {\n        return a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[3] === b[3] &&\n            a[4] === b[4] &&\n            a[5] === b[5] &&\n            a[6] === b[6] &&\n            a[7] === b[7] &&\n            a[8] === b[8] &&\n            a[9] === b[9] &&\n            a[10] === b[10] &&\n            a[11] === b[11] &&\n            a[12] === b[12] &&\n            a[13] === b[13] &&\n            a[14] === b[14] &&\n            a[15] === b[15];\n    }\n    /**\n     * Creates a 4-by-4 identity matrix.\n     *\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns A 4-by-4 identity matrix.\n     */\n    function identity(dst) {\n        const newDst = (dst ?? new Ctor(16));\n        newDst[0] = 1;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[3] = 0;\n        newDst[4] = 0;\n        newDst[5] = 1;\n        newDst[6] = 0;\n        newDst[7] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[10] = 1;\n        newDst[11] = 0;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[14] = 0;\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Takes the transpose of a matrix.\n     * @param m - The matrix.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The transpose of m.\n     */\n    function transpose(m, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        if (newDst === m) {\n            let t;\n            t = m[1];\n            m[1] = m[4];\n            m[4] = t;\n            t = m[2];\n            m[2] = m[8];\n            m[8] = t;\n            t = m[3];\n            m[3] = m[12];\n            m[12] = t;\n            t = m[6];\n            m[6] = m[9];\n            m[9] = t;\n            t = m[7];\n            m[7] = m[13];\n            m[13] = t;\n            t = m[11];\n            m[11] = m[14];\n            m[14] = t;\n            return newDst;\n        }\n        const m00 = m[0 * 4 + 0];\n        const m01 = m[0 * 4 + 1];\n        const m02 = m[0 * 4 + 2];\n        const m03 = m[0 * 4 + 3];\n        const m10 = m[1 * 4 + 0];\n        const m11 = m[1 * 4 + 1];\n        const m12 = m[1 * 4 + 2];\n        const m13 = m[1 * 4 + 3];\n        const m20 = m[2 * 4 + 0];\n        const m21 = m[2 * 4 + 1];\n        const m22 = m[2 * 4 + 2];\n        const m23 = m[2 * 4 + 3];\n        const m30 = m[3 * 4 + 0];\n        const m31 = m[3 * 4 + 1];\n        const m32 = m[3 * 4 + 2];\n        const m33 = m[3 * 4 + 3];\n        newDst[0] = m00;\n        newDst[1] = m10;\n        newDst[2] = m20;\n        newDst[3] = m30;\n        newDst[4] = m01;\n        newDst[5] = m11;\n        newDst[6] = m21;\n        newDst[7] = m31;\n        newDst[8] = m02;\n        newDst[9] = m12;\n        newDst[10] = m22;\n        newDst[11] = m32;\n        newDst[12] = m03;\n        newDst[13] = m13;\n        newDst[14] = m23;\n        newDst[15] = m33;\n        return newDst;\n    }\n    /**\n     * Computes the inverse of a 4-by-4 matrix.\n     * @param m - The matrix.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The inverse of m.\n     */\n    function inverse(m, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const m00 = m[0 * 4 + 0];\n        const m01 = m[0 * 4 + 1];\n        const m02 = m[0 * 4 + 2];\n        const m03 = m[0 * 4 + 3];\n        const m10 = m[1 * 4 + 0];\n        const m11 = m[1 * 4 + 1];\n        const m12 = m[1 * 4 + 2];\n        const m13 = m[1 * 4 + 3];\n        const m20 = m[2 * 4 + 0];\n        const m21 = m[2 * 4 + 1];\n        const m22 = m[2 * 4 + 2];\n        const m23 = m[2 * 4 + 3];\n        const m30 = m[3 * 4 + 0];\n        const m31 = m[3 * 4 + 1];\n        const m32 = m[3 * 4 + 2];\n        const m33 = m[3 * 4 + 3];\n        const tmp0 = m22 * m33;\n        const tmp1 = m32 * m23;\n        const tmp2 = m12 * m33;\n        const tmp3 = m32 * m13;\n        const tmp4 = m12 * m23;\n        const tmp5 = m22 * m13;\n        const tmp6 = m02 * m33;\n        const tmp7 = m32 * m03;\n        const tmp8 = m02 * m23;\n        const tmp9 = m22 * m03;\n        const tmp10 = m02 * m13;\n        const tmp11 = m12 * m03;\n        const tmp12 = m20 * m31;\n        const tmp13 = m30 * m21;\n        const tmp14 = m10 * m31;\n        const tmp15 = m30 * m11;\n        const tmp16 = m10 * m21;\n        const tmp17 = m20 * m11;\n        const tmp18 = m00 * m31;\n        const tmp19 = m30 * m01;\n        const tmp20 = m00 * m21;\n        const tmp21 = m20 * m01;\n        const tmp22 = m00 * m11;\n        const tmp23 = m10 * m01;\n        const t0 = (tmp0 * m11 + tmp3 * m21 + tmp4 * m31) -\n            (tmp1 * m11 + tmp2 * m21 + tmp5 * m31);\n        const t1 = (tmp1 * m01 + tmp6 * m21 + tmp9 * m31) -\n            (tmp0 * m01 + tmp7 * m21 + tmp8 * m31);\n        const t2 = (tmp2 * m01 + tmp7 * m11 + tmp10 * m31) -\n            (tmp3 * m01 + tmp6 * m11 + tmp11 * m31);\n        const t3 = (tmp5 * m01 + tmp8 * m11 + tmp11 * m21) -\n            (tmp4 * m01 + tmp9 * m11 + tmp10 * m21);\n        const d = 1 / (m00 * t0 + m10 * t1 + m20 * t2 + m30 * t3);\n        newDst[0] = d * t0;\n        newDst[1] = d * t1;\n        newDst[2] = d * t2;\n        newDst[3] = d * t3;\n        newDst[4] = d * ((tmp1 * m10 + tmp2 * m20 + tmp5 * m30) -\n            (tmp0 * m10 + tmp3 * m20 + tmp4 * m30));\n        newDst[5] = d * ((tmp0 * m00 + tmp7 * m20 + tmp8 * m30) -\n            (tmp1 * m00 + tmp6 * m20 + tmp9 * m30));\n        newDst[6] = d * ((tmp3 * m00 + tmp6 * m10 + tmp11 * m30) -\n            (tmp2 * m00 + tmp7 * m10 + tmp10 * m30));\n        newDst[7] = d * ((tmp4 * m00 + tmp9 * m10 + tmp10 * m20) -\n            (tmp5 * m00 + tmp8 * m10 + tmp11 * m20));\n        newDst[8] = d * ((tmp12 * m13 + tmp15 * m23 + tmp16 * m33) -\n            (tmp13 * m13 + tmp14 * m23 + tmp17 * m33));\n        newDst[9] = d * ((tmp13 * m03 + tmp18 * m23 + tmp21 * m33) -\n            (tmp12 * m03 + tmp19 * m23 + tmp20 * m33));\n        newDst[10] = d * ((tmp14 * m03 + tmp19 * m13 + tmp22 * m33) -\n            (tmp15 * m03 + tmp18 * m13 + tmp23 * m33));\n        newDst[11] = d * ((tmp17 * m03 + tmp20 * m13 + tmp23 * m23) -\n            (tmp16 * m03 + tmp21 * m13 + tmp22 * m23));\n        newDst[12] = d * ((tmp14 * m22 + tmp17 * m32 + tmp13 * m12) -\n            (tmp16 * m32 + tmp12 * m12 + tmp15 * m22));\n        newDst[13] = d * ((tmp20 * m32 + tmp12 * m02 + tmp19 * m22) -\n            (tmp18 * m22 + tmp21 * m32 + tmp13 * m02));\n        newDst[14] = d * ((tmp18 * m12 + tmp23 * m32 + tmp15 * m02) -\n            (tmp22 * m32 + tmp14 * m02 + tmp19 * m12));\n        newDst[15] = d * ((tmp22 * m22 + tmp16 * m02 + tmp21 * m12) -\n            (tmp20 * m12 + tmp23 * m22 + tmp17 * m02));\n        return newDst;\n    }\n    /**\n     * Compute the determinant of a matrix\n     * @param m - the matrix\n     * @returns the determinant\n     */\n    function determinant(m) {\n        const m00 = m[0 * 4 + 0];\n        const m01 = m[0 * 4 + 1];\n        const m02 = m[0 * 4 + 2];\n        const m03 = m[0 * 4 + 3];\n        const m10 = m[1 * 4 + 0];\n        const m11 = m[1 * 4 + 1];\n        const m12 = m[1 * 4 + 2];\n        const m13 = m[1 * 4 + 3];\n        const m20 = m[2 * 4 + 0];\n        const m21 = m[2 * 4 + 1];\n        const m22 = m[2 * 4 + 2];\n        const m23 = m[2 * 4 + 3];\n        const m30 = m[3 * 4 + 0];\n        const m31 = m[3 * 4 + 1];\n        const m32 = m[3 * 4 + 2];\n        const m33 = m[3 * 4 + 3];\n        const tmp0 = m22 * m33;\n        const tmp1 = m32 * m23;\n        const tmp2 = m12 * m33;\n        const tmp3 = m32 * m13;\n        const tmp4 = m12 * m23;\n        const tmp5 = m22 * m13;\n        const tmp6 = m02 * m33;\n        const tmp7 = m32 * m03;\n        const tmp8 = m02 * m23;\n        const tmp9 = m22 * m03;\n        const tmp10 = m02 * m13;\n        const tmp11 = m12 * m03;\n        const t0 = (tmp0 * m11 + tmp3 * m21 + tmp4 * m31) -\n            (tmp1 * m11 + tmp2 * m21 + tmp5 * m31);\n        const t1 = (tmp1 * m01 + tmp6 * m21 + tmp9 * m31) -\n            (tmp0 * m01 + tmp7 * m21 + tmp8 * m31);\n        const t2 = (tmp2 * m01 + tmp7 * m11 + tmp10 * m31) -\n            (tmp3 * m01 + tmp6 * m11 + tmp11 * m31);\n        const t3 = (tmp5 * m01 + tmp8 * m11 + tmp11 * m21) -\n            (tmp4 * m01 + tmp9 * m11 + tmp10 * m21);\n        return m00 * t0 + m10 * t1 + m20 * t2 + m30 * t3;\n    }\n    /**\n     * Computes the inverse of a 4-by-4 matrix. (same as inverse)\n     * @param m - The matrix.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The inverse of m.\n     */\n    const invert = inverse;\n    /**\n     * Multiplies two 4-by-4 matrices with a on the left and b on the right\n     * @param a - The matrix on the left.\n     * @param b - The matrix on the right.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The matrix product of a and b.\n     */\n    function multiply(a, b, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a03 = a[3];\n        const a10 = a[4 + 0];\n        const a11 = a[4 + 1];\n        const a12 = a[4 + 2];\n        const a13 = a[4 + 3];\n        const a20 = a[8 + 0];\n        const a21 = a[8 + 1];\n        const a22 = a[8 + 2];\n        const a23 = a[8 + 3];\n        const a30 = a[12 + 0];\n        const a31 = a[12 + 1];\n        const a32 = a[12 + 2];\n        const a33 = a[12 + 3];\n        const b00 = b[0];\n        const b01 = b[1];\n        const b02 = b[2];\n        const b03 = b[3];\n        const b10 = b[4 + 0];\n        const b11 = b[4 + 1];\n        const b12 = b[4 + 2];\n        const b13 = b[4 + 3];\n        const b20 = b[8 + 0];\n        const b21 = b[8 + 1];\n        const b22 = b[8 + 2];\n        const b23 = b[8 + 3];\n        const b30 = b[12 + 0];\n        const b31 = b[12 + 1];\n        const b32 = b[12 + 2];\n        const b33 = b[12 + 3];\n        newDst[0] = a00 * b00 + a10 * b01 + a20 * b02 + a30 * b03;\n        newDst[1] = a01 * b00 + a11 * b01 + a21 * b02 + a31 * b03;\n        newDst[2] = a02 * b00 + a12 * b01 + a22 * b02 + a32 * b03;\n        newDst[3] = a03 * b00 + a13 * b01 + a23 * b02 + a33 * b03;\n        newDst[4] = a00 * b10 + a10 * b11 + a20 * b12 + a30 * b13;\n        newDst[5] = a01 * b10 + a11 * b11 + a21 * b12 + a31 * b13;\n        newDst[6] = a02 * b10 + a12 * b11 + a22 * b12 + a32 * b13;\n        newDst[7] = a03 * b10 + a13 * b11 + a23 * b12 + a33 * b13;\n        newDst[8] = a00 * b20 + a10 * b21 + a20 * b22 + a30 * b23;\n        newDst[9] = a01 * b20 + a11 * b21 + a21 * b22 + a31 * b23;\n        newDst[10] = a02 * b20 + a12 * b21 + a22 * b22 + a32 * b23;\n        newDst[11] = a03 * b20 + a13 * b21 + a23 * b22 + a33 * b23;\n        newDst[12] = a00 * b30 + a10 * b31 + a20 * b32 + a30 * b33;\n        newDst[13] = a01 * b30 + a11 * b31 + a21 * b32 + a31 * b33;\n        newDst[14] = a02 * b30 + a12 * b31 + a22 * b32 + a32 * b33;\n        newDst[15] = a03 * b30 + a13 * b31 + a23 * b32 + a33 * b33;\n        return newDst;\n    }\n    /**\n     * Multiplies two 4-by-4 matrices with a on the left and b on the right (same as multiply)\n     * @param a - The matrix on the left.\n     * @param b - The matrix on the right.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The matrix product of a and b.\n     */\n    const mul = multiply;\n    /**\n     * Sets the translation component of a 4-by-4 matrix to the given\n     * vector.\n     * @param a - The matrix.\n     * @param v - The vector.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The matrix with translation set.\n     */\n    function setTranslation(a, v, dst) {\n        const newDst = (dst ?? identity());\n        if (a !== newDst) {\n            newDst[0] = a[0];\n            newDst[1] = a[1];\n            newDst[2] = a[2];\n            newDst[3] = a[3];\n            newDst[4] = a[4];\n            newDst[5] = a[5];\n            newDst[6] = a[6];\n            newDst[7] = a[7];\n            newDst[8] = a[8];\n            newDst[9] = a[9];\n            newDst[10] = a[10];\n            newDst[11] = a[11];\n        }\n        newDst[12] = v[0];\n        newDst[13] = v[1];\n        newDst[14] = v[2];\n        newDst[15] = 1;\n        return newDst;\n    }\n    ///**\n    // * Returns the translation component of a 4-by-4 matrix as a vector with 3\n    // * entries.\n    // * @param m - The matrix.\n    // * @param dst - vector to hold result. If not passed a new one is created.\n    // * @returns The translation component of m.\n    // */\n    function getTranslation(m, dst) {\n        const newDst = (dst ?? vec3.create());\n        newDst[0] = m[12];\n        newDst[1] = m[13];\n        newDst[2] = m[14];\n        return newDst;\n    }\n    /**\n     * Returns an axis of a 4x4 matrix as a vector with 3 entries\n     * @param m - The matrix.\n     * @param axis - The axis 0 = x, 1 = y, 2 = z;\n     * @returns The axis component of m.\n     */\n    function getAxis(m, axis, dst) {\n        const newDst = (dst ?? vec3.create());\n        const off = axis * 4;\n        newDst[0] = m[off + 0];\n        newDst[1] = m[off + 1];\n        newDst[2] = m[off + 2];\n        return newDst;\n    }\n    /**\n     * Sets an axis of a 4x4 matrix as a vector with 3 entries\n     * @param m - The matrix.\n     * @param v - the axis vector\n     * @param axis - The axis  0 = x, 1 = y, 2 = z;\n     * @param dst - The matrix to set. If not passed a new one is created.\n     * @returns The matrix with axis set.\n     */\n    function setAxis(m, v, axis, dst) {\n        const newDst = (dst === m) ? dst : copy(m, dst);\n        const off = axis * 4;\n        newDst[off + 0] = v[0];\n        newDst[off + 1] = v[1];\n        newDst[off + 2] = v[2];\n        return newDst;\n    }\n    /**\n     * Returns the \"3d\" scaling component of the matrix\n     * @param m - The Matrix\n     * @param dst - The vector to set. If not passed a new one is created.\n     */\n    function getScaling(m, dst) {\n        const newDst = (dst ?? vec3.create());\n        const xx = m[0];\n        const xy = m[1];\n        const xz = m[2];\n        const yx = m[4];\n        const yy = m[5];\n        const yz = m[6];\n        const zx = m[8];\n        const zy = m[9];\n        const zz = m[10];\n        newDst[0] = Math.sqrt(xx * xx + xy * xy + xz * xz);\n        newDst[1] = Math.sqrt(yx * yx + yy * yy + yz * yz);\n        newDst[2] = Math.sqrt(zx * zx + zy * zy + zz * zz);\n        return newDst;\n    }\n    /**\n     * Computes a 4-by-4 perspective transformation matrix given the angular height\n     * of the frustum, the aspect ratio, and the near and far clipping planes.  The\n     * arguments define a frustum extending in the negative z direction.  The given\n     * angle is the vertical angle of the frustum, and the horizontal angle is\n     * determined to produce the given aspect ratio.  The arguments near and far are\n     * the distances to the near and far clipping planes.  Note that near and far\n     * are not z coordinates, but rather they are distances along the negative\n     * z-axis.  The matrix generated sends the viewing frustum to the unit box.\n     * We assume a unit box extending from -1 to 1 in the x and y dimensions and\n     * from 0 to 1 in the z dimension.\n     *\n     * Note: If you pass `Infinity` for zFar then it will produce a projection matrix\n     * returns -Infinity for Z when transforming coordinates with Z <= 0 and +Infinity for Z\n     * otherwise.\n     *\n     * @param fieldOfViewYInRadians - The camera angle from top to bottom (in radians).\n     * @param aspect - The aspect ratio width / height.\n     * @param zNear - The depth (negative z coordinate)\n     *     of the near clipping plane.\n     * @param zFar - The depth (negative z coordinate)\n     *     of the far clipping plane.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The perspective matrix.\n     */\n    function perspective(fieldOfViewYInRadians, aspect, zNear, zFar, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const f = Math.tan(Math.PI * 0.5 - 0.5 * fieldOfViewYInRadians);\n        newDst[0] = f / aspect;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[3] = 0;\n        newDst[4] = 0;\n        newDst[5] = f;\n        newDst[6] = 0;\n        newDst[7] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[11] = -1;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[15] = 0;\n        if (Number.isFinite(zFar)) {\n            const rangeInv = 1 / (zNear - zFar);\n            newDst[10] = zFar * rangeInv;\n            newDst[14] = zFar * zNear * rangeInv;\n        }\n        else {\n            newDst[10] = -1;\n            newDst[14] = -zNear;\n        }\n        return newDst;\n    }\n    /**\n     * Computes a 4-by-4 reverse-z perspective transformation matrix given the angular height\n     * of the frustum, the aspect ratio, and the near and far clipping planes.  The\n     * arguments define a frustum extending in the negative z direction.  The given\n     * angle is the vertical angle of the frustum, and the horizontal angle is\n     * determined to produce the given aspect ratio.  The arguments near and far are\n     * the distances to the near and far clipping planes.  Note that near and far\n     * are not z coordinates, but rather they are distances along the negative\n     * z-axis.  The matrix generated sends the viewing frustum to the unit box.\n     * We assume a unit box extending from -1 to 1 in the x and y dimensions and\n     * from 1 (at -zNear) to 0 (at -zFar) in the z dimension.\n     *\n     * @param fieldOfViewYInRadians - The camera angle from top to bottom (in radians).\n     * @param aspect - The aspect ratio width / height.\n     * @param zNear - The depth (negative z coordinate)\n     *     of the near clipping plane.\n     * @param zFar - The depth (negative z coordinate)\n     *     of the far clipping plane. (default = Infinity)\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The perspective matrix.\n     */ function perspectiveReverseZ(fieldOfViewYInRadians, aspect, zNear, zFar = Infinity, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const f = 1 / Math.tan(fieldOfViewYInRadians * 0.5);\n        newDst[0] = f / aspect;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[3] = 0;\n        newDst[4] = 0;\n        newDst[5] = f;\n        newDst[6] = 0;\n        newDst[7] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[11] = -1;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[15] = 0;\n        if (zFar === Infinity) {\n            newDst[10] = 0;\n            newDst[14] = zNear;\n        }\n        else {\n            const rangeInv = 1 / (zFar - zNear);\n            newDst[10] = zNear * rangeInv;\n            newDst[14] = zFar * zNear * rangeInv;\n        }\n        return newDst;\n    }\n    /**\n     * Computes a 4-by-4 orthogonal transformation matrix that transforms from\n     * the given the left, right, bottom, and top dimensions to -1 +1 in x, and y\n     * and 0 to +1 in z.\n     * @param left - Left side of the near clipping plane viewport.\n     * @param right - Right side of the near clipping plane viewport.\n     * @param bottom - Bottom of the near clipping plane viewport.\n     * @param top - Top of the near clipping plane viewport.\n     * @param near - The depth (negative z coordinate)\n     *     of the near clipping plane.\n     * @param far - The depth (negative z coordinate)\n     *     of the far clipping plane.\n     * @param dst - Output matrix. If not passed a new one is created.\n     * @returns The orthographic projection matrix.\n     */\n    function ortho(left, right, bottom, top, near, far, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        newDst[0] = 2 / (right - left);\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[3] = 0;\n        newDst[4] = 0;\n        newDst[5] = 2 / (top - bottom);\n        newDst[6] = 0;\n        newDst[7] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[10] = 1 / (near - far);\n        newDst[11] = 0;\n        newDst[12] = (right + left) / (left - right);\n        newDst[13] = (top + bottom) / (bottom - top);\n        newDst[14] = near / (near - far);\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Computes a 4-by-4 perspective transformation matrix given the left, right,\n     * top, bottom, near and far clipping planes. The arguments define a frustum\n     * extending in the negative z direction. The arguments near and far are the\n     * distances to the near and far clipping planes. Note that near and far are not\n     * z coordinates, but rather they are distances along the negative z-axis. The\n     * matrix generated sends the viewing frustum to the unit box. We assume a unit\n     * box extending from -1 to 1 in the x and y dimensions and from 0 to 1 in the z\n     * dimension.\n     * @param left - The x coordinate of the left plane of the box.\n     * @param right - The x coordinate of the right plane of the box.\n     * @param bottom - The y coordinate of the bottom plane of the box.\n     * @param top - The y coordinate of the right plane of the box.\n     * @param near - The negative z coordinate of the near plane of the box.\n     * @param far - The negative z coordinate of the far plane of the box.\n     * @param dst - Output matrix. If not passed a new one is created.\n     * @returns The perspective projection matrix.\n     */\n    function frustum(left, right, bottom, top, near, far, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const dx = (right - left);\n        const dy = (top - bottom);\n        const dz = (near - far);\n        newDst[0] = 2 * near / dx;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[3] = 0;\n        newDst[4] = 0;\n        newDst[5] = 2 * near / dy;\n        newDst[6] = 0;\n        newDst[7] = 0;\n        newDst[8] = (left + right) / dx;\n        newDst[9] = (top + bottom) / dy;\n        newDst[10] = far / dz;\n        newDst[11] = -1;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[14] = near * far / dz;\n        newDst[15] = 0;\n        return newDst;\n    }\n    /**\n     * Computes a 4-by-4 reverse-z perspective transformation matrix given the left, right,\n     * top, bottom, near and far clipping planes. The arguments define a frustum\n     * extending in the negative z direction. The arguments near and far are the\n     * distances to the near and far clipping planes. Note that near and far are not\n     * z coordinates, but rather they are distances along the negative z-axis. The\n     * matrix generated sends the viewing frustum to the unit box. We assume a unit\n     * box extending from -1 to 1 in the x and y dimensions and from 1 (-near) to 0 (-far) in the z\n     * dimension.\n     * @param left - The x coordinate of the left plane of the box.\n     * @param right - The x coordinate of the right plane of the box.\n     * @param bottom - The y coordinate of the bottom plane of the box.\n     * @param top - The y coordinate of the right plane of the box.\n     * @param near - The negative z coordinate of the near plane of the box.\n     * @param far - The negative z coordinate of the far plane of the box.\n     * @param dst - Output matrix. If not passed a new one is created.\n     * @returns The perspective projection matrix.\n     */\n    function frustumReverseZ(left, right, bottom, top, near, far = Infinity, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const dx = (right - left);\n        const dy = (top - bottom);\n        newDst[0] = 2 * near / dx;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[3] = 0;\n        newDst[4] = 0;\n        newDst[5] = 2 * near / dy;\n        newDst[6] = 0;\n        newDst[7] = 0;\n        newDst[8] = (left + right) / dx;\n        newDst[9] = (top + bottom) / dy;\n        newDst[11] = -1;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[15] = 0;\n        if (far === Infinity) {\n            newDst[10] = 0;\n            newDst[14] = near;\n        }\n        else {\n            const rangeInv = 1 / (far - near);\n            newDst[10] = near * rangeInv;\n            newDst[14] = far * near * rangeInv;\n        }\n        return newDst;\n    }\n    const xAxis = vec3.create();\n    const yAxis = vec3.create();\n    const zAxis = vec3.create();\n    /**\n     * Computes a 4-by-4 aim transformation.\n     *\n     * This is a matrix which positions an object aiming down positive Z.\n     * toward the target.\n     *\n     * Note: this is **NOT** the inverse of lookAt as lookAt looks at negative Z.\n     *\n     * @param position - The position of the object.\n     * @param target - The position meant to be aimed at.\n     * @param up - A vector pointing up.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The aim matrix.\n     */\n    function aim(position, target, up, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        vec3.normalize(vec3.subtract(target, position, zAxis), zAxis);\n        vec3.normalize(vec3.cross(up, zAxis, xAxis), xAxis);\n        vec3.normalize(vec3.cross(zAxis, xAxis, yAxis), yAxis);\n        newDst[0] = xAxis[0];\n        newDst[1] = xAxis[1];\n        newDst[2] = xAxis[2];\n        newDst[3] = 0;\n        newDst[4] = yAxis[0];\n        newDst[5] = yAxis[1];\n        newDst[6] = yAxis[2];\n        newDst[7] = 0;\n        newDst[8] = zAxis[0];\n        newDst[9] = zAxis[1];\n        newDst[10] = zAxis[2];\n        newDst[11] = 0;\n        newDst[12] = position[0];\n        newDst[13] = position[1];\n        newDst[14] = position[2];\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Computes a 4-by-4 camera aim transformation.\n     *\n     * This is a matrix which positions an object aiming down negative Z.\n     * toward the target.\n     *\n     * Note: this is the inverse of `lookAt`\n     *\n     * @param eye - The position of the object.\n     * @param target - The position meant to be aimed at.\n     * @param up - A vector pointing up.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The aim matrix.\n     */\n    function cameraAim(eye, target, up, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        vec3.normalize(vec3.subtract(eye, target, zAxis), zAxis);\n        vec3.normalize(vec3.cross(up, zAxis, xAxis), xAxis);\n        vec3.normalize(vec3.cross(zAxis, xAxis, yAxis), yAxis);\n        newDst[0] = xAxis[0];\n        newDst[1] = xAxis[1];\n        newDst[2] = xAxis[2];\n        newDst[3] = 0;\n        newDst[4] = yAxis[0];\n        newDst[5] = yAxis[1];\n        newDst[6] = yAxis[2];\n        newDst[7] = 0;\n        newDst[8] = zAxis[0];\n        newDst[9] = zAxis[1];\n        newDst[10] = zAxis[2];\n        newDst[11] = 0;\n        newDst[12] = eye[0];\n        newDst[13] = eye[1];\n        newDst[14] = eye[2];\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Computes a 4-by-4 view transformation.\n     *\n     * This is a view matrix which transforms all other objects\n     * to be in the space of the view defined by the parameters.\n     *\n     * @param eye - The position of the object.\n     * @param target - The position meant to be aimed at.\n     * @param up - A vector pointing up.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The look-at matrix.\n     */\n    function lookAt(eye, target, up, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        vec3.normalize(vec3.subtract(eye, target, zAxis), zAxis);\n        vec3.normalize(vec3.cross(up, zAxis, xAxis), xAxis);\n        vec3.normalize(vec3.cross(zAxis, xAxis, yAxis), yAxis);\n        newDst[0] = xAxis[0];\n        newDst[1] = yAxis[0];\n        newDst[2] = zAxis[0];\n        newDst[3] = 0;\n        newDst[4] = xAxis[1];\n        newDst[5] = yAxis[1];\n        newDst[6] = zAxis[1];\n        newDst[7] = 0;\n        newDst[8] = xAxis[2];\n        newDst[9] = yAxis[2];\n        newDst[10] = zAxis[2];\n        newDst[11] = 0;\n        newDst[12] = -(xAxis[0] * eye[0] + xAxis[1] * eye[1] + xAxis[2] * eye[2]);\n        newDst[13] = -(yAxis[0] * eye[0] + yAxis[1] * eye[1] + yAxis[2] * eye[2]);\n        newDst[14] = -(zAxis[0] * eye[0] + zAxis[1] * eye[1] + zAxis[2] * eye[2]);\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Creates a 4-by-4 matrix which translates by the given vector v.\n     * @param v - The vector by\n     *     which to translate.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The translation matrix.\n     */\n    function translation(v, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        newDst[0] = 1;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[3] = 0;\n        newDst[4] = 0;\n        newDst[5] = 1;\n        newDst[6] = 0;\n        newDst[7] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[10] = 1;\n        newDst[11] = 0;\n        newDst[12] = v[0];\n        newDst[13] = v[1];\n        newDst[14] = v[2];\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Translates the given 4-by-4 matrix by the given vector v.\n     * @param m - The matrix.\n     * @param v - The vector by\n     *     which to translate.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The translated matrix.\n     */\n    function translate(m, v, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        const m00 = m[0];\n        const m01 = m[1];\n        const m02 = m[2];\n        const m03 = m[3];\n        const m10 = m[1 * 4 + 0];\n        const m11 = m[1 * 4 + 1];\n        const m12 = m[1 * 4 + 2];\n        const m13 = m[1 * 4 + 3];\n        const m20 = m[2 * 4 + 0];\n        const m21 = m[2 * 4 + 1];\n        const m22 = m[2 * 4 + 2];\n        const m23 = m[2 * 4 + 3];\n        const m30 = m[3 * 4 + 0];\n        const m31 = m[3 * 4 + 1];\n        const m32 = m[3 * 4 + 2];\n        const m33 = m[3 * 4 + 3];\n        if (m !== newDst) {\n            newDst[0] = m00;\n            newDst[1] = m01;\n            newDst[2] = m02;\n            newDst[3] = m03;\n            newDst[4] = m10;\n            newDst[5] = m11;\n            newDst[6] = m12;\n            newDst[7] = m13;\n            newDst[8] = m20;\n            newDst[9] = m21;\n            newDst[10] = m22;\n            newDst[11] = m23;\n        }\n        newDst[12] = m00 * v0 + m10 * v1 + m20 * v2 + m30;\n        newDst[13] = m01 * v0 + m11 * v1 + m21 * v2 + m31;\n        newDst[14] = m02 * v0 + m12 * v1 + m22 * v2 + m32;\n        newDst[15] = m03 * v0 + m13 * v1 + m23 * v2 + m33;\n        return newDst;\n    }\n    /**\n     * Creates a 4-by-4 matrix which rotates around the x-axis by the given angle.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotation matrix.\n     */\n    function rotationX(angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        newDst[0] = 1;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[3] = 0;\n        newDst[4] = 0;\n        newDst[5] = c;\n        newDst[6] = s;\n        newDst[7] = 0;\n        newDst[8] = 0;\n        newDst[9] = -s;\n        newDst[10] = c;\n        newDst[11] = 0;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[14] = 0;\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Rotates the given 4-by-4 matrix around the x-axis by the given\n     * angle.\n     * @param m - The matrix.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotated matrix.\n     */\n    function rotateX(m, angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const m10 = m[4];\n        const m11 = m[5];\n        const m12 = m[6];\n        const m13 = m[7];\n        const m20 = m[8];\n        const m21 = m[9];\n        const m22 = m[10];\n        const m23 = m[11];\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        newDst[4] = c * m10 + s * m20;\n        newDst[5] = c * m11 + s * m21;\n        newDst[6] = c * m12 + s * m22;\n        newDst[7] = c * m13 + s * m23;\n        newDst[8] = c * m20 - s * m10;\n        newDst[9] = c * m21 - s * m11;\n        newDst[10] = c * m22 - s * m12;\n        newDst[11] = c * m23 - s * m13;\n        if (m !== newDst) {\n            newDst[0] = m[0];\n            newDst[1] = m[1];\n            newDst[2] = m[2];\n            newDst[3] = m[3];\n            newDst[12] = m[12];\n            newDst[13] = m[13];\n            newDst[14] = m[14];\n            newDst[15] = m[15];\n        }\n        return newDst;\n    }\n    /**\n     * Creates a 4-by-4 matrix which rotates around the y-axis by the given angle.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotation matrix.\n     */\n    function rotationY(angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        newDst[0] = c;\n        newDst[1] = 0;\n        newDst[2] = -s;\n        newDst[3] = 0;\n        newDst[4] = 0;\n        newDst[5] = 1;\n        newDst[6] = 0;\n        newDst[7] = 0;\n        newDst[8] = s;\n        newDst[9] = 0;\n        newDst[10] = c;\n        newDst[11] = 0;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[14] = 0;\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Rotates the given 4-by-4 matrix around the y-axis by the given\n     * angle.\n     * @param m - The matrix.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotated matrix.\n     */\n    function rotateY(m, angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const m00 = m[0 * 4 + 0];\n        const m01 = m[0 * 4 + 1];\n        const m02 = m[0 * 4 + 2];\n        const m03 = m[0 * 4 + 3];\n        const m20 = m[2 * 4 + 0];\n        const m21 = m[2 * 4 + 1];\n        const m22 = m[2 * 4 + 2];\n        const m23 = m[2 * 4 + 3];\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        newDst[0] = c * m00 - s * m20;\n        newDst[1] = c * m01 - s * m21;\n        newDst[2] = c * m02 - s * m22;\n        newDst[3] = c * m03 - s * m23;\n        newDst[8] = c * m20 + s * m00;\n        newDst[9] = c * m21 + s * m01;\n        newDst[10] = c * m22 + s * m02;\n        newDst[11] = c * m23 + s * m03;\n        if (m !== newDst) {\n            newDst[4] = m[4];\n            newDst[5] = m[5];\n            newDst[6] = m[6];\n            newDst[7] = m[7];\n            newDst[12] = m[12];\n            newDst[13] = m[13];\n            newDst[14] = m[14];\n            newDst[15] = m[15];\n        }\n        return newDst;\n    }\n    /**\n     * Creates a 4-by-4 matrix which rotates around the z-axis by the given angle.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotation matrix.\n     */\n    function rotationZ(angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        newDst[0] = c;\n        newDst[1] = s;\n        newDst[2] = 0;\n        newDst[3] = 0;\n        newDst[4] = -s;\n        newDst[5] = c;\n        newDst[6] = 0;\n        newDst[7] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[10] = 1;\n        newDst[11] = 0;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[14] = 0;\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Rotates the given 4-by-4 matrix around the z-axis by the given\n     * angle.\n     * @param m - The matrix.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotated matrix.\n     */\n    function rotateZ(m, angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const m00 = m[0 * 4 + 0];\n        const m01 = m[0 * 4 + 1];\n        const m02 = m[0 * 4 + 2];\n        const m03 = m[0 * 4 + 3];\n        const m10 = m[1 * 4 + 0];\n        const m11 = m[1 * 4 + 1];\n        const m12 = m[1 * 4 + 2];\n        const m13 = m[1 * 4 + 3];\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        newDst[0] = c * m00 + s * m10;\n        newDst[1] = c * m01 + s * m11;\n        newDst[2] = c * m02 + s * m12;\n        newDst[3] = c * m03 + s * m13;\n        newDst[4] = c * m10 - s * m00;\n        newDst[5] = c * m11 - s * m01;\n        newDst[6] = c * m12 - s * m02;\n        newDst[7] = c * m13 - s * m03;\n        if (m !== newDst) {\n            newDst[8] = m[8];\n            newDst[9] = m[9];\n            newDst[10] = m[10];\n            newDst[11] = m[11];\n            newDst[12] = m[12];\n            newDst[13] = m[13];\n            newDst[14] = m[14];\n            newDst[15] = m[15];\n        }\n        return newDst;\n    }\n    /**\n     * Creates a 4-by-4 matrix which rotates around the given axis by the given\n     * angle.\n     * @param axis - The axis\n     *     about which to rotate.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns A matrix which rotates angle radians\n     *     around the axis.\n     */\n    function axisRotation(axis, angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        let x = axis[0];\n        let y = axis[1];\n        let z = axis[2];\n        const n = Math.sqrt(x * x + y * y + z * z);\n        x /= n;\n        y /= n;\n        z /= n;\n        const xx = x * x;\n        const yy = y * y;\n        const zz = z * z;\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        const oneMinusCosine = 1 - c;\n        newDst[0] = xx + (1 - xx) * c;\n        newDst[1] = x * y * oneMinusCosine + z * s;\n        newDst[2] = x * z * oneMinusCosine - y * s;\n        newDst[3] = 0;\n        newDst[4] = x * y * oneMinusCosine - z * s;\n        newDst[5] = yy + (1 - yy) * c;\n        newDst[6] = y * z * oneMinusCosine + x * s;\n        newDst[7] = 0;\n        newDst[8] = x * z * oneMinusCosine + y * s;\n        newDst[9] = y * z * oneMinusCosine - x * s;\n        newDst[10] = zz + (1 - zz) * c;\n        newDst[11] = 0;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[14] = 0;\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Creates a 4-by-4 matrix which rotates around the given axis by the given\n     * angle. (same as axisRotation)\n     * @param axis - The axis\n     *     about which to rotate.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns A matrix which rotates angle radians\n     *     around the axis.\n     */\n    const rotation = axisRotation;\n    /**\n     * Rotates the given 4-by-4 matrix around the given axis by the\n     * given angle.\n     * @param m - The matrix.\n     * @param axis - The axis\n     *     about which to rotate.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotated matrix.\n     */\n    function axisRotate(m, axis, angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        let x = axis[0];\n        let y = axis[1];\n        let z = axis[2];\n        const n = Math.sqrt(x * x + y * y + z * z);\n        x /= n;\n        y /= n;\n        z /= n;\n        const xx = x * x;\n        const yy = y * y;\n        const zz = z * z;\n        const c = Math.cos(angleInRadians);\n        const s = Math.sin(angleInRadians);\n        const oneMinusCosine = 1 - c;\n        const r00 = xx + (1 - xx) * c;\n        const r01 = x * y * oneMinusCosine + z * s;\n        const r02 = x * z * oneMinusCosine - y * s;\n        const r10 = x * y * oneMinusCosine - z * s;\n        const r11 = yy + (1 - yy) * c;\n        const r12 = y * z * oneMinusCosine + x * s;\n        const r20 = x * z * oneMinusCosine + y * s;\n        const r21 = y * z * oneMinusCosine - x * s;\n        const r22 = zz + (1 - zz) * c;\n        const m00 = m[0];\n        const m01 = m[1];\n        const m02 = m[2];\n        const m03 = m[3];\n        const m10 = m[4];\n        const m11 = m[5];\n        const m12 = m[6];\n        const m13 = m[7];\n        const m20 = m[8];\n        const m21 = m[9];\n        const m22 = m[10];\n        const m23 = m[11];\n        newDst[0] = r00 * m00 + r01 * m10 + r02 * m20;\n        newDst[1] = r00 * m01 + r01 * m11 + r02 * m21;\n        newDst[2] = r00 * m02 + r01 * m12 + r02 * m22;\n        newDst[3] = r00 * m03 + r01 * m13 + r02 * m23;\n        newDst[4] = r10 * m00 + r11 * m10 + r12 * m20;\n        newDst[5] = r10 * m01 + r11 * m11 + r12 * m21;\n        newDst[6] = r10 * m02 + r11 * m12 + r12 * m22;\n        newDst[7] = r10 * m03 + r11 * m13 + r12 * m23;\n        newDst[8] = r20 * m00 + r21 * m10 + r22 * m20;\n        newDst[9] = r20 * m01 + r21 * m11 + r22 * m21;\n        newDst[10] = r20 * m02 + r21 * m12 + r22 * m22;\n        newDst[11] = r20 * m03 + r21 * m13 + r22 * m23;\n        if (m !== newDst) {\n            newDst[12] = m[12];\n            newDst[13] = m[13];\n            newDst[14] = m[14];\n            newDst[15] = m[15];\n        }\n        return newDst;\n    }\n    /**\n     * Rotates the given 4-by-4 matrix around the given axis by the\n     * given angle. (same as rotate)\n     * @param m - The matrix.\n     * @param axis - The axis\n     *     about which to rotate.\n     * @param angleInRadians - The angle by which to rotate (in radians).\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The rotated matrix.\n     */\n    const rotate = axisRotate;\n    /**\n     * Creates a 4-by-4 matrix which scales in each dimension by an amount given by\n     * the corresponding entry in the given vector; assumes the vector has three\n     * entries.\n     * @param v - A vector of\n     *     three entries specifying the factor by which to scale in each dimension.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The scaling matrix.\n     */\n    function scaling(v, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        newDst[0] = v[0];\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[3] = 0;\n        newDst[4] = 0;\n        newDst[5] = v[1];\n        newDst[6] = 0;\n        newDst[7] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[10] = v[2];\n        newDst[11] = 0;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[14] = 0;\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Scales the given 4-by-4 matrix in each dimension by an amount\n     * given by the corresponding entry in the given vector; assumes the vector has\n     * three entries.\n     * @param m - The matrix to be modified.\n     * @param v - A vector of three entries specifying the\n     *     factor by which to scale in each dimension.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The scaled matrix.\n     */\n    function scale(m, v, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        newDst[0] = v0 * m[0 * 4 + 0];\n        newDst[1] = v0 * m[0 * 4 + 1];\n        newDst[2] = v0 * m[0 * 4 + 2];\n        newDst[3] = v0 * m[0 * 4 + 3];\n        newDst[4] = v1 * m[1 * 4 + 0];\n        newDst[5] = v1 * m[1 * 4 + 1];\n        newDst[6] = v1 * m[1 * 4 + 2];\n        newDst[7] = v1 * m[1 * 4 + 3];\n        newDst[8] = v2 * m[2 * 4 + 0];\n        newDst[9] = v2 * m[2 * 4 + 1];\n        newDst[10] = v2 * m[2 * 4 + 2];\n        newDst[11] = v2 * m[2 * 4 + 3];\n        if (m !== newDst) {\n            newDst[12] = m[12];\n            newDst[13] = m[13];\n            newDst[14] = m[14];\n            newDst[15] = m[15];\n        }\n        return newDst;\n    }\n    /**\n     * Creates a 4-by-4 matrix which scales a uniform amount in each dimension.\n     * @param s - the amount to scale\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The scaling matrix.\n     */\n    function uniformScaling(s, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        newDst[0] = s;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[3] = 0;\n        newDst[4] = 0;\n        newDst[5] = s;\n        newDst[6] = 0;\n        newDst[7] = 0;\n        newDst[8] = 0;\n        newDst[9] = 0;\n        newDst[10] = s;\n        newDst[11] = 0;\n        newDst[12] = 0;\n        newDst[13] = 0;\n        newDst[14] = 0;\n        newDst[15] = 1;\n        return newDst;\n    }\n    /**\n     * Scales the given 4-by-4 matrix in each dimension by a uniform scale.\n     * @param m - The matrix to be modified.\n     * @param s - The amount to scale.\n     * @param dst - matrix to hold result. If not passed a new one is created.\n     * @returns The scaled matrix.\n     */\n    function uniformScale(m, s, dst) {\n        const newDst = (dst ?? new Ctor(16));\n        newDst[0] = s * m[0 * 4 + 0];\n        newDst[1] = s * m[0 * 4 + 1];\n        newDst[2] = s * m[0 * 4 + 2];\n        newDst[3] = s * m[0 * 4 + 3];\n        newDst[4] = s * m[1 * 4 + 0];\n        newDst[5] = s * m[1 * 4 + 1];\n        newDst[6] = s * m[1 * 4 + 2];\n        newDst[7] = s * m[1 * 4 + 3];\n        newDst[8] = s * m[2 * 4 + 0];\n        newDst[9] = s * m[2 * 4 + 1];\n        newDst[10] = s * m[2 * 4 + 2];\n        newDst[11] = s * m[2 * 4 + 3];\n        if (m !== newDst) {\n            newDst[12] = m[12];\n            newDst[13] = m[13];\n            newDst[14] = m[14];\n            newDst[15] = m[15];\n        }\n        return newDst;\n    }\n    return {\n        add,\n        aim,\n        axisRotate,\n        axisRotation,\n        cameraAim,\n        clone,\n        copy,\n        create,\n        determinant,\n        equals,\n        equalsApproximately,\n        fromMat3,\n        fromQuat,\n        frustum,\n        frustumReverseZ,\n        getAxis,\n        getScaling,\n        getTranslation,\n        identity,\n        inverse,\n        invert,\n        lookAt,\n        mul,\n        mulScalar,\n        multiply,\n        multiplyScalar,\n        negate,\n        ortho,\n        perspective,\n        perspectiveReverseZ,\n        rotate,\n        rotateX,\n        rotateY,\n        rotateZ,\n        rotation,\n        rotationX,\n        rotationY,\n        rotationZ,\n        scale,\n        scaling,\n        set,\n        setAxis,\n        setTranslation,\n        translate,\n        translation,\n        transpose,\n        uniformScale,\n        uniformScaling,\n    };\n}\nconst cache$2 = new Map();\nfunction getAPI$2(Ctor) {\n    let api = cache$2.get(Ctor);\n    if (!api) {\n        api = getAPIImpl$2(Ctor);\n        cache$2.set(Ctor, api);\n    }\n    return api;\n}\n\n/*\n * Copyright 2022 Gregg Tavares\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL\n * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n * Generates am typed API for Qud\n * */\nfunction getAPIImpl$1(Ctor) {\n    const vec3 = getAPI$4(Ctor);\n    /**\n     * Creates a quat4; may be called with x, y, z to set initial values.\n     * @param x - Initial x value.\n     * @param y - Initial y value.\n     * @param z - Initial z value.\n     * @param w - Initial w value.\n     * @returns the created vector\n     */\n    function create(x, y, z, w) {\n        const newDst = new Ctor(4);\n        if (x !== undefined) {\n            newDst[0] = x;\n            if (y !== undefined) {\n                newDst[1] = y;\n                if (z !== undefined) {\n                    newDst[2] = z;\n                    if (w !== undefined) {\n                        newDst[3] = w;\n                    }\n                }\n            }\n        }\n        return newDst;\n    }\n    /**\n     * Creates a Quat; may be called with x, y, z to set initial values. (same as create)\n     * @param x - Initial x value.\n     * @param y - Initial y value.\n     * @param z - Initial z value.\n     * @param z - Initial w value.\n     * @returns the created vector\n     */\n    const fromValues = create;\n    /**\n     * Sets the values of a Quat\n     * Also see {@link quat.create} and {@link quat.copy}\n     *\n     * @param x first value\n     * @param y second value\n     * @param z third value\n     * @param w fourth value\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector with its elements set.\n     */\n    function set(x, y, z, w, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = x;\n        newDst[1] = y;\n        newDst[2] = z;\n        newDst[3] = w;\n        return newDst;\n    }\n    /**\n     * Sets a quaternion from the given angle and  axis,\n     * then returns it.\n     *\n     * @param axis - the axis to rotate around\n     * @param angleInRadians - the angle\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns The quaternion that represents the given axis and angle\n     **/\n    function fromAxisAngle(axis, angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        const halfAngle = angleInRadians * 0.5;\n        const s = Math.sin(halfAngle);\n        newDst[0] = s * axis[0];\n        newDst[1] = s * axis[1];\n        newDst[2] = s * axis[2];\n        newDst[3] = Math.cos(halfAngle);\n        return newDst;\n    }\n    /**\n     * Gets the rotation axis and angle\n     * @param q - quaternion to compute from\n     * @param dst - Vec3 to hold result. If not passed in a new one is created.\n     * @return angle and axis\n     */\n    function toAxisAngle(q, dst) {\n        const newDst = (dst ?? vec3.create(3));\n        const angle = Math.acos(q[3]) * 2;\n        const s = Math.sin(angle * 0.5);\n        if (s > EPSILON) {\n            newDst[0] = q[0] / s;\n            newDst[1] = q[1] / s;\n            newDst[2] = q[2] / s;\n        }\n        else {\n            newDst[0] = 1;\n            newDst[1] = 0;\n            newDst[2] = 0;\n        }\n        return { angle, axis: newDst };\n    }\n    /**\n     * Returns the angle in degrees between two rotations a and b.\n     * @param a - quaternion a\n     * @param b - quaternion b\n     * @return angle in radians between the two quaternions\n     */\n    function angle(a, b) {\n        const d = dot(a, b);\n        return Math.acos(2 * d * d - 1);\n    }\n    /**\n     * Multiplies two quaternions\n     *\n     * @param a - the first quaternion\n     * @param b - the second quaternion\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns A quaternion that is the result of a * b\n     */\n    function multiply(a, b, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        const bx = b[0];\n        const by = b[1];\n        const bz = b[2];\n        const bw = b[3];\n        newDst[0] = ax * bw + aw * bx + ay * bz - az * by;\n        newDst[1] = ay * bw + aw * by + az * bx - ax * bz;\n        newDst[2] = az * bw + aw * bz + ax * by - ay * bx;\n        newDst[3] = aw * bw - ax * bx - ay * by - az * bz;\n        return newDst;\n    }\n    /**\n     * Multiplies two quaternions\n     *\n     * @param a - the first quaternion\n     * @param b - the second quaternion\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns A quaternion that is the result of a * b\n     */\n    const mul = multiply;\n    /**\n     * Rotates the given quaternion around the X axis by the given angle.\n     * @param q - quaternion to rotate\n     * @param angleInRadians - The angle by which to rotate\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns A quaternion that is the result of a * b\n     */\n    function rotateX(q, angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        const halfAngle = angleInRadians * 0.5;\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const qw = q[3];\n        const bx = Math.sin(halfAngle);\n        const bw = Math.cos(halfAngle);\n        newDst[0] = qx * bw + qw * bx;\n        newDst[1] = qy * bw + qz * bx;\n        newDst[2] = qz * bw - qy * bx;\n        newDst[3] = qw * bw - qx * bx;\n        return newDst;\n    }\n    /**\n     * Rotates the given quaternion around the Y axis by the given angle.\n     * @param q - quaternion to rotate\n     * @param angleInRadians - The angle by which to rotate\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns A quaternion that is the result of a * b\n     */\n    function rotateY(q, angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        const halfAngle = angleInRadians * 0.5;\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const qw = q[3];\n        const by = Math.sin(halfAngle);\n        const bw = Math.cos(halfAngle);\n        newDst[0] = qx * bw - qz * by;\n        newDst[1] = qy * bw + qw * by;\n        newDst[2] = qz * bw + qx * by;\n        newDst[3] = qw * bw - qy * by;\n        return newDst;\n    }\n    /**\n     * Rotates the given quaternion around the Z axis by the given angle.\n     * @param q - quaternion to rotate\n     * @param angleInRadians - The angle by which to rotate\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns A quaternion that is the result of a * b\n     */\n    function rotateZ(q, angleInRadians, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        const halfAngle = angleInRadians * 0.5;\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const qw = q[3];\n        const bz = Math.sin(halfAngle);\n        const bw = Math.cos(halfAngle);\n        newDst[0] = qx * bw + qy * bz;\n        newDst[1] = qy * bw - qx * bz;\n        newDst[2] = qz * bw + qw * bz;\n        newDst[3] = qw * bw - qz * bz;\n        return newDst;\n    }\n    /**\n     * Spherically linear interpolate between two quaternions\n     *\n     * @param a - starting value\n     * @param b - ending value\n     * @param t - value where 0 = a and 1 = b\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns A quaternion that is the result of a * b\n     */\n    function slerp(a, b, t, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        let bx = b[0];\n        let by = b[1];\n        let bz = b[2];\n        let bw = b[3];\n        let cosOmega = ax * bx + ay * by + az * bz + aw * bw;\n        if (cosOmega < 0) {\n            cosOmega = -cosOmega;\n            bx = -bx;\n            by = -by;\n            bz = -bz;\n            bw = -bw;\n        }\n        let scale0;\n        let scale1;\n        if (1.0 - cosOmega > EPSILON) {\n            const omega = Math.acos(cosOmega);\n            const sinOmega = Math.sin(omega);\n            scale0 = Math.sin((1 - t) * omega) / sinOmega;\n            scale1 = Math.sin(t * omega) / sinOmega;\n        }\n        else {\n            scale0 = 1.0 - t;\n            scale1 = t;\n        }\n        newDst[0] = scale0 * ax + scale1 * bx;\n        newDst[1] = scale0 * ay + scale1 * by;\n        newDst[2] = scale0 * az + scale1 * bz;\n        newDst[3] = scale0 * aw + scale1 * bw;\n        return newDst;\n    }\n    /**\n     * Compute the inverse of a quaternion\n     *\n     * @param q - quaternion to compute the inverse of\n     * @returns A quaternion that is the result of a * b\n     */\n    function inverse(q, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        const a0 = q[0];\n        const a1 = q[1];\n        const a2 = q[2];\n        const a3 = q[3];\n        const dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n        const invDot = dot ? 1 / dot : 0;\n        newDst[0] = -a0 * invDot;\n        newDst[1] = -a1 * invDot;\n        newDst[2] = -a2 * invDot;\n        newDst[3] = a3 * invDot;\n        return newDst;\n    }\n    /**\n     * Compute the conjugate of a quaternion\n     * For quaternions with a magnitude of 1 (a unit quaternion)\n     * this returns the same as the inverse but is faster to calculate.\n     *\n     * @param q - quaternion to compute the conjugate of.\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns The conjugate of q\n     */\n    function conjugate(q, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = -q[0];\n        newDst[1] = -q[1];\n        newDst[2] = -q[2];\n        newDst[3] = q[3];\n        return newDst;\n    }\n    /**\n     * Creates a quaternion from the given rotation matrix.\n     *\n     * The created quaternion is not normalized.\n     *\n     * @param m - rotation matrix\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns the result\n     */\n    function fromMat(m, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        /*\n        0 1 2\n        3 4 5\n        6 7 8\n      \n        0 1 2\n        4 5 6\n        8 9 10\n         */\n        // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n        // article \"Quaternion Calculus and Fast Animation\".\n        const trace = m[0] + m[5] + m[10];\n        if (trace > 0.0) {\n            // |w| > 1/2, may as well choose w > 1/2\n            const root = Math.sqrt(trace + 1); // 2w\n            newDst[3] = 0.5 * root;\n            const invRoot = 0.5 / root; // 1/(4w)\n            newDst[0] = (m[6] - m[9]) * invRoot;\n            newDst[1] = (m[8] - m[2]) * invRoot;\n            newDst[2] = (m[1] - m[4]) * invRoot;\n        }\n        else {\n            // |w| <= 1/2\n            let i = 0;\n            if (m[5] > m[0]) {\n                i = 1;\n            }\n            if (m[10] > m[i * 4 + i]) {\n                i = 2;\n            }\n            const j = (i + 1) % 3;\n            const k = (i + 2) % 3;\n            const root = Math.sqrt(m[i * 4 + i] - m[j * 4 + j] - m[k * 4 + k] + 1.0);\n            newDst[i] = 0.5 * root;\n            const invRoot = 0.5 / root;\n            newDst[3] = (m[j * 4 + k] - m[k * 4 + j]) * invRoot;\n            newDst[j] = (m[j * 4 + i] + m[i * 4 + j]) * invRoot;\n            newDst[k] = (m[k * 4 + i] + m[i * 4 + k]) * invRoot;\n        }\n        return newDst;\n    }\n    /**\n     * Creates a quaternion from the given euler angle x, y, z using the provided intrinsic order for the conversion.\n     *\n     * @param xAngleInRadians - angle to rotate around X axis in radians.\n     * @param yAngleInRadians - angle to rotate around Y axis in radians.\n     * @param zAngleInRadians - angle to rotate around Z axis in radians.\n     * @param order - order to apply euler angles\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns A quaternion representing the same rotation as the euler angles applied in the given order\n     */\n    function fromEuler(xAngleInRadians, yAngleInRadians, zAngleInRadians, order, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        const xHalfAngle = xAngleInRadians * 0.5;\n        const yHalfAngle = yAngleInRadians * 0.5;\n        const zHalfAngle = zAngleInRadians * 0.5;\n        const sx = Math.sin(xHalfAngle);\n        const cx = Math.cos(xHalfAngle);\n        const sy = Math.sin(yHalfAngle);\n        const cy = Math.cos(yHalfAngle);\n        const sz = Math.sin(zHalfAngle);\n        const cz = Math.cos(zHalfAngle);\n        switch (order) {\n            case 'xyz':\n                newDst[0] = sx * cy * cz + cx * sy * sz;\n                newDst[1] = cx * sy * cz - sx * cy * sz;\n                newDst[2] = cx * cy * sz + sx * sy * cz;\n                newDst[3] = cx * cy * cz - sx * sy * sz;\n                break;\n            case 'xzy':\n                newDst[0] = sx * cy * cz - cx * sy * sz;\n                newDst[1] = cx * sy * cz - sx * cy * sz;\n                newDst[2] = cx * cy * sz + sx * sy * cz;\n                newDst[3] = cx * cy * cz + sx * sy * sz;\n                break;\n            case 'yxz':\n                newDst[0] = sx * cy * cz + cx * sy * sz;\n                newDst[1] = cx * sy * cz - sx * cy * sz;\n                newDst[2] = cx * cy * sz - sx * sy * cz;\n                newDst[3] = cx * cy * cz + sx * sy * sz;\n                break;\n            case 'yzx':\n                newDst[0] = sx * cy * cz + cx * sy * sz;\n                newDst[1] = cx * sy * cz + sx * cy * sz;\n                newDst[2] = cx * cy * sz - sx * sy * cz;\n                newDst[3] = cx * cy * cz - sx * sy * sz;\n                break;\n            case 'zxy':\n                newDst[0] = sx * cy * cz - cx * sy * sz;\n                newDst[1] = cx * sy * cz + sx * cy * sz;\n                newDst[2] = cx * cy * sz + sx * sy * cz;\n                newDst[3] = cx * cy * cz - sx * sy * sz;\n                break;\n            case 'zyx':\n                newDst[0] = sx * cy * cz - cx * sy * sz;\n                newDst[1] = cx * sy * cz + sx * cy * sz;\n                newDst[2] = cx * cy * sz - sx * sy * cz;\n                newDst[3] = cx * cy * cz + sx * sy * sz;\n                break;\n            default:\n                throw new Error(`Unknown rotation order: ${order}`);\n        }\n        return newDst;\n    }\n    /**\n     * Copies a quaternion. (same as {@link quat.clone})\n     * Also see {@link quat.create} and {@link quat.set}\n     * @param q - The quaternion.\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns A quaternion that is a copy of q\n     */\n    function copy(q, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = q[0];\n        newDst[1] = q[1];\n        newDst[2] = q[2];\n        newDst[3] = q[3];\n        return newDst;\n    }\n    /**\n     * Clones a quaternion. (same as {@link quat.copy})\n     * Also see {@link quat.create} and {@link quat.set}\n     * @param q - The quaternion.\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns A copy of q.\n     */\n    const clone = copy;\n    /**\n     * Adds two quaternions; assumes a and b have the same dimension.\n     * @param a - Operand quaternion.\n     * @param b - Operand quaternion.\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns A quaternion that is the sum of a and b.\n     */\n    function add(a, b, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = a[0] + b[0];\n        newDst[1] = a[1] + b[1];\n        newDst[2] = a[2] + b[2];\n        newDst[3] = a[3] + b[3];\n        return newDst;\n    }\n    /**\n     * Subtracts two quaternions.\n     * @param a - Operand quaternion.\n     * @param b - Operand quaternion.\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns A quaternion that is the difference of a and b.\n     */\n    function subtract(a, b, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = a[0] - b[0];\n        newDst[1] = a[1] - b[1];\n        newDst[2] = a[2] - b[2];\n        newDst[3] = a[3] - b[3];\n        return newDst;\n    }\n    /**\n     * Subtracts two quaternions.\n     * @param a - Operand quaternion.\n     * @param b - Operand quaternion.\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns A quaternion that is the difference of a and b.\n     */\n    const sub = subtract;\n    /**\n     * Multiplies a quaternion by a scalar.\n     * @param v - The quaternion.\n     * @param k - The scalar.\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns The scaled quaternion.\n     */\n    function mulScalar(v, k, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = v[0] * k;\n        newDst[1] = v[1] * k;\n        newDst[2] = v[2] * k;\n        newDst[3] = v[3] * k;\n        return newDst;\n    }\n    /**\n     * Multiplies a quaternion by a scalar. (same as mulScalar)\n     * @param v - The quaternion.\n     * @param k - The scalar.\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns The scaled quaternion.\n     */\n    const scale = mulScalar;\n    /**\n     * Divides a vector by a scalar.\n     * @param v - The vector.\n     * @param k - The scalar.\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns The scaled quaternion.\n     */\n    function divScalar(v, k, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = v[0] / k;\n        newDst[1] = v[1] / k;\n        newDst[2] = v[2] / k;\n        newDst[3] = v[3] / k;\n        return newDst;\n    }\n    /**\n     * Computes the dot product of two quaternions\n     * @param a - Operand quaternion.\n     * @param b - Operand quaternion.\n     * @returns dot product\n     */\n    function dot(a, b) {\n        return (a[0] * b[0]) + (a[1] * b[1]) + (a[2] * b[2]) + (a[3] * b[3]);\n    }\n    /**\n     * Performs linear interpolation on two quaternions.\n     * Given quaternions a and b and interpolation coefficient t, returns\n     * a + t * (b - a).\n     * @param a - Operand quaternion.\n     * @param b - Operand quaternion.\n     * @param t - Interpolation coefficient.\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns The linear interpolated result.\n     */\n    function lerp(a, b, t, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = a[0] + t * (b[0] - a[0]);\n        newDst[1] = a[1] + t * (b[1] - a[1]);\n        newDst[2] = a[2] + t * (b[2] - a[2]);\n        newDst[3] = a[3] + t * (b[3] - a[3]);\n        return newDst;\n    }\n    /**\n     * Computes the length of quaternion\n     * @param v - quaternion.\n     * @returns length of quaternion.\n     */\n    function length(v) {\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        const v3 = v[3];\n        return Math.sqrt(v0 * v0 + v1 * v1 + v2 * v2 + v3 * v3);\n    }\n    /**\n     * Computes the length of quaternion (same as length)\n     * @param v - quaternion.\n     * @returns length of quaternion.\n     */\n    const len = length;\n    /**\n     * Computes the square of the length of quaternion\n     * @param v - quaternion.\n     * @returns square of the length of quaternion.\n     */\n    function lengthSq(v) {\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        const v3 = v[3];\n        return v0 * v0 + v1 * v1 + v2 * v2 + v3 * v3;\n    }\n    /**\n     * Computes the square of the length of quaternion (same as lengthSq)\n     * @param v - quaternion.\n     * @returns square of the length of quaternion.\n     */\n    const lenSq = lengthSq;\n    /**\n     * Divides a quaternion by its Euclidean length and returns the quotient.\n     * @param v - The quaternion.\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns The normalized quaternion.\n     */\n    function normalize(v, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        const v3 = v[3];\n        const len = Math.sqrt(v0 * v0 + v1 * v1 + v2 * v2 + v3 * v3);\n        if (len > 0.00001) {\n            newDst[0] = v0 / len;\n            newDst[1] = v1 / len;\n            newDst[2] = v2 / len;\n            newDst[3] = v3 / len;\n        }\n        else {\n            newDst[0] = 0;\n            newDst[1] = 0;\n            newDst[2] = 0;\n            newDst[3] = 1;\n        }\n        return newDst;\n    }\n    /**\n     * Check if 2 quaternions are approximately equal\n     * @param a - Operand quaternion.\n     * @param b - Operand quaternion.\n     * @returns true if quaternions are approximately equal\n     */\n    function equalsApproximately(a, b) {\n        return Math.abs(a[0] - b[0]) < EPSILON &&\n            Math.abs(a[1] - b[1]) < EPSILON &&\n            Math.abs(a[2] - b[2]) < EPSILON &&\n            Math.abs(a[3] - b[3]) < EPSILON;\n    }\n    /**\n     * Check if 2 quaternions are exactly equal\n     * @param a - Operand quaternion.\n     * @param b - Operand quaternion.\n     * @returns true if quaternions are exactly equal\n     */\n    function equals(a, b) {\n        return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n    }\n    /**\n     * Creates an identity quaternion\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns an identity quaternion\n     */\n    function identity(dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = 0;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[3] = 1;\n        return newDst;\n    }\n    const tempVec3 = vec3.create();\n    const xUnitVec3 = vec3.create();\n    const yUnitVec3 = vec3.create();\n    /**\n     * Computes a quaternion to represent the shortest rotation from one vector to another.\n     *\n     * @param aUnit - the start vector\n     * @param bUnit - the end vector\n     * @param dst - quaternion to hold result. If not passed in a new one is created.\n     * @returns the result\n     */\n    function rotationTo(aUnit, bUnit, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        const dot = vec3.dot(aUnit, bUnit);\n        if (dot < -0.999999) {\n            vec3.cross(xUnitVec3, aUnit, tempVec3);\n            if (vec3.len(tempVec3) < 0.000001) {\n                vec3.cross(yUnitVec3, aUnit, tempVec3);\n            }\n            vec3.normalize(tempVec3, tempVec3);\n            fromAxisAngle(tempVec3, Math.PI, newDst);\n            return newDst;\n        }\n        else if (dot > 0.999999) {\n            newDst[0] = 0;\n            newDst[1] = 0;\n            newDst[2] = 0;\n            newDst[3] = 1;\n            return newDst;\n        }\n        else {\n            vec3.cross(aUnit, bUnit, tempVec3);\n            newDst[0] = tempVec3[0];\n            newDst[1] = tempVec3[1];\n            newDst[2] = tempVec3[2];\n            newDst[3] = 1 + dot;\n            return normalize(newDst, newDst);\n        }\n    }\n    const tempQuat1 = new Ctor(4);\n    const tempQuat2 = new Ctor(4);\n    /**\n     * Performs a spherical linear interpolation with two control points\n     *\n     * @param a - the first quaternion\n     * @param b - the second quaternion\n     * @param c - the third quaternion\n     * @param d - the fourth quaternion\n     * @param t - Interpolation coefficient 0 to 1\n     * @returns result\n     */\n    function sqlerp(a, b, c, d, t, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        slerp(a, d, t, tempQuat1);\n        slerp(b, c, t, tempQuat2);\n        slerp(tempQuat1, tempQuat2, 2 * t * (1 - t), newDst);\n        return newDst;\n    }\n    return {\n        create,\n        fromValues,\n        set,\n        fromAxisAngle,\n        toAxisAngle,\n        angle,\n        multiply,\n        mul,\n        rotateX,\n        rotateY,\n        rotateZ,\n        slerp,\n        inverse,\n        conjugate,\n        fromMat,\n        fromEuler,\n        copy,\n        clone,\n        add,\n        subtract,\n        sub,\n        mulScalar,\n        scale,\n        divScalar,\n        dot,\n        lerp,\n        length,\n        len,\n        lengthSq,\n        lenSq,\n        normalize,\n        equalsApproximately,\n        equals,\n        identity,\n        rotationTo,\n        sqlerp,\n    };\n}\nconst cache$1 = new Map();\n/**\n *\n * Quat4 math functions.\n *\n * Almost all functions take an optional `newDst` argument. If it is not passed in the\n * functions will create a new `Quat4`. In other words you can do this\n *\n *     const v = quat4.cross(v1, v2);  // Creates a new Quat4 with the cross product of v1 x v2.\n *\n * or\n *\n *     const v = quat4.create();\n *     quat4.cross(v1, v2, v);  // Puts the cross product of v1 x v2 in v\n *\n * The first style is often easier but depending on where it's used it generates garbage where\n * as there is almost never allocation with the second style.\n *\n * It is always safe to pass any vector as the destination. So for example\n *\n *     quat4.cross(v1, v2, v1);  // Puts the cross product of v1 x v2 in v1\n *\n */\nfunction getAPI$1(Ctor) {\n    let api = cache$1.get(Ctor);\n    if (!api) {\n        api = getAPIImpl$1(Ctor);\n        cache$1.set(Ctor, api);\n    }\n    return api;\n}\n\n/*\n * Copyright 2022 Gregg Tavares\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL\n * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n * Generates am typed API for Vec4\n * */\nfunction getAPIImpl(Ctor) {\n    /**\n     * Creates a vec4; may be called with x, y, z to set initial values.\n     * @param x - Initial x value.\n     * @param y - Initial y value.\n     * @param z - Initial z value.\n     * @param w - Initial w value.\n     * @returns the created vector\n     */\n    function create(x, y, z, w) {\n        const newDst = new Ctor(4);\n        if (x !== undefined) {\n            newDst[0] = x;\n            if (y !== undefined) {\n                newDst[1] = y;\n                if (z !== undefined) {\n                    newDst[2] = z;\n                    if (w !== undefined) {\n                        newDst[3] = w;\n                    }\n                }\n            }\n        }\n        return newDst;\n    }\n    /**\n     * Creates a vec4; may be called with x, y, z to set initial values. (same as create)\n     * @param x - Initial x value.\n     * @param y - Initial y value.\n     * @param z - Initial z value.\n     * @param z - Initial w value.\n     * @returns the created vector\n     */\n    const fromValues = create;\n    /**\n     * Sets the values of a Vec4\n     * Also see {@link vec4.create} and {@link vec4.copy}\n     *\n     * @param x first value\n     * @param y second value\n     * @param z third value\n     * @param w fourth value\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector with its elements set.\n     */\n    function set(x, y, z, w, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = x;\n        newDst[1] = y;\n        newDst[2] = z;\n        newDst[3] = w;\n        return newDst;\n    }\n    /**\n     * Applies Math.ceil to each element of vector\n     * @param v - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the ceil of each element of v.\n     */\n    function ceil(v, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = Math.ceil(v[0]);\n        newDst[1] = Math.ceil(v[1]);\n        newDst[2] = Math.ceil(v[2]);\n        newDst[3] = Math.ceil(v[3]);\n        return newDst;\n    }\n    /**\n     * Applies Math.floor to each element of vector\n     * @param v - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the floor of each element of v.\n     */\n    function floor(v, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = Math.floor(v[0]);\n        newDst[1] = Math.floor(v[1]);\n        newDst[2] = Math.floor(v[2]);\n        newDst[3] = Math.floor(v[3]);\n        return newDst;\n    }\n    /**\n     * Applies Math.round to each element of vector\n     * @param v - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the round of each element of v.\n     */\n    function round(v, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = Math.round(v[0]);\n        newDst[1] = Math.round(v[1]);\n        newDst[2] = Math.round(v[2]);\n        newDst[3] = Math.round(v[3]);\n        return newDst;\n    }\n    /**\n     * Clamp each element of vector between min and max\n     * @param v - Operand vector.\n     * @param max - Min value, default 0\n     * @param min - Max value, default 1\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that the clamped value of each element of v.\n     */\n    function clamp(v, min = 0, max = 1, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = Math.min(max, Math.max(min, v[0]));\n        newDst[1] = Math.min(max, Math.max(min, v[1]));\n        newDst[2] = Math.min(max, Math.max(min, v[2]));\n        newDst[3] = Math.min(max, Math.max(min, v[3]));\n        return newDst;\n    }\n    /**\n     * Adds two vectors; assumes a and b have the same dimension.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the sum of a and b.\n     */\n    function add(a, b, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = a[0] + b[0];\n        newDst[1] = a[1] + b[1];\n        newDst[2] = a[2] + b[2];\n        newDst[3] = a[3] + b[3];\n        return newDst;\n    }\n    /**\n     * Adds two vectors, scaling the 2nd; assumes a and b have the same dimension.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param scale - Amount to scale b\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the sum of a + b * scale.\n     */\n    function addScaled(a, b, scale, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = a[0] + b[0] * scale;\n        newDst[1] = a[1] + b[1] * scale;\n        newDst[2] = a[2] + b[2] * scale;\n        newDst[3] = a[3] + b[3] * scale;\n        return newDst;\n    }\n    /**\n     * Subtracts two vectors.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the difference of a and b.\n     */\n    function subtract(a, b, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = a[0] - b[0];\n        newDst[1] = a[1] - b[1];\n        newDst[2] = a[2] - b[2];\n        newDst[3] = a[3] - b[3];\n        return newDst;\n    }\n    /**\n     * Subtracts two vectors.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A vector that is the difference of a and b.\n     */\n    const sub = subtract;\n    /**\n     * Check if 2 vectors are approximately equal\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @returns true if vectors are approximately equal\n     */\n    function equalsApproximately(a, b) {\n        return Math.abs(a[0] - b[0]) < EPSILON &&\n            Math.abs(a[1] - b[1]) < EPSILON &&\n            Math.abs(a[2] - b[2]) < EPSILON &&\n            Math.abs(a[3] - b[3]) < EPSILON;\n    }\n    /**\n     * Check if 2 vectors are exactly equal\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @returns true if vectors are exactly equal\n     */\n    function equals(a, b) {\n        return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n    }\n    /**\n     * Performs linear interpolation on two vectors.\n     * Given vectors a and b and interpolation coefficient t, returns\n     * a + t * (b - a).\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param t - Interpolation coefficient.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The linear interpolated result.\n     */\n    function lerp(a, b, t, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = a[0] + t * (b[0] - a[0]);\n        newDst[1] = a[1] + t * (b[1] - a[1]);\n        newDst[2] = a[2] + t * (b[2] - a[2]);\n        newDst[3] = a[3] + t * (b[3] - a[3]);\n        return newDst;\n    }\n    /**\n     * Performs linear interpolation on two vectors.\n     * Given vectors a and b and interpolation coefficient vector t, returns\n     * a + t * (b - a).\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param t - Interpolation coefficients vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns the linear interpolated result.\n     */\n    function lerpV(a, b, t, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = a[0] + t[0] * (b[0] - a[0]);\n        newDst[1] = a[1] + t[1] * (b[1] - a[1]);\n        newDst[2] = a[2] + t[2] * (b[2] - a[2]);\n        newDst[3] = a[3] + t[3] * (b[3] - a[3]);\n        return newDst;\n    }\n    /**\n     * Return max values of two vectors.\n     * Given vectors a and b returns\n     * [max(a[0], b[0]), max(a[1], b[1]), max(a[2], b[2])].\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The max components vector.\n     */\n    function max(a, b, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = Math.max(a[0], b[0]);\n        newDst[1] = Math.max(a[1], b[1]);\n        newDst[2] = Math.max(a[2], b[2]);\n        newDst[3] = Math.max(a[3], b[3]);\n        return newDst;\n    }\n    /**\n     * Return min values of two vectors.\n     * Given vectors a and b returns\n     * [min(a[0], b[0]), min(a[1], b[1]), min(a[2], b[2])].\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The min components vector.\n     */\n    function min(a, b, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = Math.min(a[0], b[0]);\n        newDst[1] = Math.min(a[1], b[1]);\n        newDst[2] = Math.min(a[2], b[2]);\n        newDst[3] = Math.min(a[3], b[3]);\n        return newDst;\n    }\n    /**\n     * Multiplies a vector by a scalar.\n     * @param v - The vector.\n     * @param k - The scalar.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The scaled vector.\n     */\n    function mulScalar(v, k, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = v[0] * k;\n        newDst[1] = v[1] * k;\n        newDst[2] = v[2] * k;\n        newDst[3] = v[3] * k;\n        return newDst;\n    }\n    /**\n     * Multiplies a vector by a scalar. (same as mulScalar)\n     * @param v - The vector.\n     * @param k - The scalar.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The scaled vector.\n     */\n    const scale = mulScalar;\n    /**\n     * Divides a vector by a scalar.\n     * @param v - The vector.\n     * @param k - The scalar.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The scaled vector.\n     */\n    function divScalar(v, k, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = v[0] / k;\n        newDst[1] = v[1] / k;\n        newDst[2] = v[2] / k;\n        newDst[3] = v[3] / k;\n        return newDst;\n    }\n    /**\n     * Inverse a vector.\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The inverted vector.\n     */\n    function inverse(v, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = 1 / v[0];\n        newDst[1] = 1 / v[1];\n        newDst[2] = 1 / v[2];\n        newDst[3] = 1 / v[3];\n        return newDst;\n    }\n    /**\n     * Invert a vector. (same as inverse)\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The inverted vector.\n     */\n    const invert = inverse;\n    /**\n     * Computes the dot product of two vectors\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @returns dot product\n     */\n    function dot(a, b) {\n        return (a[0] * b[0]) + (a[1] * b[1]) + (a[2] * b[2]) + (a[3] * b[3]);\n    }\n    /**\n     * Computes the length of vector\n     * @param v - vector.\n     * @returns length of vector.\n     */\n    function length(v) {\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        const v3 = v[3];\n        return Math.sqrt(v0 * v0 + v1 * v1 + v2 * v2 + v3 * v3);\n    }\n    /**\n     * Computes the length of vector (same as length)\n     * @param v - vector.\n     * @returns length of vector.\n     */\n    const len = length;\n    /**\n     * Computes the square of the length of vector\n     * @param v - vector.\n     * @returns square of the length of vector.\n     */\n    function lengthSq(v) {\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        const v3 = v[3];\n        return v0 * v0 + v1 * v1 + v2 * v2 + v3 * v3;\n    }\n    /**\n     * Computes the square of the length of vector (same as lengthSq)\n     * @param v - vector.\n     * @returns square of the length of vector.\n     */\n    const lenSq = lengthSq;\n    /**\n     * Computes the distance between 2 points\n     * @param a - vector.\n     * @param b - vector.\n     * @returns distance between a and b\n     */\n    function distance(a, b) {\n        const dx = a[0] - b[0];\n        const dy = a[1] - b[1];\n        const dz = a[2] - b[2];\n        const dw = a[3] - b[3];\n        return Math.sqrt(dx * dx + dy * dy + dz * dz + dw * dw);\n    }\n    /**\n     * Computes the distance between 2 points (same as distance)\n     * @param a - vector.\n     * @param b - vector.\n     * @returns distance between a and b\n     */\n    const dist = distance;\n    /**\n     * Computes the square of the distance between 2 points\n     * @param a - vector.\n     * @param b - vector.\n     * @returns square of the distance between a and b\n     */\n    function distanceSq(a, b) {\n        const dx = a[0] - b[0];\n        const dy = a[1] - b[1];\n        const dz = a[2] - b[2];\n        const dw = a[3] - b[3];\n        return dx * dx + dy * dy + dz * dz + dw * dw;\n    }\n    /**\n     * Computes the square of the distance between 2 points (same as distanceSq)\n     * @param a - vector.\n     * @param b - vector.\n     * @returns square of the distance between a and b\n     */\n    const distSq = distanceSq;\n    /**\n     * Divides a vector by its Euclidean length and returns the quotient.\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The normalized vector.\n     */\n    function normalize(v, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        const v0 = v[0];\n        const v1 = v[1];\n        const v2 = v[2];\n        const v3 = v[3];\n        const len = Math.sqrt(v0 * v0 + v1 * v1 + v2 * v2 + v3 * v3);\n        if (len > 0.00001) {\n            newDst[0] = v0 / len;\n            newDst[1] = v1 / len;\n            newDst[2] = v2 / len;\n            newDst[3] = v3 / len;\n        }\n        else {\n            newDst[0] = 0;\n            newDst[1] = 0;\n            newDst[2] = 0;\n            newDst[3] = 0;\n        }\n        return newDst;\n    }\n    /**\n     * Negates a vector.\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns -v.\n     */\n    function negate(v, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = -v[0];\n        newDst[1] = -v[1];\n        newDst[2] = -v[2];\n        newDst[3] = -v[3];\n        return newDst;\n    }\n    /**\n     * Copies a vector. (same as {@link vec4.clone})\n     * Also see {@link vec4.create} and {@link vec4.set}\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A copy of v.\n     */\n    function copy(v, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = v[0];\n        newDst[1] = v[1];\n        newDst[2] = v[2];\n        newDst[3] = v[3];\n        return newDst;\n    }\n    /**\n     * Clones a vector. (same as {@link vec4.copy})\n     * Also see {@link vec4.create} and {@link vec4.set}\n     * @param v - The vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns A copy of v.\n     */\n    const clone = copy;\n    /**\n     * Multiplies a vector by another vector (component-wise); assumes a and\n     * b have the same length.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of products of entries of a and b.\n     */\n    function multiply(a, b, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = a[0] * b[0];\n        newDst[1] = a[1] * b[1];\n        newDst[2] = a[2] * b[2];\n        newDst[3] = a[3] * b[3];\n        return newDst;\n    }\n    /**\n     * Multiplies a vector by another vector (component-wise); assumes a and\n     * b have the same length. (same as mul)\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of products of entries of a and b.\n     */\n    const mul = multiply;\n    /**\n     * Divides a vector by another vector (component-wise); assumes a and\n     * b have the same length.\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of quotients of entries of a and b.\n     */\n    function divide(a, b, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = a[0] / b[0];\n        newDst[1] = a[1] / b[1];\n        newDst[2] = a[2] / b[2];\n        newDst[3] = a[3] / b[3];\n        return newDst;\n    }\n    /**\n     * Divides a vector by another vector (component-wise); assumes a and\n     * b have the same length. (same as divide)\n     * @param a - Operand vector.\n     * @param b - Operand vector.\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The vector of quotients of entries of a and b.\n     */\n    const div = divide;\n    /**\n     * Zero's a vector\n     * @param dst - vector to hold result. If not passed in a new one is created.\n     * @returns The zeroed vector.\n     */\n    function zero(dst) {\n        const newDst = (dst ?? new Ctor(4));\n        newDst[0] = 0;\n        newDst[1] = 0;\n        newDst[2] = 0;\n        newDst[3] = 0;\n        return newDst;\n    }\n    /**\n     * transform vec4 by 4x4 matrix\n     * @param v - the vector\n     * @param m - The matrix.\n     * @param dst - optional vec4 to store result. If not passed a new one is created.\n     * @returns the transformed vector\n     */\n    function transformMat4(v, m, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        const x = v[0];\n        const y = v[1];\n        const z = v[2];\n        const w = v[3];\n        newDst[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n        newDst[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n        newDst[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n        newDst[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n        return newDst;\n    }\n    /**\n     * Treat a 4D vector as a direction and set it's length\n     *\n     * @param a The vec4 to lengthen\n     * @param len The length of the resulting vector\n     * @returns The lengthened vector\n     */\n    function setLength(a, len, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        normalize(a, newDst);\n        return mulScalar(newDst, len, newDst);\n    }\n    /**\n     * Ensure a vector is not longer than a max length\n     *\n     * @param a The vec4 to limit\n     * @param maxLen The longest length of the resulting vector\n     * @returns The vector, shortened to maxLen if it's too long\n     */\n    function truncate(a, maxLen, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        if (length(a) > maxLen) {\n            return setLength(a, maxLen, newDst);\n        }\n        return copy(a, newDst);\n    }\n    /**\n     * Return the vector exactly between 2 endpoint vectors\n     *\n     * @param a Endpoint 1\n     * @param b Endpoint 2\n     * @returns The vector exactly residing between endpoints 1 and 2\n     */\n    function midpoint(a, b, dst) {\n        const newDst = (dst ?? new Ctor(4));\n        return lerp(a, b, 0.5, newDst);\n    }\n    return {\n        create,\n        fromValues,\n        set,\n        ceil,\n        floor,\n        round,\n        clamp,\n        add,\n        addScaled,\n        subtract,\n        sub,\n        equalsApproximately,\n        equals,\n        lerp,\n        lerpV,\n        max,\n        min,\n        mulScalar,\n        scale,\n        divScalar,\n        inverse,\n        invert,\n        dot,\n        length,\n        len,\n        lengthSq,\n        lenSq,\n        distance,\n        dist,\n        distanceSq,\n        distSq,\n        normalize,\n        negate,\n        copy,\n        clone,\n        multiply,\n        mul,\n        divide,\n        div,\n        zero,\n        transformMat4,\n        setLength,\n        truncate,\n        midpoint,\n    };\n}\nconst cache = new Map();\n/**\n *\n * Vec4 math functions.\n *\n * Almost all functions take an optional `newDst` argument. If it is not passed in the\n * functions will create a new `Vec4`. In other words you can do this\n *\n *     const v = vec4.cross(v1, v2);  // Creates a new Vec4 with the cross product of v1 x v2.\n *\n * or\n *\n *     const v = vec4.create();\n *     vec4.cross(v1, v2, v);  // Puts the cross product of v1 x v2 in v\n *\n * The first style is often easier but depending on where it's used it generates garbage where\n * as there is almost never allocation with the second style.\n *\n * It is always safe to pass any vector as the destination. So for example\n *\n *     vec4.cross(v1, v2, v1);  // Puts the cross product of v1 x v2 in v1\n *\n */\nfunction getAPI(Ctor) {\n    let api = cache.get(Ctor);\n    if (!api) {\n        api = getAPIImpl(Ctor);\n        cache.set(Ctor, api);\n    }\n    return api;\n}\n\n/**\n * Some docs\n * @namespace wgpu-matrix\n */\n/**\n * Generate wgpu-matrix API for type\n */\nfunction wgpuMatrixAPI(Mat3Ctor, Mat4Ctor, QuatCtor, Vec2Ctor, Vec3Ctor, Vec4Ctor) {\n    return {\n        /** @namespace mat3 */\n        mat3: getAPI$3(Mat3Ctor),\n        /** @namespace mat4 */\n        mat4: getAPI$2(Mat4Ctor),\n        /** @namespace quat */\n        quat: getAPI$1(QuatCtor),\n        /** @namespace vec2 */\n        vec2: getAPI$5(Vec2Ctor),\n        /** @namespace vec3 */\n        vec3: getAPI$4(Vec3Ctor),\n        /** @namespace vec4 */\n        vec4: getAPI(Vec4Ctor),\n    };\n}\nconst { \n/**\n * 3x3 Matrix functions that default to returning `Float32Array`\n * @namespace\n */\nmat3, \n/**\n * 4x4 Matrix functions that default to returning `Float32Array`\n * @namespace\n */\nmat4, \n/**\n * Quaternion functions that default to returning `Float32Array`\n * @namespace\n */\nquat, \n/**\n * Vec2 functions that default to returning `Float32Array`\n * @namespace\n */\nvec2, \n/**\n * Vec3 functions that default to returning `Float32Array`\n * @namespace\n */\nvec3, \n/**\n * Vec3 functions that default to returning `Float32Array`\n * @namespace\n */\nvec4, } = wgpuMatrixAPI(Float32Array, Float32Array, Float32Array, Float32Array, Float32Array, Float32Array);\nconst { \n/**\n * 3x3 Matrix functions that default to returning `Float64Array`\n * @namespace\n */\nmat3: mat3d, \n/**\n * 4x4 Matrix functions that default to returning `Float64Array`\n * @namespace\n */\nmat4: mat4d, \n/**\n * Quaternion functions that default to returning `Float64Array`\n * @namespace\n */\nquat: quatd, \n/**\n * Vec2 functions that default to returning `Float64Array`\n * @namespace\n */\nvec2: vec2d, \n/**\n * Vec3 functions that default to returning `Float64Array`\n * @namespace\n */\nvec3: vec3d, \n/**\n * Vec3 functions that default to returning `Float64Array`\n * @namespace\n */\nvec4: vec4d, } = wgpuMatrixAPI(Float64Array, Float64Array, Float64Array, Float64Array, Float64Array, Float64Array);\nconst { \n/**\n * 3x3 Matrix functions that default to returning `number[]`\n * @namespace\n */\nmat3: mat3n, \n/**\n * 4x4 Matrix functions that default to returning `number[]`\n * @namespace\n */\nmat4: mat4n, \n/**\n * Quaternion functions that default to returning `number[]`\n * @namespace\n */\nquat: quatn, \n/**\n * Vec2 functions that default to returning `number[]`\n * @namespace\n */\nvec2: vec2n, \n/**\n * Vec3 functions that default to returning `number[]`\n * @namespace\n */\nvec3: vec3n, \n/**\n * Vec3 functions that default to returning `number[]`\n * @namespace\n */\nvec4: vec4n, } = wgpuMatrixAPI(ZeroArray, Array, Array, Array, Array, Array);\n\nexport { mat3, mat3d, mat3n, mat4, mat4d, mat4n, quat, quatd, quatn, utils, vec2, vec2d, vec2n, vec3, vec3d, vec3n, vec4, vec4d, vec4n };\n//# sourceMappingURL=wgpu-matrix.module.js.map\n","import { quat, utils, mat4 } from \"wgpu-matrix\";\n\nexport function lerp(a: number, b: number, t: number): number {\n    return a + (b - a) * t;\n}\n\nconst slerpA = quat.create();\nconst slerpB = quat.create();\nconst slerpOut = quat.create();\n\nexport function slerp(\n    fromX: number,\n    fromY: number,\n    fromZ: number,\n    fromW: number,\n    toX: number,\n    toY: number,\n    toZ: number,\n    toW: number,\n    t: number\n): { x: number; y: number; z: number; w: number } {\n    quat.set(fromX, fromY, fromZ, fromW, slerpA);\n    quat.set(toX, toY, toZ, toW, slerpB);\n    quat.slerp(slerpA, slerpB, t, slerpOut);\n    return { x: slerpOut[0], y: slerpOut[1], z: slerpOut[2], w: slerpOut[3] };\n}\n\nexport function eulerToQuaternion(\n    x: number,\n    y: number,\n    z: number\n): { x: number; y: number; z: number; w: number } {\n    const result = quat.fromEuler(utils.degToRad(x), utils.degToRad(y), utils.degToRad(z), \"xyz\");\n    return { x: result[0], y: result[1], z: result[2], w: result[3] };\n}\n\nexport function quaternionToEuler(\n    x: number,\n    y: number,\n    z: number,\n    w: number\n): { x: number; y: number; z: number } {\n    const x2 = x + x,\n        y2 = y + y,\n        z2 = z + z;\n    const xx = x * x2,\n        xy = x * y2,\n        xz = x * z2;\n    const yy = y * y2,\n        yz = y * z2,\n        zz = z * z2;\n    const wx = w * x2,\n        wy = w * y2,\n        wz = w * z2;\n\n    const m11 = 1 - (yy + zz);\n    const m12 = xy - wz;\n    const m13 = xz + wy;\n    const m22 = 1 - (xx + zz);\n    const m23 = yz - wx;\n    const m32 = yz + wx;\n    const m33 = 1 - (xx + yy);\n\n    const ey = Math.asin(Math.max(-1, Math.min(1, m13)));\n    let ex: number, ez: number;\n\n    if (Math.abs(m13) < 0.9999999) {\n        ex = Math.atan2(-m23, m33);\n        ez = Math.atan2(-m12, m11);\n    } else {\n        ex = Math.atan2(m32, m22);\n        ez = 0;\n    }\n\n    return {\n        x: utils.radToDeg(ex),\n        y: utils.radToDeg(ey),\n        z: utils.radToDeg(ez),\n    };\n}\n\nconst lookAtMatrix = mat4.create();\nconst lookAtQuat = quat.create();\n\nexport function lookAt(\n    eyeX: number,\n    eyeY: number,\n    eyeZ: number,\n    targetX: number,\n    targetY: number,\n    targetZ: number,\n    upX = 0,\n    upY = 1,\n    upZ = 0\n): { x: number; y: number; z: number; w: number } {\n    mat4.cameraAim([eyeX, eyeY, eyeZ], [targetX, targetY, targetZ], [upX, upY, upZ], lookAtMatrix);\n    quat.fromMat(lookAtMatrix, lookAtQuat);\n    return { x: lookAtQuat[0], y: lookAtQuat[1], z: lookAtQuat[2], w: lookAtQuat[3] };\n}\n","import { defineRelation } from \"./relation\";\n\nexport const ChildOf = defineRelation(\"child-of\", {\n    exclusive: true,\n    autoRemoveSubject: true,\n});\n","'use strict';\n\nconst nameStartChar = ':A-Za-z_\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02FF\\\\u0370-\\\\u037D\\\\u037F-\\\\u1FFF\\\\u200C-\\\\u200D\\\\u2070-\\\\u218F\\\\u2C00-\\\\u2FEF\\\\u3001-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFFD';\nconst nameChar = nameStartChar + '\\\\-.\\\\d\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040';\nexport const nameRegexp = '[' + nameStartChar + '][' + nameChar + ']*';\nconst regexName = new RegExp('^' + nameRegexp + '$');\n\nexport function getAllMatches(string, regex) {\n  const matches = [];\n  let match = regex.exec(string);\n  while (match) {\n    const allmatches = [];\n    allmatches.startIndex = regex.lastIndex - match[0].length;\n    const len = match.length;\n    for (let index = 0; index < len; index++) {\n      allmatches.push(match[index]);\n    }\n    matches.push(allmatches);\n    match = regex.exec(string);\n  }\n  return matches;\n}\n\nexport const isName = function(string) {\n  const match = regexName.exec(string);\n  return !(match === null || typeof match === 'undefined');\n}\n\nexport function isExist(v) {\n  return typeof v !== 'undefined';\n}\n\nexport function isEmptyObject(obj) {\n  return Object.keys(obj).length === 0;\n}\n\n/**\n * Copy all the properties of a into b.\n * @param {*} target\n * @param {*} a\n */\nexport function merge(target, a, arrayMode) {\n  if (a) {\n    const keys = Object.keys(a); // will return an array of own properties\n    const len = keys.length; //don't make it inline\n    for (let i = 0; i < len; i++) {\n      if (arrayMode === 'strict') {\n        target[keys[i]] = [ a[keys[i]] ];\n      } else {\n        target[keys[i]] = a[keys[i]];\n      }\n    }\n  }\n}\n/* exports.merge =function (b,a){\n  return Object.assign(b,a);\n} */\n\nexport function getValue(v) {\n  if (exports.isExist(v)) {\n    return v;\n  } else {\n    return '';\n  }\n}\n\n// const fakeCall = function(a) {return a;};\n// const fakeCallNoReturn = function() {};","'use strict';\n\nimport {getAllMatches, isName} from './util.js';\n\nconst defaultOptions = {\n  allowBooleanAttributes: false, //A tag can have attributes without any value\n  unpairedTags: []\n};\n\n//const tagsPattern = new RegExp(\"<\\\\/?([\\\\w:\\\\-_\\.]+)\\\\s*\\/?>\",\"g\");\nexport function validate(xmlData, options) {\n  options = Object.assign({}, defaultOptions, options);\n\n  //xmlData = xmlData.replace(/(\\r\\n|\\n|\\r)/gm,\"\");//make it single line\n  //xmlData = xmlData.replace(/(^\\s*<\\?xml.*?\\?>)/g,\"\");//Remove XML starting tag\n  //xmlData = xmlData.replace(/(<!DOCTYPE[\\s\\w\\\"\\.\\/\\-\\:]+(\\[.*\\])*\\s*>)/g,\"\");//Remove DOCTYPE\n  const tags = [];\n  let tagFound = false;\n\n  //indicates that the root tag has been closed (aka. depth 0 has been reached)\n  let reachedRoot = false;\n\n  if (xmlData[0] === '\\ufeff') {\n    // check for byte order mark (BOM)\n    xmlData = xmlData.substr(1);\n  }\n  \n  for (let i = 0; i < xmlData.length; i++) {\n\n    if (xmlData[i] === '<' && xmlData[i+1] === '?') {\n      i+=2;\n      i = readPI(xmlData,i);\n      if (i.err) return i;\n    }else if (xmlData[i] === '<') {\n      //starting of tag\n      //read until you reach to '>' avoiding any '>' in attribute value\n      let tagStartPos = i;\n      i++;\n      \n      if (xmlData[i] === '!') {\n        i = readCommentAndCDATA(xmlData, i);\n        continue;\n      } else {\n        let closingTag = false;\n        if (xmlData[i] === '/') {\n          //closing tag\n          closingTag = true;\n          i++;\n        }\n        //read tagname\n        let tagName = '';\n        for (; i < xmlData.length &&\n          xmlData[i] !== '>' &&\n          xmlData[i] !== ' ' &&\n          xmlData[i] !== '\\t' &&\n          xmlData[i] !== '\\n' &&\n          xmlData[i] !== '\\r'; i++\n        ) {\n          tagName += xmlData[i];\n        }\n        tagName = tagName.trim();\n        //console.log(tagName);\n\n        if (tagName[tagName.length - 1] === '/') {\n          //self closing tag without attributes\n          tagName = tagName.substring(0, tagName.length - 1);\n          //continue;\n          i--;\n        }\n        if (!validateTagName(tagName)) {\n          let msg;\n          if (tagName.trim().length === 0) {\n            msg = \"Invalid space after '<'.\";\n          } else {\n            msg = \"Tag '\"+tagName+\"' is an invalid name.\";\n          }\n          return getErrorObject('InvalidTag', msg, getLineNumberForPosition(xmlData, i));\n        }\n\n        const result = readAttributeStr(xmlData, i);\n        if (result === false) {\n          return getErrorObject('InvalidAttr', \"Attributes for '\"+tagName+\"' have open quote.\", getLineNumberForPosition(xmlData, i));\n        }\n        let attrStr = result.value;\n        i = result.index;\n\n        if (attrStr[attrStr.length - 1] === '/') {\n          //self closing tag\n          const attrStrStart = i - attrStr.length;\n          attrStr = attrStr.substring(0, attrStr.length - 1);\n          const isValid = validateAttributeString(attrStr, options);\n          if (isValid === true) {\n            tagFound = true;\n            //continue; //text may presents after self closing tag\n          } else {\n            //the result from the nested function returns the position of the error within the attribute\n            //in order to get the 'true' error line, we need to calculate the position where the attribute begins (i - attrStr.length) and then add the position within the attribute\n            //this gives us the absolute index in the entire xml, which we can use to find the line at last\n            return getErrorObject(isValid.err.code, isValid.err.msg, getLineNumberForPosition(xmlData, attrStrStart + isValid.err.line));\n          }\n        } else if (closingTag) {\n          if (!result.tagClosed) {\n            return getErrorObject('InvalidTag', \"Closing tag '\"+tagName+\"' doesn't have proper closing.\", getLineNumberForPosition(xmlData, i));\n          } else if (attrStr.trim().length > 0) {\n            return getErrorObject('InvalidTag', \"Closing tag '\"+tagName+\"' can't have attributes or invalid starting.\", getLineNumberForPosition(xmlData, tagStartPos));\n          } else if (tags.length === 0) {\n            return getErrorObject('InvalidTag', \"Closing tag '\"+tagName+\"' has not been opened.\", getLineNumberForPosition(xmlData, tagStartPos));\n          } else {\n            const otg = tags.pop();\n            if (tagName !== otg.tagName) {\n              let openPos = getLineNumberForPosition(xmlData, otg.tagStartPos);\n              return getErrorObject('InvalidTag',\n                \"Expected closing tag '\"+otg.tagName+\"' (opened in line \"+openPos.line+\", col \"+openPos.col+\") instead of closing tag '\"+tagName+\"'.\",\n                getLineNumberForPosition(xmlData, tagStartPos));\n            }\n\n            //when there are no more tags, we reached the root level.\n            if (tags.length == 0) {\n              reachedRoot = true;\n            }\n          }\n        } else {\n          const isValid = validateAttributeString(attrStr, options);\n          if (isValid !== true) {\n            //the result from the nested function returns the position of the error within the attribute\n            //in order to get the 'true' error line, we need to calculate the position where the attribute begins (i - attrStr.length) and then add the position within the attribute\n            //this gives us the absolute index in the entire xml, which we can use to find the line at last\n            return getErrorObject(isValid.err.code, isValid.err.msg, getLineNumberForPosition(xmlData, i - attrStr.length + isValid.err.line));\n          }\n\n          //if the root level has been reached before ...\n          if (reachedRoot === true) {\n            return getErrorObject('InvalidXml', 'Multiple possible root nodes found.', getLineNumberForPosition(xmlData, i));\n          } else if(options.unpairedTags.indexOf(tagName) !== -1){\n            //don't push into stack\n          } else {\n            tags.push({tagName, tagStartPos});\n          }\n          tagFound = true;\n        }\n\n        //skip tag text value\n        //It may include comments and CDATA value\n        for (i++; i < xmlData.length; i++) {\n          if (xmlData[i] === '<') {\n            if (xmlData[i + 1] === '!') {\n              //comment or CADATA\n              i++;\n              i = readCommentAndCDATA(xmlData, i);\n              continue;\n            } else if (xmlData[i+1] === '?') {\n              i = readPI(xmlData, ++i);\n              if (i.err) return i;\n            } else{\n              break;\n            }\n          } else if (xmlData[i] === '&') {\n            const afterAmp = validateAmpersand(xmlData, i);\n            if (afterAmp == -1)\n              return getErrorObject('InvalidChar', \"char '&' is not expected.\", getLineNumberForPosition(xmlData, i));\n            i = afterAmp;\n          }else{\n            if (reachedRoot === true && !isWhiteSpace(xmlData[i])) {\n              return getErrorObject('InvalidXml', \"Extra text at the end\", getLineNumberForPosition(xmlData, i));\n            }\n          }\n        } //end of reading tag text value\n        if (xmlData[i] === '<') {\n          i--;\n        }\n      }\n    } else {\n      if ( isWhiteSpace(xmlData[i])) {\n        continue;\n      }\n      return getErrorObject('InvalidChar', \"char '\"+xmlData[i]+\"' is not expected.\", getLineNumberForPosition(xmlData, i));\n    }\n  }\n\n  if (!tagFound) {\n    return getErrorObject('InvalidXml', 'Start tag expected.', 1);\n  }else if (tags.length == 1) {\n      return getErrorObject('InvalidTag', \"Unclosed tag '\"+tags[0].tagName+\"'.\", getLineNumberForPosition(xmlData, tags[0].tagStartPos));\n  }else if (tags.length > 0) {\n      return getErrorObject('InvalidXml', \"Invalid '\"+\n          JSON.stringify(tags.map(t => t.tagName), null, 4).replace(/\\r?\\n/g, '')+\n          \"' found.\", {line: 1, col: 1});\n  }\n\n  return true;\n};\n\nfunction isWhiteSpace(char){\n  return char === ' ' || char === '\\t' || char === '\\n'  || char === '\\r';\n}\n/**\n * Read Processing insstructions and skip\n * @param {*} xmlData\n * @param {*} i\n */\nfunction readPI(xmlData, i) {\n  const start = i;\n  for (; i < xmlData.length; i++) {\n    if (xmlData[i] == '?' || xmlData[i] == ' ') {\n      //tagname\n      const tagname = xmlData.substr(start, i - start);\n      if (i > 5 && tagname === 'xml') {\n        return getErrorObject('InvalidXml', 'XML declaration allowed only at the start of the document.', getLineNumberForPosition(xmlData, i));\n      } else if (xmlData[i] == '?' && xmlData[i + 1] == '>') {\n        //check if valid attribut string\n        i++;\n        break;\n      } else {\n        continue;\n      }\n    }\n  }\n  return i;\n}\n\nfunction readCommentAndCDATA(xmlData, i) {\n  if (xmlData.length > i + 5 && xmlData[i + 1] === '-' && xmlData[i + 2] === '-') {\n    //comment\n    for (i += 3; i < xmlData.length; i++) {\n      if (xmlData[i] === '-' && xmlData[i + 1] === '-' && xmlData[i + 2] === '>') {\n        i += 2;\n        break;\n      }\n    }\n  } else if (\n    xmlData.length > i + 8 &&\n    xmlData[i + 1] === 'D' &&\n    xmlData[i + 2] === 'O' &&\n    xmlData[i + 3] === 'C' &&\n    xmlData[i + 4] === 'T' &&\n    xmlData[i + 5] === 'Y' &&\n    xmlData[i + 6] === 'P' &&\n    xmlData[i + 7] === 'E'\n  ) {\n    let angleBracketsCount = 1;\n    for (i += 8; i < xmlData.length; i++) {\n      if (xmlData[i] === '<') {\n        angleBracketsCount++;\n      } else if (xmlData[i] === '>') {\n        angleBracketsCount--;\n        if (angleBracketsCount === 0) {\n          break;\n        }\n      }\n    }\n  } else if (\n    xmlData.length > i + 9 &&\n    xmlData[i + 1] === '[' &&\n    xmlData[i + 2] === 'C' &&\n    xmlData[i + 3] === 'D' &&\n    xmlData[i + 4] === 'A' &&\n    xmlData[i + 5] === 'T' &&\n    xmlData[i + 6] === 'A' &&\n    xmlData[i + 7] === '['\n  ) {\n    for (i += 8; i < xmlData.length; i++) {\n      if (xmlData[i] === ']' && xmlData[i + 1] === ']' && xmlData[i + 2] === '>') {\n        i += 2;\n        break;\n      }\n    }\n  }\n\n  return i;\n}\n\nconst doubleQuote = '\"';\nconst singleQuote = \"'\";\n\n/**\n * Keep reading xmlData until '<' is found outside the attribute value.\n * @param {string} xmlData\n * @param {number} i\n */\nfunction readAttributeStr(xmlData, i) {\n  let attrStr = '';\n  let startChar = '';\n  let tagClosed = false;\n  for (; i < xmlData.length; i++) {\n    if (xmlData[i] === doubleQuote || xmlData[i] === singleQuote) {\n      if (startChar === '') {\n        startChar = xmlData[i];\n      } else if (startChar !== xmlData[i]) {\n        //if vaue is enclosed with double quote then single quotes are allowed inside the value and vice versa\n      } else {\n        startChar = '';\n      }\n    } else if (xmlData[i] === '>') {\n      if (startChar === '') {\n        tagClosed = true;\n        break;\n      }\n    }\n    attrStr += xmlData[i];\n  }\n  if (startChar !== '') {\n    return false;\n  }\n\n  return {\n    value: attrStr,\n    index: i,\n    tagClosed: tagClosed\n  };\n}\n\n/**\n * Select all the attributes whether valid or invalid.\n */\nconst validAttrStrRegxp = new RegExp('(\\\\s*)([^\\\\s=]+)(\\\\s*=)?(\\\\s*([\\'\"])(([\\\\s\\\\S])*?)\\\\5)?', 'g');\n\n//attr, =\"sd\", a=\"amit's\", a=\"sd\"b=\"saf\", ab  cd=\"\"\n\nfunction validateAttributeString(attrStr, options) {\n  //console.log(\"start:\"+attrStr+\":end\");\n\n  //if(attrStr.trim().length === 0) return true; //empty string\n\n  const matches = getAllMatches(attrStr, validAttrStrRegxp);\n  const attrNames = {};\n\n  for (let i = 0; i < matches.length; i++) {\n    if (matches[i][1].length === 0) {\n      //nospace before attribute name: a=\"sd\"b=\"saf\"\n      return getErrorObject('InvalidAttr', \"Attribute '\"+matches[i][2]+\"' has no space in starting.\", getPositionFromMatch(matches[i]))\n    } else if (matches[i][3] !== undefined && matches[i][4] === undefined) {\n      return getErrorObject('InvalidAttr', \"Attribute '\"+matches[i][2]+\"' is without value.\", getPositionFromMatch(matches[i]));\n    } else if (matches[i][3] === undefined && !options.allowBooleanAttributes) {\n      //independent attribute: ab\n      return getErrorObject('InvalidAttr', \"boolean attribute '\"+matches[i][2]+\"' is not allowed.\", getPositionFromMatch(matches[i]));\n    }\n    /* else if(matches[i][6] === undefined){//attribute without value: ab=\n                    return { err: { code:\"InvalidAttr\",msg:\"attribute \" + matches[i][2] + \" has no value assigned.\"}};\n                } */\n    const attrName = matches[i][2];\n    if (!validateAttrName(attrName)) {\n      return getErrorObject('InvalidAttr', \"Attribute '\"+attrName+\"' is an invalid name.\", getPositionFromMatch(matches[i]));\n    }\n    if (!attrNames.hasOwnProperty(attrName)) {\n      //check for duplicate attribute.\n      attrNames[attrName] = 1;\n    } else {\n      return getErrorObject('InvalidAttr', \"Attribute '\"+attrName+\"' is repeated.\", getPositionFromMatch(matches[i]));\n    }\n  }\n\n  return true;\n}\n\nfunction validateNumberAmpersand(xmlData, i) {\n  let re = /\\d/;\n  if (xmlData[i] === 'x') {\n    i++;\n    re = /[\\da-fA-F]/;\n  }\n  for (; i < xmlData.length; i++) {\n    if (xmlData[i] === ';')\n      return i;\n    if (!xmlData[i].match(re))\n      break;\n  }\n  return -1;\n}\n\nfunction validateAmpersand(xmlData, i) {\n  // https://www.w3.org/TR/xml/#dt-charref\n  i++;\n  if (xmlData[i] === ';')\n    return -1;\n  if (xmlData[i] === '#') {\n    i++;\n    return validateNumberAmpersand(xmlData, i);\n  }\n  let count = 0;\n  for (; i < xmlData.length; i++, count++) {\n    if (xmlData[i].match(/\\w/) && count < 20)\n      continue;\n    if (xmlData[i] === ';')\n      break;\n    return -1;\n  }\n  return i;\n}\n\nfunction getErrorObject(code, message, lineNumber) {\n  return {\n    err: {\n      code: code,\n      msg: message,\n      line: lineNumber.line || lineNumber,\n      col: lineNumber.col,\n    },\n  };\n}\n\nfunction validateAttrName(attrName) {\n  return isName(attrName);\n}\n\n// const startsWithXML = /^xml/i;\n\nfunction validateTagName(tagname) {\n  return isName(tagname) /* && !tagname.match(startsWithXML) */;\n}\n\n//this function returns the line number for the character at the given index\nfunction getLineNumberForPosition(xmlData, index) {\n  const lines = xmlData.substring(0, index).split(/\\r?\\n/);\n  return {\n    line: lines.length,\n\n    // column number is last line's length + 1, because column numbering starts at 1:\n    col: lines[lines.length - 1].length + 1\n  };\n}\n\n//this function returns the position of the first character of match within attrStr\nfunction getPositionFromMatch(match) {\n  return match.startIndex + match[1].length;\n}\n","\nexport const defaultOptions = {\n    preserveOrder: false,\n    attributeNamePrefix: '@_',\n    attributesGroupName: false,\n    textNodeName: '#text',\n    ignoreAttributes: true,\n    removeNSPrefix: false, // remove NS from tag name or attribute name if true\n    allowBooleanAttributes: false, //a tag can have attributes without any value\n    //ignoreRootElement : false,\n    parseTagValue: true,\n    parseAttributeValue: false,\n    trimValues: true, //Trim string values of tag and attributes\n    cdataPropName: false,\n    numberParseOptions: {\n      hex: true,\n      leadingZeros: true,\n      eNotation: true\n    },\n    tagValueProcessor: function(tagName, val) {\n      return val;\n    },\n    attributeValueProcessor: function(attrName, val) {\n      return val;\n    },\n    stopNodes: [], //nested tags will not be parsed even for errors\n    alwaysCreateTextNode: false,\n    isArray: () => false,\n    commentPropName: false,\n    unpairedTags: [],\n    processEntities: true,\n    htmlEntities: false,\n    ignoreDeclaration: false,\n    ignorePiTags: false,\n    transformTagName: false,\n    transformAttributeName: false,\n    updateTag: function(tagName, jPath, attrs){\n      return tagName\n    },\n    // skipEmptyListItem: false\n    captureMetaData: false,\n};\n   \nexport const buildOptions = function(options) {\n    return Object.assign({}, defaultOptions, options);\n};\n","'use strict';\n\nlet METADATA_SYMBOL;\n\nif (typeof Symbol !== \"function\") {\n  METADATA_SYMBOL = \"@@xmlMetadata\";\n} else {\n  METADATA_SYMBOL = Symbol(\"XML Node Metadata\");\n}\n\nexport default class XmlNode{\n  constructor(tagname) {\n    this.tagname = tagname;\n    this.child = []; //nested tags, text, cdata, comments in order\n    this[\":@\"] = {}; //attributes map\n  }\n  add(key,val){\n    // this.child.push( {name : key, val: val, isCdata: isCdata });\n    if(key === \"__proto__\") key = \"#__proto__\";\n    this.child.push( {[key]: val });\n  }\n  addChild(node, startIndex) {\n    if(node.tagname === \"__proto__\") node.tagname = \"#__proto__\";\n    if(node[\":@\"] && Object.keys(node[\":@\"]).length > 0){\n      this.child.push( { [node.tagname]: node.child, [\":@\"]: node[\":@\"] });\n    }else{\n      this.child.push( { [node.tagname]: node.child });\n    }\n    // if requested, add the startIndex\n    if (startIndex !== undefined) {\n      // Note: for now we just overwrite the metadata. If we had more complex metadata,\n      // we might need to do an object append here:  metadata = { ...metadata, startIndex }\n      this.child[this.child.length - 1][METADATA_SYMBOL] = { startIndex };\n    }\n  }\n  /** symbol used for metadata */\n  static getMetaDataSymbol() {\n    return METADATA_SYMBOL;\n  }\n}\n","import {isName} from '../util.js';\n\nexport default class DocTypeReader{\n    constructor(processEntities){\n        this.suppressValidationErr = !processEntities;\n    }\n    \n    readDocType(xmlData, i){\n    \n        const entities = {};\n        if( xmlData[i + 3] === 'O' &&\n            xmlData[i + 4] === 'C' &&\n            xmlData[i + 5] === 'T' &&\n            xmlData[i + 6] === 'Y' &&\n            xmlData[i + 7] === 'P' &&\n            xmlData[i + 8] === 'E')\n        {    \n            i = i+9;\n            let angleBracketsCount = 1;\n            let hasBody = false, comment = false;\n            let exp = \"\";\n            for(;i<xmlData.length;i++){\n                if (xmlData[i] === '<' && !comment) { //Determine the tag type\n                    if( hasBody && hasSeq(xmlData, \"!ENTITY\",i)){\n                        i += 7; \n                        let entityName, val;\n                        [entityName, val,i] = this.readEntityExp(xmlData,i+1,this.suppressValidationErr);\n                        if(val.indexOf(\"&\") === -1) //Parameter entities are not supported\n                            entities[ entityName ] = {\n                                regx : RegExp( `&${entityName};`,\"g\"),\n                                val: val\n                            };\n                    }\n                    else if( hasBody && hasSeq(xmlData, \"!ELEMENT\",i))  {\n                        i += 8;//Not supported\n                        const {index} = this.readElementExp(xmlData,i+1);\n                        i = index;\n                    }else if( hasBody && hasSeq(xmlData, \"!ATTLIST\",i)){\n                        i += 8;//Not supported\n                        // const {index} = this.readAttlistExp(xmlData,i+1);\n                        // i = index;\n                    }else if( hasBody && hasSeq(xmlData, \"!NOTATION\",i)) {\n                        i += 9;//Not supported\n                        const {index} = this.readNotationExp(xmlData,i+1,this.suppressValidationErr);\n                        i = index;\n                    }else if( hasSeq(xmlData, \"!--\",i) ) comment = true;\n                    else throw new Error(`Invalid DOCTYPE`);\n\n                    angleBracketsCount++;\n                    exp = \"\";\n                } else if (xmlData[i] === '>') { //Read tag content\n                    if(comment){\n                        if( xmlData[i - 1] === \"-\" && xmlData[i - 2] === \"-\"){\n                            comment = false;\n                            angleBracketsCount--;\n                        }\n                    }else{\n                        angleBracketsCount--;\n                    }\n                    if (angleBracketsCount === 0) {\n                    break;\n                    }\n                }else if( xmlData[i] === '['){\n                    hasBody = true;\n                }else{\n                    exp += xmlData[i];\n                }\n            }\n            if(angleBracketsCount !== 0){\n                throw new Error(`Unclosed DOCTYPE`);\n            }\n        }else{\n            throw new Error(`Invalid Tag instead of DOCTYPE`);\n        }\n        return {entities, i};\n    }\n    readEntityExp(xmlData, i) {    \n        //External entities are not supported\n        //    <!ENTITY ext SYSTEM \"http://normal-website.com\" >\n\n        //Parameter entities are not supported\n        //    <!ENTITY entityname \"&anotherElement;\">\n\n        //Internal entities are supported\n        //    <!ENTITY entityname \"replacement text\">\n\n        // Skip leading whitespace after <!ENTITY\n        i = skipWhitespace(xmlData, i);\n\n        // Read entity name\n        let entityName = \"\";\n        while (i < xmlData.length && !/\\s/.test(xmlData[i]) && xmlData[i] !== '\"' && xmlData[i] !== \"'\") {\n            entityName += xmlData[i];\n            i++;\n        }\n        validateEntityName(entityName);\n\n        // Skip whitespace after entity name\n        i = skipWhitespace(xmlData, i);\n\n        // Check for unsupported constructs (external entities or parameter entities)\n        if(!this.suppressValidationErr){\n            if (xmlData.substring(i, i + 6).toUpperCase() === \"SYSTEM\") {\n                throw new Error(\"External entities are not supported\");\n            }else if (xmlData[i] === \"%\") {\n                throw new Error(\"Parameter entities are not supported\");\n            }\n        }\n\n        // Read entity value (internal entity)\n        let entityValue = \"\";\n        [i, entityValue] = this.readIdentifierVal(xmlData, i, \"entity\");\n        i--;\n        return [entityName, entityValue, i ];\n    }\n\n    readNotationExp(xmlData, i) {\n        // Skip leading whitespace after <!NOTATION\n        i = skipWhitespace(xmlData, i);\n\n        // Read notation name\n        let notationName = \"\";\n        while (i < xmlData.length && !/\\s/.test(xmlData[i])) {\n            notationName += xmlData[i];\n            i++;\n        }\n        !this.suppressValidationErr && validateEntityName(notationName);\n\n        // Skip whitespace after notation name\n        i = skipWhitespace(xmlData, i);\n\n        // Check identifier type (SYSTEM or PUBLIC)\n        const identifierType = xmlData.substring(i, i + 6).toUpperCase();\n        if (!this.suppressValidationErr && identifierType !== \"SYSTEM\" && identifierType !== \"PUBLIC\") {\n            throw new Error(`Expected SYSTEM or PUBLIC, found \"${identifierType}\"`);\n        }\n        i += identifierType.length;\n\n        // Skip whitespace after identifier type\n        i = skipWhitespace(xmlData, i);\n\n        // Read public identifier (if PUBLIC)\n        let publicIdentifier = null;\n        let systemIdentifier = null;\n\n        if (identifierType === \"PUBLIC\") {\n            [i, publicIdentifier ] = this.readIdentifierVal(xmlData, i, \"publicIdentifier\");\n\n            // Skip whitespace after public identifier\n            i = skipWhitespace(xmlData, i);\n\n            // Optionally read system identifier\n            if (xmlData[i] === '\"' || xmlData[i] === \"'\") {\n                [i, systemIdentifier ] = this.readIdentifierVal(xmlData, i,\"systemIdentifier\");\n            }\n        } else if (identifierType === \"SYSTEM\") {\n            // Read system identifier (mandatory for SYSTEM)\n            [i, systemIdentifier ] = this.readIdentifierVal(xmlData, i, \"systemIdentifier\");\n\n            if (!this.suppressValidationErr && !systemIdentifier) {\n                throw new Error(\"Missing mandatory system identifier for SYSTEM notation\");\n            }\n        }\n        \n        return {notationName, publicIdentifier, systemIdentifier, index: --i};\n    }\n\n    readIdentifierVal(xmlData, i, type) {\n        let identifierVal = \"\";\n        const startChar = xmlData[i];\n        if (startChar !== '\"' && startChar !== \"'\") {\n            throw new Error(`Expected quoted string, found \"${startChar}\"`);\n        }\n        i++;\n\n        while (i < xmlData.length && xmlData[i] !== startChar) {\n            identifierVal += xmlData[i];\n            i++;\n        }\n\n        if (xmlData[i] !== startChar) {\n            throw new Error(`Unterminated ${type} value`);\n        }\n        i++;\n        return [i, identifierVal];\n    }\n\n    readElementExp(xmlData, i) {\n        // <!ELEMENT br EMPTY>\n        // <!ELEMENT div ANY>\n        // <!ELEMENT title (#PCDATA)>\n        // <!ELEMENT book (title, author+)>\n        // <!ELEMENT name (content-model)>\n        \n        // Skip leading whitespace after <!ELEMENT\n        i = skipWhitespace(xmlData, i);\n\n        // Read element name\n        let elementName = \"\";\n        while (i < xmlData.length && !/\\s/.test(xmlData[i])) {\n            elementName += xmlData[i];\n            i++;\n        }\n\n        // Validate element name\n        if (!this.suppressValidationErr && !isName(elementName)) {\n            throw new Error(`Invalid element name: \"${elementName}\"`);\n        }\n\n        // Skip whitespace after element name\n        i = skipWhitespace(xmlData, i);\n        let contentModel = \"\";\n        // Expect '(' to start content model\n        if(xmlData[i] === \"E\" && hasSeq(xmlData, \"MPTY\",i)) i+=4;\n        else if(xmlData[i] === \"A\" && hasSeq(xmlData, \"NY\",i)) i+=2;\n        else if (xmlData[i] === \"(\") {\n            i++; // Move past '('\n\n            // Read content model\n            while (i < xmlData.length && xmlData[i] !== \")\") {\n                contentModel += xmlData[i];\n                i++;\n            }\n            if (xmlData[i] !== \")\") {\n                throw new Error(\"Unterminated content model\");\n            }\n\n        }else if(!this.suppressValidationErr){\n            throw new Error(`Invalid Element Expression, found \"${xmlData[i]}\"`);\n        }\n        \n        return {\n            elementName,\n            contentModel: contentModel.trim(),\n            index: i\n        };\n    }\n\n    readAttlistExp(xmlData, i) {\n        // Skip leading whitespace after <!ATTLIST\n        i = skipWhitespace(xmlData, i);\n\n        // Read element name\n        let elementName = \"\";\n        while (i < xmlData.length && !/\\s/.test(xmlData[i])) {\n            elementName += xmlData[i];\n            i++;\n        }\n\n        // Validate element name\n        validateEntityName(elementName)\n\n        // Skip whitespace after element name\n        i = skipWhitespace(xmlData, i);\n\n        // Read attribute name\n        let attributeName = \"\";\n        while (i < xmlData.length && !/\\s/.test(xmlData[i])) {\n            attributeName += xmlData[i];\n            i++;\n        }\n\n        // Validate attribute name\n        if (!validateEntityName(attributeName)) {\n            throw new Error(`Invalid attribute name: \"${attributeName}\"`);\n        }\n\n        // Skip whitespace after attribute name\n        i = skipWhitespace(xmlData, i);\n\n        // Read attribute type\n        let attributeType = \"\";\n        if (xmlData.substring(i, i + 8).toUpperCase() === \"NOTATION\") {\n            attributeType = \"NOTATION\";\n            i += 8; // Move past \"NOTATION\"\n\n            // Skip whitespace after \"NOTATION\"\n            i = skipWhitespace(xmlData, i);\n\n            // Expect '(' to start the list of notations\n            if (xmlData[i] !== \"(\") {\n                throw new Error(`Expected '(', found \"${xmlData[i]}\"`);\n            }\n            i++; // Move past '('\n\n            // Read the list of allowed notations\n            let allowedNotations = [];\n            while (i < xmlData.length && xmlData[i] !== \")\") {\n                let notation = \"\";\n                while (i < xmlData.length && xmlData[i] !== \"|\" && xmlData[i] !== \")\") {\n                    notation += xmlData[i];\n                    i++;\n                }\n\n                // Validate notation name\n                notation = notation.trim();\n                if (!validateEntityName(notation)) {\n                    throw new Error(`Invalid notation name: \"${notation}\"`);\n                }\n\n                allowedNotations.push(notation);\n\n                // Skip '|' separator or exit loop\n                if (xmlData[i] === \"|\") {\n                    i++; // Move past '|'\n                    i = skipWhitespace(xmlData, i); // Skip optional whitespace after '|'\n                }\n            }\n\n            if (xmlData[i] !== \")\") {\n                throw new Error(\"Unterminated list of notations\");\n            }\n            i++; // Move past ')'\n\n            // Store the allowed notations as part of the attribute type\n            attributeType += \" (\" + allowedNotations.join(\"|\") + \")\";\n        } else {\n            // Handle simple types (e.g., CDATA, ID, IDREF, etc.)\n            while (i < xmlData.length && !/\\s/.test(xmlData[i])) {\n                attributeType += xmlData[i];\n                i++;\n            }\n\n            // Validate simple attribute type\n            const validTypes = [\"CDATA\", \"ID\", \"IDREF\", \"IDREFS\", \"ENTITY\", \"ENTITIES\", \"NMTOKEN\", \"NMTOKENS\"];\n            if (!this.suppressValidationErr && !validTypes.includes(attributeType.toUpperCase())) {\n                throw new Error(`Invalid attribute type: \"${attributeType}\"`);\n            }\n        }\n\n        // Skip whitespace after attribute type\n        i = skipWhitespace(xmlData, i);\n\n        // Read default value\n        let defaultValue = \"\";\n        if (xmlData.substring(i, i + 8).toUpperCase() === \"#REQUIRED\") {\n            defaultValue = \"#REQUIRED\";\n            i += 8;\n        } else if (xmlData.substring(i, i + 7).toUpperCase() === \"#IMPLIED\") {\n            defaultValue = \"#IMPLIED\";\n            i += 7;\n        } else {\n            [i, defaultValue] = this.readIdentifierVal(xmlData, i, \"ATTLIST\");\n        }\n\n        return {\n            elementName,\n            attributeName,\n            attributeType,\n            defaultValue,\n            index: i\n        }\n    }\n}\n\n\n\nconst skipWhitespace = (data, index) => {\n    while (index < data.length && /\\s/.test(data[index])) {\n        index++;\n    }\n    return index;\n};\n\n\n\nfunction hasSeq(data, seq,i){\n    for(let j=0;j<seq.length;j++){\n        if(seq[j]!==data[i+j+1]) return false;\n    }\n    return true;\n}\n\nfunction validateEntityName(name){\n    if (isName(name))\n\t    return name;\n    else\n        throw new Error(`Invalid entity name ${name}`);\n}\n","const hexRegex = /^[-+]?0x[a-fA-F0-9]+$/;\nconst numRegex = /^([\\-\\+])?(0*)([0-9]*(\\.[0-9]*)?)$/;\n// const octRegex = /^0x[a-z0-9]+/;\n// const binRegex = /0x[a-z0-9]+/;\n\n \nconst consider = {\n    hex :  true,\n    // oct: false,\n    leadingZeros: true,\n    decimalPoint: \"\\.\",\n    eNotation: true,\n    //skipLike: /regex/\n};\n\nexport default function toNumber(str, options = {}){\n    options = Object.assign({}, consider, options );\n    if(!str || typeof str !== \"string\" ) return str;\n    \n    let trimmedStr  = str.trim();\n    \n    if(options.skipLike !== undefined && options.skipLike.test(trimmedStr)) return str;\n    else if(str===\"0\") return 0;\n    else if (options.hex && hexRegex.test(trimmedStr)) {\n        return parse_int(trimmedStr, 16);\n    // }else if (options.oct && octRegex.test(str)) {\n    //     return Number.parseInt(val, 8);\n    }else if (trimmedStr.includes('e') || trimmedStr.includes('E')) { //eNotation\n        return resolveEnotation(str,trimmedStr,options);\n    // }else if (options.parseBin && binRegex.test(str)) {\n    //     return Number.parseInt(val, 2);\n    }else{\n        //separate negative sign, leading zeros, and rest number\n        const match = numRegex.exec(trimmedStr);\n        // +00.123 => [ , '+', '00', '.123', ..\n        if(match){\n            const sign = match[1] || \"\";\n            const leadingZeros = match[2];\n            let numTrimmedByZeros = trimZeros(match[3]); //complete num without leading zeros\n            const decimalAdjacentToLeadingZeros = sign ? // 0., -00., 000.\n                str[leadingZeros.length+1] === \".\" \n                : str[leadingZeros.length] === \".\";\n\n            //trim ending zeros for floating number\n            if(!options.leadingZeros //leading zeros are not allowed\n                && (leadingZeros.length > 1 \n                    || (leadingZeros.length === 1 && !decimalAdjacentToLeadingZeros))){\n                // 00, 00.3, +03.24, 03, 03.24\n                return str;\n            }\n            else{//no leading zeros or leading zeros are allowed\n                const num = Number(trimmedStr);\n                const parsedStr = String(num);\n\n                if( num === 0) return num;\n                if(parsedStr.search(/[eE]/) !== -1){ //given number is long and parsed to eNotation\n                    if(options.eNotation) return num;\n                    else return str;\n                }else if(trimmedStr.indexOf(\".\") !== -1){ //floating number\n                    if(parsedStr === \"0\") return num; //0.0\n                    else if(parsedStr === numTrimmedByZeros) return num; //0.456. 0.79000\n                    else if( parsedStr === `${sign}${numTrimmedByZeros}`) return num;\n                    else return str;\n                }\n                \n                let n = leadingZeros? numTrimmedByZeros : trimmedStr;\n                if(leadingZeros){\n                    // -009 => -9\n                    return (n === parsedStr) || (sign+n === parsedStr) ? num : str\n                }else  {\n                    // +9\n                    return (n === parsedStr) || (n === sign+parsedStr) ? num : str\n                }\n            }\n        }else{ //non-numeric string\n            return str;\n        }\n    }\n}\n\nconst eNotationRegx = /^([-+])?(0*)(\\d*(\\.\\d*)?[eE][-\\+]?\\d+)$/;\nfunction resolveEnotation(str,trimmedStr,options){\n    if(!options.eNotation) return str;\n    const notation = trimmedStr.match(eNotationRegx); \n    if(notation){\n        let sign = notation[1] || \"\";\n        const eChar = notation[3].indexOf(\"e\") === -1 ? \"E\" : \"e\";\n        const leadingZeros = notation[2];\n        const eAdjacentToLeadingZeros = sign ? // 0E.\n            str[leadingZeros.length+1] === eChar \n            : str[leadingZeros.length] === eChar;\n\n        if(leadingZeros.length > 1 && eAdjacentToLeadingZeros) return str;\n        else if(leadingZeros.length === 1 \n            && (notation[3].startsWith(`.${eChar}`) || notation[3][0] === eChar)){\n                return Number(trimmedStr);\n        }else if(options.leadingZeros && !eAdjacentToLeadingZeros){ //accept with leading zeros\n            //remove leading 0s\n            trimmedStr = (notation[1] || \"\") + notation[3];\n            return Number(trimmedStr);\n        }else return str;\n    }else{\n        return str;\n    }\n}\n\n/**\n * \n * @param {string} numStr without leading zeros\n * @returns \n */\nfunction trimZeros(numStr){\n    if(numStr && numStr.indexOf(\".\") !== -1){//float\n        numStr = numStr.replace(/0+$/, \"\"); //remove ending zeros\n        if(numStr === \".\")  numStr = \"0\";\n        else if(numStr[0] === \".\")  numStr = \"0\"+numStr;\n        else if(numStr[numStr.length-1] === \".\")  numStr = numStr.substring(0,numStr.length-1);\n        return numStr;\n    }\n    return numStr;\n}\n\nfunction parse_int(numStr, base){\n    //polyfill\n    if(parseInt) return parseInt(numStr, base);\n    else if(Number.parseInt) return Number.parseInt(numStr, base);\n    else if(window && window.parseInt) return window.parseInt(numStr, base);\n    else throw new Error(\"parseInt, Number.parseInt, window.parseInt are not supported\")\n}","export default function getIgnoreAttributesFn(ignoreAttributes) {\n    if (typeof ignoreAttributes === 'function') {\n        return ignoreAttributes\n    }\n    if (Array.isArray(ignoreAttributes)) {\n        return (attrName) => {\n            for (const pattern of ignoreAttributes) {\n                if (typeof pattern === 'string' && attrName === pattern) {\n                    return true\n                }\n                if (pattern instanceof RegExp && pattern.test(attrName)) {\n                    return true\n                }\n            }\n        }\n    }\n    return () => false\n}","'use strict';\n///@ts-check\n\nimport {getAllMatches, isExist} from '../util.js';\nimport xmlNode from './xmlNode.js';\nimport DocTypeReader from './DocTypeReader.js';\nimport toNumber from \"strnum\";\nimport getIgnoreAttributesFn from \"../ignoreAttributes.js\";\n\n// const regx =\n//   '<((!\\\\[CDATA\\\\[([\\\\s\\\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\\\/)(NAME)\\\\s*>))([^<]*)'\n//   .replace(/NAME/g, util.nameRegexp);\n\n//const tagsRegx = new RegExp(\"<(\\\\/?[\\\\w:\\\\-\\._]+)([^>]*)>(\\\\s*\"+cdataRegx+\")*([^<]+)?\",\"g\");\n//const tagsRegx = new RegExp(\"<(\\\\/?)((\\\\w*:)?([\\\\w:\\\\-\\._]+))([^>]*)>([^<]*)(\"+cdataRegx+\"([^<]*))*([^<]+)?\",\"g\");\n\nexport default class OrderedObjParser{\n  constructor(options){\n    this.options = options;\n    this.currentNode = null;\n    this.tagsNodeStack = [];\n    this.docTypeEntities = {};\n    this.lastEntities = {\n      \"apos\" : { regex: /&(apos|#39|#x27);/g, val : \"'\"},\n      \"gt\" : { regex: /&(gt|#62|#x3E);/g, val : \">\"},\n      \"lt\" : { regex: /&(lt|#60|#x3C);/g, val : \"<\"},\n      \"quot\" : { regex: /&(quot|#34|#x22);/g, val : \"\\\"\"},\n    };\n    this.ampEntity = { regex: /&(amp|#38|#x26);/g, val : \"&\"};\n    this.htmlEntities = {\n      \"space\": { regex: /&(nbsp|#160);/g, val: \" \" },\n      // \"lt\" : { regex: /&(lt|#60);/g, val: \"<\" },\n      // \"gt\" : { regex: /&(gt|#62);/g, val: \">\" },\n      // \"amp\" : { regex: /&(amp|#38);/g, val: \"&\" },\n      // \"quot\" : { regex: /&(quot|#34);/g, val: \"\\\"\" },\n      // \"apos\" : { regex: /&(apos|#39);/g, val: \"'\" },\n      \"cent\" : { regex: /&(cent|#162);/g, val: \"\" },\n      \"pound\" : { regex: /&(pound|#163);/g, val: \"\" },\n      \"yen\" : { regex: /&(yen|#165);/g, val: \"\" },\n      \"euro\" : { regex: /&(euro|#8364);/g, val: \"\" },\n      \"copyright\" : { regex: /&(copy|#169);/g, val: \"\" },\n      \"reg\" : { regex: /&(reg|#174);/g, val: \"\" },\n      \"inr\" : { regex: /&(inr|#8377);/g, val: \"\" },\n      \"num_dec\": { regex: /&#([0-9]{1,7});/g, val : (_, str) => String.fromCodePoint(Number.parseInt(str, 10)) },\n      \"num_hex\": { regex: /&#x([0-9a-fA-F]{1,6});/g, val : (_, str) => String.fromCodePoint(Number.parseInt(str, 16)) },\n    };\n    this.addExternalEntities = addExternalEntities;\n    this.parseXml = parseXml;\n    this.parseTextData = parseTextData;\n    this.resolveNameSpace = resolveNameSpace;\n    this.buildAttributesMap = buildAttributesMap;\n    this.isItStopNode = isItStopNode;\n    this.replaceEntitiesValue = replaceEntitiesValue;\n    this.readStopNodeData = readStopNodeData;\n    this.saveTextToParentTag = saveTextToParentTag;\n    this.addChild = addChild;\n    this.ignoreAttributesFn = getIgnoreAttributesFn(this.options.ignoreAttributes)\n\n    if(this.options.stopNodes && this.options.stopNodes.length > 0){\n      this.stopNodesExact = new Set();\n      this.stopNodesWildcard = new Set();\n      for(let i = 0; i < this.options.stopNodes.length; i++){\n        const stopNodeExp = this.options.stopNodes[i];\n        if(typeof stopNodeExp !== 'string') continue;\n        if(stopNodeExp.startsWith(\"*.\")){\n          this.stopNodesWildcard.add(stopNodeExp.substring(2));\n        }else{\n          this.stopNodesExact.add(stopNodeExp);\n        }\n      }\n    }\n  }\n\n}\n\nfunction addExternalEntities(externalEntities){\n  const entKeys = Object.keys(externalEntities);\n  for (let i = 0; i < entKeys.length; i++) {\n    const ent = entKeys[i];\n    this.lastEntities[ent] = {\n       regex: new RegExp(\"&\"+ent+\";\",\"g\"),\n       val : externalEntities[ent]\n    }\n  }\n}\n\n/**\n * @param {string} val\n * @param {string} tagName\n * @param {string} jPath\n * @param {boolean} dontTrim\n * @param {boolean} hasAttributes\n * @param {boolean} isLeafNode\n * @param {boolean} escapeEntities\n */\nfunction parseTextData(val, tagName, jPath, dontTrim, hasAttributes, isLeafNode, escapeEntities) {\n  if (val !== undefined) {\n    if (this.options.trimValues && !dontTrim) {\n      val = val.trim();\n    }\n    if(val.length > 0){\n      if(!escapeEntities) val = this.replaceEntitiesValue(val);\n      \n      const newval = this.options.tagValueProcessor(tagName, val, jPath, hasAttributes, isLeafNode);\n      if(newval === null || newval === undefined){\n        //don't parse\n        return val;\n      }else if(typeof newval !== typeof val || newval !== val){\n        //overwrite\n        return newval;\n      }else if(this.options.trimValues){\n        return parseValue(val, this.options.parseTagValue, this.options.numberParseOptions);\n      }else{\n        const trimmedVal = val.trim();\n        if(trimmedVal === val){\n          return parseValue(val, this.options.parseTagValue, this.options.numberParseOptions);\n        }else{\n          return val;\n        }\n      }\n    }\n  }\n}\n\nfunction resolveNameSpace(tagname) {\n  if (this.options.removeNSPrefix) {\n    const tags = tagname.split(':');\n    const prefix = tagname.charAt(0) === '/' ? '/' : '';\n    if (tags[0] === 'xmlns') {\n      return '';\n    }\n    if (tags.length === 2) {\n      tagname = prefix + tags[1];\n    }\n  }\n  return tagname;\n}\n\n//TODO: change regex to capture NS\n//const attrsRegx = new RegExp(\"([\\\\w\\\\-\\\\.\\\\:]+)\\\\s*=\\\\s*(['\\\"])((.|\\n)*?)\\\\2\",\"gm\");\nconst attrsRegx = new RegExp('([^\\\\s=]+)\\\\s*(=\\\\s*([\\'\"])([\\\\s\\\\S]*?)\\\\3)?', 'gm');\n\nfunction buildAttributesMap(attrStr, jPath) {\n  if (this.options.ignoreAttributes !== true && typeof attrStr === 'string') {\n    // attrStr = attrStr.replace(/\\r?\\n/g, ' ');\n    //attrStr = attrStr || attrStr.trim();\n\n    const matches = getAllMatches(attrStr, attrsRegx);\n    const len = matches.length; //don't make it inline\n    const attrs = {};\n    for (let i = 0; i < len; i++) {\n      const attrName = this.resolveNameSpace(matches[i][1]);\n      if (this.ignoreAttributesFn(attrName, jPath)) {\n        continue\n      }\n      let oldVal = matches[i][4];\n      let aName = this.options.attributeNamePrefix + attrName;\n      if (attrName.length) {\n        if (this.options.transformAttributeName) {\n          aName = this.options.transformAttributeName(aName);\n        }\n        if(aName === \"__proto__\") aName  = \"#__proto__\";\n        if (oldVal !== undefined) {\n          if (this.options.trimValues) {\n            oldVal = oldVal.trim();\n          }\n          oldVal = this.replaceEntitiesValue(oldVal);\n          const newVal = this.options.attributeValueProcessor(attrName, oldVal, jPath);\n          if(newVal === null || newVal === undefined){\n            //don't parse\n            attrs[aName] = oldVal;\n          }else if(typeof newVal !== typeof oldVal || newVal !== oldVal){\n            //overwrite\n            attrs[aName] = newVal;\n          }else{\n            //parse\n            attrs[aName] = parseValue(\n              oldVal,\n              this.options.parseAttributeValue,\n              this.options.numberParseOptions\n            );\n          }\n        } else if (this.options.allowBooleanAttributes) {\n          attrs[aName] = true;\n        }\n      }\n    }\n    if (!Object.keys(attrs).length) {\n      return;\n    }\n    if (this.options.attributesGroupName) {\n      const attrCollection = {};\n      attrCollection[this.options.attributesGroupName] = attrs;\n      return attrCollection;\n    }\n    return attrs\n  }\n}\n\nconst parseXml = function(xmlData) {\n  xmlData = xmlData.replace(/\\r\\n?/g, \"\\n\"); //TODO: remove this line\n  const xmlObj = new xmlNode('!xml');\n  let currentNode = xmlObj;\n  let textData = \"\";\n  let jPath = \"\";\n  const docTypeReader = new DocTypeReader(this.options.processEntities);\n  for(let i=0; i< xmlData.length; i++){//for each char in XML data\n    const ch = xmlData[i];\n    if(ch === '<'){\n      // const nextIndex = i+1;\n      // const _2ndChar = xmlData[nextIndex];\n      if( xmlData[i+1] === '/') {//Closing Tag\n        const closeIndex = findClosingIndex(xmlData, \">\", i, \"Closing Tag is not closed.\")\n        let tagName = xmlData.substring(i+2,closeIndex).trim();\n\n        if(this.options.removeNSPrefix){\n          const colonIndex = tagName.indexOf(\":\");\n          if(colonIndex !== -1){\n            tagName = tagName.substr(colonIndex+1);\n          }\n        }\n\n        if(this.options.transformTagName) {\n          tagName = this.options.transformTagName(tagName);\n        }\n\n        if(currentNode){\n          textData = this.saveTextToParentTag(textData, currentNode, jPath);\n        }\n\n        //check if last tag of nested tag was unpaired tag\n        const lastTagName = jPath.substring(jPath.lastIndexOf(\".\")+1);\n        if(tagName && this.options.unpairedTags.indexOf(tagName) !== -1 ){\n          throw new Error(`Unpaired tag can not be used as closing tag: </${tagName}>`);\n        }\n        let propIndex = 0\n        if(lastTagName && this.options.unpairedTags.indexOf(lastTagName) !== -1 ){\n          propIndex = jPath.lastIndexOf('.', jPath.lastIndexOf('.')-1)\n          this.tagsNodeStack.pop();\n        }else{\n          propIndex = jPath.lastIndexOf(\".\");\n        }\n        jPath = jPath.substring(0, propIndex);\n\n        currentNode = this.tagsNodeStack.pop();//avoid recursion, set the parent tag scope\n        textData = \"\";\n        i = closeIndex;\n      } else if( xmlData[i+1] === '?') {\n\n        let tagData = readTagExp(xmlData,i, false, \"?>\");\n        if(!tagData) throw new Error(\"Pi Tag is not closed.\");\n\n        textData = this.saveTextToParentTag(textData, currentNode, jPath);\n        if( (this.options.ignoreDeclaration && tagData.tagName === \"?xml\") || this.options.ignorePiTags){\n          //do nothing\n        }else{\n  \n          const childNode = new xmlNode(tagData.tagName);\n          childNode.add(this.options.textNodeName, \"\");\n          \n          if(tagData.tagName !== tagData.tagExp && tagData.attrExpPresent){\n            childNode[\":@\"] = this.buildAttributesMap(tagData.tagExp, jPath);\n          }\n          this.addChild(currentNode, childNode, jPath, i);\n        }\n\n\n        i = tagData.closeIndex + 1;\n      } else if(xmlData.substr(i + 1, 3) === '!--') {\n        const endIndex = findClosingIndex(xmlData, \"-->\", i+4, \"Comment is not closed.\")\n        if(this.options.commentPropName){\n          const comment = xmlData.substring(i + 4, endIndex - 2);\n\n          textData = this.saveTextToParentTag(textData, currentNode, jPath);\n\n          currentNode.add(this.options.commentPropName, [ { [this.options.textNodeName] : comment } ]);\n        }\n        i = endIndex;\n      } else if( xmlData.substr(i + 1, 2) === '!D') {\n        const result = docTypeReader.readDocType(xmlData, i);\n        this.docTypeEntities = result.entities;\n        i = result.i;\n      }else if(xmlData.substr(i + 1, 2) === '![') {\n        const closeIndex = findClosingIndex(xmlData, \"]]>\", i, \"CDATA is not closed.\") - 2;\n        const tagExp = xmlData.substring(i + 9,closeIndex);\n\n        textData = this.saveTextToParentTag(textData, currentNode, jPath);\n\n        let val = this.parseTextData(tagExp, currentNode.tagname, jPath, true, false, true, true);\n        if(val == undefined) val = \"\";\n\n        //cdata should be set even if it is 0 length string\n        if(this.options.cdataPropName){\n          currentNode.add(this.options.cdataPropName, [ { [this.options.textNodeName] : tagExp } ]);\n        }else{\n          currentNode.add(this.options.textNodeName, val);\n        }\n        \n        i = closeIndex + 2;\n      }else {//Opening tag\n        let result = readTagExp(xmlData,i, this.options.removeNSPrefix);\n        let tagName= result.tagName;\n        const rawTagName = result.rawTagName;\n        let tagExp = result.tagExp;\n        let attrExpPresent = result.attrExpPresent;\n        let closeIndex = result.closeIndex;\n\n        if (this.options.transformTagName) {\n          //console.log(tagExp, tagName)\n          const newTagName = this.options.transformTagName(tagName);\n          if(tagExp === tagName) {\n            tagExp = newTagName\n          }\n          tagName = newTagName;\n        }\n        \n        //save text as child node\n        if (currentNode && textData) {\n          if(currentNode.tagname !== '!xml'){\n            //when nested tag is found\n            textData = this.saveTextToParentTag(textData, currentNode, jPath, false);\n          }\n        }\n\n        //check if last tag was unpaired tag\n        const lastTag = currentNode;\n        if(lastTag && this.options.unpairedTags.indexOf(lastTag.tagname) !== -1 ){\n          currentNode = this.tagsNodeStack.pop();\n          jPath = jPath.substring(0, jPath.lastIndexOf(\".\"));\n        }\n        if(tagName !== xmlObj.tagname){\n          jPath += jPath ? \".\" + tagName : tagName;\n        }\n        const startIndex = i;\n        if (this.isItStopNode(this.stopNodesExact, this.stopNodesWildcard, jPath, tagName)) {\n          let tagContent = \"\";\n          //self-closing tag\n          if(tagExp.length > 0 && tagExp.lastIndexOf(\"/\") === tagExp.length - 1){\n            if(tagName[tagName.length - 1] === \"/\"){ //remove trailing '/'\n              tagName = tagName.substr(0, tagName.length - 1);\n              jPath = jPath.substr(0, jPath.length - 1);\n              tagExp = tagName;\n            }else{\n              tagExp = tagExp.substr(0, tagExp.length - 1);\n            }\n            i = result.closeIndex;\n          }\n          //unpaired tag\n          else if(this.options.unpairedTags.indexOf(tagName) !== -1){\n            \n            i = result.closeIndex;\n          }\n          //normal tag\n          else{\n            //read until closing tag is found\n            const result = this.readStopNodeData(xmlData, rawTagName, closeIndex + 1);\n            if(!result) throw new Error(`Unexpected end of ${rawTagName}`);\n            i = result.i;\n            tagContent = result.tagContent;\n          }\n\n          const childNode = new xmlNode(tagName);\n\n          if(tagName !== tagExp && attrExpPresent){\n            childNode[\":@\"] = this.buildAttributesMap(tagExp, jPath\n            );\n          }\n          if(tagContent) {\n            tagContent = this.parseTextData(tagContent, tagName, jPath, true, attrExpPresent, true, true);\n          }\n          \n          jPath = jPath.substr(0, jPath.lastIndexOf(\".\"));\n          childNode.add(this.options.textNodeName, tagContent);\n          \n          this.addChild(currentNode, childNode, jPath, startIndex);\n        }else{\n  //selfClosing tag\n          if(tagExp.length > 0 && tagExp.lastIndexOf(\"/\") === tagExp.length - 1){\n            if(tagName[tagName.length - 1] === \"/\"){ //remove trailing '/'\n              tagName = tagName.substr(0, tagName.length - 1);\n              jPath = jPath.substr(0, jPath.length - 1);\n              tagExp = tagName;\n            }else{\n              tagExp = tagExp.substr(0, tagExp.length - 1);\n            }\n            \n            if(this.options.transformTagName) {\n              const newTagName = this.options.transformTagName(tagName);\n              if(tagExp === tagName) {\n                tagExp = newTagName\n              }\n              tagName = newTagName;\n            }\n\n            const childNode = new xmlNode(tagName);\n            if(tagName !== tagExp && attrExpPresent){\n              childNode[\":@\"] = this.buildAttributesMap(tagExp, jPath);\n            }\n            this.addChild(currentNode, childNode, jPath, startIndex);\n            jPath = jPath.substr(0, jPath.lastIndexOf(\".\"));\n          }\n    //opening tag\n          else{\n            const childNode = new xmlNode( tagName);\n            this.tagsNodeStack.push(currentNode);\n            \n            if(tagName !== tagExp && attrExpPresent){\n              childNode[\":@\"] = this.buildAttributesMap(tagExp, jPath);\n            }\n            this.addChild(currentNode, childNode, jPath, startIndex);\n            currentNode = childNode;\n          }\n          textData = \"\";\n          i = closeIndex;\n        }\n      }\n    }else{\n      textData += xmlData[i];\n    }\n  }\n  return xmlObj.child;\n}\n\nfunction addChild(currentNode, childNode, jPath, startIndex){\n  // unset startIndex if not requested\n  if (!this.options.captureMetaData) startIndex = undefined;\n  const result = this.options.updateTag(childNode.tagname, jPath, childNode[\":@\"])\n  if(result === false){\n    //do nothing\n  } else if(typeof result === \"string\"){\n    childNode.tagname = result\n    currentNode.addChild(childNode, startIndex);\n  }else{\n    currentNode.addChild(childNode, startIndex);\n  }\n}\n\nconst replaceEntitiesValue = function(val){\n\n  if(this.options.processEntities){\n    for(let entityName in this.docTypeEntities){\n      const entity = this.docTypeEntities[entityName];\n      val = val.replace( entity.regx, entity.val);\n    }\n    for(let entityName in this.lastEntities){\n      const entity = this.lastEntities[entityName];\n      val = val.replace( entity.regex, entity.val);\n    }\n    if(this.options.htmlEntities){\n      for(let entityName in this.htmlEntities){\n        const entity = this.htmlEntities[entityName];\n        val = val.replace( entity.regex, entity.val);\n      }\n    }\n    val = val.replace( this.ampEntity.regex, this.ampEntity.val);\n  }\n  return val;\n}\nfunction saveTextToParentTag(textData, currentNode, jPath, isLeafNode) {\n  if (textData) { //store previously collected data as textNode\n    if(isLeafNode === undefined) isLeafNode = currentNode.child.length === 0\n    \n    textData = this.parseTextData(textData,\n      currentNode.tagname,\n      jPath,\n      false,\n      currentNode[\":@\"] ? Object.keys(currentNode[\":@\"]).length !== 0 : false,\n      isLeafNode);\n\n    if (textData !== undefined && textData !== \"\")\n      currentNode.add(this.options.textNodeName, textData);\n    textData = \"\";\n  }\n  return textData;\n}\n\n//TODO: use jPath to simplify the logic\n/**\n * @param {Set} stopNodesExact\n * @param {Set} stopNodesWildcard\n * @param {string} jPath\n * @param {string} currentTagName\n */\nfunction isItStopNode(stopNodesExact, stopNodesWildcard, jPath, currentTagName){\n  if(stopNodesWildcard && stopNodesWildcard.has(currentTagName)) return true;\n  if(stopNodesExact && stopNodesExact.has(jPath)) return true;\n  return false;\n}\n\n/**\n * Returns the tag Expression and where it is ending handling single-double quotes situation\n * @param {string} xmlData \n * @param {number} i starting index\n * @returns \n */\nfunction tagExpWithClosingIndex(xmlData, i, closingChar = \">\"){\n  let attrBoundary;\n  let tagExp = \"\";\n  for (let index = i; index < xmlData.length; index++) {\n    let ch = xmlData[index];\n    if (attrBoundary) {\n        if (ch === attrBoundary) attrBoundary = \"\";//reset\n    } else if (ch === '\"' || ch === \"'\") {\n        attrBoundary = ch;\n    } else if (ch === closingChar[0]) {\n      if(closingChar[1]){\n        if(xmlData[index + 1] === closingChar[1]){\n          return {\n            data: tagExp,\n            index: index\n          }\n        }\n      }else{\n        return {\n          data: tagExp,\n          index: index\n        }\n      }\n    } else if (ch === '\\t') {\n      ch = \" \"\n    }\n    tagExp += ch;\n  }\n}\n\nfunction findClosingIndex(xmlData, str, i, errMsg){\n  const closingIndex = xmlData.indexOf(str, i);\n  if(closingIndex === -1){\n    throw new Error(errMsg)\n  }else{\n    return closingIndex + str.length - 1;\n  }\n}\n\nfunction readTagExp(xmlData,i, removeNSPrefix, closingChar = \">\"){\n  const result = tagExpWithClosingIndex(xmlData, i+1, closingChar);\n  if(!result) return;\n  let tagExp = result.data;\n  const closeIndex = result.index;\n  const separatorIndex = tagExp.search(/\\s/);\n  let tagName = tagExp;\n  let attrExpPresent = true;\n  if(separatorIndex !== -1){//separate tag name and attributes expression\n    tagName = tagExp.substring(0, separatorIndex);\n    tagExp = tagExp.substring(separatorIndex + 1).trimStart();\n  }\n\n  const rawTagName = tagName;\n  if(removeNSPrefix){\n    const colonIndex = tagName.indexOf(\":\");\n    if(colonIndex !== -1){\n      tagName = tagName.substr(colonIndex+1);\n      attrExpPresent = tagName !== result.data.substr(colonIndex + 1);\n    }\n  }\n\n  return {\n    tagName: tagName,\n    tagExp: tagExp,\n    closeIndex: closeIndex,\n    attrExpPresent: attrExpPresent,\n    rawTagName: rawTagName,\n  }\n}\n/**\n * find paired tag for a stop node\n * @param {string} xmlData \n * @param {string} tagName \n * @param {number} i \n */\nfunction readStopNodeData(xmlData, tagName, i){\n  const startIndex = i;\n  // Starting at 1 since we already have an open tag\n  let openTagCount = 1;\n\n  for (; i < xmlData.length; i++) {\n    if( xmlData[i] === \"<\"){ \n      if (xmlData[i+1] === \"/\") {//close tag\n          const closeIndex = findClosingIndex(xmlData, \">\", i, `${tagName} is not closed`);\n          let closeTagName = xmlData.substring(i+2,closeIndex).trim();\n          if(closeTagName === tagName){\n            openTagCount--;\n            if (openTagCount === 0) {\n              return {\n                tagContent: xmlData.substring(startIndex, i),\n                i : closeIndex\n              }\n            }\n          }\n          i=closeIndex;\n        } else if(xmlData[i+1] === '?') { \n          const closeIndex = findClosingIndex(xmlData, \"?>\", i+1, \"StopNode is not closed.\")\n          i=closeIndex;\n        } else if(xmlData.substr(i + 1, 3) === '!--') { \n          const closeIndex = findClosingIndex(xmlData, \"-->\", i+3, \"StopNode is not closed.\")\n          i=closeIndex;\n        } else if(xmlData.substr(i + 1, 2) === '![') { \n          const closeIndex = findClosingIndex(xmlData, \"]]>\", i, \"StopNode is not closed.\") - 2;\n          i=closeIndex;\n        } else {\n          const tagData = readTagExp(xmlData, i, '>')\n\n          if (tagData) {\n            const openTagName = tagData && tagData.tagName;\n            if (openTagName === tagName && tagData.tagExp[tagData.tagExp.length-1] !== \"/\") {\n              openTagCount++;\n            }\n            i=tagData.closeIndex;\n          }\n        }\n      }\n  }//end for loop\n}\n\nfunction parseValue(val, shouldParse, options) {\n  if (shouldParse && typeof val === 'string') {\n    //console.log(options)\n    const newval = val.trim();\n    if(newval === 'true' ) return true;\n    else if(newval === 'false' ) return false;\n    else return toNumber(val, options);\n  } else {\n    if (isExist(val)) {\n      return val;\n    } else {\n      return '';\n    }\n  }\n}\n","'use strict';\n\nimport XmlNode from './xmlNode.js';\n\nconst METADATA_SYMBOL = XmlNode.getMetaDataSymbol();\n\n/**\n * \n * @param {array} node \n * @param {any} options \n * @returns \n */\nexport default function prettify(node, options){\n  return compress( node, options);\n}\n\n/**\n * \n * @param {array} arr \n * @param {object} options \n * @param {string} jPath \n * @returns object\n */\nfunction compress(arr, options, jPath){\n  let text;\n  const compressedObj = {};\n  for (let i = 0; i < arr.length; i++) {\n    const tagObj = arr[i];\n    const property = propName(tagObj);\n    let newJpath = \"\";\n    if(jPath === undefined) newJpath = property;\n    else newJpath = jPath + \".\" + property;\n\n    if(property === options.textNodeName){\n      if(text === undefined) text = tagObj[property];\n      else text += \"\" + tagObj[property];\n    }else if(property === undefined){\n      continue;\n    }else if(tagObj[property]){\n      \n      let val = compress(tagObj[property], options, newJpath);\n      const isLeaf = isLeafTag(val, options);\n      if (tagObj[METADATA_SYMBOL] !== undefined) {\n        val[METADATA_SYMBOL] = tagObj[METADATA_SYMBOL]; // copy over metadata\n      }\n\n      if(tagObj[\":@\"]){\n        assignAttributes( val, tagObj[\":@\"], newJpath, options);\n      }else if(Object.keys(val).length === 1 && val[options.textNodeName] !== undefined && !options.alwaysCreateTextNode){\n        val = val[options.textNodeName];\n      }else if(Object.keys(val).length === 0){\n        if(options.alwaysCreateTextNode) val[options.textNodeName] = \"\";\n        else val = \"\";\n      }\n\n      if(compressedObj[property] !== undefined && compressedObj.hasOwnProperty(property)) {\n        if(!Array.isArray(compressedObj[property])) {\n            compressedObj[property] = [ compressedObj[property] ];\n        }\n        compressedObj[property].push(val);\n      }else{\n        //TODO: if a node is not an array, then check if it should be an array\n        //also determine if it is a leaf node\n        if (options.isArray(property, newJpath, isLeaf )) {\n          compressedObj[property] = [val];\n        }else{\n          compressedObj[property] = val;\n        }\n      }\n    }\n    \n  }\n  // if(text && text.length > 0) compressedObj[options.textNodeName] = text;\n  if(typeof text === \"string\"){\n    if(text.length > 0) compressedObj[options.textNodeName] = text;\n  }else if(text !== undefined) compressedObj[options.textNodeName] = text;\n  return compressedObj;\n}\n\nfunction propName(obj){\n  const keys = Object.keys(obj);\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    if(key !== \":@\") return key;\n  }\n}\n\nfunction assignAttributes(obj, attrMap, jpath, options){\n  if (attrMap) {\n    const keys = Object.keys(attrMap);\n    const len = keys.length; //don't make it inline\n    for (let i = 0; i < len; i++) {\n      const atrrName = keys[i];\n      if (options.isArray(atrrName, jpath + \".\" + atrrName, true, true)) {\n        obj[atrrName] = [ attrMap[atrrName] ];\n      } else {\n        obj[atrrName] = attrMap[atrrName];\n      }\n    }\n  }\n}\n\nfunction isLeafTag(obj, options){\n  const { textNodeName } = options;\n  const propCount = Object.keys(obj).length;\n  \n  if (propCount === 0) {\n    return true;\n  }\n\n  if (\n    propCount === 1 &&\n    (obj[textNodeName] || typeof obj[textNodeName] === \"boolean\" || obj[textNodeName] === 0)\n  ) {\n    return true;\n  }\n\n  return false;\n}\n","import { buildOptions} from './OptionsBuilder.js';\nimport OrderedObjParser from './OrderedObjParser.js';\nimport prettify from './node2json.js';\nimport {validate} from \"../validator.js\";\nimport XmlNode from './xmlNode.js';\n\nexport default class XMLParser{\n    \n    constructor(options){\n        this.externalEntities = {};\n        this.options = buildOptions(options);\n        \n    }\n    /**\n     * Parse XML dats to JS object \n     * @param {string|Uint8Array} xmlData \n     * @param {boolean|Object} validationOption \n     */\n    parse(xmlData,validationOption){\n        if(typeof xmlData !== \"string\" && xmlData.toString){\n            xmlData = xmlData.toString();\n        }else if(typeof xmlData !== \"string\"){\n            throw new Error(\"XML data is accepted in String or Bytes[] form.\")\n        }\n        \n        if( validationOption){\n            if(validationOption === true) validationOption = {}; //validate with default options\n            \n            const result = validate(xmlData, validationOption);\n            if (result !== true) {\n              throw Error( `${result.err.msg}:${result.err.line}:${result.err.col}` )\n            }\n          }\n        const orderedObjParser = new OrderedObjParser(this.options);\n        orderedObjParser.addExternalEntities(this.externalEntities);\n        const orderedResult = orderedObjParser.parseXml(xmlData);\n        if(this.options.preserveOrder || orderedResult === undefined) return orderedResult;\n        else return prettify(orderedResult, this.options);\n    }\n\n    /**\n     * Add Entity which is not by default supported by this library\n     * @param {string} key \n     * @param {string} value \n     */\n    addEntity(key, value){\n        if(value.indexOf(\"&\") !== -1){\n            throw new Error(\"Entity value can't have '&'\")\n        }else if(key.indexOf(\"&\") !== -1 || key.indexOf(\";\") !== -1){\n            throw new Error(\"An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'\")\n        }else if(value === \"&\"){\n            throw new Error(\"An entity with value '&' is not permitted\");\n        }else{\n            this.externalEntities[key] = value;\n        }\n    }\n\n    /**\n     * Returns a Symbol that can be used to access the metadata\n     * property on a node.\n     * \n     * If Symbol is not available in the environment, an ordinary property is used\n     * and the name of the property is here returned.\n     * \n     * The XMLMetaData property is only present when `captureMetaData`\n     * is true in the options.\n     */\n    static getMetaDataSymbol() {\n        return XmlNode.getMetaDataSymbol();\n    }\n}\n","import { XMLParser } from \"fast-xml-parser\";\nimport { getRegisteredComponent, type RegisteredComponent } from \"../component\";\nimport { toCamelCase } from \"../ecs/naming\";\n\nexport interface ParsedElement {\n    readonly tag: string;\n    readonly attrs: Readonly<Record<string, string>>;\n    readonly children: readonly ParsedElement[];\n}\n\nexport interface EntityRef {\n    readonly attrName: string;\n    readonly targetName: string;\n}\n\nexport interface EntityDef {\n    readonly id?: string;\n    readonly components: readonly ComponentDef[];\n    readonly children: readonly EntityDef[];\n    readonly entityRefs: readonly EntityRef[];\n}\n\nexport interface ComponentDef {\n    readonly def: RegisteredComponent;\n    readonly attrs: Record<string, string>;\n}\n\nexport interface ParseResult {\n    readonly entities: readonly EntityDef[];\n    readonly errors: readonly ParseError[];\n    readonly warnings: readonly string[];\n}\n\nexport interface ParseError {\n    readonly message: string;\n    readonly path?: string;\n}\n\nexport function parseXml(xml: string): ParseResult {\n    const errors: ParseError[] = [];\n    const warnings: string[] = [];\n\n    const parser = new XMLParser({\n        ignoreAttributes: false,\n        attributeNamePrefix: \"\",\n        preserveOrder: true,\n        trimValues: true,\n        allowBooleanAttributes: true,\n    });\n\n    let raw: unknown;\n    try {\n        raw = parser.parse(xml, { allowBooleanAttributes: true });\n    } catch (e) {\n        return {\n            entities: [],\n            errors: [{ message: `xml parse error: ${(e as Error).message}` }],\n            warnings: [],\n        };\n    }\n\n    const elements = normalizeRaw(raw);\n    const entities: EntityDef[] = [];\n\n    for (const el of elements) {\n        if (el.tag === \"scene\") {\n            for (const child of el.children) {\n                const result = parseEntityElement(child, errors, warnings);\n                if (result) entities.push(result);\n            }\n        } else if (el.tag === \"a\") {\n            const result = parseEntityElement(el, errors, warnings);\n            if (result) entities.push(result);\n        } else if (el.tag.toLowerCase() === \"scene\" || el.tag.toLowerCase() === \"world\") {\n            errors.push({ message: `Invalid tag \"${el.tag}\". Use lowercase <scene>` });\n        }\n    }\n\n    return { entities, errors, warnings };\n}\n\nfunction isEntityRef(value: string): boolean {\n    return value.startsWith(\"@\") && value.length > 1;\n}\n\nfunction parseEntityElement(\n    el: ParsedElement,\n    errors: ParseError[],\n    warnings: string[]\n): EntityDef | null {\n    if (el.tag !== \"a\") {\n        if (el.tag.toLowerCase() === \"a\") {\n            errors.push({ message: `Invalid tag \"${el.tag}\". Use lowercase <a>` });\n        }\n        return null;\n    }\n\n    const components: ComponentDef[] = [];\n    const children: EntityDef[] = [];\n    const entityRefs: EntityRef[] = [];\n    const shorthands: Array<{ name: string; value: string }> = [];\n    let entityId: string | undefined;\n\n    for (const [attrName, attrValue] of Object.entries(el.attrs)) {\n        if (attrName === \"id\") {\n            entityId = attrValue;\n            continue;\n        }\n\n        if (typeof attrValue === \"string\" && isEntityRef(attrValue)) {\n            entityRefs.push({\n                attrName,\n                targetName: attrValue.slice(1),\n            });\n            continue;\n        }\n\n        const registered = getRegisteredComponent(attrName);\n        if (registered) {\n            const attrs: Record<string, string> = {};\n            if (typeof attrValue === \"string\" && attrValue !== \"\") {\n                attrs[\"_value\"] = attrValue;\n            }\n            components.push({ def: registered, attrs });\n            continue;\n        }\n\n        if (typeof attrValue === \"string\" && attrValue !== \"\") {\n            shorthands.push({ name: attrName, value: attrValue });\n        }\n    }\n\n    for (const { name, value } of shorthands) {\n        const camel = toCamelCase(name);\n        let matched = false;\n\n        for (const comp of components) {\n            const component = comp.def.component;\n            const hasField = camel in component || `${camel}X` in component;\n\n            if (hasField) {\n                matched = true;\n                if (!comp.attrs._value) {\n                    comp.attrs[name] = value;\n                }\n            }\n        }\n\n        if (!matched) {\n            const id = entityId ? ` (${entityId})` : \"\";\n            warnings.push(`shorthand \"${name}\" matches no declared component${id}`);\n        }\n    }\n\n    for (const child of el.children) {\n        if (child.tag === \"a\") {\n            const childEntity = parseEntityElement(child, errors, warnings);\n            if (childEntity) children.push(childEntity);\n        } else if (child.tag.toLowerCase() === \"a\") {\n            errors.push({ message: `Invalid tag \"${child.tag}\". Use lowercase <a>` });\n        } else {\n            errors.push({ message: `Only <a> children allowed, found <${child.tag}>` });\n        }\n    }\n\n    return { id: entityId, components, children, entityRefs };\n}\n\ninterface RawElement {\n    [key: string]: unknown;\n    \":@\"?: Record<string, string>;\n}\n\nfunction normalizeRaw(raw: unknown): ParsedElement[] {\n    if (!Array.isArray(raw)) return [];\n\n    const result: ParsedElement[] = [];\n\n    for (const item of raw as RawElement[]) {\n        if (typeof item !== \"object\" || item === null) continue;\n\n        for (const [key, value] of Object.entries(item)) {\n            if (key === \":@\") continue;\n\n            const rawAttrs = item[\":@\"] ?? {};\n            const attrs: Record<string, string> = {};\n\n            for (const [attrKey, attrVal] of Object.entries(rawAttrs)) {\n                if (typeof attrVal === \"string\") {\n                    attrs[attrKey] = attrVal;\n                } else if (attrVal === true || attrVal === \"\") {\n                    attrs[attrKey] = \"\";\n                }\n            }\n\n            const children = normalizeRaw(value as unknown);\n\n            result.push({\n                tag: key,\n                attrs,\n                children,\n            });\n        }\n    }\n\n    return result;\n}\n","import { toCamelCase, toKebabCase, findClosestMatch } from \"../ecs/naming\";\nimport type { ComponentData } from \"../component\";\n\nexport interface PropertyParseResult {\n    readonly values: Record<string, number>;\n    readonly errors: readonly string[];\n}\n\nfunction detectVec2(component: ComponentData, base: string): boolean {\n    return `${base}X` in component && `${base}Y` in component;\n}\n\nfunction detectVec3(component: ComponentData, base: string): boolean {\n    return detectVec2(component, base) && `${base}Z` in component;\n}\n\nfunction detectVec4(component: ComponentData, base: string): boolean {\n    return detectVec3(component, base) && `${base}W` in component;\n}\n\nfunction parseNumber(value: string): number | null {\n    value = value.trim();\n\n    if (value.startsWith(\"0x\") || value.startsWith(\"0X\")) {\n        return parseInt(value, 16);\n    }\n\n    if (value.startsWith(\"#\")) {\n        return parseInt(value.slice(1), 16);\n    }\n\n    if (value === \"true\") return 1;\n    if (value === \"false\") return 0;\n\n    const num = parseFloat(value);\n    return isNaN(num) ? null : num;\n}\n\nfunction parseValues(valueStr: string): (number | null)[] {\n    return valueStr.trim().split(/\\s+/).map(parseNumber);\n}\n\nexport function parsePropertyString(\n    componentName: string,\n    propertyString: string,\n    component: ComponentData\n): PropertyParseResult {\n    const values: Record<string, number> = {};\n    const errors: string[] = [];\n\n    const properties = propertyString\n        .split(\";\")\n        .map((p) => p.trim())\n        .filter(Boolean);\n\n    for (const prop of properties) {\n        const colonIdx = prop.indexOf(\":\");\n        if (colonIdx === -1) {\n            errors.push(`Invalid syntax: \"${prop}\" (expected \"field: value\")`);\n            continue;\n        }\n\n        const rawName = prop.slice(0, colonIdx).trim();\n        const valueStr = prop.slice(colonIdx + 1).trim();\n\n        if (!rawName || !valueStr) {\n            errors.push(`Invalid syntax: \"${prop}\" (empty field or value)`);\n            continue;\n        }\n\n        const name = toCamelCase(rawName);\n        const parsed = parseValues(valueStr);\n\n        if (parsed.some((v) => v === null)) {\n            errors.push(`Invalid number in \"${prop}\"`);\n            continue;\n        }\n\n        const nums = parsed as number[];\n\n        if (detectVec4(component, name)) {\n            if (nums.length === 4) {\n                values[`${name}X`] = nums[0];\n                values[`${name}Y`] = nums[1];\n                values[`${name}Z`] = nums[2];\n                values[`${name}W`] = nums[3];\n            } else if (nums.length === 1) {\n                values[`${name}X`] = nums[0];\n                values[`${name}Y`] = nums[0];\n                values[`${name}Z`] = nums[0];\n                values[`${name}W`] = nums[0];\n            } else {\n                errors.push(\n                    `${componentName}.${rawName}: expected 1 or 4 values, got ${nums.length}`\n                );\n            }\n            continue;\n        }\n\n        if (detectVec3(component, name)) {\n            if (nums.length === 3) {\n                values[`${name}X`] = nums[0];\n                values[`${name}Y`] = nums[1];\n                values[`${name}Z`] = nums[2];\n            } else if (nums.length === 1) {\n                values[`${name}X`] = nums[0];\n                values[`${name}Y`] = nums[0];\n                values[`${name}Z`] = nums[0];\n            } else {\n                errors.push(\n                    `${componentName}.${rawName}: expected 1 or 3 values, got ${nums.length}`\n                );\n            }\n            continue;\n        }\n\n        if (detectVec2(component, name)) {\n            if (nums.length === 2) {\n                values[`${name}X`] = nums[0];\n                values[`${name}Y`] = nums[1];\n            } else if (nums.length === 1) {\n                values[`${name}X`] = nums[0];\n                values[`${name}Y`] = nums[0];\n            } else {\n                errors.push(\n                    `${componentName}.${rawName}: expected 1 or 2 values, got ${nums.length}`\n                );\n            }\n            continue;\n        }\n\n        if (name in component) {\n            if (nums.length === 1) {\n                values[name] = nums[0];\n            } else {\n                errors.push(`${componentName}.${rawName}: expected 1 value, got ${nums.length}`);\n            }\n            continue;\n        }\n\n        const fieldNames = Object.keys(component);\n        const suggestion = findClosestMatch(rawName, fieldNames);\n        if (suggestion) {\n            errors.push(\n                `${componentName}: unknown field \"${rawName}\", did you mean \"${toKebabCase(suggestion)}\"?`\n            );\n        } else {\n            errors.push(`${componentName}: unknown field \"${rawName}\"`);\n        }\n    }\n\n    return { values, errors };\n}\n\nexport function isCSSAttrSyntax(value: string): boolean {\n    return value.includes(\":\") && (value.includes(\";\") || /^[\\w-]+\\s*:/.test(value));\n}\n","import { addComponent, Pair } from \"bitecs\";\nimport type { State } from \"../state\";\nimport type { ParseContext, ComponentData, RegisteredComponent } from \"../component\";\nimport { getRelationDef } from \"../relation\";\nimport {\n    parseXml,\n    type EntityDef,\n    type ComponentDef,\n    type ParseError,\n    type EntityRef,\n} from \"./parser\";\nimport { parsePropertyString, isCSSAttrSyntax } from \"./property-parser\";\nimport { initRuntime } from \"../runtime\";\nimport { ChildOf } from \"../hierarchy\";\n\nexport interface LoadResult {\n    readonly entities: Map<string, number>;\n    readonly roots: readonly number[];\n    readonly errors: readonly ParseError[];\n}\n\nexport type PostLoadHook = (state: State, context: ParseContext) => void;\n\nconst postLoadHooks: PostLoadHook[] = [];\n\nexport function registerPostLoadHook(hook: PostLoadHook): void {\n    postLoadHooks.push(hook);\n}\n\nexport function unregisterPostLoadHook(hook: PostLoadHook): void {\n    const idx = postLoadHooks.indexOf(hook);\n    if (idx !== -1) postLoadHooks.splice(idx, 1);\n}\n\nclass LoadParseContext implements ParseContext {\n    private readonly nameToEntity = new Map<string, number>();\n    private _currentEid = 0;\n\n    get currentEid(): number {\n        return this._currentEid;\n    }\n\n    setCurrentEid(eid: number): void {\n        this._currentEid = eid;\n    }\n\n    getEntityByName(name: string): number | null {\n        return this.nameToEntity.get(name) ?? null;\n    }\n\n    setName(name: string, eid: number): void {\n        this.nameToEntity.set(name, eid);\n    }\n\n    getEntityMap(): Map<string, number> {\n        return new Map(this.nameToEntity);\n    }\n}\n\nexport function loadScene(state: State, xml: string): LoadResult {\n    const parseResult = parseXml(xml);\n    return instantiateScene(state, parseResult.entities, parseResult.errors);\n}\n\nexport async function loadSceneFile(state: State, path: string): Promise<LoadResult> {\n    const runtime = await initRuntime();\n    const xml = await runtime.readFile(path);\n    return loadScene(state, xml);\n}\n\ninterface QueuedEntity {\n    readonly def: EntityDef;\n    readonly eid: number;\n    readonly parent?: number;\n}\n\nfunction instantiateScene(\n    state: State,\n    entityDefs: readonly EntityDef[],\n    parseErrors: readonly ParseError[]\n): LoadResult {\n    const context = new LoadParseContext();\n    const errors: ParseError[] = [...parseErrors];\n    const queue: QueuedEntity[] = [];\n    const roots: number[] = [];\n\n    for (const entityDef of entityDefs) {\n        const eid = createEntityTree(state, entityDef, context, undefined, queue);\n        roots.push(eid);\n    }\n\n    for (const { def, eid, parent } of queue) {\n        if (parent !== undefined) {\n            addComponent(state.world, eid, Pair(ChildOf.relation, parent));\n        }\n\n        for (const ref of def.entityRefs) {\n            applyRelation(state, eid, ref, context, errors);\n        }\n\n        for (const compDef of def.components) {\n            applyComponent(state, eid, compDef, context, errors);\n        }\n    }\n\n    for (const hook of postLoadHooks) {\n        hook(state, context);\n    }\n\n    return {\n        entities: context.getEntityMap(),\n        roots,\n        errors,\n    };\n}\n\nfunction createEntityTree(\n    state: State,\n    def: EntityDef,\n    context: LoadParseContext,\n    parent: number | undefined,\n    queue: QueuedEntity[]\n): number {\n    const eid = state.addEntity();\n\n    if (def.id) {\n        context.setName(def.id, eid);\n    }\n\n    queue.push({ def, eid, parent });\n\n    for (const childDef of def.children) {\n        createEntityTree(state, childDef, context, eid, queue);\n    }\n\n    return eid;\n}\n\nfunction applyRelation(\n    state: State,\n    eid: number,\n    ref: EntityRef,\n    context: LoadParseContext,\n    errors: ParseError[]\n): void {\n    const relationDef = getRelationDef(ref.attrName);\n    if (!relationDef) {\n        errors.push({ message: `Unknown relation: \"${ref.attrName}\"` });\n        return;\n    }\n\n    const targetEid = context.getEntityByName(ref.targetName);\n    if (targetEid === null) {\n        errors.push({ message: `Unknown entity: \"@${ref.targetName}\"` });\n        return;\n    }\n\n    state.addRelation(eid, relationDef, targetEid);\n}\n\nfunction applyComponent(\n    state: State,\n    eid: number,\n    compDef: ComponentDef,\n    context: LoadParseContext,\n    errors: ParseError[]\n): void {\n    const { def, attrs } = compDef;\n    const { component, name, traits } = def;\n\n    state.addComponent(eid, component as never);\n\n    const defaults = traits?.defaults?.() ?? {};\n    for (const [field, value] of Object.entries(defaults)) {\n        setFieldValue(component, field, eid, value as number);\n    }\n\n    let values: Record<string, number>;\n\n    context.setCurrentEid(eid);\n    if (traits?.adapter) {\n        values = traits.adapter(attrs, state, context) as Record<string, number>;\n    } else {\n        const result = parseAttrs(def, attrs);\n        values = result.values;\n        for (const err of result.errors) {\n            errors.push({ message: `<${name}> ${err}` });\n        }\n    }\n\n    for (const [field, value] of Object.entries(values)) {\n        setFieldValue(component, field, eid, value);\n    }\n}\n\nfunction parseAttrs(\n    def: RegisteredComponent,\n    attrs: Record<string, string>\n): { values: Record<string, number>; errors: string[] } {\n    const allValues: Record<string, number> = {};\n    const allErrors: string[] = [];\n\n    if (attrs._value) {\n        if (isCSSAttrSyntax(attrs._value)) {\n            const result = parsePropertyString(def.name, attrs._value, def.component);\n            Object.assign(allValues, result.values);\n            allErrors.push(...result.errors);\n        }\n    }\n\n    for (const [attrName, attrValue] of Object.entries(attrs)) {\n        if (attrName === \"_value\") continue;\n        if (!attrValue) continue;\n\n        if (isCSSAttrSyntax(attrValue)) {\n            const result = parsePropertyString(def.name, attrValue, def.component);\n            Object.assign(allValues, result.values);\n            allErrors.push(...result.errors);\n        } else {\n            const result = parsePropertyString(\n                def.name,\n                `${attrName}: ${attrValue}`,\n                def.component\n            );\n            Object.assign(allValues, result.values);\n            allErrors.push(...result.errors);\n        }\n    }\n\n    return { values: allValues, errors: allErrors };\n}\n\nfunction setFieldValue(component: ComponentData, field: string, eid: number, value: number): void {\n    const arr = component[field];\n    if (arr != null && (ArrayBuffer.isView(arr) || Array.isArray(arr))) {\n        arr[eid] = value;\n    }\n}\n","import { requestGPU as coreRequestGPU } from \"../../../core\";\n\nexport interface GPUCore {\n    device: GPUDevice;\n    format: GPUTextureFormat;\n}\n\nexport interface GPUContext extends GPUCore {\n    context: GPUCanvasContext;\n    canvas: HTMLCanvasElement;\n}\n\nasync function createCore(): Promise<GPUCore> {\n    const device = await coreRequestGPU();\n    const format = navigator.gpu.getPreferredCanvasFormat();\n    return { device, format };\n}\n\nconst shared = createCore();\n\nexport async function initGPU(\n    canvas: HTMLCanvasElement,\n    device?: GPUDevice\n): Promise<GPUContext> {\n    const core = device\n        ? { device, format: navigator.gpu.getPreferredCanvasFormat() }\n        : await shared;\n\n    const context = canvas.getContext(\"webgpu\");\n    if (!context) {\n        throw new Error(\"Failed to get WebGPU context\");\n    }\n\n    context.configure({ device: core.device, format: core.format, alphaMode: \"opaque\" });\n\n    return { ...core, context, canvas };\n}\n","export interface BufferDescriptor {\n    size: number;\n    usage: GPUBufferUsageFlags;\n    label?: string;\n    mappedAtCreation?: boolean;\n}\n\nexport function createBuffer(device: GPUDevice, desc: BufferDescriptor): GPUBuffer {\n    return device.createBuffer({\n        size: desc.size,\n        usage: desc.usage,\n        label: desc.label,\n        mappedAtCreation: desc.mappedAtCreation,\n    });\n}\n\nexport function writeBuffer(\n    device: GPUDevice,\n    buffer: GPUBuffer,\n    data: Float32Array,\n    offset = 0\n): void {\n    device.queue.writeBuffer(buffer, offset, data as Float32Array<ArrayBuffer>);\n}\n\nexport function createUniformBuffer(device: GPUDevice, size: number, label?: string): GPUBuffer {\n    return createBuffer(device, {\n        size,\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n        label,\n    });\n}\n\nexport function createStorageBuffer(device: GPUDevice, size: number, label?: string): GPUBuffer {\n    return createBuffer(device, {\n        size,\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        label,\n    });\n}\n\nexport function createVertexBuffer(\n    device: GPUDevice,\n    data: Float32Array,\n    label?: string\n): GPUBuffer {\n    const buffer = createBuffer(device, {\n        size: data.byteLength,\n        usage: GPUBufferUsage.VERTEX | GPUBufferUsage.COPY_DST,\n        label,\n    });\n    device.queue.writeBuffer(buffer, 0, data as Float32Array<ArrayBuffer>);\n    return buffer;\n}\n\nexport function createIndexBuffer(device: GPUDevice, data: Uint16Array, label?: string): GPUBuffer {\n    const buffer = createBuffer(device, {\n        size: data.byteLength,\n        usage: GPUBufferUsage.INDEX | GPUBufferUsage.COPY_DST,\n        label,\n    });\n    device.queue.writeBuffer(buffer, 0, data as Uint16Array<ArrayBuffer>);\n    return buffer;\n}\n","export interface RenderPassConfig {\n    colorView: GPUTextureView;\n    clearColor?: GPUColor;\n    depthView?: GPUTextureView;\n    clearDepth?: number;\n}\n\nexport function beginRenderPass(\n    encoder: GPUCommandEncoder,\n    config: RenderPassConfig\n): GPURenderPassEncoder {\n    const colorAttachment: GPURenderPassColorAttachment = {\n        view: config.colorView,\n        clearValue: config.clearColor ?? { r: 0.1, g: 0.1, b: 0.1, a: 1.0 },\n        loadOp: \"clear\",\n        storeOp: \"store\",\n    };\n\n    const descriptor: GPURenderPassDescriptor = {\n        colorAttachments: [colorAttachment],\n    };\n\n    if (config.depthView) {\n        descriptor.depthStencilAttachment = {\n            view: config.depthView,\n            depthClearValue: config.clearDepth ?? 1.0,\n            depthLoadOp: \"clear\",\n            depthStoreOp: \"store\",\n        };\n    }\n\n    return encoder.beginRenderPass(descriptor);\n}\n\nexport function createDepthTexture(device: GPUDevice, width: number, height: number): GPUTexture {\n    return device.createTexture({\n        size: { width, height },\n        format: \"depth24plus\",\n        usage: GPUTextureUsage.RENDER_ATTACHMENT,\n    });\n}\n","import type { Geometry } from \"./index\";\n\nexport function createBoxGeometry(): Geometry {\n    const vertices = new Float32Array([\n        -0.5, -0.5, 0.5, 0, 0, 1, 0.5, -0.5, 0.5, 0, 0, 1, 0.5, 0.5, 0.5, 0, 0, 1, -0.5, 0.5, 0.5,\n        0, 0, 1,\n\n        0.5, -0.5, -0.5, 0, 0, -1, -0.5, -0.5, -0.5, 0, 0, -1, -0.5, 0.5, -0.5, 0, 0, -1, 0.5, 0.5,\n        -0.5, 0, 0, -1,\n\n        -0.5, 0.5, 0.5, 0, 1, 0, 0.5, 0.5, 0.5, 0, 1, 0, 0.5, 0.5, -0.5, 0, 1, 0, -0.5, 0.5, -0.5,\n        0, 1, 0,\n\n        -0.5, -0.5, -0.5, 0, -1, 0, 0.5, -0.5, -0.5, 0, -1, 0, 0.5, -0.5, 0.5, 0, -1, 0, -0.5, -0.5,\n        0.5, 0, -1, 0,\n\n        0.5, -0.5, 0.5, 1, 0, 0, 0.5, -0.5, -0.5, 1, 0, 0, 0.5, 0.5, -0.5, 1, 0, 0, 0.5, 0.5, 0.5,\n        1, 0, 0,\n\n        -0.5, -0.5, -0.5, -1, 0, 0, -0.5, -0.5, 0.5, -1, 0, 0, -0.5, 0.5, 0.5, -1, 0, 0, -0.5, 0.5,\n        -0.5, -1, 0, 0,\n    ]);\n\n    const indices = new Uint16Array([\n        0, 1, 2, 0, 2, 3, 4, 5, 6, 4, 6, 7, 8, 9, 10, 8, 10, 11, 12, 13, 14, 12, 14, 15, 16, 17, 18,\n        16, 18, 19, 20, 21, 22, 20, 22, 23,\n    ]);\n\n    return {\n        vertices,\n        indices,\n        vertexCount: 24,\n        indexCount: 36,\n    };\n}\n","import type { Geometry } from \"./index\";\n\nexport function createSphereGeometry(segments = 32, rings = 16): Geometry {\n    const vertices: number[] = [];\n    const indices: number[] = [];\n    const radius = 0.5;\n\n    for (let y = 0; y <= rings; y++) {\n        const v = y / rings;\n        const theta = v * Math.PI;\n\n        for (let x = 0; x <= segments; x++) {\n            const u = x / segments;\n            const phi = u * Math.PI * 2;\n\n            const nx = Math.sin(theta) * Math.cos(phi);\n            const ny = Math.cos(theta);\n            const nz = Math.sin(theta) * Math.sin(phi);\n\n            vertices.push(nx * radius, ny * radius, nz * radius, nx, ny, nz);\n        }\n    }\n\n    for (let y = 0; y < rings; y++) {\n        for (let x = 0; x < segments; x++) {\n            const a = y * (segments + 1) + x;\n            const b = a + segments + 1;\n\n            indices.push(a, a + 1, b);\n            indices.push(a + 1, b + 1, b);\n        }\n    }\n\n    const vertexCount = (rings + 1) * (segments + 1);\n    const indexCount = rings * segments * 6;\n\n    return {\n        vertices: new Float32Array(vertices),\n        indices: new Uint16Array(indices),\n        vertexCount,\n        indexCount,\n    };\n}\n","import type { Geometry } from \"./index\";\n\nexport function createPlaneGeometry(): Geometry {\n    const vertices = new Float32Array([\n        -0.5, 0, 0.5, 0, 1, 0, 0.5, 0, 0.5, 0, 1, 0, 0.5, 0, -0.5, 0, 1, 0, -0.5, 0, -0.5, 0, 1, 0,\n    ]);\n\n    const indices = new Uint16Array([0, 1, 2, 0, 2, 3]);\n\n    return {\n        vertices,\n        indices,\n        vertexCount: 4,\n        indexCount: 6,\n    };\n}\n","let wasm;\n\n/**\n * @param {number} count\n */\nexport function compute_transforms(count) {\n    wasm.compute_transforms(count);\n}\n\n/**\n * @returns {number}\n */\nexport function get_indices_ptr() {\n    const ret = wasm.get_indices_ptr();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_matrices_ptr() {\n    const ret = wasm.get_matrices_ptr();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_max_entities() {\n    const ret = wasm.get_max_entities();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_no_parent() {\n    const ret = wasm.get_no_parent();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_parents_ptr() {\n    const ret = wasm.get_parents_ptr();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_pos_x_ptr() {\n    const ret = wasm.get_pos_x_ptr();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_pos_y_ptr() {\n    const ret = wasm.get_pos_y_ptr();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_pos_z_ptr() {\n    const ret = wasm.get_pos_z_ptr();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_quat_w_ptr() {\n    const ret = wasm.get_quat_w_ptr();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_quat_x_ptr() {\n    const ret = wasm.get_quat_x_ptr();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_quat_y_ptr() {\n    const ret = wasm.get_quat_y_ptr();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_quat_z_ptr() {\n    const ret = wasm.get_quat_z_ptr();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_scale_x_ptr() {\n    const ret = wasm.get_scale_x_ptr();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_scale_y_ptr() {\n    const ret = wasm.get_scale_y_ptr();\n    return ret >>> 0;\n}\n\n/**\n * @returns {number}\n */\nexport function get_scale_z_ptr() {\n    const ret = wasm.get_scale_z_ptr();\n    return ret >>> 0;\n}\n\nexport function init_data() {\n    wasm.init_data();\n}\n\nconst EXPECTED_RESPONSE_TYPES = new Set(['basic', 'cors', 'default']);\n\nasync function __wbg_load(module, imports) {\n    if (typeof Response === 'function' && module instanceof Response) {\n        if (typeof WebAssembly.instantiateStreaming === 'function') {\n            try {\n                return await WebAssembly.instantiateStreaming(module, imports);\n            } catch (e) {\n                const validResponse = module.ok && EXPECTED_RESPONSE_TYPES.has(module.type);\n\n                if (validResponse && module.headers.get('Content-Type') !== 'application/wasm') {\n                    console.warn(\"`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n\", e);\n\n                } else {\n                    throw e;\n                }\n            }\n        }\n\n        const bytes = await module.arrayBuffer();\n        return await WebAssembly.instantiate(bytes, imports);\n    } else {\n        const instance = await WebAssembly.instantiate(module, imports);\n\n        if (instance instanceof WebAssembly.Instance) {\n            return { instance, module };\n        } else {\n            return instance;\n        }\n    }\n}\n\nfunction __wbg_get_imports() {\n    const imports = {};\n    imports.wbg = {};\n\n    return imports;\n}\n\nfunction __wbg_finalize_init(instance, module) {\n    wasm = instance.exports;\n    __wbg_init.__wbindgen_wasm_module = module;\n\n\n\n    return wasm;\n}\n\nfunction initSync(module) {\n    if (wasm !== undefined) return wasm;\n\n\n    if (typeof module !== 'undefined') {\n        if (Object.getPrototypeOf(module) === Object.prototype) {\n            ({module} = module)\n        } else {\n            console.warn('using deprecated parameters for `initSync()`; pass a single object instead')\n        }\n    }\n\n    const imports = __wbg_get_imports();\n    if (!(module instanceof WebAssembly.Module)) {\n        module = new WebAssembly.Module(module);\n    }\n    const instance = new WebAssembly.Instance(module, imports);\n    return __wbg_finalize_init(instance, module);\n}\n\nasync function __wbg_init(module_or_path) {\n    if (wasm !== undefined) return wasm;\n\n\n    if (typeof module_or_path !== 'undefined') {\n        if (Object.getPrototypeOf(module_or_path) === Object.prototype) {\n            ({module_or_path} = module_or_path)\n        } else {\n            console.warn('using deprecated parameters for the initialization function; pass a single object instead')\n        }\n    }\n\n    if (typeof module_or_path === 'undefined') {\n        module_or_path = new URL('shallot_transforms_bg.wasm', import.meta.url);\n    }\n    const imports = __wbg_get_imports();\n\n    if (typeof module_or_path === 'string' || (typeof Request === 'function' && module_or_path instanceof Request) || (typeof URL === 'function' && module_or_path instanceof URL)) {\n        module_or_path = fetch(module_or_path);\n    }\n\n    const { instance, module } = await __wbg_load(await module_or_path, imports);\n\n    return __wbg_finalize_init(instance, module);\n}\n\nexport { initSync };\nexport default __wbg_init;\n","import wasmInit, {\n    get_pos_x_ptr,\n    get_pos_y_ptr,\n    get_pos_z_ptr,\n    get_quat_x_ptr,\n    get_quat_y_ptr,\n    get_quat_z_ptr,\n    get_quat_w_ptr,\n    get_scale_x_ptr,\n    get_scale_y_ptr,\n    get_scale_z_ptr,\n    get_matrices_ptr,\n    get_indices_ptr,\n    get_parents_ptr,\n    get_max_entities,\n    get_no_parent,\n    init_data,\n    compute_transforms,\n} from \"../../../rust/transforms/pkg/shallot_transforms.js\";\n\nexport let posX: Float32Array;\nexport let posY: Float32Array;\nexport let posZ: Float32Array;\nexport let quatX: Float32Array;\nexport let quatY: Float32Array;\nexport let quatZ: Float32Array;\nexport let quatW: Float32Array;\nexport let scaleX: Float32Array;\nexport let scaleY: Float32Array;\nexport let scaleZ: Float32Array;\nexport let matrices: Float32Array;\nexport let indices: Uint32Array;\nexport let parents: Uint32Array;\nexport let NoParent: number;\n\nexport async function init(): Promise<void> {\n    if (posX) return;\n    const wasm = await wasmInit();\n    init_data();\n    const buffer = wasm.memory.buffer;\n    const maxEntities = get_max_entities();\n\n    posX = new Float32Array(buffer, get_pos_x_ptr(), maxEntities);\n    posY = new Float32Array(buffer, get_pos_y_ptr(), maxEntities);\n    posZ = new Float32Array(buffer, get_pos_z_ptr(), maxEntities);\n    quatX = new Float32Array(buffer, get_quat_x_ptr(), maxEntities);\n    quatY = new Float32Array(buffer, get_quat_y_ptr(), maxEntities);\n    quatZ = new Float32Array(buffer, get_quat_z_ptr(), maxEntities);\n    quatW = new Float32Array(buffer, get_quat_w_ptr(), maxEntities);\n    scaleX = new Float32Array(buffer, get_scale_x_ptr(), maxEntities);\n    scaleY = new Float32Array(buffer, get_scale_y_ptr(), maxEntities);\n    scaleZ = new Float32Array(buffer, get_scale_z_ptr(), maxEntities);\n    matrices = new Float32Array(buffer, get_matrices_ptr(), maxEntities * 16);\n    indices = new Uint32Array(buffer, get_indices_ptr(), maxEntities);\n    parents = new Uint32Array(buffer, get_parents_ptr(), maxEntities);\n    NoParent = get_no_parent();\n}\n\nexport function compute(count: number): void {\n    compute_transforms(count);\n}\n","import { Hierarchy, Not, Wildcard } from \"bitecs\";\nimport { quat, utils } from \"wgpu-matrix\";\nimport { ChildOf } from \"../../core/hierarchy\";\nimport { setTraits } from \"../../core/component\";\nimport { MAX_ENTITIES } from \"../../core/constants\";\nimport type { State, System, Plugin } from \"../../core\";\nimport { eulerToQuaternion, quaternionToEuler } from \"../../core/math\";\nimport * as wasm from \"./wasm\";\n\nconst tempQuatA = quat.create();\nconst tempQuatB = quat.create();\nconst tempQuatResult = quat.create();\n\nexport function rotate(eid: number, dx: number, dy: number, dz: number): void {\n    quat.fromEuler(utils.degToRad(dx), utils.degToRad(dy), utils.degToRad(dz), \"xyz\", tempQuatA);\n    quat.set(\n        Transform.quatX[eid],\n        Transform.quatY[eid],\n        Transform.quatZ[eid],\n        Transform.quatW[eid],\n        tempQuatB\n    );\n    quat.multiply(tempQuatB, tempQuatA, tempQuatResult);\n    Transform.quatX[eid] = tempQuatResult[0];\n    Transform.quatY[eid] = tempQuatResult[1];\n    Transform.quatZ[eid] = tempQuatResult[2];\n    Transform.quatW[eid] = tempQuatResult[3];\n}\n\ninterface EulerProxy extends Array<number> {\n    get(eid: number): number;\n    set(eid: number, value: number): void;\n}\n\nfunction eulerProxy(axis: \"x\" | \"y\" | \"z\"): EulerProxy {\n    function getValue(eid: number): number {\n        const e = quaternionToEuler(\n            Transform.quatX[eid],\n            Transform.quatY[eid],\n            Transform.quatZ[eid],\n            Transform.quatW[eid]\n        );\n        return e[axis];\n    }\n\n    function setValue(eid: number, value: number): void {\n        const e = quaternionToEuler(\n            Transform.quatX[eid],\n            Transform.quatY[eid],\n            Transform.quatZ[eid],\n            Transform.quatW[eid]\n        );\n        e[axis] = value;\n        const q = eulerToQuaternion(e.x, e.y, e.z);\n        Transform.quatX[eid] = q.x;\n        Transform.quatY[eid] = q.y;\n        Transform.quatZ[eid] = q.z;\n        Transform.quatW[eid] = q.w;\n    }\n\n    return new Proxy([] as unknown as EulerProxy, {\n        get(_, prop) {\n            if (prop === \"get\") return getValue;\n            if (prop === \"set\") return setValue;\n            const eid = Number(prop);\n            if (Number.isNaN(eid)) return undefined;\n            return getValue(eid);\n        },\n        set(_, prop, value) {\n            const eid = Number(prop);\n            if (Number.isNaN(eid)) return false;\n            setValue(eid, value);\n            return true;\n        },\n    });\n}\n\nexport const Transform: {\n    posX: Float32Array;\n    posY: Float32Array;\n    posZ: Float32Array;\n    quatX: Float32Array;\n    quatY: Float32Array;\n    quatZ: Float32Array;\n    quatW: Float32Array;\n    scaleX: Float32Array;\n    scaleY: Float32Array;\n    scaleZ: Float32Array;\n    eulerX: EulerProxy;\n    eulerY: EulerProxy;\n    eulerZ: EulerProxy;\n} = {\n    posX: new Float32Array(MAX_ENTITIES),\n    posY: new Float32Array(MAX_ENTITIES),\n    posZ: new Float32Array(MAX_ENTITIES),\n    quatX: new Float32Array(MAX_ENTITIES),\n    quatY: new Float32Array(MAX_ENTITIES),\n    quatZ: new Float32Array(MAX_ENTITIES),\n    quatW: new Float32Array(MAX_ENTITIES),\n    scaleX: new Float32Array(MAX_ENTITIES),\n    scaleY: new Float32Array(MAX_ENTITIES),\n    scaleZ: new Float32Array(MAX_ENTITIES),\n    eulerX: eulerProxy(\"x\"),\n    eulerY: eulerProxy(\"y\"),\n    eulerZ: eulerProxy(\"z\"),\n};\n\nexport const WorldTransform: { data: Float32Array } = {\n    data: new Float32Array(MAX_ENTITIES * 16),\n};\n\nsetTraits(Transform, {\n    defaults: () => ({\n        posX: 0,\n        posY: 0,\n        posZ: 0,\n        quatX: 0,\n        quatY: 0,\n        quatZ: 0,\n        quatW: 1,\n        scaleX: 1,\n        scaleY: 1,\n        scaleZ: 1,\n    }),\n    accessors: {\n        eulerX: Transform.eulerX,\n        eulerY: Transform.eulerY,\n        eulerZ: Transform.eulerZ,\n    },\n});\n\nasync function init(): Promise<void> {\n    await wasm.init();\n\n    Transform.posX = wasm.posX;\n    Transform.posY = wasm.posY;\n    Transform.posZ = wasm.posZ;\n    Transform.quatX = wasm.quatX;\n    Transform.quatY = wasm.quatY;\n    Transform.quatZ = wasm.quatZ;\n    Transform.quatW = wasm.quatW;\n    Transform.scaleX = wasm.scaleX;\n    Transform.scaleY = wasm.scaleY;\n    Transform.scaleZ = wasm.scaleZ;\n    WorldTransform.data = wasm.matrices;\n}\n\nconst TransformSystem: System = {\n    group: \"simulation\",\n    last: true,\n\n    update(state: State) {\n        for (const eid of state.query([Transform, Not(WorldTransform)])) {\n            state.addComponent(eid, WorldTransform);\n        }\n\n        let count = 0;\n\n        for (const eid of state.query([Transform, Not(ChildOf.relation(Wildcard))])) {\n            wasm.indices[count] = eid;\n            wasm.parents[count] = wasm.NoParent;\n            count++;\n        }\n\n        for (const eid of state.query([\n            Transform,\n            ChildOf.relation(Wildcard),\n            Hierarchy(ChildOf.relation),\n        ])) {\n            wasm.indices[count] = eid;\n            wasm.parents[count] = state.getRelationTargets(eid, ChildOf)[0];\n            count++;\n        }\n\n        wasm.compute(count);\n    },\n};\n\nexport const TransformsPlugin: Plugin = {\n    systems: [TransformSystem],\n    components: { Transform, WorldTransform },\n    initialize: init,\n};\n","import { observe, onAdd } from \"bitecs\";\nimport { setTraits } from \"../../core/component\";\nimport type { State, System } from \"../../core\";\nimport { MAX_ENTITIES } from \"../../core/constants\";\nimport { WorldTransform } from \"../transforms\";\nimport { Render, getShapeBuffers, type WebGPURenderContext, type ShapeBuffers } from \"./context\";\n\nexport const MeshShape = {\n    Box: 0,\n    Sphere: 1,\n    Plane: 2,\n} as const;\n\nfunction sizeProxy(offset: number): Float32Array {\n    function getValue(eid: number): number {\n        return Mesh.data[eid * 8 + offset];\n    }\n    function setValue(eid: number, value: number): void {\n        Mesh.data[eid * 8 + offset] = value;\n    }\n    return new Proxy([] as unknown as Float32Array, {\n        get(_, prop) {\n            if (prop === \"get\") return getValue;\n            if (prop === \"set\") return setValue;\n            const eid = Number(prop);\n            if (Number.isNaN(eid)) return undefined;\n            return getValue(eid);\n        },\n        set(_, prop, value) {\n            const eid = Number(prop);\n            if (Number.isNaN(eid)) return false;\n            setValue(eid, value);\n            return true;\n        },\n    });\n}\n\nfunction colorProxy(): Uint32Array {\n    function getValue(eid: number): number {\n        const o = eid * 8 + 4;\n        const r = Math.round(Mesh.data[o + 0] * 255);\n        const g = Math.round(Mesh.data[o + 1] * 255);\n        const b = Math.round(Mesh.data[o + 2] * 255);\n        const a = Math.round(Mesh.data[o + 3] * 255);\n        return ((a << 24) | (r << 16) | (g << 8) | b) >>> 0;\n    }\n    function setValue(eid: number, value: number): void {\n        const o = eid * 8 + 4;\n        Mesh.data[o + 0] = ((value >> 16) & 0xff) / 255;\n        Mesh.data[o + 1] = ((value >> 8) & 0xff) / 255;\n        Mesh.data[o + 2] = (value & 0xff) / 255;\n        Mesh.data[o + 3] = ((value >> 24) & 0xff) / 255;\n    }\n    return new Proxy([] as unknown as Uint32Array, {\n        get(_, prop) {\n            if (prop === \"get\") return getValue;\n            if (prop === \"set\") return setValue;\n            const eid = Number(prop);\n            if (Number.isNaN(eid)) return undefined;\n            return getValue(eid);\n        },\n        set(_, prop, value) {\n            const eid = Number(prop);\n            if (Number.isNaN(eid)) return false;\n            setValue(eid, value);\n            return true;\n        },\n    });\n}\n\nexport const Mesh = {\n    shape: new Uint32Array(MAX_ENTITIES),\n    visible: new Uint32Array(MAX_ENTITIES),\n    sizeX: sizeProxy(0),\n    sizeY: sizeProxy(1),\n    sizeZ: sizeProxy(2),\n    color: colorProxy(),\n    data: new Float32Array(MAX_ENTITIES * 8),\n};\n\nsetTraits(Mesh, {\n    defaults: () => ({\n        shape: MeshShape.Box,\n        visible: 1,\n        sizeX: 1,\n        sizeY: 1,\n        sizeZ: 1,\n        color: 0xffffffff,\n    }),\n});\n\nconst pending: number[] = [];\nlet initialized = false;\n\nfunction init(state: State): void {\n    if (initialized) return;\n    initialized = true;\n\n    for (const eid of state.query([Mesh, WorldTransform])) {\n        pending.push(eid);\n    }\n\n    observe(state.world, onAdd(Mesh, WorldTransform), (eid: number) => {\n        pending.push(eid);\n    });\n}\n\nfunction registerEntity(eid: number, buffers: ShapeBuffers): void {\n    const idx = buffers.count;\n    buffers.entityIds[idx] = eid;\n    buffers.count++;\n    buffers.dirty = true;\n}\n\nfunction uploadEntityIds(ctx: WebGPURenderContext, buffers: ShapeBuffers): void {\n    ctx.gpu.device.queue.writeBuffer(\n        buffers.entityIdBuffer,\n        0,\n        buffers.entityIds.buffer,\n        0,\n        buffers.count * 4\n    );\n\n    ctx.gpu.device.queue.writeBuffer(\n        buffers.visibleEntityIdBuffer,\n        0,\n        buffers.entityIds.buffer,\n        0,\n        buffers.count * 4\n    );\n}\n\nfunction uploadIndirectArgs(ctx: WebGPURenderContext, shape: number, buffers: ShapeBuffers): void {\n    const geo = ctx.geometries.get(shape);\n    if (!geo) return;\n\n    const indirectArgs = new Uint32Array([geo.indexCount, buffers.count, 0, 0, 0]);\n\n    ctx.gpu.device.queue.writeBuffer(buffers.indirectBuffer, 0, indirectArgs);\n}\n\nfunction uploadMeshData(ctx: WebGPURenderContext, maxEid: number): void {\n    const byteLength = (maxEid + 1) * 8 * 4;\n    ctx.gpu.device.queue.writeBuffer(\n        ctx.meshDataBuffer,\n        0,\n        Mesh.data.buffer,\n        Mesh.data.byteOffset,\n        byteLength\n    );\n}\n\nfunction uploadMatrices(ctx: WebGPURenderContext, maxEid: number): void {\n    const byteLength = (maxEid + 1) * 64;\n    ctx.gpu.device.queue.writeBuffer(\n        ctx.matricesBuffer,\n        0,\n        WorldTransform.data.buffer,\n        WorldTransform.data.byteOffset,\n        byteLength\n    );\n}\n\nexport const MeshSyncSystem: System = {\n    group: \"draw\",\n    first: true,\n\n    update(state: State) {\n        const render = Render.from(state);\n        const ctx = render?.context as WebGPURenderContext | undefined;\n        if (!ctx) return;\n\n        init(state);\n\n        let maxEid = 0;\n        for (const eid of pending) {\n            if (Mesh.visible[eid] !== 1) continue;\n\n            const shape = Mesh.shape[eid];\n            const buffers = getShapeBuffers(ctx, shape);\n            registerEntity(eid, buffers);\n            if (eid > maxEid) maxEid = eid;\n        }\n        pending.length = 0;\n\n        for (const [shape, buffers] of ctx.shapes) {\n            if (buffers.dirty) {\n                uploadEntityIds(ctx, buffers);\n                uploadIndirectArgs(ctx, shape, buffers);\n                buffers.dirty = false;\n            }\n        }\n\n        for (const [, buffers] of ctx.shapes) {\n            for (let i = 0; i < buffers.count; i++) {\n                const eid = buffers.entityIds[i];\n                if (eid > maxEid) maxEid = eid;\n            }\n        }\n\n        if (maxEid > 0) {\n            uploadMeshData(ctx, maxEid);\n            uploadMatrices(ctx, maxEid);\n        }\n    },\n};\n","import { setTraits } from \"../../core/component\";\nimport type { State, System } from \"../../core\";\nimport { writeBuffer } from \"./gpu\";\nimport { Render } from \"./context\";\n\nexport const AmbientLight = {\n    color: [] as number[],\n    intensity: [] as number[],\n};\n\nsetTraits(AmbientLight, {\n    defaults: () => ({ color: 0x888888, intensity: 1.0 }),\n});\n\nexport const DirectionalLight = {\n    color: [] as number[],\n    intensity: [] as number[],\n    directionX: [] as number[],\n    directionY: [] as number[],\n    directionZ: [] as number[],\n};\n\nsetTraits(DirectionalLight, {\n    defaults: () => ({\n        color: 0xffffff,\n        intensity: 1.0,\n        directionX: -0.5,\n        directionY: -1.0,\n        directionZ: -0.5,\n    }),\n});\n\nexport const LIGHT_UNIFORM_SIZE = 64;\n\nconst lightUniforms = new Float32Array(16);\n\nfunction unpackColor(color: number): [number, number, number] {\n    return [((color >> 16) & 0xff) / 255, ((color >> 8) & 0xff) / 255, (color & 0xff) / 255];\n}\n\nfunction normalizeDirection(x: number, y: number, z: number): [number, number, number] {\n    const len = Math.sqrt(x * x + y * y + z * z);\n    if (len === 0) return [0, -1, 0];\n    return [x / len, y / len, z / len];\n}\n\nexport function packLightUniforms(\n    ambient: { color: number; intensity: number } | null,\n    directional: {\n        color: number;\n        intensity: number;\n        dirX: number;\n        dirY: number;\n        dirZ: number;\n    } | null\n): Float32Array {\n    if (ambient) {\n        const [r, g, b] = unpackColor(ambient.color);\n        lightUniforms[0] = r;\n        lightUniforms[1] = g;\n        lightUniforms[2] = b;\n        lightUniforms[3] = ambient.intensity;\n    } else {\n        lightUniforms[0] = 0.5;\n        lightUniforms[1] = 0.5;\n        lightUniforms[2] = 0.5;\n        lightUniforms[3] = 0.3;\n    }\n    lightUniforms[4] = 0;\n    lightUniforms[5] = 0;\n    lightUniforms[6] = 0;\n    lightUniforms[7] = 0;\n\n    if (directional) {\n        const [dx, dy, dz] = normalizeDirection(\n            directional.dirX,\n            directional.dirY,\n            directional.dirZ\n        );\n        lightUniforms[8] = dx;\n        lightUniforms[9] = dy;\n        lightUniforms[10] = dz;\n        lightUniforms[11] = 0;\n\n        const [cr, cg, cb] = unpackColor(directional.color);\n        lightUniforms[12] = cr * directional.intensity;\n        lightUniforms[13] = cg * directional.intensity;\n        lightUniforms[14] = cb * directional.intensity;\n        lightUniforms[15] = 0;\n    } else {\n        lightUniforms[8] = 0;\n        lightUniforms[9] = -1;\n        lightUniforms[10] = 0;\n        lightUniforms[11] = 0;\n        lightUniforms[12] = 0;\n        lightUniforms[13] = 0;\n        lightUniforms[14] = 0;\n        lightUniforms[15] = 0;\n    }\n\n    return lightUniforms;\n}\n\nexport interface RenderContext {\n    gpu: { device: GPUDevice };\n    lightBuffer: GPUBuffer;\n}\n\nexport const LightSyncSystem: System = {\n    group: \"draw\",\n    update(state: State) {\n        const render = Render.from(state);\n        const ctx = render?.context as RenderContext | undefined;\n        if (!ctx) return;\n\n        let ambient: { color: number; intensity: number } | null = null;\n        let directional: {\n            color: number;\n            intensity: number;\n            dirX: number;\n            dirY: number;\n            dirZ: number;\n        } | null = null;\n\n        for (const eid of state.query([AmbientLight])) {\n            ambient = {\n                color: AmbientLight.color[eid],\n                intensity: AmbientLight.intensity[eid],\n            };\n            break;\n        }\n\n        for (const eid of state.query([DirectionalLight])) {\n            directional = {\n                color: DirectionalLight.color[eid],\n                intensity: DirectionalLight.intensity[eid],\n                dirX: DirectionalLight.directionX[eid],\n                dirY: DirectionalLight.directionY[eid],\n                dirZ: DirectionalLight.directionZ[eid],\n            };\n            break;\n        }\n\n        const uniforms = packLightUniforms(ambient, directional);\n        writeBuffer(ctx.gpu.device, ctx.lightBuffer, uniforms);\n    },\n};\n","export const LIT_SHADER = /* wgsl */ `\nstruct Uniforms {\n    viewProjection: mat4x4f,\n}\n\nstruct LightUniforms {\n    ambientColor: vec4f,\n    _padding: vec4f,\n    sunDirection: vec4f,\n    sunColor: vec4f,\n}\n\nstruct MeshData {\n    size: vec4f,\n    color: vec4f,\n}\n\n@group(0) @binding(0) var<uniform> uniforms: Uniforms;\n@group(0) @binding(1) var<uniform> lights: LightUniforms;\n@group(0) @binding(2) var<storage, read> worldMatrices: array<mat4x4f>;\n@group(0) @binding(3) var<storage, read> entityIds: array<u32>;\n@group(0) @binding(4) var<storage, read> meshData: array<MeshData>;\n\nstruct VertexInput {\n    @location(0) position: vec3f,\n    @location(1) normal: vec3f,\n    @builtin(instance_index) instanceIndex: u32,\n}\n\nstruct VertexOutput {\n    @builtin(position) position: vec4f,\n    @location(0) worldNormal: vec3f,\n    @location(1) @interpolate(flat) entityId: u32,\n}\n\n@vertex\nfn vertexMain(input: VertexInput) -> VertexOutput {\n    let eid = entityIds[input.instanceIndex];\n    let transform = worldMatrices[eid];\n    let size = meshData[eid].size.xyz;\n\n    let scaledPos = input.position * size;\n    let worldPos = transform * vec4f(scaledPos, 1.0);\n\n    let m3 = mat3x3f(transform[0].xyz, transform[1].xyz, transform[2].xyz);\n    let worldNormal = normalize(m3 * input.normal);\n\n    var output: VertexOutput;\n    output.position = uniforms.viewProjection * worldPos;\n    output.worldNormal = worldNormal;\n    output.entityId = eid;\n    return output;\n}\n\n@fragment\nfn fragmentMain(input: VertexOutput) -> @location(0) vec4f {\n    let normal = normalize(input.worldNormal);\n    let color = meshData[input.entityId].color;\n\n    let ambient = lights.ambientColor.rgb * lights.ambientColor.a;\n    let NdotL = max(dot(normal, -lights.sunDirection.xyz), 0.0);\n    let diffuse = lights.sunColor.rgb * NdotL;\n\n    let finalColor = (ambient + diffuse) * color.rgb;\n    return vec4f(finalColor, color.a);\n}\n`;\n","import type { GPUContext } from \"./gpu\";\nimport { LIT_SHADER } from \"./shaders\";\n\nexport interface LitPipeline {\n    pipeline: GPURenderPipeline;\n    bindGroupLayout: GPUBindGroupLayout;\n}\n\nexport async function createLitPipeline(\n    ctx: GPUContext,\n    targetFormat?: GPUTextureFormat\n): Promise<LitPipeline> {\n    const shaderModule = ctx.device.createShaderModule({\n        label: \"litShader\",\n        code: LIT_SHADER,\n    });\n\n    const bindGroupLayout = ctx.device.createBindGroupLayout({\n        entries: [\n            { binding: 0, visibility: GPUShaderStage.VERTEX, buffer: { type: \"uniform\" } },\n            {\n                binding: 1,\n                visibility: GPUShaderStage.VERTEX | GPUShaderStage.FRAGMENT,\n                buffer: { type: \"uniform\" },\n            },\n            {\n                binding: 2,\n                visibility: GPUShaderStage.VERTEX,\n                buffer: { type: \"read-only-storage\" },\n            },\n            {\n                binding: 3,\n                visibility: GPUShaderStage.VERTEX,\n                buffer: { type: \"read-only-storage\" },\n            },\n            {\n                binding: 4,\n                visibility: GPUShaderStage.VERTEX | GPUShaderStage.FRAGMENT,\n                buffer: { type: \"read-only-storage\" },\n            },\n        ],\n    });\n\n    const pipelineLayout = ctx.device.createPipelineLayout({\n        bindGroupLayouts: [bindGroupLayout],\n    });\n\n    const pipeline = await ctx.device.createRenderPipelineAsync({\n        label: \"litPipeline\",\n        layout: pipelineLayout,\n        vertex: {\n            module: shaderModule,\n            entryPoint: \"vertexMain\",\n            buffers: [\n                {\n                    arrayStride: 24,\n                    attributes: [\n                        { shaderLocation: 0, offset: 0, format: \"float32x3\" },\n                        { shaderLocation: 1, offset: 12, format: \"float32x3\" },\n                    ],\n                },\n            ],\n        },\n        fragment: {\n            module: shaderModule,\n            entryPoint: \"fragmentMain\",\n            targets: [{ format: targetFormat ?? ctx.format }],\n        },\n        primitive: {\n            topology: \"triangle-list\",\n            cullMode: \"back\",\n        },\n        depthStencil: {\n            format: \"depth24plus\",\n            depthWriteEnabled: true,\n            depthCompare: \"less\",\n        },\n    });\n\n    return { pipeline, bindGroupLayout };\n}\n","import { setTraits } from \"../../core/component\";\nimport { type GPUContext, type RenderTarget, resizeRenderTarget } from \"./gpu\";\n\nconst UberShader = /* wgsl */ `\nstruct VertexOutput {\n    @builtin(position) position: vec4f,\n    @location(0) uv: vec2f,\n}\n\n@vertex\nfn vertexMain(@builtin(vertex_index) vertexIndex: u32) -> VertexOutput {\n    var positions = array<vec2f, 3>(\n        vec2f(-1.0, -1.0),\n        vec2f(3.0, -1.0),\n        vec2f(-1.0, 3.0)\n    );\n\n    let pos = positions[vertexIndex];\n\n    var output: VertexOutput;\n    output.position = vec4f(pos, 0.0, 1.0);\n    output.uv = (pos + 1.0) * 0.5;\n    output.uv.y = 1.0 - output.uv.y;\n    return output;\n}\n\n@group(0) @binding(0) var inputTexture: texture_2d<f32>;\n@group(0) @binding(1) var inputSampler: sampler;\n\nstruct Uniforms {\n    exposure: f32,\n    vignetteStrength: f32,\n    vignetteInner: f32,\n    vignetteOuter: f32,\n    texelSizeX: f32,\n    texelSizeY: f32,\n    flags: u32,\n    _pad: u32,\n}\n\n@group(0) @binding(2) var<uniform> uniforms: Uniforms;\n\nconst FLAG_TONEMAP: u32 = 1u;\nconst FLAG_FXAA: u32 = 2u;\nconst FLAG_VIGNETTE: u32 = 4u;\n\nfn aces(x: vec3f) -> vec3f {\n    let a = 2.51;\n    let b = 0.03;\n    let c = 2.43;\n    let d = 0.59;\n    let e = 0.14;\n    return saturate((x * (a * x + b)) / (x * (c * x + d) + e));\n}\n\nfn luma(color: vec3f) -> f32 {\n    return dot(color, vec3f(0.299, 0.587, 0.114));\n}\n\nconst FXAA_REDUCE_MIN: f32 = 1.0 / 128.0;\nconst FXAA_REDUCE_MUL: f32 = 1.0 / 8.0;\nconst FXAA_SPAN_MAX: f32 = 8.0;\n\nfn applyFXAA(uv: vec2f, colorM: vec3f) -> vec3f {\n    let texelSize = vec2f(uniforms.texelSizeX, uniforms.texelSizeY);\n\n    let colorNW = textureSample(inputTexture, inputSampler, uv + vec2f(-1.0, -1.0) * texelSize).rgb;\n    let colorNE = textureSample(inputTexture, inputSampler, uv + vec2f(1.0, -1.0) * texelSize).rgb;\n    let colorSW = textureSample(inputTexture, inputSampler, uv + vec2f(-1.0, 1.0) * texelSize).rgb;\n    let colorSE = textureSample(inputTexture, inputSampler, uv + vec2f(1.0, 1.0) * texelSize).rgb;\n\n    let lumaM = luma(colorM);\n    let lumaNW = luma(colorNW);\n    let lumaNE = luma(colorNE);\n    let lumaSW = luma(colorSW);\n    let lumaSE = luma(colorSE);\n\n    let lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    let lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    var dir: vec2f;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y = ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    let dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * 0.25 * FXAA_REDUCE_MUL, FXAA_REDUCE_MIN);\n    let rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = clamp(dir * rcpDirMin, vec2f(-FXAA_SPAN_MAX), vec2f(FXAA_SPAN_MAX)) * texelSize;\n\n    let colorA = 0.5 * (\n        textureSample(inputTexture, inputSampler, uv + dir * (1.0 / 3.0 - 0.5)).rgb +\n        textureSample(inputTexture, inputSampler, uv + dir * (2.0 / 3.0 - 0.5)).rgb\n    );\n\n    let colorB = colorA * 0.5 + 0.25 * (\n        textureSample(inputTexture, inputSampler, uv + dir * -0.5).rgb +\n        textureSample(inputTexture, inputSampler, uv + dir * 0.5).rgb\n    );\n\n    let lumaB = luma(colorB);\n\n    if lumaB < lumaMin || lumaB > lumaMax {\n        return colorA;\n    }\n    return colorB;\n}\n\nfn applyVignette(color: vec3f, uv: vec2f) -> vec3f {\n    let center = vec2f(0.5, 0.5);\n    let dist = distance(uv, center);\n    let vignette = 1.0 - smoothstep(uniforms.vignetteInner, uniforms.vignetteOuter, dist) * uniforms.vignetteStrength;\n    return color * vignette;\n}\n\n@fragment\nfn fragmentMain(@location(0) uv: vec2f) -> @location(0) vec4f {\n    var color = textureSample(inputTexture, inputSampler, uv).rgb;\n\n    if (uniforms.flags & FLAG_FXAA) != 0u {\n        color = applyFXAA(uv, color);\n    }\n\n    if (uniforms.flags & FLAG_TONEMAP) != 0u {\n        color = aces(color * uniforms.exposure);\n    }\n\n    if (uniforms.flags & FLAG_VIGNETTE) != 0u {\n        color = applyVignette(color, uv);\n    }\n\n    return vec4f(color, 1.0);\n}\n`;\n\nexport const Tonemap = {\n    exposure: [] as number[],\n};\n\nsetTraits(Tonemap, {\n    defaults: () => ({ exposure: 1.0 }),\n});\n\nexport const FXAA = {};\n\nexport const Vignette = {\n    strength: [] as number[],\n    inner: [] as number[],\n    outer: [] as number[],\n};\n\nsetTraits(Vignette, {\n    defaults: () => ({ strength: 0.5, inner: 0.4, outer: 0.8 }),\n});\n\nconst FlagTonemap = 1;\nconst FlagFxaa = 2;\nconst FlagVignette = 4;\n\nexport interface PostProcessPipeline {\n    pipeline: GPURenderPipeline;\n    uniforms: GPUBuffer;\n    layout: GPUBindGroupLayout;\n    sampler: GPUSampler;\n    sceneTarget: RenderTarget | null;\n    blitPipeline: GPURenderPipeline;\n    blitLayout: GPUBindGroupLayout;\n}\n\nexport interface EffectConfig {\n    tonemap: boolean;\n    exposure: number;\n    fxaa: boolean;\n    vignette: boolean;\n    vignetteStrength: number;\n    vignetteInner: number;\n    vignetteOuter: number;\n}\n\nexport async function initPostProcess(gpu: GPUContext): Promise<PostProcessPipeline> {\n    const shaderModule = gpu.device.createShaderModule({\n        label: \"Uber post-process shader\",\n        code: UberShader,\n    });\n\n    const layout = gpu.device.createBindGroupLayout({\n        entries: [\n            { binding: 0, visibility: GPUShaderStage.FRAGMENT, texture: { sampleType: \"float\" } },\n            { binding: 1, visibility: GPUShaderStage.FRAGMENT, sampler: {} },\n            { binding: 2, visibility: GPUShaderStage.FRAGMENT, buffer: { type: \"uniform\" } },\n        ],\n    });\n\n    const uniforms = gpu.device.createBuffer({\n        size: 32,\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n    });\n\n    const sampler = gpu.device.createSampler({\n        magFilter: \"linear\",\n        minFilter: \"linear\",\n    });\n\n    const blitLayout = gpu.device.createBindGroupLayout({\n        entries: [\n            { binding: 0, visibility: GPUShaderStage.FRAGMENT, texture: { sampleType: \"float\" } },\n            { binding: 1, visibility: GPUShaderStage.FRAGMENT, sampler: {} },\n        ],\n    });\n\n    const blitShader = gpu.device.createShaderModule({\n        label: \"Blit shader\",\n        code: `\nstruct VertexOutput {\n    @builtin(position) position: vec4f,\n    @location(0) uv: vec2f,\n}\n\n@vertex\nfn vertexMain(@builtin(vertex_index) vertexIndex: u32) -> VertexOutput {\n    var positions = array<vec2f, 3>(\n        vec2f(-1.0, -1.0),\n        vec2f(3.0, -1.0),\n        vec2f(-1.0, 3.0)\n    );\n    let pos = positions[vertexIndex];\n    var output: VertexOutput;\n    output.position = vec4f(pos, 0.0, 1.0);\n    output.uv = (pos + 1.0) * 0.5;\n    output.uv.y = 1.0 - output.uv.y;\n    return output;\n}\n\n@group(0) @binding(0) var inputTexture: texture_2d<f32>;\n@group(0) @binding(1) var inputSampler: sampler;\n\n@fragment\nfn fragmentMain(@location(0) uv: vec2f) -> @location(0) vec4f {\n    return textureSample(inputTexture, inputSampler, uv);\n}\n`,\n    });\n\n    const [pipeline, blitPipeline] = await Promise.all([\n        gpu.device.createRenderPipelineAsync({\n            label: \"Uber post-process pipeline\",\n            layout: gpu.device.createPipelineLayout({ bindGroupLayouts: [layout] }),\n            vertex: { module: shaderModule, entryPoint: \"vertexMain\" },\n            fragment: {\n                module: shaderModule,\n                entryPoint: \"fragmentMain\",\n                targets: [{ format: gpu.format }],\n            },\n            primitive: { topology: \"triangle-list\" },\n        }),\n        gpu.device.createRenderPipelineAsync({\n            label: \"Blit pipeline\",\n            layout: gpu.device.createPipelineLayout({ bindGroupLayouts: [blitLayout] }),\n            vertex: { module: blitShader, entryPoint: \"vertexMain\" },\n            fragment: {\n                module: blitShader,\n                entryPoint: \"fragmentMain\",\n                targets: [{ format: gpu.format }],\n            },\n            primitive: { topology: \"triangle-list\" },\n        }),\n    ]);\n\n    return {\n        pipeline,\n        uniforms,\n        layout,\n        sampler,\n        sceneTarget: null,\n        blitPipeline,\n        blitLayout,\n    };\n}\n\nexport function ensurePostProcessTargets(\n    pp: PostProcessPipeline,\n    gpu: GPUContext,\n    width: number,\n    height: number\n): void {\n    pp.sceneTarget = resizeRenderTarget(gpu.device, pp.sceneTarget, width, height, \"rgba16float\");\n}\n\nexport function updatePostProcess(\n    gpu: GPUContext,\n    pp: PostProcessPipeline,\n    config: EffectConfig,\n    width: number,\n    height: number\n): void {\n    let flags = 0;\n    if (config.tonemap) flags |= FlagTonemap;\n    if (config.fxaa) flags |= FlagFxaa;\n    if (config.vignette) flags |= FlagVignette;\n\n    const data = new ArrayBuffer(32);\n    const floats = new Float32Array(data);\n    const uints = new Uint32Array(data);\n\n    floats[0] = config.exposure;\n    floats[1] = config.vignetteStrength;\n    floats[2] = config.vignetteInner;\n    floats[3] = config.vignetteOuter;\n    floats[4] = 1.0 / width;\n    floats[5] = 1.0 / height;\n    uints[6] = flags;\n    uints[7] = 0;\n\n    gpu.device.queue.writeBuffer(pp.uniforms, 0, data);\n}\n\nexport function execPostProcess(\n    encoder: GPUCommandEncoder,\n    pp: PostProcessPipeline,\n    gpu: GPUContext,\n    hasEffects: boolean,\n    output: GPUTextureView\n): void {\n    if (!pp.sceneTarget) return;\n\n    if (hasEffects) {\n        const bindGroup = gpu.device.createBindGroup({\n            layout: pp.layout,\n            entries: [\n                { binding: 0, resource: pp.sceneTarget.view },\n                { binding: 1, resource: pp.sampler },\n                { binding: 2, resource: { buffer: pp.uniforms } },\n            ],\n        });\n\n        const pass = encoder.beginRenderPass({\n            colorAttachments: [\n                {\n                    view: output,\n                    loadOp: \"clear\",\n                    storeOp: \"store\",\n                    clearValue: { r: 0, g: 0, b: 0, a: 1 },\n                },\n            ],\n        });\n\n        pass.setPipeline(pp.pipeline);\n        pass.setBindGroup(0, bindGroup);\n        pass.draw(3);\n        pass.end();\n    } else {\n        const bindGroup = gpu.device.createBindGroup({\n            layout: pp.blitLayout,\n            entries: [\n                { binding: 0, resource: pp.sceneTarget.view },\n                { binding: 1, resource: pp.sampler },\n            ],\n        });\n\n        const pass = encoder.beginRenderPass({\n            colorAttachments: [\n                {\n                    view: output,\n                    loadOp: \"clear\",\n                    storeOp: \"store\",\n                    clearValue: { r: 0, g: 0, b: 0, a: 1 },\n                },\n            ],\n        });\n\n        pass.setPipeline(pp.blitPipeline);\n        pass.setBindGroup(0, bindGroup);\n        pass.draw(3);\n        pass.end();\n    }\n}\n","import { setTraits } from \"../../core/component\";\n\nexport const RenderMode = {\n    Raster: 0,\n    Raytracing: 1,\n} as const;\n\nexport type RenderModeType = (typeof RenderMode)[keyof typeof RenderMode];\n\nexport const DebugMode = {\n    Color: 0,\n    Depth: 1,\n    Normal: 2,\n    Material: 3,\n    Hit: 4,\n} as const;\n\nexport type DebugModeType = (typeof DebugMode)[keyof typeof DebugMode];\n\nexport const Camera = {\n    fov: [] as number[],\n    near: [] as number[],\n    far: [] as number[],\n    active: [] as number[],\n    clearColor: [] as number[],\n    renderMode: [] as number[],\n    debugMode: [] as number[],\n};\n\nsetTraits(Camera, {\n    defaults: () => ({\n        fov: 60,\n        near: 0.1,\n        far: 1000,\n        active: 1,\n        clearColor: 0x1a1a1a,\n        renderMode: RenderMode.Raster,\n        debugMode: DebugMode.Color,\n    }),\n});\n","import { mat4 } from \"wgpu-matrix\";\nimport type { State, System } from \"../../core\";\nimport { WorldTransform } from \"../transforms\";\nimport { Camera } from \"./camera\";\nimport { MeshShape } from \"./mesh\";\nimport type { GPUContext } from \"./gpu\";\nimport { Render, type WebGPURenderContext, type ShapeBuffers } from \"./context\";\n\nconst WorkgroupSize = 64;\n\nexport interface ShapeAABB {\n    minX: number;\n    minY: number;\n    minZ: number;\n    maxX: number;\n    maxY: number;\n    maxZ: number;\n}\n\nexport const ShapeAABBs: Record<number, ShapeAABB> = {\n    [MeshShape.Box]: { minX: -0.5, minY: -0.5, minZ: -0.5, maxX: 0.5, maxY: 0.5, maxZ: 0.5 },\n    [MeshShape.Sphere]: { minX: -0.5, minY: -0.5, minZ: -0.5, maxX: 0.5, maxY: 0.5, maxZ: 0.5 },\n    [MeshShape.Plane]: { minX: -0.5, minY: -0.01, minZ: -0.5, maxX: 0.5, maxY: 0.01, maxZ: 0.5 },\n};\n\nexport interface CullingContext {\n    pipeline: GPUComputePipeline;\n    bindGroupLayout: GPUBindGroupLayout;\n    uniformBuffer: GPUBuffer;\n    uniformData: Float32Array;\n    shapeAABBBuffers: Map<number, GPUBuffer>;\n}\n\nconst CullingShader = /* wgsl */ `\nstruct CullUniforms {\n    viewProjection: mat4x4f,\n    planes: array<vec4f, 6>,\n}\n\nstruct AABB {\n    minPoint: vec3f,\n    maxPoint: vec3f,\n}\n\nstruct IndirectArgs {\n    indexCount: u32,\n    instanceCount: atomic<u32>,\n    firstIndex: u32,\n    baseVertex: u32,\n    firstInstance: u32,\n}\n\n@group(0) @binding(0) var<uniform> uniforms: CullUniforms;\n@group(0) @binding(1) var<storage, read> worldMatrices: array<mat4x4f>;\n@group(0) @binding(2) var<storage, read> entityIds: array<u32>;\n@group(0) @binding(3) var<storage, read_write> visibleEntityIds: array<u32>;\n@group(0) @binding(4) var<storage, read_write> indirectArgs: IndirectArgs;\n@group(0) @binding(5) var<uniform> shapeAABB: AABB;\n\nfn transformCorner(m: mat4x4f, corner: vec3f) -> vec3f {\n    return (m * vec4f(corner, 1.0)).xyz;\n}\n\nfn testFrustumOBB(m: mat4x4f, aabbMin: vec3f, aabbMax: vec3f) -> bool {\n    var corners: array<vec3f, 8>;\n    corners[0] = transformCorner(m, vec3f(aabbMin.x, aabbMin.y, aabbMin.z));\n    corners[1] = transformCorner(m, vec3f(aabbMax.x, aabbMin.y, aabbMin.z));\n    corners[2] = transformCorner(m, vec3f(aabbMin.x, aabbMax.y, aabbMin.z));\n    corners[3] = transformCorner(m, vec3f(aabbMax.x, aabbMax.y, aabbMin.z));\n    corners[4] = transformCorner(m, vec3f(aabbMin.x, aabbMin.y, aabbMax.z));\n    corners[5] = transformCorner(m, vec3f(aabbMax.x, aabbMin.y, aabbMax.z));\n    corners[6] = transformCorner(m, vec3f(aabbMin.x, aabbMax.y, aabbMax.z));\n    corners[7] = transformCorner(m, vec3f(aabbMax.x, aabbMax.y, aabbMax.z));\n\n    for (var p = 0u; p < 6u; p++) {\n        let plane = uniforms.planes[p];\n        var allOutside = true;\n\n        for (var c = 0u; c < 8u; c++) {\n            let dist = dot(plane.xyz, corners[c]) + plane.w;\n            if (dist >= 0.0) {\n                allOutside = false;\n                break;\n            }\n        }\n\n        if (allOutside) {\n            return false;\n        }\n    }\n    return true;\n}\n\n@compute @workgroup_size(64)\nfn main(@builtin(global_invocation_id) globalId: vec3u) {\n    let idx = globalId.x;\n    let entityCount = arrayLength(&entityIds);\n\n    if (idx >= entityCount) {\n        return;\n    }\n\n    let eid = entityIds[idx];\n    let transform = worldMatrices[eid];\n\n    if (testFrustumOBB(transform, shapeAABB.minPoint, shapeAABB.maxPoint)) {\n        let slot = atomicAdd(&indirectArgs.instanceCount, 1u);\n        visibleEntityIds[slot] = eid;\n    }\n}\n`;\n\nexport function extractFrustumPlanes(viewProj: Float32Array, planes: Float32Array): void {\n    const m = viewProj;\n\n    planes[0] = m[3] + m[0];\n    planes[1] = m[7] + m[4];\n    planes[2] = m[11] + m[8];\n    planes[3] = m[15] + m[12];\n    normalizePlane(planes, 0);\n\n    planes[4] = m[3] - m[0];\n    planes[5] = m[7] - m[4];\n    planes[6] = m[11] - m[8];\n    planes[7] = m[15] - m[12];\n    normalizePlane(planes, 4);\n\n    planes[8] = m[3] + m[1];\n    planes[9] = m[7] + m[5];\n    planes[10] = m[11] + m[9];\n    planes[11] = m[15] + m[13];\n    normalizePlane(planes, 8);\n\n    planes[12] = m[3] - m[1];\n    planes[13] = m[7] - m[5];\n    planes[14] = m[11] - m[9];\n    planes[15] = m[15] - m[13];\n    normalizePlane(planes, 12);\n\n    planes[16] = m[3] + m[2];\n    planes[17] = m[7] + m[6];\n    planes[18] = m[11] + m[10];\n    planes[19] = m[15] + m[14];\n    normalizePlane(planes, 16);\n\n    planes[20] = m[3] - m[2];\n    planes[21] = m[7] - m[6];\n    planes[22] = m[11] - m[10];\n    planes[23] = m[15] - m[14];\n    normalizePlane(planes, 20);\n}\n\nfunction normalizePlane(planes: Float32Array, offset: number): void {\n    const a = planes[offset];\n    const b = planes[offset + 1];\n    const c = planes[offset + 2];\n    const len = Math.sqrt(a * a + b * b + c * c);\n    if (len > 0) {\n        planes[offset] /= len;\n        planes[offset + 1] /= len;\n        planes[offset + 2] /= len;\n        planes[offset + 3] /= len;\n    }\n}\n\nfunction createAABBBuffer(device: GPUDevice, aabb: ShapeAABB): GPUBuffer {\n    const buffer = device.createBuffer({\n        label: \"shapeAABB\",\n        size: 32,\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n    });\n\n    const data = new Float32Array([\n        aabb.minX,\n        aabb.minY,\n        aabb.minZ,\n        0,\n        aabb.maxX,\n        aabb.maxY,\n        aabb.maxZ,\n        0,\n    ]);\n    device.queue.writeBuffer(buffer, 0, data);\n\n    return buffer;\n}\n\nexport async function initCulling(gpu: GPUContext): Promise<CullingContext> {\n    const device = gpu.device;\n\n    const bindGroupLayout = device.createBindGroupLayout({\n        label: \"cullBindGroupLayout\",\n        entries: [\n            { binding: 0, visibility: GPUShaderStage.COMPUTE, buffer: { type: \"uniform\" } },\n            {\n                binding: 1,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: { type: \"read-only-storage\" },\n            },\n            {\n                binding: 2,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: { type: \"read-only-storage\" },\n            },\n            { binding: 3, visibility: GPUShaderStage.COMPUTE, buffer: { type: \"storage\" } },\n            { binding: 4, visibility: GPUShaderStage.COMPUTE, buffer: { type: \"storage\" } },\n            { binding: 5, visibility: GPUShaderStage.COMPUTE, buffer: { type: \"uniform\" } },\n        ],\n    });\n\n    const pipelineLayout = device.createPipelineLayout({\n        label: \"cullPipelineLayout\",\n        bindGroupLayouts: [bindGroupLayout],\n    });\n\n    const shaderModule = device.createShaderModule({\n        label: \"cullShader\",\n        code: CullingShader,\n    });\n\n    const pipeline = await device.createComputePipelineAsync({\n        label: \"cullPipeline\",\n        layout: pipelineLayout,\n        compute: {\n            module: shaderModule,\n            entryPoint: \"main\",\n        },\n    });\n\n    const uniformBuffer = device.createBuffer({\n        label: \"cullUniforms\",\n        size: 160,\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n    });\n\n    const uniformData = new Float32Array(40);\n\n    const shapeAABBBuffers = new Map<number, GPUBuffer>();\n    for (const [shape, aabb] of Object.entries(ShapeAABBs)) {\n        shapeAABBBuffers.set(Number(shape), createAABBBuffer(device, aabb));\n    }\n\n    return {\n        pipeline,\n        bindGroupLayout,\n        uniformBuffer,\n        uniformData,\n        shapeAABBBuffers,\n    };\n}\n\nconst viewMatrix = mat4.create();\nconst projMatrix = mat4.create();\nconst viewProjMatrix = mat4.create();\n\nfunction buildViewMatrix(cameraEid: number, out: Float32Array): void {\n    const d = WorldTransform.data;\n    const o = cameraEid * 16;\n    const r00 = d[o],\n        r01 = d[o + 1],\n        r02 = d[o + 2];\n    const r10 = d[o + 4],\n        r11 = d[o + 5],\n        r12 = d[o + 6];\n    const r20 = d[o + 8],\n        r21 = d[o + 9],\n        r22 = d[o + 10];\n    const tx = d[o + 12],\n        ty = d[o + 13],\n        tz = d[o + 14];\n\n    out[0] = r00;\n    out[1] = r10;\n    out[2] = r20;\n    out[3] = 0;\n    out[4] = r01;\n    out[5] = r11;\n    out[6] = r21;\n    out[7] = 0;\n    out[8] = r02;\n    out[9] = r12;\n    out[10] = r22;\n    out[11] = 0;\n    out[12] = -(r00 * tx + r01 * ty + r02 * tz);\n    out[13] = -(r10 * tx + r11 * ty + r12 * tz);\n    out[14] = -(r20 * tx + r21 * ty + r22 * tz);\n    out[15] = 1;\n}\n\nfunction ensureCullBindGroup(ctx: WebGPURenderContext, shape: number, buffers: ShapeBuffers): void {\n    if (buffers.cullBindGroup && !buffers.dirty) return;\n\n    const cull = ctx.culling;\n    buffers.cullBindGroup = ctx.gpu.device.createBindGroup({\n        layout: cull.bindGroupLayout,\n        entries: [\n            { binding: 0, resource: { buffer: cull.uniformBuffer } },\n            { binding: 1, resource: { buffer: ctx.matricesBuffer } },\n            { binding: 2, resource: { buffer: buffers.entityIdBuffer } },\n            { binding: 3, resource: { buffer: buffers.visibleEntityIdBuffer } },\n            { binding: 4, resource: { buffer: buffers.indirectBuffer } },\n            { binding: 5, resource: { buffer: cull.shapeAABBBuffers.get(shape)! } },\n        ],\n    });\n    buffers.dirty = false;\n}\n\nexport const CullingSystem: System = {\n    group: \"draw\",\n\n    update(state: State) {\n        const render = Render.from(state);\n        const ctx = render?.context as WebGPURenderContext | null;\n        if (!ctx || !ctx.culling) return;\n\n        let cameraEid: number | null = null;\n        for (const eid of state.query([Camera, WorldTransform])) {\n            if (Camera.active[eid] === 1) {\n                cameraEid = eid;\n                break;\n            }\n        }\n        if (cameraEid === null) return;\n\n        const aspect = ctx.gpu.canvas.width / ctx.gpu.canvas.height;\n        const fov = (Camera.fov[cameraEid] * Math.PI) / 180;\n\n        buildViewMatrix(cameraEid, viewMatrix);\n        mat4.perspective(fov, aspect, Camera.near[cameraEid], Camera.far[cameraEid], projMatrix);\n        mat4.multiply(projMatrix, viewMatrix, viewProjMatrix);\n\n        const cull = ctx.culling;\n        cull.uniformData.set(viewProjMatrix, 0);\n        extractFrustumPlanes(viewProjMatrix, cull.uniformData.subarray(16));\n        ctx.gpu.device.queue.writeBuffer(cull.uniformBuffer, 0, cull.uniformData.buffer, 0, 160);\n\n        const encoder = ctx.gpu.device.createCommandEncoder();\n\n        for (const [shape, buffers] of ctx.shapes) {\n            if (buffers.count === 0) continue;\n\n            const geo = ctx.geometries.get(shape);\n            if (!geo) continue;\n\n            resetIndirectBuffer(ctx.gpu.device, buffers, geo.indexCount);\n            ensureCullBindGroup(ctx, shape, buffers);\n\n            const computePass = encoder.beginComputePass();\n            computePass.setPipeline(cull.pipeline);\n            computePass.setBindGroup(0, buffers.cullBindGroup!);\n            computePass.dispatchWorkgroups(Math.ceil(buffers.count / WorkgroupSize));\n            computePass.end();\n        }\n\n        ctx.gpu.device.queue.submit([encoder.finish()]);\n    },\n};\n\nfunction resetIndirectBuffer(device: GPUDevice, buffers: ShapeBuffers, indexCount: number): void {\n    const resetData = new Uint32Array([indexCount, 0, 0, 0, 0]);\n    device.queue.writeBuffer(buffers.indirectBuffer, 0, resetData);\n}\n","import { resource, type RenderContext } from \"../../core\";\nimport {\n    type GPUContext,\n    initGPU,\n    createUniformBuffer,\n    createVertexBuffer,\n    createIndexBuffer,\n} from \"./gpu\";\nimport {\n    createBoxGeometry,\n    createSphereGeometry,\n    createPlaneGeometry,\n    type Geometry,\n} from \"./geometry\";\nimport { MeshShape } from \"./mesh\";\nimport { LIGHT_UNIFORM_SIZE } from \"./lighting\";\nimport { createLitPipeline, type LitPipeline } from \"./pipeline\";\nimport { type PostProcessPipeline, initPostProcess } from \"./postprocess\";\nimport { type CullingContext, initCulling } from \"./culling\";\nimport { MAX_ENTITIES } from \"../../core/constants\";\n\nexport interface RenderState {\n    readonly canvas: HTMLCanvasElement;\n    context: RenderContext | null;\n}\n\nexport const Render = resource<RenderState>(\"render\");\n\nexport interface GeometryBuffers {\n    vertexBuffer: GPUBuffer;\n    indexBuffer: GPUBuffer;\n    indexCount: number;\n}\n\nexport interface ShapeBuffers {\n    count: number;\n    entityIds: Uint32Array;\n    entityIdBuffer: GPUBuffer;\n    visibleEntityIdBuffer: GPUBuffer;\n    indirectBuffer: GPUBuffer;\n    bindGroup: GPUBindGroup | null;\n    cullBindGroup: GPUBindGroup | null;\n    dirty: boolean;\n}\n\nexport interface WebGPURenderContext extends RenderContext {\n    gpu: GPUContext;\n    pipeline: LitPipeline;\n    uniformBuffer: GPUBuffer;\n    lightBuffer: GPUBuffer;\n    matricesBuffer: GPUBuffer;\n    meshDataBuffer: GPUBuffer;\n    depthTexture: GPUTexture | null;\n    depthTextureView: GPUTextureView | null;\n    depthTextureWidth: number;\n    depthTextureHeight: number;\n    geometries: Map<number, GeometryBuffers>;\n    shapes: Map<number, ShapeBuffers>;\n    postprocess: PostProcessPipeline;\n    culling: CullingContext;\n}\n\nfunction createGeometryBuffers(device: GPUDevice, geometry: Geometry): GeometryBuffers {\n    return {\n        vertexBuffer: createVertexBuffer(device, geometry.vertices),\n        indexBuffer: createIndexBuffer(device, geometry.indices),\n        indexCount: geometry.indexCount,\n    };\n}\n\nexport function createShapeBuffers(device: GPUDevice): ShapeBuffers {\n    return {\n        count: 0,\n        entityIds: new Uint32Array(MAX_ENTITIES),\n        entityIdBuffer: device.createBuffer({\n            label: \"entityIds\",\n            size: MAX_ENTITIES * 4,\n            usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        }),\n        visibleEntityIdBuffer: device.createBuffer({\n            label: \"visibleEntityIds\",\n            size: MAX_ENTITIES * 4,\n            usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        }),\n        indirectBuffer: device.createBuffer({\n            label: \"indirectArgs\",\n            size: 20,\n            usage: GPUBufferUsage.STORAGE | GPUBufferUsage.INDIRECT | GPUBufferUsage.COPY_DST,\n        }),\n        bindGroup: null,\n        cullBindGroup: null,\n        dirty: true,\n    };\n}\n\nexport function getShapeBuffers(ctx: WebGPURenderContext, shape: number): ShapeBuffers {\n    const buffers = ctx.shapes.get(shape);\n    if (!buffers) throw new Error(`Unknown shape: ${shape}`);\n    return buffers;\n}\n\nexport async function initRenderContext(\n    canvas: HTMLCanvasElement,\n    device?: GPUDevice\n): Promise<WebGPURenderContext> {\n    const gpu = await initGPU(canvas, device);\n\n    const uniformBuffer = createUniformBuffer(gpu.device, 64, \"viewProjection\");\n    const lightBuffer = createUniformBuffer(gpu.device, LIGHT_UNIFORM_SIZE, \"lights\");\n\n    const matricesBuffer = gpu.device.createBuffer({\n        label: \"worldMatrices\",\n        size: MAX_ENTITIES * 64,\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n    });\n\n    const meshDataBuffer = gpu.device.createBuffer({\n        label: \"meshData\",\n        size: MAX_ENTITIES * 32,\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n    });\n\n    const geometries = new Map<number, GeometryBuffers>();\n    geometries.set(MeshShape.Box, createGeometryBuffers(gpu.device, createBoxGeometry()));\n    geometries.set(\n        MeshShape.Sphere,\n        createGeometryBuffers(gpu.device, createSphereGeometry(16, 12))\n    );\n    geometries.set(MeshShape.Plane, createGeometryBuffers(gpu.device, createPlaneGeometry()));\n\n    const shapes = new Map<number, ShapeBuffers>();\n    shapes.set(MeshShape.Box, createShapeBuffers(gpu.device));\n    shapes.set(MeshShape.Sphere, createShapeBuffers(gpu.device));\n    shapes.set(MeshShape.Plane, createShapeBuffers(gpu.device));\n\n    const [pipeline, postprocess, culling] = await Promise.all([\n        createLitPipeline(gpu, \"rgba16float\"),\n        initPostProcess(gpu),\n        initCulling(gpu),\n    ]);\n    return {\n        gpu,\n        pipeline,\n        uniformBuffer,\n        lightBuffer,\n        matricesBuffer,\n        meshDataBuffer,\n        depthTexture: null,\n        depthTextureView: null,\n        depthTextureWidth: 0,\n        depthTextureHeight: 0,\n        geometries,\n        shapes,\n        postprocess,\n        culling,\n    };\n}\n","export type vec3 = { x: number; y: number; z: number };\nexport type rgb = { r: number; g: number; b: number };\n\nexport interface Ray {\n    origin: vec3;\n    direction: vec3;\n    tMin: number;\n    tMax: number;\n}\n\nexport interface Hit {\n    t: number;\n    normal: vec3;\n    position: vec3;\n    material: number;\n}\n\nexport interface Terrain {\n    position: vec3;\n    sizeX: number;\n    sizeZ: number;\n    scale: number;\n    resolution: number;\n    material: number;\n}\n\nexport interface DirectionalLight {\n    direction: vec3;\n    color: rgb;\n    intensity: number;\n}\n\nexport interface Atmosphere {\n    sunDir: vec3;\n    sunPower: number;\n    zenith: rgb;\n    sunRadius: number;\n    horizon: rgb;\n    fogDensity: number;\n    fogColor: rgb;\n    fogHeight: number;\n}\n\nexport interface Camera {\n    position: vec3;\n    right: vec3;\n    up: vec3;\n    forward: vec3;\n    fov: number;\n}\n\nexport interface Transforms {\n    data: Float32Array;\n}\n\nexport type IndexableArray = ArrayLike<number> & { [index: number]: number };\n\nexport interface Scene {\n    camera: Camera;\n    entityIds: number[];\n    transforms: Transforms;\n    shapes: Uint32Array<ArrayBuffer>;\n    sizes: {\n        x: IndexableArray;\n        y: IndexableArray;\n        z: IndexableArray;\n    };\n    albedo: {\n        r: IndexableArray;\n        g: IndexableArray;\n        b: IndexableArray;\n    };\n    roughness: IndexableArray;\n    metallic: IndexableArray;\n    terrain?: Terrain;\n    heights?: Float32Array<ArrayBuffer>;\n    lights: DirectionalLight[];\n    atmosphere: Atmosphere;\n}\n\nexport type DebugMode = \"color\" | \"depth\" | \"normal\" | \"material\" | \"hit\";\n\nexport const DEBUG_COLOR = 0;\nexport const DEBUG_DEPTH = 1;\nexport const DEBUG_NORMAL = 2;\nexport const DEBUG_MATERIAL = 3;\nexport const DEBUG_HIT = 4;\n\nexport function debugModeToNumber(mode: DebugMode): number {\n    switch (mode) {\n        case \"color\":\n            return DEBUG_COLOR;\n        case \"depth\":\n            return DEBUG_DEPTH;\n        case \"normal\":\n            return DEBUG_NORMAL;\n        case \"material\":\n            return DEBUG_MATERIAL;\n        case \"hit\":\n            return DEBUG_HIT;\n    }\n}\n\nexport interface Config {\n    width: number;\n    height: number;\n    reference: boolean;\n    debug?: DebugMode;\n    near?: number;\n    far?: number;\n    useBVH?: boolean;\n}\n\nexport const BVH_CONFIG_BYTES = 16;\n\nexport const TERRAIN_FLOATS = 8;\nexport const TERRAIN_BYTES = TERRAIN_FLOATS * 4;\n\nexport const LIGHT_FLOATS = 8;\nexport const LIGHT_BYTES = LIGHT_FLOATS * 4;\n\nexport const MAX_LIGHTS = 8;\nexport const LIGHT_ARRAY_BYTES = MAX_LIGHTS * LIGHT_BYTES;\n\nexport const ENTITY_DATA_FLOATS = 8;\nexport const ENTITY_DATA_BYTES = ENTITY_DATA_FLOATS * 4;\n\nexport const ATMOSPHERE_FLOATS = 16;\nexport const ATMOSPHERE_BYTES = ATMOSPHERE_FLOATS * 4;\n\nexport const CAMERA_FLOATS = 16;\nexport const CAMERA_BYTES = CAMERA_FLOATS * 4;\n\nexport const CONFIG_BYTES = 32;\nexport const COUNTS_BYTES = 16;\nexport const BYTES_PER_ROW_ALIGNMENT = 256;\nexport const BYTES_PER_PIXEL = 8;\nexport const PIXELS_PER_ROW_ALIGNMENT = BYTES_PER_ROW_ALIGNMENT / BYTES_PER_PIXEL;\n\nexport function computePaddedWidth(width: number): number {\n    return Math.ceil(width / PIXELS_PER_ROW_ALIGNMENT) * PIXELS_PER_ROW_ALIGNMENT;\n}\n\nexport function computeBytesPerRow(width: number): number {\n    return computePaddedWidth(width) * BYTES_PER_PIXEL;\n}\n\nexport function packTerrain(terrain: Terrain): ArrayBuffer {\n    const buffer = new ArrayBuffer(TERRAIN_BYTES);\n    const floats = new Float32Array(buffer);\n    const uints = new Uint32Array(buffer);\n    floats[0] = terrain.position.x;\n    floats[1] = terrain.position.y;\n    floats[2] = terrain.position.z;\n    floats[3] = terrain.sizeX;\n    floats[4] = terrain.sizeZ;\n    floats[5] = terrain.scale;\n    uints[6] = terrain.resolution;\n    uints[7] = terrain.material;\n    return buffer;\n}\n\nexport function packLights(lights: DirectionalLight[]): ArrayBuffer {\n    const buffer = new ArrayBuffer(LIGHT_ARRAY_BYTES);\n    const data = new Float32Array(buffer);\n    const count = Math.min(lights.length, MAX_LIGHTS);\n    for (let i = 0; i < count; i++) {\n        const l = lights[i];\n        const o = i * LIGHT_FLOATS;\n        data[o + 0] = l.direction.x;\n        data[o + 1] = l.direction.y;\n        data[o + 2] = l.direction.z;\n        data[o + 3] = 0;\n        data[o + 4] = l.color.r;\n        data[o + 5] = l.color.g;\n        data[o + 6] = l.color.b;\n        data[o + 7] = l.intensity;\n    }\n    return buffer;\n}\n\nexport function packEntityData(\n    sizes: {\n        x: IndexableArray;\n        y: IndexableArray;\n        z: IndexableArray;\n    },\n    albedo: {\n        r: IndexableArray;\n        g: IndexableArray;\n        b: IndexableArray;\n    },\n    roughness: IndexableArray,\n    metallic: IndexableArray,\n    count: number\n): ArrayBuffer {\n    const buffer = new ArrayBuffer(count * ENTITY_DATA_BYTES);\n    const data = new Float32Array(buffer);\n    for (let i = 0; i < count; i++) {\n        const o = i * ENTITY_DATA_FLOATS;\n        data[o + 0] = sizes.x[i];\n        data[o + 1] = sizes.y[i];\n        data[o + 2] = sizes.z[i];\n        data[o + 3] = roughness[i];\n        data[o + 4] = albedo.r[i];\n        data[o + 5] = albedo.g[i];\n        data[o + 6] = albedo.b[i];\n        data[o + 7] = metallic[i];\n    }\n    return buffer;\n}\n\nexport function packTransforms(transforms: Transforms, maxEid: number): ArrayBuffer {\n    const count = maxEid + 1;\n    const byteLength = count * 64;\n    return transforms.data.buffer.slice(\n        transforms.data.byteOffset,\n        transforms.data.byteOffset + byteLength\n    ) as ArrayBuffer;\n}\n\nexport function packAtmosphere(atm: Atmosphere): ArrayBuffer {\n    const buffer = new ArrayBuffer(ATMOSPHERE_BYTES);\n    const data = new Float32Array(buffer);\n    data[0] = atm.sunDir.x;\n    data[1] = atm.sunDir.y;\n    data[2] = atm.sunDir.z;\n    data[3] = atm.sunPower;\n    data[4] = atm.zenith.r;\n    data[5] = atm.zenith.g;\n    data[6] = atm.zenith.b;\n    data[7] = atm.sunRadius;\n    data[8] = atm.horizon.r;\n    data[9] = atm.horizon.g;\n    data[10] = atm.horizon.b;\n    data[11] = atm.fogDensity;\n    data[12] = atm.fogColor.r;\n    data[13] = atm.fogColor.g;\n    data[14] = atm.fogColor.b;\n    data[15] = atm.fogHeight;\n    return buffer;\n}\n\nexport function createDefaultAtmosphere(): Atmosphere {\n    const len = Math.sqrt(0.5 * 0.5 + 0.7 * 0.7 + 0.5 * 0.5);\n    return {\n        sunDir: { x: 0.5 / len, y: 0.7 / len, z: 0.5 / len },\n        sunPower: 8.0,\n        zenith: { r: 0.2, g: 0.4, b: 0.8 },\n        sunRadius: 0.02,\n        horizon: { r: 0.8, g: 0.6, b: 0.4 },\n        fogDensity: 0.005,\n        fogColor: { r: 0.7, g: 0.7, b: 0.8 },\n        fogHeight: 0.1,\n    };\n}\n\nexport function packCamera(camera: Camera): ArrayBuffer {\n    const buffer = new ArrayBuffer(CAMERA_BYTES);\n    const data = new Float32Array(buffer);\n    data[0] = camera.position.x;\n    data[1] = camera.position.y;\n    data[2] = camera.position.z;\n    data[3] = 0;\n    data[4] = camera.right.x;\n    data[5] = camera.right.y;\n    data[6] = camera.right.z;\n    data[7] = 0;\n    data[8] = camera.up.x;\n    data[9] = camera.up.y;\n    data[10] = camera.up.z;\n    data[11] = 0;\n    data[12] = camera.forward.x;\n    data[13] = camera.forward.y;\n    data[14] = camera.forward.z;\n    data[15] = camera.fov;\n    return buffer;\n}\n\nexport function packConfig(config: Config): ArrayBuffer {\n    const buffer = new ArrayBuffer(CONFIG_BYTES);\n    const uints = new Uint32Array(buffer);\n    const floats = new Float32Array(buffer);\n\n    uints[0] = config.width;\n    uints[1] = config.height;\n    uints[2] = config.reference ? 1 : 0;\n    uints[3] = config.debug ? debugModeToNumber(config.debug) : 0;\n    floats[4] = config.near ?? 0.1;\n    floats[5] = config.far ?? 100.0;\n    uints[6] = computePaddedWidth(config.width);\n    floats[7] = 0;\n\n    return buffer;\n}\n\nexport function packCounts(scene: Scene): ArrayBuffer {\n    const buffer = new ArrayBuffer(COUNTS_BYTES);\n    const data = new Uint32Array(buffer);\n    data[0] = scene.entityIds.length;\n    data[1] = scene.lights.length;\n    data[2] = 0;\n    data[3] = 0;\n    return buffer;\n}\n","import type { vec3 } from \"./model\";\n\nexport interface AABB {\n    minX: number;\n    minY: number;\n    minZ: number;\n    maxX: number;\n    maxY: number;\n    maxZ: number;\n}\n\nexport interface FlatBVH {\n    nodes: Float32Array<ArrayBuffer>;\n    primitiveIndices: Uint32Array<ArrayBuffer>;\n    nodeCount: number;\n}\n\ninterface BVHBuildNode {\n    aabb: AABB;\n    leftChild: BVHBuildNode | null;\n    rightChild: BVHBuildNode | null;\n    indices: number[];\n}\n\nexport const BVH_NODE_FLOATS = 8;\nexport const BVH_NODE_BYTES = BVH_NODE_FLOATS * 4;\nexport const MAX_PRIMITIVES_PER_LEAF = 4;\nexport const MAX_BVH_DEPTH = 32;\nexport const BVH_LEAF_FLAG = 0x80000000;\n\nexport function createAABB(): AABB {\n    return {\n        minX: Infinity,\n        minY: Infinity,\n        minZ: Infinity,\n        maxX: -Infinity,\n        maxY: -Infinity,\n        maxZ: -Infinity,\n    };\n}\n\nexport function expandAABB(aabb: AABB, point: vec3): void {\n    aabb.minX = Math.min(aabb.minX, point.x);\n    aabb.minY = Math.min(aabb.minY, point.y);\n    aabb.minZ = Math.min(aabb.minZ, point.z);\n    aabb.maxX = Math.max(aabb.maxX, point.x);\n    aabb.maxY = Math.max(aabb.maxY, point.y);\n    aabb.maxZ = Math.max(aabb.maxZ, point.z);\n}\n\nexport type AABBLookup = (eid: number) => AABB;\n\nexport function mergeAABBs(a: AABB, b: AABB): AABB {\n    return {\n        minX: Math.min(a.minX, b.minX),\n        minY: Math.min(a.minY, b.minY),\n        minZ: Math.min(a.minZ, b.minZ),\n        maxX: Math.max(a.maxX, b.maxX),\n        maxY: Math.max(a.maxY, b.maxY),\n        maxZ: Math.max(a.maxZ, b.maxZ),\n    };\n}\n\nexport function aabbCentroid(aabb: AABB): vec3 {\n    return {\n        x: (aabb.minX + aabb.maxX) * 0.5,\n        y: (aabb.minY + aabb.maxY) * 0.5,\n        z: (aabb.minZ + aabb.maxZ) * 0.5,\n    };\n}\n\nexport function aabbExtent(aabb: AABB): vec3 {\n    return {\n        x: aabb.maxX - aabb.minX,\n        y: aabb.maxY - aabb.minY,\n        z: aabb.maxZ - aabb.minZ,\n    };\n}\n\nexport function aabbSurfaceArea(aabb: AABB): number {\n    const dx = aabb.maxX - aabb.minX;\n    const dy = aabb.maxY - aabb.minY;\n    const dz = aabb.maxZ - aabb.minZ;\n    return 2 * (dx * dy + dy * dz + dz * dx);\n}\n\nconst SAHBinCount = 12;\nconst TraversalCost = 1.0;\nconst IntersectCost = 1.0;\n\ninterface SAHBin {\n    count: number;\n    aabb: AABB;\n}\n\nfunction findBestSAHSplit(\n    entityIds: number[],\n    getAABB: AABBLookup,\n    centroids: vec3[],\n    centroidAABB: AABB,\n    parentAABB: AABB,\n    axis: number\n): { splitIndex: number; cost: number } | null {\n    const extent = aabbExtent(centroidAABB);\n    const axisExtent = axis === 0 ? extent.x : axis === 1 ? extent.y : extent.z;\n\n    if (axisExtent < 1e-8) {\n        return null;\n    }\n\n    const axisMin =\n        axis === 0 ? centroidAABB.minX : axis === 1 ? centroidAABB.minY : centroidAABB.minZ;\n\n    const bins: SAHBin[] = Array.from({ length: SAHBinCount }, () => ({\n        count: 0,\n        aabb: createAABB(),\n    }));\n\n    for (let i = 0; i < entityIds.length; i++) {\n        const centroid = centroids[i];\n        const centroidPos = axis === 0 ? centroid.x : axis === 1 ? centroid.y : centroid.z;\n\n        let binIdx = Math.floor(((centroidPos - axisMin) / axisExtent) * SAHBinCount);\n        binIdx = Math.max(0, Math.min(SAHBinCount - 1, binIdx));\n\n        bins[binIdx].count++;\n        bins[binIdx].aabb = mergeAABBs(bins[binIdx].aabb, getAABB(entityIds[i]));\n    }\n\n    const leftAABBs: AABB[] = new Array(SAHBinCount - 1);\n    const leftCounts: number[] = new Array(SAHBinCount - 1);\n    let runningAABB = createAABB();\n    let runningCount = 0;\n\n    for (let i = 0; i < SAHBinCount - 1; i++) {\n        runningCount += bins[i].count;\n        if (bins[i].count > 0) {\n            runningAABB = mergeAABBs(runningAABB, bins[i].aabb);\n        }\n        leftAABBs[i] = { ...runningAABB };\n        leftCounts[i] = runningCount;\n    }\n\n    const rightAABBs: AABB[] = new Array(SAHBinCount - 1);\n    const rightCounts: number[] = new Array(SAHBinCount - 1);\n    runningAABB = createAABB();\n    runningCount = 0;\n\n    for (let i = SAHBinCount - 1; i > 0; i--) {\n        runningCount += bins[i].count;\n        if (bins[i].count > 0) {\n            runningAABB = mergeAABBs(runningAABB, bins[i].aabb);\n        }\n        rightAABBs[i - 1] = { ...runningAABB };\n        rightCounts[i - 1] = runningCount;\n    }\n\n    const parentArea = aabbSurfaceArea(parentAABB);\n    let bestCost = Infinity;\n    let bestSplit = -1;\n\n    for (let i = 0; i < SAHBinCount - 1; i++) {\n        if (leftCounts[i] === 0 || rightCounts[i] === 0) {\n            continue;\n        }\n\n        const leftArea = aabbSurfaceArea(leftAABBs[i]);\n        const rightArea = aabbSurfaceArea(rightAABBs[i]);\n\n        const cost =\n            TraversalCost +\n            (leftArea / parentArea) * leftCounts[i] * IntersectCost +\n            (rightArea / parentArea) * rightCounts[i] * IntersectCost;\n\n        if (cost < bestCost) {\n            bestCost = cost;\n            bestSplit = i;\n        }\n    }\n\n    if (bestSplit < 0) {\n        return null;\n    }\n\n    const leafCost = entityIds.length * IntersectCost;\n    if (leafCost <= bestCost && entityIds.length <= MAX_PRIMITIVES_PER_LEAF) {\n        return null;\n    }\n\n    return { splitIndex: bestSplit, cost: bestCost };\n}\n\nfunction chooseSplitAxis(aabb: AABB): number {\n    const extent = aabbExtent(aabb);\n    if (extent.x >= extent.y && extent.x >= extent.z) return 0;\n    if (extent.y >= extent.z) return 1;\n    return 2;\n}\n\nfunction getCentroidComponent(centroid: vec3, axis: number): number {\n    if (axis === 0) return centroid.x;\n    if (axis === 1) return centroid.y;\n    return centroid.z;\n}\n\nfunction buildRecursive(entityIds: number[], getAABB: AABBLookup, depth: number): BVHBuildNode {\n    let aabb = createAABB();\n    for (const eid of entityIds) {\n        aabb = mergeAABBs(aabb, getAABB(eid));\n    }\n\n    if (entityIds.length <= MAX_PRIMITIVES_PER_LEAF || depth >= MAX_BVH_DEPTH) {\n        return {\n            aabb,\n            leftChild: null,\n            rightChild: null,\n            indices: entityIds.slice(),\n        };\n    }\n\n    const centroids = entityIds.map((eid) => aabbCentroid(getAABB(eid)));\n    let centroidAABB = createAABB();\n    for (const c of centroids) {\n        expandAABB(centroidAABB, c);\n    }\n\n    let bestSAHResult: { splitIndex: number; cost: number; axis: number } | null = null;\n\n    for (let axis = 0; axis < 3; axis++) {\n        const result = findBestSAHSplit(entityIds, getAABB, centroids, centroidAABB, aabb, axis);\n        if (result !== null) {\n            if (bestSAHResult === null || result.cost < bestSAHResult.cost) {\n                bestSAHResult = { ...result, axis };\n            }\n        }\n    }\n\n    let leftIds: number[];\n    let rightIds: number[];\n\n    if (bestSAHResult !== null) {\n        const axis = bestSAHResult.axis;\n        const axisMin =\n            axis === 0 ? centroidAABB.minX : axis === 1 ? centroidAABB.minY : centroidAABB.minZ;\n        const extent = aabbExtent(centroidAABB);\n        const axisExtent = axis === 0 ? extent.x : axis === 1 ? extent.y : extent.z;\n\n        const splitBoundary = axisMin + ((bestSAHResult.splitIndex + 1) / SAHBinCount) * axisExtent;\n\n        leftIds = [];\n        rightIds = [];\n\n        for (let i = 0; i < entityIds.length; i++) {\n            const centroid = centroids[i];\n            const centroidPos = axis === 0 ? centroid.x : axis === 1 ? centroid.y : centroid.z;\n\n            if (centroidPos < splitBoundary) {\n                leftIds.push(entityIds[i]);\n            } else {\n                rightIds.push(entityIds[i]);\n            }\n        }\n\n        if (leftIds.length === 0 || rightIds.length === 0) {\n            const axis = chooseSplitAxis(centroidAABB);\n            const sortedPairs = entityIds\n                .map((eid, i) => ({ eid, centroid: centroids[i] }))\n                .sort(\n                    (a, b) =>\n                        getCentroidComponent(a.centroid, axis) -\n                        getCentroidComponent(b.centroid, axis)\n                );\n\n            const mid = Math.floor(sortedPairs.length / 2);\n            leftIds = sortedPairs.slice(0, mid).map((p) => p.eid);\n            rightIds = sortedPairs.slice(mid).map((p) => p.eid);\n        }\n    } else {\n        const axis = chooseSplitAxis(centroidAABB);\n\n        const sortedPairs = entityIds\n            .map((eid, i) => ({ eid, centroid: centroids[i] }))\n            .sort(\n                (a, b) =>\n                    getCentroidComponent(a.centroid, axis) - getCentroidComponent(b.centroid, axis)\n            );\n\n        const mid = Math.floor(sortedPairs.length / 2);\n        leftIds = sortedPairs.slice(0, mid).map((p) => p.eid);\n        rightIds = sortedPairs.slice(mid).map((p) => p.eid);\n    }\n\n    if (leftIds.length === 0 || rightIds.length === 0) {\n        return {\n            aabb,\n            leftChild: null,\n            rightChild: null,\n            indices: entityIds.slice(),\n        };\n    }\n\n    return {\n        aabb,\n        leftChild: buildRecursive(leftIds, getAABB, depth + 1),\n        rightChild: buildRecursive(rightIds, getAABB, depth + 1),\n        indices: [],\n    };\n}\n\nfunction countNodes(node: BVHBuildNode): number {\n    if (node.leftChild === null) {\n        return 1;\n    }\n    return 1 + countNodes(node.leftChild!) + countNodes(node.rightChild!);\n}\n\nfunction countPrimitives(node: BVHBuildNode): number {\n    if (node.leftChild === null) {\n        return node.indices.length;\n    }\n    return countPrimitives(node.leftChild!) + countPrimitives(node.rightChild!);\n}\n\nfunction flattenBVH(root: BVHBuildNode | null): FlatBVH {\n    if (root === null) {\n        return {\n            nodes: new Float32Array(0),\n            primitiveIndices: new Uint32Array(0),\n            nodeCount: 0,\n        };\n    }\n\n    const nodeCount = countNodes(root);\n    const primCount = countPrimitives(root);\n\n    const nodes = new Float32Array(nodeCount * BVH_NODE_FLOATS);\n    const nodesU32 = new Uint32Array(nodes.buffer);\n    const primitiveIndices = new Uint32Array(primCount);\n\n    let nextNodeIdx = 0;\n    let nextPrimIdx = 0;\n\n    function flatten(node: BVHBuildNode): number {\n        const myIdx = nextNodeIdx++;\n        const offset = myIdx * BVH_NODE_FLOATS;\n\n        nodes[offset + 0] = node.aabb.minX;\n        nodes[offset + 1] = node.aabb.minY;\n        nodes[offset + 2] = node.aabb.minZ;\n        nodes[offset + 4] = node.aabb.maxX;\n        nodes[offset + 5] = node.aabb.maxY;\n        nodes[offset + 6] = node.aabb.maxZ;\n\n        if (node.leftChild === null) {\n            const primStart = nextPrimIdx;\n            for (const eid of node.indices) {\n                primitiveIndices[nextPrimIdx++] = eid;\n            }\n            nodesU32[offset + 3] = primStart;\n            nodesU32[offset + 7] = BVH_LEAF_FLAG | node.indices.length;\n        } else {\n            const leftIdx = flatten(node.leftChild!);\n            const rightIdx = flatten(node.rightChild!);\n\n            nodesU32[offset + 3] = leftIdx;\n            nodesU32[offset + 7] = rightIdx;\n        }\n\n        return myIdx;\n    }\n\n    flatten(root);\n\n    return { nodes, primitiveIndices, nodeCount };\n}\n\nexport function buildBVH(entityIds: number[], getAABB: AABBLookup): FlatBVH {\n    if (entityIds.length === 0) {\n        return {\n            nodes: new Float32Array(0),\n            primitiveIndices: new Uint32Array(0),\n            nodeCount: 0,\n        };\n    }\n\n    const root = buildRecursive(entityIds, getAABB, 0);\n    return flattenBVH(root);\n}\n\nexport function packBVHNodes(bvh: FlatBVH): ArrayBuffer {\n    return bvh.nodes.buffer as ArrayBuffer;\n}\n\nexport function packPrimitiveIndices(bvh: FlatBVH): ArrayBuffer {\n    return bvh.primitiveIndices.buffer as ArrayBuffer;\n}\n\nexport interface BVHCache {\n    hash: number;\n    bvh: FlatBVH;\n}\n\nfunction floatBits(f: number): number {\n    const buf = new Float32Array(1);\n    buf[0] = f;\n    return new Uint32Array(buf.buffer)[0];\n}\n\nexport function hashEntities(entityIds: number[], getAABB: AABBLookup): number {\n    let hash = entityIds.length * 2654435761;\n    for (const eid of entityIds) {\n        const aabb = getAABB(eid);\n        hash ^= floatBits(aabb.minX) * 31;\n        hash ^= floatBits(aabb.minY) * 37;\n        hash ^= floatBits(aabb.minZ) * 41;\n        hash ^= floatBits(aabb.maxX) * 43;\n        hash ^= floatBits(aabb.maxY) * 47;\n        hash ^= floatBits(aabb.maxZ) * 53;\n        hash ^= eid * 59;\n        hash = (hash << 5) - hash;\n    }\n    return hash >>> 0;\n}\n","export const RAYTRACE_CORE = /* wgsl */ `\nstruct Config {\n    width: u32,\n    height: u32,\n    referenceMode: u32,\n    debugMode: u32,\n    near: f32,\n    far: f32,\n    paddedWidth: u32,\n    _pad1: f32,\n}\n\nstruct Camera {\n    position: vec3f,\n    _pad0: f32,\n    right: vec3f,\n    _pad1: f32,\n    up: vec3f,\n    _pad2: f32,\n    forward: vec3f,\n    fov: f32,\n}\n\nstruct DirectionalLight {\n    direction: vec3f,\n    _pad0: f32,\n    color: vec3f,\n    intensity: f32,\n}\n\nstruct Atmosphere {\n    sunDir: vec3f,\n    sunPower: f32,\n    zenith: vec3f,\n    sunRadius: f32,\n    horizon: vec3f,\n    fogDensity: f32,\n    fogColor: vec3f,\n    fogHeight: f32,\n}\n\nstruct Terrain {\n    position: vec3f,\n    sizeX: f32,\n    sizeZ: f32,\n    heightScale: f32,\n    resolution: u32,\n    materialId: u32,\n}\n\nstruct Ray {\n    origin: vec3f,\n    tMin: f32,\n    direction: vec3f,\n    tMax: f32,\n}\n\nstruct Hit {\n    t: f32,\n    normal: vec3f,\n    position: vec3f,\n    entity: u32,\n    didHit: u32,\n}\n\nstruct SceneCounts {\n    entityCount: u32,\n    lightCount: u32,\n    _pad0: u32,\n    _pad1: u32,\n}\n\nstruct BVHNode {\n    aabbMin: vec3f,\n    leftOrPrimStart: u32,\n    aabbMax: vec3f,\n    rightOrPrimCount: u32,\n}\n\nstruct BVHConfig {\n    nodeCount: u32,\n    useBVH: u32,\n    _pad0: u32,\n    _pad1: u32,\n}\n\nstruct EntityData {\n    size: vec4f,              // x, y, z, roughness\n    albedoAndMetallic: vec4f, // r, g, b, metallic\n}\n\nconst MaxLights: u32 = 8u;\n\nstruct LightArray {\n    lights: array<DirectionalLight, 8>,\n}\n\nconst BVHLeafFlag: u32 = 0x80000000u;\nconst MaxBVHStack: u32 = 32u;\n\nconst ShapeBox: u32 = 0u;\nconst ShapeSphere: u32 = 1u;\nconst ShapePlane: u32 = 2u;\n\n@group(0) @binding(0) var<uniform> config: Config;\n@group(0) @binding(1) var<uniform> camera: Camera;\n@group(0) @binding(2) var<uniform> counts: SceneCounts;\n@group(0) @binding(3) var<storage, read> transforms: array<mat4x4f>;\n@group(0) @binding(4) var<storage, read> entityIds: array<u32>;\n@group(0) @binding(5) var<storage, read> shapes: array<u32>;\n// Binding 6 is defined in entry-point-specific code (output)\n@group(0) @binding(7) var<uniform> lightArray: LightArray;\n@group(0) @binding(8) var<uniform> atmosphere: Atmosphere;\n@group(0) @binding(9) var<uniform> terrain: Terrain;\n@group(0) @binding(10) var<storage, read> terrainHeights: array<f32>;\n@group(0) @binding(11) var<storage, read> bvhNodes: array<BVHNode>;\n@group(0) @binding(12) var<storage, read> primitiveIndices: array<u32>;\n@group(0) @binding(13) var<uniform> bvhConfig: BVHConfig;\n@group(0) @binding(14) var<storage, read> entityData: array<EntityData>;\n\nfn getSize(eid: u32) -> vec3f {\n    return entityData[eid].size.xyz;\n}\n\nfn getAlbedo(eid: u32) -> vec3f {\n    return entityData[eid].albedoAndMetallic.rgb;\n}\n\nfn getRoughness(eid: u32) -> f32 {\n    return entityData[eid].size.w;\n}\n\nfn getMetallic(eid: u32) -> f32 {\n    return entityData[eid].albedoAndMetallic.w;\n}\n\nfn generateRay(pixelX: u32, pixelY: u32) -> Ray {\n    let aspect = f32(config.width) / f32(config.height);\n    let tanHalfFov = tan(camera.fov * 0.5);\n\n    let u = (f32(pixelX) + 0.5) / f32(config.width) * 2.0 - 1.0;\n    let v = 1.0 - (f32(pixelY) + 0.5) / f32(config.height) * 2.0;\n\n    var dir = camera.forward\n        + u * aspect * tanHalfFov * camera.right\n        + v * tanHalfFov * camera.up;\n    dir = normalize(dir);\n\n    var ray: Ray;\n    ray.origin = camera.position;\n    ray.tMin = 0.001;\n    ray.direction = dir;\n    ray.tMax = 1e30;\n    return ray;\n}\n\nfn intersectSphereTransform(ray: Ray, transform: mat4x4f, eid: u32) -> f32 {\n    let center = transform[3].xyz;\n    let radius = getSize(eid).x * 0.5;\n\n    let oc = ray.origin - center;\n    let a = dot(ray.direction, ray.direction);\n    let halfB = dot(oc, ray.direction);\n    let c = dot(oc, oc) - radius * radius;\n\n    let discriminant = halfB * halfB - a * c;\n    if (discriminant < 0.0) {\n        return 1e31;\n    }\n\n    let sqrtD = sqrt(discriminant);\n    var t = (-halfB - sqrtD) / a;\n    if (t < ray.tMin || t > ray.tMax) {\n        t = (-halfB + sqrtD) / a;\n        if (t < ray.tMin || t > ray.tMax) {\n            return 1e31;\n        }\n    }\n    return t;\n}\n\nfn getSphereNormal(hitPos: vec3f, transform: mat4x4f) -> vec3f {\n    let center = transform[3].xyz;\n    return normalize(hitPos - center);\n}\n\nfn intersectPlaneTransform(ray: Ray, transform: mat4x4f) -> f32 {\n    let normal = normalize(transform[1].xyz);\n    let point = transform[3].xyz;\n    let distance = dot(normal, point);\n\n    let denom = dot(ray.direction, normal);\n    if (abs(denom) < 1e-8) {\n        return 1e31;\n    }\n\n    let originDot = dot(ray.origin, normal);\n    let t = (distance - originDot) / denom;\n\n    if (t < ray.tMin || t > ray.tMax) {\n        return 1e31;\n    }\n    return t;\n}\n\nfn getPlaneNormal(transform: mat4x4f) -> vec3f {\n    return normalize(transform[1].xyz);\n}\n\nfn getTerrainHeight(worldX: f32, worldZ: f32) -> f32 {\n    let localX = (worldX - terrain.position.x) / terrain.sizeX + 0.5;\n    let localZ = (worldZ - terrain.position.z) / terrain.sizeZ + 0.5;\n\n    if (localX < 0.0 || localX > 1.0 || localZ < 0.0 || localZ > 1.0) {\n        return -1e30;\n    }\n\n    let res = f32(terrain.resolution);\n    let gridX = localX * (res - 1.0);\n    let gridZ = localZ * (res - 1.0);\n\n    let ix = u32(floor(gridX));\n    let iz = u32(floor(gridZ));\n    let fx = gridX - floor(gridX);\n    let fz = gridZ - floor(gridZ);\n\n    let ix1 = min(ix + 1u, terrain.resolution - 1u);\n    let iz1 = min(iz + 1u, terrain.resolution - 1u);\n\n    let h00 = terrainHeights[iz * terrain.resolution + ix];\n    let h10 = terrainHeights[iz * terrain.resolution + ix1];\n    let h01 = terrainHeights[iz1 * terrain.resolution + ix];\n    let h11 = terrainHeights[iz1 * terrain.resolution + ix1];\n\n    let h0 = h00 + (h10 - h00) * fx;\n    let h1 = h01 + (h11 - h01) * fx;\n\n    return terrain.position.y + (h0 + (h1 - h0) * fz) * terrain.heightScale;\n}\n\nfn getTerrainNormal(worldX: f32, worldZ: f32) -> vec3f {\n    let eps = terrain.sizeX / f32(terrain.resolution);\n\n    let hL = getTerrainHeight(worldX - eps, worldZ);\n    let hR = getTerrainHeight(worldX + eps, worldZ);\n    let hD = getTerrainHeight(worldX, worldZ - eps);\n    let hU = getTerrainHeight(worldX, worldZ + eps);\n\n    let nx = hL - hR;\n    let ny = 2.0 * eps / terrain.heightScale;\n    let nz = hD - hU;\n\n    return normalize(vec3f(nx, ny, nz));\n}\n\nfn intersectAABB(ray: Ray, aabbMin: vec3f, aabbMax: vec3f, invDir: vec3f, tMax: f32) -> bool {\n    let t1 = (aabbMin - ray.origin) * invDir;\n    let t2 = (aabbMax - ray.origin) * invDir;\n\n    let tmin = max(max(min(t1.x, t2.x), min(t1.y, t2.y)), min(t1.z, t2.z));\n    let tmax = min(min(max(t1.x, t2.x), max(t1.y, t2.y)), max(t1.z, t2.z));\n\n    return tmax >= max(tmin, ray.tMin) && tmin < tMax;\n}\n\nfn intersectAABBDist(ray: Ray, aabbMin: vec3f, aabbMax: vec3f, invDir: vec3f) -> f32 {\n    let t1 = (aabbMin - ray.origin) * invDir;\n    let t2 = (aabbMax - ray.origin) * invDir;\n\n    let tmin = max(max(min(t1.x, t2.x), min(t1.y, t2.y)), min(t1.z, t2.z));\n    let tmax = min(min(max(t1.x, t2.x), max(t1.y, t2.y)), max(t1.z, t2.z));\n\n    if (tmax < max(tmin, ray.tMin)) {\n        return 1e31;\n    }\n    return max(tmin, ray.tMin);\n}\n\nfn traceRayBVH(ray: Ray) -> Hit {\n    var hit: Hit;\n    hit.t = 1e31;\n    hit.didHit = 0u;\n\n    if (bvhConfig.nodeCount == 0u) {\n        return hit;\n    }\n\n    let invDir = 1.0 / ray.direction;\n\n    var stack: array<u32, 32>;\n    var stackPtr = 0u;\n    stack[0] = 0u;\n    stackPtr = 1u;\n\n    while (stackPtr > 0u) {\n        stackPtr = stackPtr - 1u;\n        let nodeIdx = stack[stackPtr];\n\n        let node = bvhNodes[nodeIdx];\n\n        if (!intersectAABB(ray, node.aabbMin, node.aabbMax, invDir, hit.t)) {\n            continue;\n        }\n\n        let isLeaf = (node.rightOrPrimCount & BVHLeafFlag) != 0u;\n\n        if (isLeaf) {\n            let primStart = node.leftOrPrimStart;\n            let primCount = node.rightOrPrimCount & 0x7FFFFFFFu;\n\n            for (var i = 0u; i < primCount; i++) {\n                let eid = primitiveIndices[primStart + i];\n                let transform = transforms[eid];\n                let shape = shapes[eid];\n\n                if (shape == ShapeSphere) {\n                    let t = intersectSphereTransform(ray, transform, eid);\n                    if (t < hit.t) {\n                        hit.t = t;\n                        hit.position = ray.origin + t * ray.direction;\n                        hit.normal = getSphereNormal(hit.position, transform);\n                        hit.entity = eid;\n                        hit.didHit = 1u;\n                    }\n                }\n            }\n        } else {\n            let leftIdx = node.leftOrPrimStart;\n            let rightIdx = node.rightOrPrimCount;\n\n            let leftNode = bvhNodes[leftIdx];\n            let rightNode = bvhNodes[rightIdx];\n\n            let leftDist = intersectAABBDist(ray, leftNode.aabbMin, leftNode.aabbMax, invDir);\n            let rightDist = intersectAABBDist(ray, rightNode.aabbMin, rightNode.aabbMax, invDir);\n\n            if (leftDist < rightDist) {\n                if (rightDist < hit.t && stackPtr < MaxBVHStack) {\n                    stack[stackPtr] = rightIdx;\n                    stackPtr = stackPtr + 1u;\n                }\n                if (leftDist < hit.t && stackPtr < MaxBVHStack) {\n                    stack[stackPtr] = leftIdx;\n                    stackPtr = stackPtr + 1u;\n                }\n            } else {\n                if (leftDist < hit.t && stackPtr < MaxBVHStack) {\n                    stack[stackPtr] = leftIdx;\n                    stackPtr = stackPtr + 1u;\n                }\n                if (rightDist < hit.t && stackPtr < MaxBVHStack) {\n                    stack[stackPtr] = rightIdx;\n                    stackPtr = stackPtr + 1u;\n                }\n            }\n        }\n    }\n\n    return hit;\n}\n\nfn intersectTerrain(ray: Ray) -> Hit {\n    var hit: Hit;\n    hit.t = 1e31;\n    hit.didHit = 0u;\n\n    if (terrain.resolution == 0u) {\n        return hit;\n    }\n\n    let halfX = terrain.sizeX * 0.5;\n    let halfZ = terrain.sizeZ * 0.5;\n    let minX = terrain.position.x - halfX;\n    let maxX = terrain.position.x + halfX;\n    let minZ = terrain.position.z - halfZ;\n    let maxZ = terrain.position.z + halfZ;\n    let minY = terrain.position.y;\n    let maxY = terrain.position.y + terrain.heightScale;\n\n    var tMin = ray.tMin;\n    var tMax = ray.tMax;\n\n    if (abs(ray.direction.x) > 1e-8) {\n        let t1 = (minX - ray.origin.x) / ray.direction.x;\n        let t2 = (maxX - ray.origin.x) / ray.direction.x;\n        tMin = max(tMin, min(t1, t2));\n        tMax = min(tMax, max(t1, t2));\n    } else if (ray.origin.x < minX || ray.origin.x > maxX) {\n        return hit;\n    }\n\n    if (abs(ray.direction.z) > 1e-8) {\n        let t1 = (minZ - ray.origin.z) / ray.direction.z;\n        let t2 = (maxZ - ray.origin.z) / ray.direction.z;\n        tMin = max(tMin, min(t1, t2));\n        tMax = min(tMax, max(t1, t2));\n    } else if (ray.origin.z < minZ || ray.origin.z > maxZ) {\n        return hit;\n    }\n\n    if (abs(ray.direction.y) > 1e-8) {\n        let t1 = (minY - ray.origin.y) / ray.direction.y;\n        let t2 = (maxY - ray.origin.y) / ray.direction.y;\n        tMin = max(tMin, min(t1, t2));\n        tMax = min(tMax, max(t1, t2));\n    } else if (ray.origin.y < minY || ray.origin.y > maxY) {\n        return hit;\n    }\n\n    if (tMin > tMax) {\n        return hit;\n    }\n\n    let cellSize = terrain.sizeX / f32(terrain.resolution);\n    let aabbSpan = tMax - tMin;\n    let stepSize = min(cellSize * 0.5, aabbSpan / 16.0);\n    let maxSteps = 1024;\n\n    var t = max(tMin, ray.tMin);\n    var lastAbove = true;\n    var prevT = t;\n\n    for (var i = 0; i < maxSteps; i++) {\n        if (t > tMax) {\n            break;\n        }\n\n        let x = ray.origin.x + t * ray.direction.x;\n        let y = ray.origin.y + t * ray.direction.y;\n        let z = ray.origin.z + t * ray.direction.z;\n\n        let terrainY = getTerrainHeight(x, z);\n        if (terrainY < -1e20) {\n            prevT = t;\n            t += stepSize;\n            lastAbove = true;\n            continue;\n        }\n\n        let above = y > terrainY;\n\n        if (lastAbove && !above) {\n            var lo = prevT;\n            var hi = t;\n\n            for (var j = 0; j < 8; j++) {\n                let mid = (lo + hi) * 0.5;\n                let mx = ray.origin.x + mid * ray.direction.x;\n                let my = ray.origin.y + mid * ray.direction.y;\n                let mz = ray.origin.z + mid * ray.direction.z;\n                let mTerrain = getTerrainHeight(mx, mz);\n\n                if (my > mTerrain) {\n                    lo = mid;\n                } else {\n                    hi = mid;\n                }\n            }\n\n            if (hi >= ray.tMin && hi <= ray.tMax) {\n                hit.t = hi;\n                hit.position = ray.origin + hi * ray.direction;\n                hit.normal = getTerrainNormal(hit.position.x, hit.position.z);\n                hit.entity = terrain.materialId;\n                hit.didHit = 1u;\n                return hit;\n            }\n        }\n\n        lastAbove = above;\n        prevT = t;\n        t += stepSize;\n    }\n\n    if (lastAbove) {\n        let x = ray.origin.x + tMax * ray.direction.x;\n        let y = ray.origin.y + tMax * ray.direction.y;\n        let z = ray.origin.z + tMax * ray.direction.z;\n        let terrainY = getTerrainHeight(x, z);\n\n        if (terrainY > -1e20 && y <= terrainY) {\n            var lo = prevT;\n            var hi = tMax;\n\n            for (var j = 0; j < 8; j++) {\n                let mid = (lo + hi) * 0.5;\n                let mx = ray.origin.x + mid * ray.direction.x;\n                let my = ray.origin.y + mid * ray.direction.y;\n                let mz = ray.origin.z + mid * ray.direction.z;\n                let mTerrain = getTerrainHeight(mx, mz);\n\n                if (my > mTerrain) {\n                    lo = mid;\n                } else {\n                    hi = mid;\n                }\n            }\n\n            if (hi >= ray.tMin && hi <= ray.tMax) {\n                hit.t = hi;\n                hit.position = ray.origin + hi * ray.direction;\n                hit.normal = getTerrainNormal(hit.position.x, hit.position.z);\n                hit.entity = terrain.materialId;\n                hit.didHit = 1u;\n                return hit;\n            }\n        }\n    }\n\n    return hit;\n}\n\nfn traceRay(ray: Ray) -> Hit {\n    var hit: Hit;\n    hit.t = 1e31;\n    hit.didHit = 0u;\n\n    if (bvhConfig.useBVH == 1u && bvhConfig.nodeCount > 0u) {\n        hit = traceRayBVH(ray);\n    }\n\n    // Linear scan for all entities (brute force or planes)\n    for (var i = 0u; i < counts.entityCount; i++) {\n        let eid = entityIds[i];\n        let transform = transforms[eid];\n        let shape = shapes[eid];\n\n        if (shape == ShapeSphere) {\n            // Skip if using BVH (already tested)\n            if (bvhConfig.useBVH == 1u && bvhConfig.nodeCount > 0u) {\n                continue;\n            }\n            let t = intersectSphereTransform(ray, transform, eid);\n            if (t < hit.t) {\n                hit.t = t;\n                hit.position = ray.origin + t * ray.direction;\n                hit.normal = getSphereNormal(hit.position, transform);\n                hit.entity = eid;\n                hit.didHit = 1u;\n            }\n        } else if (shape == ShapePlane) {\n            let t = intersectPlaneTransform(ray, transform);\n            if (t < hit.t) {\n                hit.t = t;\n                hit.position = ray.origin + t * ray.direction;\n                hit.normal = getPlaneNormal(transform);\n                hit.entity = eid;\n                hit.didHit = 1u;\n            }\n        }\n    }\n\n    let terrainHit = intersectTerrain(ray);\n    if (terrainHit.didHit == 1u && terrainHit.t < hit.t) {\n        hit = terrainHit;\n    }\n\n    return hit;\n}\n\nconst ShadowBias: f32 = 0.001;\nconst Ambient: f32 = 0.1;\n\nfn getSkyColor(rayDir: vec3f) -> vec3f {\n    let t = clamp(rayDir.y * 0.5 + 0.5, 0.0, 1.0);\n    let sky = mix(atmosphere.horizon, atmosphere.zenith, t);\n\n    let sunDot = dot(rayDir, atmosphere.sunDir);\n    let inner = cos(atmosphere.sunRadius);\n    let outer = cos(atmosphere.sunRadius * 2.0);\n    let sun = vec3f(1.0, 0.95, 0.8) * smoothstep(outer, inner, sunDot) * atmosphere.sunPower;\n\n    return sky + sun;\n}\n\nfn applyFog(color: vec3f, dist: f32, rayDir: vec3f, hitY: f32) -> vec3f {\n    let base = 1.0 - exp(-dist * atmosphere.fogDensity);\n    let height = exp(-max(hitY, 0.0) * atmosphere.fogHeight);\n    let amount = clamp(base * height, 0.0, 1.0);\n    let fog = mix(atmosphere.fogColor, getSkyColor(rayDir), 0.3);\n    return mix(color, fog, amount);\n}\n\nfn isInShadow(origin: vec3f, dir: vec3f, maxT: f32) -> bool {\n    var ray: Ray;\n    ray.origin = origin;\n    ray.direction = dir;\n    ray.tMin = ShadowBias;\n    ray.tMax = maxT;\n\n    let hit = traceRay(ray);\n    return hit.didHit == 1u;\n}\n\nfn reflectDir(incident: vec3f, normal: vec3f) -> vec3f {\n    return incident - 2.0 * dot(normal, incident) * normal;\n}\n\nfn fresnelSchlick(cosTheta: f32, F0: f32) -> f32 {\n    return F0 + (1.0 - F0) * pow(1.0 - cosTheta, 5.0);\n}\n\nfn computeDirectLighting(hit: Hit) -> vec3f {\n    let albedo = getAlbedo(hit.entity);\n    var totalLight = Ambient;\n    var lightColor = vec3f(1.0, 1.0, 1.0);\n\n    for (var i = 0u; i < min(counts.lightCount, MaxLights); i++) {\n        let light = lightArray.lights[i];\n        let nDotL = dot(hit.normal, light.direction);\n\n        if (nDotL > 0.0) {\n            let shadowOrigin = hit.position + hit.normal * ShadowBias;\n\n            if (!isInShadow(shadowOrigin, light.direction, 1e30)) {\n                totalLight += nDotL * light.intensity;\n                lightColor = light.color;\n            }\n        }\n    }\n\n    return albedo * totalLight * lightColor;\n}\n\nfn shadeColor(hit: Hit, ray: Ray) -> vec3f {\n    if (hit.didHit == 0u) {\n        return getSkyColor(ray.direction);\n    }\n\n    let albedo = getAlbedo(hit.entity);\n    let metal = getMetallic(hit.entity);\n\n    var litColor: vec3f;\n    if (counts.lightCount == 0u) {\n        litColor = albedo;\n    } else {\n        litColor = computeDirectLighting(hit);\n    }\n\n    if (metal > 0.01) {\n        let viewDir = -ray.direction;\n        let cosTheta = max(0.0, dot(viewDir, hit.normal));\n\n        var F0: f32;\n        if (metal > 0.5) {\n            F0 = albedo.r;\n        } else {\n            F0 = 0.04;\n        }\n        let fresnel = fresnelSchlick(cosTheta, F0);\n        let reflectAmount = fresnel * metal;\n\n        let reflectDirection = reflectDir(ray.direction, hit.normal);\n        let bias = 0.001;\n        var reflectRay: Ray;\n        reflectRay.origin = hit.position + hit.normal * bias;\n        reflectRay.direction = reflectDirection;\n        reflectRay.tMin = 0.001;\n        reflectRay.tMax = 1e30;\n\n        let reflectHit = traceRay(reflectRay);\n        var reflectColor: vec3f;\n\n        if (reflectHit.didHit == 1u) {\n            let reflectAlbedo = getAlbedo(reflectHit.entity);\n            if (counts.lightCount == 0u) {\n                reflectColor = reflectAlbedo;\n            } else {\n                reflectColor = computeDirectLighting(reflectHit);\n            }\n            reflectColor = applyFog(reflectColor, reflectHit.t, reflectDirection, reflectHit.position.y);\n        } else {\n            reflectColor = getSkyColor(reflectDirection);\n        }\n\n        let diffuseWeight = 1.0 - reflectAmount;\n        litColor = litColor * diffuseWeight + reflectColor * reflectAmount;\n    }\n\n    return applyFog(litColor, hit.t, ray.direction, hit.position.y);\n}\n\nfn shadeDepth(hit: Hit) -> vec3f {\n    if (hit.didHit == 0u) {\n        return vec3f(0.0, 0.0, 0.0);\n    }\n    let normalized = clamp((hit.t - config.near) / (config.far - config.near), 0.0, 1.0);\n    let inverted = 1.0 - normalized;\n    return vec3f(inverted, inverted, inverted);\n}\n\nfn shadeNormal(hit: Hit) -> vec3f {\n    if (hit.didHit == 0u) {\n        return vec3f(0.0, 0.0, 0.0);\n    }\n    return (hit.normal + 1.0) * 0.5;\n}\n\nfn hslToRgb(h: f32, s: f32, l: f32) -> vec3f {\n    let c = (1.0 - abs(2.0 * l - 1.0)) * s;\n    let hue6 = h * 6.0;\n    let hue6mod2 = hue6 - floor(hue6 * 0.5) * 2.0;\n    let x = c * (1.0 - abs(hue6mod2 - 1.0));\n    let m = l - c * 0.5;\n    var rgb: vec3f;\n    if (hue6 < 1.0) {\n        rgb = vec3f(c, x, 0.0);\n    } else if (hue6 < 2.0) {\n        rgb = vec3f(x, c, 0.0);\n    } else if (hue6 < 3.0) {\n        rgb = vec3f(0.0, c, x);\n    } else if (hue6 < 4.0) {\n        rgb = vec3f(0.0, x, c);\n    } else if (hue6 < 5.0) {\n        rgb = vec3f(x, 0.0, c);\n    } else {\n        rgb = vec3f(c, 0.0, x);\n    }\n    return rgb + m;\n}\n\nfn shadeMaterial(hit: Hit) -> vec3f {\n    if (hit.didHit == 0u) {\n        return vec3f(0.0, 0.0, 0.0);\n    }\n    let hue = fract(f32(hit.entity) * 137.5 / 360.0);\n    return hslToRgb(hue, 0.7, 0.5);\n}\n\nfn shadeHit(hit: Hit) -> vec3f {\n    if (hit.didHit == 0u) {\n        return vec3f(0.0, 0.0, 0.0);\n    }\n    return vec3f(1.0, 1.0, 1.0);\n}\n\nfn shade(hit: Hit, ray: Ray) -> vec3f {\n    switch (config.debugMode) {\n        case 0u: { return shadeColor(hit, ray); }\n        case 1u: { return shadeDepth(hit); }\n        case 2u: { return shadeNormal(hit); }\n        case 3u: { return shadeMaterial(hit); }\n        case 4u: { return shadeHit(hit); }\n        default: { return shadeColor(hit, ray); }\n    }\n}\n`;\n\nexport const HARNESS_ENTRY_POINT = /* wgsl */ `\n@group(0) @binding(6) var<storage, read_write> output: array<u32>;\n\nfn packRGBA8(color: vec3f) -> u32 {\n    let r = u32(clamp(color.x * 255.0 + 0.5, 0.0, 255.0));\n    let g = u32(clamp(color.y * 255.0 + 0.5, 0.0, 255.0));\n    let b = u32(clamp(color.z * 255.0 + 0.5, 0.0, 255.0));\n    let a = 255u;\n    return r | (g << 8u) | (b << 16u) | (a << 24u);\n}\n\n@compute @workgroup_size(64)\nfn main(@builtin(global_invocation_id) gid: vec3u) {\n    let pixelIndex = gid.x;\n    let pixelCount = config.width * config.height;\n    if (pixelIndex >= pixelCount) {\n        return;\n    }\n\n    let pixelX = pixelIndex % config.width;\n    let pixelY = pixelIndex / config.width;\n\n    let ray = generateRay(pixelX, pixelY);\n    let hit = traceRay(ray);\n    let color = shade(hit, ray);\n\n    let outputIndex = pixelY * config.paddedWidth + pixelX;\n    output[outputIndex] = packRGBA8(color);\n}\n`;\n\nexport const RAYCAST_ENTRY_POINT = /* wgsl */ `\n@group(0) @binding(6) var outputTexture: texture_storage_2d<rgba16float, write>;\n\n@compute @workgroup_size(8, 8)\nfn main(@builtin(global_invocation_id) gid: vec3u) {\n    let pixelX = gid.x;\n    let pixelY = gid.y;\n\n    if (pixelX >= config.width || pixelY >= config.height) {\n        return;\n    }\n\n    let ray = generateRay(pixelX, pixelY);\n    let hit = traceRay(ray);\n    let color = shade(hit, ray);\n\n    textureStore(outputTexture, vec2i(i32(pixelX), i32(pixelY)), vec4f(color, 1.0));\n}\n`;\n\nexport const HARNESS_SHADER = RAYTRACE_CORE + HARNESS_ENTRY_POINT;\nexport const RAYCAST_SHADER = RAYTRACE_CORE + RAYCAST_ENTRY_POINT;\n","import type { Scene, Config } from \"./model\";\nimport {\n    packTerrain,\n    packLights,\n    packEntityData,\n    packTransforms,\n    packAtmosphere,\n    packCamera,\n    packConfig,\n    packCounts,\n    TERRAIN_BYTES,\n    LIGHT_ARRAY_BYTES,\n    ENTITY_DATA_BYTES,\n    ATMOSPHERE_BYTES,\n    CAMERA_BYTES,\n    CONFIG_BYTES,\n    COUNTS_BYTES,\n    BVH_CONFIG_BYTES,\n    computePaddedWidth,\n} from \"./model\";\nimport { buildBVH, BVH_NODE_BYTES, type BVHCache, type AABB, type AABBLookup } from \"./bvh\";\nimport { HARNESS_SHADER } from \"./shaders\";\n\nconst WorkgroupSize = 64;\nconst ShapeSphere = 1;\n\nfunction createSphereAABBLookup(scene: Scene): AABBLookup {\n    return (eid: number): AABB => {\n        const o = eid * 16;\n        const cx = scene.transforms.data[o + 12];\n        const cy = scene.transforms.data[o + 13];\n        const cz = scene.transforms.data[o + 14];\n        const radius = scene.sizes.x[eid] * 0.5;\n        return {\n            minX: cx - radius,\n            minY: cy - radius,\n            minZ: cz - radius,\n            maxX: cx + radius,\n            maxY: cy + radius,\n            maxZ: cz + radius,\n        };\n    };\n}\n\nexport interface RTHarnessContext {\n    device: GPUDevice;\n    pipeline: GPUComputePipeline;\n    bindGroupLayout: GPUBindGroupLayout;\n    buffers: unknown;\n    bvhCache: BVHCache | null;\n}\n\nexport function initRTHarness(device: GPUDevice): RTHarnessContext {\n    const bindGroupLayout = device.createBindGroupLayout({\n        label: \"rtBindGroupLayout\",\n        entries: [\n            { binding: 0, visibility: GPUShaderStage.COMPUTE, buffer: { type: \"uniform\" } },\n            { binding: 1, visibility: GPUShaderStage.COMPUTE, buffer: { type: \"uniform\" } },\n            { binding: 2, visibility: GPUShaderStage.COMPUTE, buffer: { type: \"uniform\" } },\n            {\n                binding: 3,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: { type: \"read-only-storage\" },\n            },\n            {\n                binding: 4,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: { type: \"read-only-storage\" },\n            },\n            {\n                binding: 5,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: { type: \"read-only-storage\" },\n            },\n            { binding: 6, visibility: GPUShaderStage.COMPUTE, buffer: { type: \"storage\" } },\n            { binding: 7, visibility: GPUShaderStage.COMPUTE, buffer: { type: \"uniform\" } },\n            { binding: 8, visibility: GPUShaderStage.COMPUTE, buffer: { type: \"uniform\" } },\n            { binding: 9, visibility: GPUShaderStage.COMPUTE, buffer: { type: \"uniform\" } },\n            {\n                binding: 10,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: { type: \"read-only-storage\" },\n            },\n            {\n                binding: 11,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: { type: \"read-only-storage\" },\n            },\n            {\n                binding: 12,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: { type: \"read-only-storage\" },\n            },\n            { binding: 13, visibility: GPUShaderStage.COMPUTE, buffer: { type: \"uniform\" } },\n            {\n                binding: 14,\n                visibility: GPUShaderStage.COMPUTE,\n                buffer: { type: \"read-only-storage\" },\n            },\n        ],\n    });\n\n    const pipelineLayout = device.createPipelineLayout({\n        label: \"rtPipelineLayout\",\n        bindGroupLayouts: [bindGroupLayout],\n    });\n\n    const shaderModule = device.createShaderModule({\n        label: \"rtShader\",\n        code: HARNESS_SHADER,\n    });\n\n    const pipeline = device.createComputePipeline({\n        label: \"rtPipeline\",\n        layout: pipelineLayout,\n        compute: {\n            module: shaderModule,\n            entryPoint: \"main\",\n        },\n    });\n\n    return { device, pipeline, bindGroupLayout, buffers: null, bvhCache: null };\n}\n\nfunction findMaxEntityId(entityIds: number[]): number {\n    let max = 0;\n    for (const eid of entityIds) {\n        if (eid > max) max = eid;\n    }\n    return max;\n}\n\nexport async function renderGPU(\n    ctx: RTHarnessContext,\n    scene: Scene,\n    config: Config\n): Promise<Uint8Array> {\n    const { device, pipeline, bindGroupLayout } = ctx;\n    const { width, height } = config;\n    const pixelCount = width * height;\n    const paddedWidth = computePaddedWidth(width);\n    const paddedPixelCount = paddedWidth * height;\n\n    const entityCount = scene.entityIds.length;\n    const maxEid = findMaxEntityId(scene.entityIds);\n    const sparseSize = maxEid + 1;\n\n    const configBuffer = device.createBuffer({\n        label: \"rtConfig\",\n        size: CONFIG_BYTES,\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n    });\n\n    const cameraBuffer = device.createBuffer({\n        label: \"rtCamera\",\n        size: CAMERA_BYTES,\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n    });\n\n    const countsBuffer = device.createBuffer({\n        label: \"rtCounts\",\n        size: COUNTS_BYTES,\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n    });\n\n    const transformsBuffer = device.createBuffer({\n        label: \"rtTransforms\",\n        size: Math.max(64, sparseSize * 64),\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n    });\n\n    const entityIdsBuffer = device.createBuffer({\n        label: \"rtEntityIds\",\n        size: Math.max(4, entityCount * 4),\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n    });\n\n    const shapesBuffer = device.createBuffer({\n        label: \"rtShapes\",\n        size: Math.max(4, sparseSize * 4),\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n    });\n\n    const outputBuffer = device.createBuffer({\n        label: \"rtOutput\",\n        size: paddedPixelCount * 4,\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC,\n    });\n\n    const lightBuffer = device.createBuffer({\n        label: \"rtLights\",\n        size: LIGHT_ARRAY_BYTES,\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n    });\n\n    const atmosphereBuffer = device.createBuffer({\n        label: \"rtAtmosphere\",\n        size: ATMOSPHERE_BYTES,\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n    });\n\n    const terrainBuffer = device.createBuffer({\n        label: \"rtTerrain\",\n        size: TERRAIN_BYTES,\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n    });\n\n    const terrainHeightsSize = scene.terrain && scene.heights ? scene.heights.length * 4 : 4;\n    const terrainHeightsBuffer = device.createBuffer({\n        label: \"rtTerrainHeights\",\n        size: terrainHeightsSize,\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n    });\n\n    const sphereIds = scene.entityIds.filter((eid) => scene.shapes[eid] === ShapeSphere);\n    const useBVH = config.useBVH !== false && sphereIds.length > 0;\n    const getAABB = createSphereAABBLookup(scene);\n    const bvh = useBVH ? buildBVH(sphereIds, getAABB) : null;\n\n    const bvhNodeCount = bvh ? bvh.nodeCount : 0;\n    const bvhNodesSize = Math.max(BVH_NODE_BYTES, bvhNodeCount * BVH_NODE_BYTES);\n    const bvhPrimCount = bvh ? bvh.primitiveIndices.length : 0;\n    const bvhPrimSize = Math.max(4, bvhPrimCount * 4);\n\n    const bvhNodesBuffer = device.createBuffer({\n        label: \"rtBVHNodes\",\n        size: bvhNodesSize,\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n    });\n\n    const bvhPrimIndicesBuffer = device.createBuffer({\n        label: \"rtBVHPrimIndices\",\n        size: bvhPrimSize,\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n    });\n\n    const bvhConfigBuffer = device.createBuffer({\n        label: \"rtBVHConfig\",\n        size: BVH_CONFIG_BYTES,\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n    });\n\n    const entityDataBuffer = device.createBuffer({\n        label: \"rtEntityData\",\n        size: Math.max(ENTITY_DATA_BYTES, sparseSize * ENTITY_DATA_BYTES),\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n    });\n\n    const readbackBuffer = device.createBuffer({\n        label: \"rtReadback\",\n        size: paddedPixelCount * 4,\n        usage: GPUBufferUsage.MAP_READ | GPUBufferUsage.COPY_DST,\n    });\n\n    device.queue.writeBuffer(configBuffer, 0, packConfig(config));\n    device.queue.writeBuffer(cameraBuffer, 0, packCamera(scene.camera));\n    device.queue.writeBuffer(countsBuffer, 0, packCounts(scene));\n\n    if (entityCount > 0) {\n        device.queue.writeBuffer(\n            transformsBuffer,\n            0,\n            packTransforms(scene.transforms, sparseSize - 1)\n        );\n        device.queue.writeBuffer(entityIdsBuffer, 0, new Uint32Array(scene.entityIds));\n        device.queue.writeBuffer(\n            shapesBuffer,\n            0,\n            new Uint32Array(scene.shapes.subarray(0, sparseSize))\n        );\n        const entityData = packEntityData(\n            scene.sizes,\n            scene.albedo,\n            scene.roughness,\n            scene.metallic,\n            sparseSize\n        );\n        device.queue.writeBuffer(entityDataBuffer, 0, entityData);\n    }\n\n    device.queue.writeBuffer(lightBuffer, 0, packLights(scene.lights));\n\n    device.queue.writeBuffer(atmosphereBuffer, 0, packAtmosphere(scene.atmosphere));\n\n    if (scene.terrain && scene.heights) {\n        device.queue.writeBuffer(terrainBuffer, 0, packTerrain(scene.terrain));\n        device.queue.writeBuffer(terrainHeightsBuffer, 0, scene.heights);\n    } else {\n        device.queue.writeBuffer(terrainBuffer, 0, new Uint32Array(8));\n        device.queue.writeBuffer(terrainHeightsBuffer, 0, new Float32Array(1));\n    }\n\n    if (bvh && bvh.nodeCount > 0) {\n        device.queue.writeBuffer(bvhNodesBuffer, 0, bvh.nodes);\n        device.queue.writeBuffer(bvhPrimIndicesBuffer, 0, bvh.primitiveIndices);\n    } else {\n        device.queue.writeBuffer(bvhNodesBuffer, 0, new Float32Array(8));\n        device.queue.writeBuffer(bvhPrimIndicesBuffer, 0, new Uint32Array(1));\n    }\n\n    const bvhConfigData = new Uint32Array([bvhNodeCount, useBVH ? 1 : 0, 0, 0]);\n    device.queue.writeBuffer(bvhConfigBuffer, 0, bvhConfigData);\n\n    const bindGroup = device.createBindGroup({\n        layout: bindGroupLayout,\n        entries: [\n            { binding: 0, resource: { buffer: configBuffer } },\n            { binding: 1, resource: { buffer: cameraBuffer } },\n            { binding: 2, resource: { buffer: countsBuffer } },\n            { binding: 3, resource: { buffer: transformsBuffer } },\n            { binding: 4, resource: { buffer: entityIdsBuffer } },\n            { binding: 5, resource: { buffer: shapesBuffer } },\n            { binding: 6, resource: { buffer: outputBuffer } },\n            { binding: 7, resource: { buffer: lightBuffer } },\n            { binding: 8, resource: { buffer: atmosphereBuffer } },\n            { binding: 9, resource: { buffer: terrainBuffer } },\n            { binding: 10, resource: { buffer: terrainHeightsBuffer } },\n            { binding: 11, resource: { buffer: bvhNodesBuffer } },\n            { binding: 12, resource: { buffer: bvhPrimIndicesBuffer } },\n            { binding: 13, resource: { buffer: bvhConfigBuffer } },\n            { binding: 14, resource: { buffer: entityDataBuffer } },\n        ],\n    });\n\n    const encoder = device.createCommandEncoder();\n    const pass = encoder.beginComputePass();\n    pass.setPipeline(pipeline);\n    pass.setBindGroup(0, bindGroup);\n    pass.dispatchWorkgroups(Math.ceil(pixelCount / WorkgroupSize));\n    pass.end();\n\n    encoder.copyBufferToBuffer(outputBuffer, 0, readbackBuffer, 0, paddedPixelCount * 4);\n    device.queue.submit([encoder.finish()]);\n\n    await readbackBuffer.mapAsync(GPUMapMode.READ);\n    const paddedData = new Uint8Array(readbackBuffer.getMappedRange().slice(0));\n    readbackBuffer.unmap();\n\n    const result = new Uint8Array(pixelCount * 4);\n    for (let y = 0; y < height; y++) {\n        const srcOffset = y * paddedWidth * 4;\n        const dstOffset = y * width * 4;\n        result.set(paddedData.subarray(srcOffset, srcOffset + width * 4), dstOffset);\n    }\n\n    configBuffer.destroy();\n    cameraBuffer.destroy();\n    countsBuffer.destroy();\n    transformsBuffer.destroy();\n    entityIdsBuffer.destroy();\n    shapesBuffer.destroy();\n    lightBuffer.destroy();\n    atmosphereBuffer.destroy();\n    terrainBuffer.destroy();\n    terrainHeightsBuffer.destroy();\n    bvhNodesBuffer.destroy();\n    bvhPrimIndicesBuffer.destroy();\n    bvhConfigBuffer.destroy();\n    entityDataBuffer.destroy();\n    outputBuffer.destroy();\n    readbackBuffer.destroy();\n\n    return result;\n}\n\nexport function disposeRTHarness(_ctx: RTHarnessContext): void {}\n","export type ResourceId = number;\nexport type NodeId = number;\n\nexport type ResourceType = \"texture\" | \"buffer\";\nexport type AccessMode = \"read\" | \"write\" | \"readwrite\";\n\nexport interface TextureDesc {\n    type: \"texture\";\n    format: GPUTextureFormat;\n    width: number;\n    height: number;\n    usage: GPUTextureUsageFlags;\n}\n\nexport interface BufferDesc {\n    type: \"buffer\";\n    size: number;\n    usage: GPUBufferUsageFlags;\n}\n\nexport type ResourceDesc = TextureDesc | BufferDesc;\n\nexport interface Resource {\n    id: ResourceId;\n    name: string;\n    desc: ResourceDesc;\n    handle: GPUTexture | GPUBuffer | null;\n    view: GPUTextureView | null;\n}\n\nexport interface ResourceRef {\n    id: ResourceId;\n    access: AccessMode;\n}\n\nexport interface GraphNode {\n    id: NodeId;\n    name: string;\n    enabled: boolean;\n    inputs: ResourceRef[];\n    outputs: ResourceRef[];\n    execute: (ctx: GraphExecutionContext, encoder: GPUCommandEncoder) => void;\n}\n\nexport interface RenderGraph {\n    resources: Map<ResourceId, Resource>;\n    nodes: GraphNode[];\n    sorted: GraphNode[];\n    nextResourceId: number;\n    nextNodeId: number;\n}\n\nexport interface GraphExecutionContext {\n    device: GPUDevice;\n    queue: GPUQueue;\n    canvasWidth: number;\n    canvasHeight: number;\n    canvasFormat: GPUTextureFormat;\n    canvasView: GPUTextureView;\n    getTexture(id: ResourceId): GPUTexture;\n    getTextureView(id: ResourceId): GPUTextureView;\n    getBuffer(id: ResourceId): GPUBuffer;\n}\n\nexport function createEmptyGraph(): RenderGraph {\n    return {\n        resources: new Map(),\n        nodes: [],\n        sorted: [],\n        nextResourceId: 0,\n        nextNodeId: 0,\n    };\n}\n\nexport function declareTexture(\n    graph: RenderGraph,\n    name: string,\n    format: GPUTextureFormat,\n    width: number,\n    height: number,\n    usage?: GPUTextureUsageFlags\n): ResourceId {\n    const id = graph.nextResourceId++;\n    const defaultUsage =\n        GPUTextureUsage.RENDER_ATTACHMENT |\n        GPUTextureUsage.TEXTURE_BINDING |\n        GPUTextureUsage.COPY_SRC |\n        GPUTextureUsage.COPY_DST;\n\n    graph.resources.set(id, {\n        id,\n        name,\n        desc: {\n            type: \"texture\",\n            format,\n            width,\n            height,\n            usage: usage ?? defaultUsage,\n        },\n        handle: null,\n        view: null,\n    });\n\n    return id;\n}\n\nexport function declareBuffer(\n    graph: RenderGraph,\n    name: string,\n    size: number,\n    usage: GPUBufferUsageFlags\n): ResourceId {\n    const id = graph.nextResourceId++;\n\n    graph.resources.set(id, {\n        id,\n        name,\n        desc: {\n            type: \"buffer\",\n            size,\n            usage,\n        },\n        handle: null,\n        view: null,\n    });\n\n    return id;\n}\n\nexport function addNode(graph: RenderGraph, node: Omit<GraphNode, \"id\">): NodeId {\n    const id = graph.nextNodeId++;\n    graph.nodes.push({ ...node, id });\n    return id;\n}\n","import type { RenderGraph, GraphNode, GraphExecutionContext, ResourceId, NodeId } from \"./graph\";\n\nexport function toposort(graph: RenderGraph): GraphNode[] {\n    const nodes = graph.nodes.filter((n) => n.enabled);\n    if (nodes.length === 0) return [];\n\n    const resourceWriters = new Map<ResourceId, NodeId>();\n    for (const node of nodes) {\n        for (const output of node.outputs) {\n            resourceWriters.set(output.id, node.id);\n        }\n    }\n\n    const adjList = new Map<NodeId, NodeId[]>();\n    const inDegree = new Map<NodeId, number>();\n\n    for (const node of nodes) {\n        adjList.set(node.id, []);\n        inDegree.set(node.id, 0);\n    }\n\n    for (const node of nodes) {\n        for (const input of node.inputs) {\n            const writerId = resourceWriters.get(input.id);\n            if (writerId !== undefined && writerId !== node.id) {\n                adjList.get(writerId)!.push(node.id);\n                inDegree.set(node.id, (inDegree.get(node.id) ?? 0) + 1);\n            }\n        }\n    }\n\n    const queue: NodeId[] = [];\n    for (const node of nodes) {\n        if ((inDegree.get(node.id) ?? 0) === 0) {\n            queue.push(node.id);\n        }\n    }\n\n    const sorted: GraphNode[] = [];\n    const nodeMap = new Map(nodes.map((n) => [n.id, n]));\n\n    while (queue.length > 0) {\n        const id = queue.shift()!;\n        sorted.push(nodeMap.get(id)!);\n\n        for (const neighbor of adjList.get(id) ?? []) {\n            const degree = (inDegree.get(neighbor) ?? 1) - 1;\n            inDegree.set(neighbor, degree);\n            if (degree === 0) {\n                queue.push(neighbor);\n            }\n        }\n    }\n\n    if (sorted.length !== nodes.length) {\n        throw new Error(\"Render graph has a cycle\");\n    }\n\n    return sorted;\n}\n\nexport function allocateResources(graph: RenderGraph, device: GPUDevice): void {\n    for (const resource of graph.resources.values()) {\n        if (resource.handle) continue;\n\n        if (resource.desc.type === \"texture\") {\n            const texture = device.createTexture({\n                label: resource.name,\n                size: {\n                    width: resource.desc.width,\n                    height: resource.desc.height,\n                },\n                format: resource.desc.format,\n                usage: resource.desc.usage,\n            });\n            resource.handle = texture;\n            resource.view = texture.createView();\n        } else {\n            resource.handle = device.createBuffer({\n                label: resource.name,\n                size: resource.desc.size,\n                usage: resource.desc.usage,\n            });\n        }\n    }\n}\n\nexport function deallocateResources(graph: RenderGraph): void {\n    for (const resource of graph.resources.values()) {\n        if (resource.handle) {\n            resource.handle.destroy();\n            resource.handle = null;\n            resource.view = null;\n        }\n    }\n}\n\nexport function executeGraph(\n    graph: RenderGraph,\n    device: GPUDevice,\n    queue: GPUQueue,\n    canvasWidth: number,\n    canvasHeight: number,\n    canvasFormat: GPUTextureFormat,\n    canvasView: GPUTextureView\n): void {\n    allocateResources(graph, device);\n\n    const ctx: GraphExecutionContext = {\n        device,\n        queue,\n        canvasWidth,\n        canvasHeight,\n        canvasFormat,\n        canvasView,\n\n        getTexture(id: ResourceId): GPUTexture {\n            const resource = graph.resources.get(id);\n            if (!resource || resource.desc.type !== \"texture\" || !resource.handle) {\n                throw new Error(`Texture resource ${id} not found`);\n            }\n            return resource.handle as GPUTexture;\n        },\n\n        getTextureView(id: ResourceId): GPUTextureView {\n            const resource = graph.resources.get(id);\n            if (!resource || resource.desc.type !== \"texture\" || !resource.view) {\n                throw new Error(`Texture view for resource ${id} not found`);\n            }\n            return resource.view;\n        },\n\n        getBuffer(id: ResourceId): GPUBuffer {\n            const resource = graph.resources.get(id);\n            if (!resource || resource.desc.type !== \"buffer\" || !resource.handle) {\n                throw new Error(`Buffer resource ${id} not found`);\n            }\n            return resource.handle as GPUBuffer;\n        },\n    };\n\n    const encoder = device.createCommandEncoder();\n\n    for (const node of graph.sorted) {\n        node.execute(ctx, encoder);\n    }\n\n    queue.submit([encoder.finish()]);\n}\n","import type { WebGPURenderContext, ShapeBuffers } from \"../context\";\nimport type { CameraData } from \"../camera-data\";\nimport { beginRenderPass } from \"../gpu\";\nimport type { GraphNode, GraphExecutionContext, ResourceId } from \"../graph/graph\";\n\nfunction unpackClearColor(color: number): GPUColor {\n    return {\n        r: ((color >> 16) & 0xff) / 255,\n        g: ((color >> 8) & 0xff) / 255,\n        b: (color & 0xff) / 255,\n        a: 1.0,\n    };\n}\n\nfunction ensureBindGroup(ctx: WebGPURenderContext, buffers: ShapeBuffers): void {\n    if (buffers.bindGroup && !buffers.dirty) return;\n\n    buffers.bindGroup = ctx.gpu.device.createBindGroup({\n        layout: ctx.pipeline.bindGroupLayout,\n        entries: [\n            { binding: 0, resource: { buffer: ctx.uniformBuffer } },\n            { binding: 1, resource: { buffer: ctx.lightBuffer } },\n            { binding: 2, resource: { buffer: ctx.matricesBuffer } },\n            { binding: 3, resource: { buffer: buffers.visibleEntityIdBuffer } },\n            { binding: 4, resource: { buffer: ctx.meshDataBuffer } },\n        ],\n    });\n}\n\nexport interface RasterNodeConfig {\n    renderContext: WebGPURenderContext;\n    cameraData: CameraData;\n    sceneColorId: ResourceId;\n    sceneDepthId: ResourceId;\n}\n\nexport function createRasterNode(config: RasterNodeConfig): GraphNode {\n    const { renderContext: ctx, cameraData, sceneColorId, sceneDepthId } = config;\n\n    return {\n        id: 0,\n        name: \"raster\",\n        enabled: true,\n        inputs: [],\n        outputs: [\n            { id: sceneColorId, access: \"write\" },\n            { id: sceneDepthId, access: \"write\" },\n        ],\n        execute(graphCtx: GraphExecutionContext, encoder: GPUCommandEncoder) {\n            graphCtx.queue.writeBuffer(ctx.uniformBuffer, 0, cameraData.viewProjMatrix.buffer);\n\n            for (const [, buffers] of ctx.shapes) {\n                if (buffers.count === 0) continue;\n                ensureBindGroup(ctx, buffers);\n            }\n\n            const sceneColorView = graphCtx.getTextureView(sceneColorId);\n            const sceneDepthView = graphCtx.getTextureView(sceneDepthId);\n\n            const renderPass = beginRenderPass(encoder, {\n                colorView: sceneColorView,\n                clearColor: unpackClearColor(cameraData.clearColor),\n                depthView: sceneDepthView,\n                clearDepth: 1.0,\n            });\n\n            renderPass.setPipeline(ctx.pipeline.pipeline);\n\n            for (const [shape, buffers] of ctx.shapes) {\n                if (buffers.count === 0) continue;\n\n                const geo = ctx.geometries.get(shape);\n                if (!geo) continue;\n\n                renderPass.setBindGroup(0, buffers.bindGroup!);\n                renderPass.setVertexBuffer(0, geo.vertexBuffer);\n                renderPass.setIndexBuffer(geo.indexBuffer, \"uint16\");\n                renderPass.drawIndexedIndirect(buffers.indirectBuffer, 0);\n            }\n\n            renderPass.end();\n        },\n    };\n}\n","import type { GraphNode, GraphExecutionContext, ResourceId } from \"../graph/graph\";\nimport type { Scene, Config } from \"../raytracing/model\";\nimport {\n    packTerrain,\n    packLights,\n    packEntityData,\n    packTransforms,\n    packAtmosphere,\n    packCamera,\n    packConfig,\n    packCounts,\n    TERRAIN_BYTES,\n    LIGHT_ARRAY_BYTES,\n    ENTITY_DATA_BYTES,\n    ATMOSPHERE_BYTES,\n    CAMERA_BYTES,\n    CONFIG_BYTES,\n    COUNTS_BYTES,\n    BVH_CONFIG_BYTES,\n} from \"../raytracing/model\";\nimport {\n    buildBVH,\n    BVH_NODE_BYTES,\n    hashEntities,\n    type AABB,\n    type AABBLookup,\n} from \"../raytracing/bvh\";\nimport type { RTHarnessContext } from \"../raytracing/harness\";\nimport { RAYCAST_SHADER } from \"../raytracing/shaders\";\n\nconst WorkgroupSizeX = 8;\nconst WorkgroupSizeY = 8;\nconst ShapeSphere = 1;\n\nfunction createSphereAABBLookup(scene: Scene): AABBLookup {\n    return (eid: number): AABB => {\n        const o = eid * 16;\n        const cx = scene.transforms.data[o + 12];\n        const cy = scene.transforms.data[o + 13];\n        const cz = scene.transforms.data[o + 14];\n        const radius = scene.sizes.x[eid] * 0.5;\n        return {\n            minX: cx - radius,\n            minY: cy - radius,\n            minZ: cz - radius,\n            maxX: cx + radius,\n            maxY: cy + radius,\n            maxZ: cz + radius,\n        };\n    };\n}\n\nexport interface RaycastNodeConfig {\n    harness: RTHarnessContext;\n    scene: Scene;\n    config: Config;\n    outputId: ResourceId;\n}\n\nexport interface RaycastBuffers {\n    config: GPUBuffer;\n    camera: GPUBuffer;\n    counts: GPUBuffer;\n    transforms: GPUBuffer;\n    entityIds: GPUBuffer;\n    shapes: GPUBuffer;\n    lights: GPUBuffer;\n    atmosphere: GPUBuffer;\n    terrain: GPUBuffer;\n    terrainHeights: GPUBuffer;\n    bvhNodes: GPUBuffer;\n    bvhPrimIndices: GPUBuffer;\n    bvhConfig: GPUBuffer;\n    entityData: GPUBuffer;\n    width: number;\n    height: number;\n    maxEntityId: number;\n}\n\nfunction findMaxEntityId(entityIds: number[]): number {\n    let max = 0;\n    for (const eid of entityIds) {\n        if (eid > max) max = eid;\n    }\n    return max;\n}\n\nfunction createBuffers(\n    device: GPUDevice,\n    width: number,\n    height: number,\n    scene: Scene\n): RaycastBuffers {\n    const entityCount = Math.max(1, scene.entityIds.length);\n    const maxEid = findMaxEntityId(scene.entityIds);\n    const sparseSize = Math.max(1, maxEid + 1);\n\n    return {\n        config: device.createBuffer({\n            label: \"rtConfig\",\n            size: CONFIG_BYTES,\n            usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n        }),\n        camera: device.createBuffer({\n            label: \"rtCamera\",\n            size: CAMERA_BYTES,\n            usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n        }),\n        counts: device.createBuffer({\n            label: \"rtCounts\",\n            size: COUNTS_BYTES,\n            usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n        }),\n        transforms: device.createBuffer({\n            label: \"rtTransforms\",\n            size: Math.max(64, sparseSize * 64),\n            usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        }),\n        entityIds: device.createBuffer({\n            label: \"rtEntityIds\",\n            size: Math.max(4, entityCount * 4),\n            usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        }),\n        shapes: device.createBuffer({\n            label: \"rtShapes\",\n            size: Math.max(4, sparseSize * 4),\n            usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        }),\n        lights: device.createBuffer({\n            label: \"rtLights\",\n            size: LIGHT_ARRAY_BYTES,\n            usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n        }),\n        atmosphere: device.createBuffer({\n            label: \"rtAtmosphere\",\n            size: ATMOSPHERE_BYTES,\n            usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n        }),\n        terrain: device.createBuffer({\n            label: \"rtTerrain\",\n            size: TERRAIN_BYTES,\n            usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n        }),\n        terrainHeights: device.createBuffer({\n            label: \"rtTerrainHeights\",\n            size: scene.terrain && scene.heights ? scene.heights.length * 4 : 4,\n            usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        }),\n        bvhNodes: device.createBuffer({\n            label: \"rtBVHNodes\",\n            size: Math.max(BVH_NODE_BYTES, entityCount * 2 * BVH_NODE_BYTES),\n            usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        }),\n        bvhPrimIndices: device.createBuffer({\n            label: \"rtBVHPrimIndices\",\n            size: Math.max(4, entityCount * 4),\n            usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        }),\n        bvhConfig: device.createBuffer({\n            label: \"rtBVHConfig\",\n            size: BVH_CONFIG_BYTES,\n            usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n        }),\n        entityData: device.createBuffer({\n            label: \"rtEntityData\",\n            size: Math.max(ENTITY_DATA_BYTES, sparseSize * ENTITY_DATA_BYTES),\n            usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        }),\n        width,\n        height,\n        maxEntityId: maxEid,\n    };\n}\n\nfunction uploadSceneData(\n    device: GPUDevice,\n    queue: GPUQueue,\n    harness: RTHarnessContext,\n    scene: Scene,\n    config: Config\n): void {\n    const buffers = harness.buffers as RaycastBuffers;\n    const entityCount = scene.entityIds.length;\n    const maxEid = findMaxEntityId(scene.entityIds);\n    const sparseSize = maxEid + 1;\n\n    queue.writeBuffer(buffers.config, 0, packConfig(config));\n    queue.writeBuffer(buffers.camera, 0, packCamera(scene.camera));\n    queue.writeBuffer(buffers.counts, 0, packCounts(scene));\n\n    if (entityCount > 0) {\n        queue.writeBuffer(buffers.transforms, 0, packTransforms(scene.transforms, maxEid));\n        queue.writeBuffer(buffers.entityIds, 0, new Uint32Array(scene.entityIds));\n        queue.writeBuffer(buffers.shapes, 0, new Uint32Array(scene.shapes.subarray(0, sparseSize)));\n        const entityData = packEntityData(\n            scene.sizes,\n            scene.albedo,\n            scene.roughness,\n            scene.metallic,\n            sparseSize\n        );\n        queue.writeBuffer(buffers.entityData, 0, entityData);\n    }\n\n    queue.writeBuffer(buffers.lights, 0, packLights(scene.lights));\n\n    queue.writeBuffer(buffers.atmosphere, 0, packAtmosphere(scene.atmosphere));\n\n    if (scene.terrain && scene.heights) {\n        queue.writeBuffer(buffers.terrain, 0, packTerrain(scene.terrain));\n        queue.writeBuffer(buffers.terrainHeights, 0, scene.heights);\n    } else {\n        queue.writeBuffer(buffers.terrain, 0, new Uint32Array(8));\n        queue.writeBuffer(buffers.terrainHeights, 0, new Float32Array(1));\n    }\n\n    const sphereIds = scene.entityIds.filter((eid) => scene.shapes[eid] === ShapeSphere);\n    const useBVH = config.useBVH !== false && sphereIds.length > 0;\n    const getAABB = createSphereAABBLookup(scene);\n    let bvh = harness.bvhCache?.bvh ?? null;\n    let cacheHit = false;\n\n    if (useBVH) {\n        const currentHash = hashEntities(sphereIds, getAABB);\n        if (harness.bvhCache && harness.bvhCache.hash === currentHash) {\n            cacheHit = true;\n            bvh = harness.bvhCache.bvh;\n        } else {\n            bvh = buildBVH(sphereIds, getAABB);\n            harness.bvhCache = { hash: currentHash, bvh };\n            if (bvh.nodeCount > 0) {\n                queue.writeBuffer(buffers.bvhNodes, 0, bvh.nodes);\n                queue.writeBuffer(buffers.bvhPrimIndices, 0, bvh.primitiveIndices);\n            }\n        }\n    }\n\n    if (!cacheHit && (!bvh || bvh.nodeCount === 0)) {\n        queue.writeBuffer(buffers.bvhNodes, 0, new Float32Array(8));\n        queue.writeBuffer(buffers.bvhPrimIndices, 0, new Uint32Array(1));\n    }\n\n    const bvhConfigData = new Uint32Array([bvh ? bvh.nodeCount : 0, useBVH ? 1 : 0, 0, 0]);\n    queue.writeBuffer(buffers.bvhConfig, 0, bvhConfigData);\n}\n\nexport function destroyBuffers(buffers: RaycastBuffers): void {\n    buffers.config.destroy();\n    buffers.camera.destroy();\n    buffers.counts.destroy();\n    buffers.transforms.destroy();\n    buffers.entityIds.destroy();\n    buffers.shapes.destroy();\n    buffers.lights.destroy();\n    buffers.atmosphere.destroy();\n    buffers.terrain.destroy();\n    buffers.terrainHeights.destroy();\n    buffers.bvhNodes.destroy();\n    buffers.bvhPrimIndices.destroy();\n    buffers.bvhConfig.destroy();\n    buffers.entityData.destroy();\n}\n\nfunction needsBufferResize(buffers: RaycastBuffers, config: Config, scene: Scene): boolean {\n    if (buffers.width !== config.width || buffers.height !== config.height) {\n        return true;\n    }\n    const maxEid = findMaxEntityId(scene.entityIds);\n    if (maxEid > buffers.maxEntityId) {\n        return true;\n    }\n    return false;\n}\n\ninterface RaycastHarnessContext extends RTHarnessContext {\n    raycastPipeline?: GPUComputePipeline;\n    raycastBindGroupLayout?: GPUBindGroupLayout;\n}\n\nexport function createRaycastNode(nodeConfig: RaycastNodeConfig): GraphNode {\n    const { harness, scene, config, outputId } = nodeConfig;\n    const ctx = harness as RaycastHarnessContext;\n    let bindGroup: GPUBindGroup | null = null;\n    let lastTextureView: GPUTextureView | null = null;\n\n    return {\n        id: 0,\n        name: \"raycast\",\n        enabled: true,\n        inputs: [],\n        outputs: [{ id: outputId, access: \"write\" }],\n        execute(gctx: GraphExecutionContext, encoder: GPUCommandEncoder) {\n            const { width, height } = config;\n\n            if (!ctx.raycastPipeline) {\n                const bindGroupLayout = gctx.device.createBindGroupLayout({\n                    label: \"raycastBindGroupLayout\",\n                    entries: [\n                        {\n                            binding: 0,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"uniform\" },\n                        },\n                        {\n                            binding: 1,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"uniform\" },\n                        },\n                        {\n                            binding: 2,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"uniform\" },\n                        },\n                        {\n                            binding: 3,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"read-only-storage\" },\n                        },\n                        {\n                            binding: 4,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"read-only-storage\" },\n                        },\n                        {\n                            binding: 5,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"read-only-storage\" },\n                        },\n                        {\n                            binding: 6,\n                            visibility: GPUShaderStage.COMPUTE,\n                            storageTexture: { access: \"write-only\", format: \"rgba16float\" },\n                        },\n                        {\n                            binding: 7,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"uniform\" },\n                        },\n                        {\n                            binding: 8,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"uniform\" },\n                        },\n                        {\n                            binding: 9,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"uniform\" },\n                        },\n                        {\n                            binding: 10,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"read-only-storage\" },\n                        },\n                        {\n                            binding: 11,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"read-only-storage\" },\n                        },\n                        {\n                            binding: 12,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"read-only-storage\" },\n                        },\n                        {\n                            binding: 13,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"uniform\" },\n                        },\n                        {\n                            binding: 14,\n                            visibility: GPUShaderStage.COMPUTE,\n                            buffer: { type: \"read-only-storage\" },\n                        },\n                    ],\n                });\n\n                const pipelineLayout = gctx.device.createPipelineLayout({\n                    label: \"raycastPipelineLayout\",\n                    bindGroupLayouts: [bindGroupLayout],\n                });\n\n                const shaderModule = gctx.device.createShaderModule({\n                    label: \"raycastShader\",\n                    code: RAYCAST_SHADER,\n                });\n\n                const pipeline = gctx.device.createComputePipeline({\n                    label: \"raycastPipeline\",\n                    layout: pipelineLayout,\n                    compute: {\n                        module: shaderModule,\n                        entryPoint: \"main\",\n                    },\n                });\n\n                ctx.raycastPipeline = pipeline;\n                ctx.raycastBindGroupLayout = bindGroupLayout;\n            }\n\n            const pipeline = ctx.raycastPipeline;\n            const bindGroupLayout = ctx.raycastBindGroupLayout!;\n\n            let buffers = harness.buffers as RaycastBuffers | null;\n\n            if (!buffers || needsBufferResize(buffers, config, scene)) {\n                if (buffers) destroyBuffers(buffers);\n                buffers = createBuffers(gctx.device, width, height, scene);\n                harness.buffers = buffers;\n                harness.bvhCache = null;\n                bindGroup = null;\n            }\n\n            uploadSceneData(gctx.device, gctx.queue, harness, scene, config);\n\n            const outputTexture = gctx.getTexture(outputId);\n            const textureView = outputTexture.createView();\n\n            if (!bindGroup || lastTextureView !== textureView) {\n                bindGroup = gctx.device.createBindGroup({\n                    layout: bindGroupLayout,\n                    entries: [\n                        { binding: 0, resource: { buffer: buffers.config } },\n                        { binding: 1, resource: { buffer: buffers.camera } },\n                        { binding: 2, resource: { buffer: buffers.counts } },\n                        { binding: 3, resource: { buffer: buffers.transforms } },\n                        { binding: 4, resource: { buffer: buffers.entityIds } },\n                        { binding: 5, resource: { buffer: buffers.shapes } },\n                        { binding: 6, resource: textureView },\n                        { binding: 7, resource: { buffer: buffers.lights } },\n                        { binding: 8, resource: { buffer: buffers.atmosphere } },\n                        { binding: 9, resource: { buffer: buffers.terrain } },\n                        { binding: 10, resource: { buffer: buffers.terrainHeights } },\n                        { binding: 11, resource: { buffer: buffers.bvhNodes } },\n                        { binding: 12, resource: { buffer: buffers.bvhPrimIndices } },\n                        { binding: 13, resource: { buffer: buffers.bvhConfig } },\n                        { binding: 14, resource: { buffer: buffers.entityData } },\n                    ],\n                });\n                lastTextureView = textureView;\n            }\n\n            const pass = encoder.beginComputePass();\n            pass.setPipeline(pipeline);\n            pass.setBindGroup(0, bindGroup);\n            pass.dispatchWorkgroups(\n                Math.ceil(width / WorkgroupSizeX),\n                Math.ceil(height / WorkgroupSizeY)\n            );\n            pass.end();\n        },\n    };\n}\n","import { resource } from \"../../core\";\n\nexport const MAX_LINES = 10000;\nexport const LINE_INSTANCE_FLOATS = 16;\nexport const LINE_INSTANCE_BYTES = LINE_INSTANCE_FLOATS * 4;\n\nexport const MAX_ARROWS = 10000;\nexport const ARROW_INSTANCE_FLOATS = 20;\nexport const ARROW_INSTANCE_BYTES = ARROW_INSTANCE_FLOATS * 4;\n\nexport interface LineRenderContext {\n    lineBuffer: GPUBuffer;\n    lineStaging: Float32Array;\n    lineCount: number;\n    linePipeline: GPURenderPipeline;\n    lineBindGroupLayout: GPUBindGroupLayout;\n    lineBindGroup: GPUBindGroup | null;\n    lineUniformBuffer: GPUBuffer;\n    arrowBuffer: GPUBuffer;\n    arrowStaging: Float32Array;\n    arrowCount: number;\n    arrowPipeline: GPURenderPipeline;\n    arrowBindGroup: GPUBindGroup | null;\n}\n\nexport const Lines = resource<LineRenderContext>(\"lines\");\n\nexport function initLineBuffers(device: GPUDevice): {\n    lineBuffer: GPUBuffer;\n    lineStaging: Float32Array;\n    lineUniformBuffer: GPUBuffer;\n    arrowBuffer: GPUBuffer;\n    arrowStaging: Float32Array;\n} {\n    const lineBuffer = device.createBuffer({\n        size: MAX_LINES * LINE_INSTANCE_BYTES,\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        label: \"lineStorage\",\n    });\n\n    const lineUniformBuffer = device.createBuffer({\n        size: 96, // viewProjection (64) + screenSize (8) + padding (8) + cameraPos (12) + padding (4)\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n        label: \"lineUniforms\",\n    });\n\n    const arrowBuffer = device.createBuffer({\n        size: MAX_ARROWS * ARROW_INSTANCE_BYTES,\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        label: \"arrowStorage\",\n    });\n\n    return {\n        lineBuffer,\n        lineStaging: new Float32Array(MAX_LINES * LINE_INSTANCE_FLOATS),\n        lineUniformBuffer,\n        arrowBuffer,\n        arrowStaging: new Float32Array(MAX_ARROWS * ARROW_INSTANCE_FLOATS),\n    };\n}\n","import type { State } from \"../../core\";\nimport type { WebGPURenderContext } from \"../../standard/render/context\";\nimport { Lines } from \"./context\";\n\nconst lineUniforms = new Float32Array(24);\n\nexport function drawLines(\n    state: State,\n    ctx: WebGPURenderContext,\n    renderPass: GPURenderPassEncoder,\n    viewProjMatrix: Float32Array,\n    cameraPos: Float32Array\n): void {\n    const lines = Lines.from(state);\n    if (!lines) return;\n    if (lines.lineCount === 0 && lines.arrowCount === 0) return;\n\n    lineUniforms.set(viewProjMatrix, 0); // 0-15: viewProjection\n    lineUniforms[16] = ctx.gpu.canvas.width; // 16: screenSize.x\n    lineUniforms[17] = ctx.gpu.canvas.height; // 17: screenSize.y\n    lineUniforms[18] = 0; // 18: padding\n    lineUniforms[19] = 0; // 19: padding\n    lineUniforms[20] = cameraPos[0]; // 20: cameraPos.x\n    lineUniforms[21] = cameraPos[1]; // 21: cameraPos.y\n    lineUniforms[22] = cameraPos[2]; // 22: cameraPos.z\n    lineUniforms[23] = 0; // 23: padding\n\n    ctx.gpu.device.queue.writeBuffer(lines.lineUniformBuffer, 0, lineUniforms);\n\n    if (lines.lineCount > 0) {\n        if (!lines.lineBindGroup) {\n            lines.lineBindGroup = ctx.gpu.device.createBindGroup({\n                layout: lines.lineBindGroupLayout,\n                entries: [\n                    { binding: 0, resource: { buffer: lines.lineUniformBuffer } },\n                    { binding: 1, resource: { buffer: lines.lineBuffer } },\n                ],\n            });\n        }\n\n        renderPass.setPipeline(lines.linePipeline);\n        renderPass.setBindGroup(0, lines.lineBindGroup);\n        renderPass.draw(lines.lineCount * 6);\n    }\n\n    if (lines.arrowCount > 0) {\n        if (!lines.arrowBindGroup) {\n            lines.arrowBindGroup = ctx.gpu.device.createBindGroup({\n                layout: lines.lineBindGroupLayout,\n                entries: [\n                    { binding: 0, resource: { buffer: lines.lineUniformBuffer } },\n                    { binding: 1, resource: { buffer: lines.arrowBuffer } },\n                ],\n            });\n        }\n\n        renderPass.setPipeline(lines.arrowPipeline);\n        renderPass.setBindGroup(0, lines.arrowBindGroup);\n        renderPass.draw(lines.arrowCount * 3);\n    }\n}\n","import { resource } from \"../../core\";\nimport type { GlyphAtlas } from \"./atlas\";\n\nexport const MAX_GLYPHS = 50000;\nexport const GLYPH_INSTANCE_FLOATS = 16;\nexport const GLYPH_INSTANCE_BYTES = GLYPH_INSTANCE_FLOATS * 4;\n\nexport interface TextRenderContext {\n    glyphBuffer: GPUBuffer;\n    glyphStaging: Float32Array;\n    glyphCount: number;\n    textPipeline: GPURenderPipeline;\n    textBindGroupLayout: GPUBindGroupLayout;\n    textBindGroup: GPUBindGroup | null;\n    textUniformBuffer: GPUBuffer;\n    atlas: GlyphAtlas;\n    atlasSampler: GPUSampler;\n    textContent: Map<number, string>;\n    nextTextId: number;\n}\n\nexport const Text = resource<TextRenderContext>(\"text\");\n\nexport function initTextBuffers(device: GPUDevice): {\n    glyphBuffer: GPUBuffer;\n    glyphStaging: Float32Array;\n    textUniformBuffer: GPUBuffer;\n} {\n    const glyphBuffer = device.createBuffer({\n        size: MAX_GLYPHS * GLYPH_INSTANCE_BYTES,\n        usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST,\n        label: \"glyphStorage\",\n    });\n\n    const textUniformBuffer = device.createBuffer({\n        size: 80, // viewProjection (64) + sdfParams (8) + padding (8)\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n        label: \"textUniforms\",\n    });\n\n    return {\n        glyphBuffer,\n        glyphStaging: new Float32Array(MAX_GLYPHS * GLYPH_INSTANCE_FLOATS),\n        textUniformBuffer,\n    };\n}\n","import type { State } from \"../../core\";\nimport type { WebGPURenderContext } from \"../../standard/render/context\";\nimport { Text } from \"./context\";\n\nconst textUniforms = new Float32Array(20);\n\nexport function drawText(\n    state: State,\n    ctx: WebGPURenderContext,\n    renderPass: GPURenderPassEncoder,\n    viewProjMatrix: Float32Array\n): void {\n    const text = Text.from(state);\n    if (!text) return;\n    if (text.glyphCount === 0) return;\n\n    textUniforms.set(viewProjMatrix, 0);\n    textUniforms[16] = 0.1;\n    textUniforms[17] = 0;\n    textUniforms[18] = 0;\n    textUniforms[19] = 0;\n\n    ctx.gpu.device.queue.writeBuffer(text.textUniformBuffer, 0, textUniforms);\n\n    if (!text.textBindGroup) {\n        text.textBindGroup = ctx.gpu.device.createBindGroup({\n            layout: text.textBindGroupLayout,\n            entries: [\n                { binding: 0, resource: { buffer: text.textUniformBuffer } },\n                { binding: 1, resource: { buffer: text.glyphBuffer } },\n                { binding: 2, resource: text.atlas.textureView },\n                { binding: 3, resource: text.atlasSampler },\n            ],\n        });\n    }\n\n    renderPass.setPipeline(text.textPipeline);\n    renderPass.setBindGroup(0, text.textBindGroup);\n    renderPass.draw(text.glyphCount * 6);\n}\n","import type { State } from \"../../../core\";\nimport type { WebGPURenderContext } from \"../context\";\nimport type { CameraData } from \"../camera-data\";\nimport type { GraphNode, GraphExecutionContext, ResourceId } from \"../graph/graph\";\nimport { drawLines } from \"../../../extras/lines/draw\";\nimport { drawText } from \"../../../extras/text/draw\";\nimport { Lines } from \"../../../extras/lines/context\";\nimport { Text } from \"../../../extras/text/context\";\n\nexport interface OverlayNodeConfig {\n    state: State;\n    renderContext: WebGPURenderContext;\n    cameraData: CameraData;\n    inputColorId: ResourceId;\n    outputColorId: ResourceId;\n}\n\nexport function createOverlayNode(config: OverlayNodeConfig): GraphNode {\n    const { state, renderContext: ctx, cameraData, inputColorId, outputColorId } = config;\n\n    return {\n        id: 0,\n        name: \"overlay\",\n        enabled: true,\n        inputs: [{ id: inputColorId, access: \"read\" }],\n        outputs: [{ id: outputColorId, access: \"write\" }],\n        execute(graphCtx: GraphExecutionContext, encoder: GPUCommandEncoder) {\n            const colorView = graphCtx.getTextureView(outputColorId);\n\n            const renderPass = encoder.beginRenderPass({\n                colorAttachments: [\n                    {\n                        view: colorView,\n                        loadOp: \"load\",\n                        storeOp: \"store\",\n                    },\n                ],\n            });\n\n            const lines = Lines.from(state);\n            if (lines) {\n                drawLines(\n                    state,\n                    ctx,\n                    renderPass,\n                    cameraData.viewProjMatrix,\n                    cameraData.cameraPosition\n                );\n            }\n\n            const text = Text.from(state);\n            if (text && text.glyphCount > 0) {\n                drawText(state, ctx, renderPass, cameraData.viewProjMatrix);\n            }\n\n            renderPass.end();\n        },\n    };\n}\n","import type { GraphNode, GraphExecutionContext, ResourceId } from \"../graph/graph\";\nimport type { PostProcessPipeline, EffectConfig } from \"../postprocess\";\nimport type { GPUContext } from \"../gpu\";\n\nexport interface PostProcessNodeConfig {\n    gpu: GPUContext;\n    pipeline: PostProcessPipeline;\n    config: EffectConfig;\n    inputId: ResourceId;\n    outputId: ResourceId;\n}\n\nconst FLAG_TONEMAP = 1;\nconst FLAG_FXAA = 2;\nconst FLAG_VIGNETTE = 4;\n\nexport function createPostProcessNode(nodeConfig: PostProcessNodeConfig): GraphNode {\n    const { gpu, pipeline: pp, config, inputId, outputId } = nodeConfig;\n\n    return {\n        id: 0,\n        name: \"postprocess\",\n        enabled: true,\n        inputs: [{ id: inputId, access: \"read\" }],\n        outputs: [{ id: outputId, access: \"write\" }],\n        execute(ctx: GraphExecutionContext, encoder: GPUCommandEncoder) {\n            const hasEffects = config.tonemap || config.fxaa || config.vignette;\n\n            let flags = 0;\n            if (config.tonemap) flags |= FLAG_TONEMAP;\n            if (config.fxaa) flags |= FLAG_FXAA;\n            if (config.vignette) flags |= FLAG_VIGNETTE;\n\n            const data = new ArrayBuffer(32);\n            const floats = new Float32Array(data);\n            const uints = new Uint32Array(data);\n\n            floats[0] = config.exposure;\n            floats[1] = config.vignetteStrength;\n            floats[2] = config.vignetteInner;\n            floats[3] = config.vignetteOuter;\n            floats[4] = 1.0 / ctx.canvasWidth;\n            floats[5] = 1.0 / ctx.canvasHeight;\n            uints[6] = flags;\n            uints[7] = 0;\n\n            ctx.queue.writeBuffer(pp.uniforms, 0, data);\n\n            const inputView = ctx.getTextureView(inputId);\n            const outputView = ctx.getTextureView(outputId);\n\n            if (hasEffects) {\n                const bindGroup = ctx.device.createBindGroup({\n                    layout: pp.layout,\n                    entries: [\n                        { binding: 0, resource: inputView },\n                        { binding: 1, resource: pp.sampler },\n                        { binding: 2, resource: { buffer: pp.uniforms } },\n                    ],\n                });\n\n                const pass = encoder.beginRenderPass({\n                    colorAttachments: [\n                        {\n                            view: outputView,\n                            loadOp: \"clear\",\n                            storeOp: \"store\",\n                            clearValue: { r: 0, g: 0, b: 0, a: 1 },\n                        },\n                    ],\n                });\n\n                pass.setPipeline(pp.pipeline);\n                pass.setBindGroup(0, bindGroup);\n                pass.draw(3);\n                pass.end();\n            } else {\n                const bindGroup = ctx.device.createBindGroup({\n                    layout: pp.blitLayout,\n                    entries: [\n                        { binding: 0, resource: inputView },\n                        { binding: 1, resource: pp.sampler },\n                    ],\n                });\n\n                const pass = encoder.beginRenderPass({\n                    colorAttachments: [\n                        {\n                            view: outputView,\n                            loadOp: \"clear\",\n                            storeOp: \"store\",\n                            clearValue: { r: 0, g: 0, b: 0, a: 1 },\n                        },\n                    ],\n                });\n\n                pass.setPipeline(pp.blitPipeline);\n                pass.setBindGroup(0, bindGroup);\n                pass.draw(3);\n                pass.end();\n            }\n        },\n    };\n}\n","import type { GraphNode, GraphExecutionContext, ResourceId } from \"../graph/graph\";\nimport type { PostProcessPipeline } from \"../postprocess\";\n\nexport interface BlitNodeConfig {\n    pipeline: PostProcessPipeline;\n    inputId: ResourceId;\n}\n\nexport function createBlitNode(config: BlitNodeConfig): GraphNode {\n    const { pipeline: pp, inputId } = config;\n\n    return {\n        id: 0,\n        name: \"blit\",\n        enabled: true,\n        inputs: [{ id: inputId, access: \"read\" }],\n        outputs: [],\n        execute(ctx: GraphExecutionContext, encoder: GPUCommandEncoder) {\n            const inputView = ctx.getTextureView(inputId);\n\n            const bindGroup = ctx.device.createBindGroup({\n                layout: pp.blitLayout,\n                entries: [\n                    { binding: 0, resource: inputView },\n                    { binding: 1, resource: pp.sampler },\n                ],\n            });\n\n            const pass = encoder.beginRenderPass({\n                colorAttachments: [\n                    {\n                        view: ctx.canvasView,\n                        loadOp: \"clear\",\n                        storeOp: \"store\",\n                        clearValue: { r: 0, g: 0, b: 0, a: 1 },\n                    },\n                ],\n            });\n\n            pass.setPipeline(pp.blitPipeline);\n            pass.setBindGroup(0, bindGroup);\n            pass.draw(3);\n            pass.end();\n        },\n    };\n}\n","import { mat4 } from \"wgpu-matrix\";\nimport { WorldTransform } from \"../transforms\";\nimport { Camera } from \"./camera\";\n\nexport interface CameraData {\n    viewMatrix: Float32Array;\n    projMatrix: Float32Array;\n    viewProjMatrix: Float32Array;\n    cameraPosition: Float32Array;\n    canvasWidth: number;\n    canvasHeight: number;\n    clearColor: number;\n}\n\nconst tempViewMatrix = mat4.create();\nconst tempProjMatrix = mat4.create();\nconst tempViewProjMatrix = mat4.create();\n\nfunction buildViewMatrix(cameraEid: number, out: Float32Array): void {\n    const d = WorldTransform.data;\n    const o = cameraEid * 16;\n    const r00 = d[o],\n        r01 = d[o + 1],\n        r02 = d[o + 2];\n    const r10 = d[o + 4],\n        r11 = d[o + 5],\n        r12 = d[o + 6];\n    const r20 = d[o + 8],\n        r21 = d[o + 9],\n        r22 = d[o + 10];\n    const tx = d[o + 12],\n        ty = d[o + 13],\n        tz = d[o + 14];\n\n    out[0] = r00;\n    out[1] = r10;\n    out[2] = r20;\n    out[3] = 0;\n    out[4] = r01;\n    out[5] = r11;\n    out[6] = r21;\n    out[7] = 0;\n    out[8] = r02;\n    out[9] = r12;\n    out[10] = r22;\n    out[11] = 0;\n    out[12] = -(r00 * tx + r01 * ty + r02 * tz);\n    out[13] = -(r10 * tx + r11 * ty + r12 * tz);\n    out[14] = -(r20 * tx + r21 * ty + r22 * tz);\n    out[15] = 1;\n}\n\nexport function extractCameraData(\n    cameraEid: number,\n    canvasWidth: number,\n    canvasHeight: number\n): CameraData {\n    const aspect = canvasWidth / canvasHeight;\n    const fov = (Camera.fov[cameraEid] * Math.PI) / 180;\n\n    buildViewMatrix(cameraEid, tempViewMatrix);\n    mat4.perspective(fov, aspect, Camera.near[cameraEid], Camera.far[cameraEid], tempProjMatrix);\n    mat4.multiply(tempProjMatrix, tempViewMatrix, tempViewProjMatrix);\n\n    const o = cameraEid * 16;\n    const cameraPosition = new Float32Array([\n        WorldTransform.data[o + 12],\n        WorldTransform.data[o + 13],\n        WorldTransform.data[o + 14],\n    ]);\n\n    return {\n        viewMatrix: new Float32Array(tempViewMatrix),\n        projMatrix: new Float32Array(tempProjMatrix),\n        viewProjMatrix: new Float32Array(tempViewProjMatrix),\n        cameraPosition,\n        canvasWidth,\n        canvasHeight,\n        clearColor: Camera.clearColor[cameraEid],\n    };\n}\n","import type { State } from \"../../../core\";\nimport { Camera } from \"../camera\";\nimport { WorldTransform } from \"../../transforms\";\nimport { Tonemap, FXAA, Vignette, type EffectConfig } from \"../postprocess\";\nimport type { WebGPURenderContext } from \"../context\";\nimport type { RTHarnessContext } from \"../raytracing/harness\";\nimport type { Scene, Config } from \"../raytracing/model\";\nimport { type RenderGraph, createEmptyGraph, declareTexture, addNode } from \"./graph\";\nimport { toposort } from \"./executor\";\nimport { createRasterNode } from \"../nodes/raster\";\nimport { createRaycastNode } from \"../nodes/raycast\";\nimport { createOverlayNode } from \"../nodes/overlay\";\nimport { createPostProcessNode } from \"../nodes/postprocess\";\nimport { createBlitNode } from \"../nodes/blit\";\nimport { extractCameraData, type CameraData } from \"../camera-data\";\nimport { Lines } from \"../../../extras/lines/context\";\nimport { Text } from \"../../../extras/text/context\";\n\nexport const RenderMode = {\n    Raster: 0,\n    Raytracing: 1,\n} as const;\n\nexport type RenderModeType = (typeof RenderMode)[keyof typeof RenderMode];\n\nexport interface GraphBuilderInput {\n    width: number;\n    height: number;\n    renderMode: RenderModeType;\n    effects: EffectConfig;\n    cameraData: CameraData;\n    renderContext: WebGPURenderContext;\n    raytracing?: { harness: RTHarnessContext; scene: Scene; config: Config };\n}\n\nexport interface GraphBuilderConfig {\n    state: State;\n    renderContext: WebGPURenderContext;\n    rtHarness?: RTHarnessContext;\n    rtScene?: Scene;\n    rtConfig?: Config;\n    renderMode?: RenderModeType;\n}\n\nfunction findActiveCamera(state: State): number | null {\n    for (const eid of state.query([Camera, WorldTransform])) {\n        if (Camera.active[eid] === 1) {\n            return eid;\n        }\n    }\n    return null;\n}\n\nexport function collectEffectConfig(state: State, cameraEid: number): EffectConfig {\n    const hasTonemap = state.hasComponent(cameraEid, Tonemap);\n    const hasFxaa = state.hasComponent(cameraEid, FXAA);\n    const hasVignette = state.hasComponent(cameraEid, Vignette);\n\n    return {\n        tonemap: hasTonemap,\n        exposure: hasTonemap ? Tonemap.exposure[cameraEid] : 1.0,\n        fxaa: hasFxaa,\n        vignette: hasVignette,\n        vignetteStrength: hasVignette ? Vignette.strength[cameraEid] : 0.5,\n        vignetteInner: hasVignette ? Vignette.inner[cameraEid] : 0.4,\n        vignetteOuter: hasVignette ? Vignette.outer[cameraEid] : 0.8,\n    };\n}\n\nexport function collectGraphBuilderInput(config: GraphBuilderConfig): GraphBuilderInput | null {\n    const { state, renderContext: ctx, renderMode = RenderMode.Raster } = config;\n\n    const cameraEid = findActiveCamera(state);\n    if (cameraEid === null) return null;\n\n    const width = ctx.gpu.canvas.width;\n    const height = ctx.gpu.canvas.height;\n    const effects = collectEffectConfig(state, cameraEid);\n    const cameraData = extractCameraData(cameraEid, width, height);\n\n    const input: GraphBuilderInput = {\n        width,\n        height,\n        renderMode,\n        effects,\n        cameraData,\n        renderContext: ctx,\n    };\n\n    if (renderMode === RenderMode.Raytracing) {\n        if (!config.rtHarness || !config.rtScene || !config.rtConfig) {\n            return null;\n        }\n        input.raytracing = {\n            harness: config.rtHarness,\n            scene: config.rtScene,\n            config: config.rtConfig,\n        };\n    }\n\n    return input;\n}\n\nexport function buildGraph(input: GraphBuilderInput, state: State): RenderGraph {\n    const { width, height, renderMode, effects, cameraData, renderContext: ctx } = input;\n    const hasOverlays = Lines.from(state) !== undefined || Text.from(state) !== undefined;\n\n    const graph = createEmptyGraph();\n\n    const sceneColorFormat: GPUTextureFormat = \"rgba16float\";\n    const sceneColorUsage =\n        GPUTextureUsage.RENDER_ATTACHMENT |\n        GPUTextureUsage.TEXTURE_BINDING |\n        GPUTextureUsage.COPY_SRC |\n        GPUTextureUsage.COPY_DST |\n        GPUTextureUsage.STORAGE_BINDING;\n    const sceneColorId = declareTexture(\n        graph,\n        \"sceneColor\",\n        sceneColorFormat,\n        width,\n        height,\n        sceneColorUsage\n    );\n    const sceneDepthId = declareTexture(\n        graph,\n        \"sceneDepth\",\n        \"depth24plus\",\n        width,\n        height,\n        GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.TEXTURE_BINDING\n    );\n\n    if (renderMode === RenderMode.Raytracing && input.raytracing) {\n        addNode(\n            graph,\n            createRaycastNode({\n                harness: input.raytracing.harness,\n                scene: input.raytracing.scene,\n                config: input.raytracing.config,\n                outputId: sceneColorId,\n            })\n        );\n    } else {\n        addNode(\n            graph,\n            createRasterNode({\n                renderContext: ctx,\n                cameraData,\n                sceneColorId,\n                sceneDepthId,\n            })\n        );\n    }\n\n    if (hasOverlays) {\n        addNode(\n            graph,\n            createOverlayNode({\n                state,\n                renderContext: ctx,\n                cameraData,\n                inputColorId: sceneColorId,\n                outputColorId: sceneColorId,\n            })\n        );\n    }\n\n    const hasEffects = effects.tonemap || effects.fxaa || effects.vignette;\n\n    if (hasEffects) {\n        const postProcessedId = declareTexture(\n            graph,\n            \"postProcessed\",\n            ctx.gpu.format,\n            width,\n            height\n        );\n\n        addNode(\n            graph,\n            createPostProcessNode({\n                gpu: ctx.gpu,\n                pipeline: ctx.postprocess,\n                config: effects,\n                inputId: sceneColorId,\n                outputId: postProcessedId,\n            })\n        );\n\n        addNode(\n            graph,\n            createBlitNode({\n                pipeline: ctx.postprocess,\n                inputId: postProcessedId,\n            })\n        );\n    } else {\n        addNode(\n            graph,\n            createBlitNode({\n                pipeline: ctx.postprocess,\n                inputId: sceneColorId,\n            })\n        );\n    }\n\n    graph.sorted = toposort(graph);\n    return graph;\n}\n\nexport function buildRenderGraph(config: GraphBuilderConfig): RenderGraph | null {\n    const input = collectGraphBuilderInput(config);\n    if (!input) return null;\n    return buildGraph(input, config.state);\n}\n","import { setTraits } from \"../../core/component\";\nimport { MAX_ENTITIES } from \"../../core/constants\";\n\nexport const Material = {\n    albedoR: new Float32Array(MAX_ENTITIES),\n    albedoG: new Float32Array(MAX_ENTITIES),\n    albedoB: new Float32Array(MAX_ENTITIES),\n    roughness: new Float32Array(MAX_ENTITIES),\n    metallic: new Float32Array(MAX_ENTITIES),\n};\n\nsetTraits(Material, {\n    defaults: () => ({\n        albedoR: 0.8,\n        albedoG: 0.8,\n        albedoB: 0.8,\n        roughness: 0.5,\n        metallic: 0,\n    }),\n});\n","import { setTraits } from \"../../core/component\";\n\nexport const Atmosphere = {\n    sunDirX: [] as number[],\n    sunDirY: [] as number[],\n    sunDirZ: [] as number[],\n    sunPower: [] as number[],\n    zenithR: [] as number[],\n    zenithG: [] as number[],\n    zenithB: [] as number[],\n    horizonR: [] as number[],\n    horizonG: [] as number[],\n    horizonB: [] as number[],\n    sunRadius: [] as number[],\n    fogDensity: [] as number[],\n    fogColorR: [] as number[],\n    fogColorG: [] as number[],\n    fogColorB: [] as number[],\n    fogHeight: [] as number[],\n};\n\nsetTraits(Atmosphere, {\n    defaults: () => ({\n        sunDirX: 0.5,\n        sunDirY: 0.7,\n        sunDirZ: 0.5,\n        sunPower: 8.0,\n        zenithR: 0.2,\n        zenithG: 0.4,\n        zenithB: 0.8,\n        horizonR: 0.8,\n        horizonG: 0.6,\n        horizonB: 0.4,\n        sunRadius: 0.02,\n        fogDensity: 0.005,\n        fogColorR: 0.5,\n        fogColorG: 0.6,\n        fogColorB: 0.7,\n        fogHeight: 0.1,\n    }),\n});\n","import { setTraits } from \"../../core/component\";\n\nexport const Terrain = {\n    sizeX: [] as number[],\n    sizeZ: [] as number[],\n    heightScale: [] as number[],\n    resolution: [] as number[],\n};\n\nsetTraits(Terrain, {\n    defaults: () => ({\n        sizeX: 10,\n        sizeZ: 10,\n        heightScale: 2,\n        resolution: 16,\n    }),\n});\n\nconst terrainHeights = new Map<number, Float32Array<ArrayBuffer>>();\n\nexport function setTerrainHeights(eid: number, heights: Float32Array<ArrayBuffer>): void {\n    terrainHeights.set(eid, heights);\n}\n\nexport function getTerrainHeights(eid: number): Float32Array<ArrayBuffer> | undefined {\n    return terrainHeights.get(eid);\n}\n\nexport function clearTerrainHeights(eid: number): void {\n    terrainHeights.delete(eid);\n}\n","import type { State } from \"../../../core\";\nimport { WorldTransform } from \"../../transforms\";\nimport { Camera } from \"../camera\";\nimport { Mesh } from \"../mesh\";\nimport { Material } from \"../material\";\nimport { Atmosphere } from \"../atmosphere\";\nimport { Terrain, getTerrainHeights } from \"../terrain\";\nimport { DirectionalLight } from \"../lighting\";\nimport type { Scene } from \"../raytracing/model\";\nimport { createDefaultAtmosphere } from \"../raytracing/model\";\n\nfunction normalize(x: number, y: number, z: number): { x: number; y: number; z: number } {\n    const len = Math.sqrt(x * x + y * y + z * z);\n    return len === 0 ? { x: 0, y: 1, z: 0 } : { x: x / len, y: y / len, z: z / len };\n}\n\nfunction collectCamera(cameraEid: number) {\n    const d = WorldTransform.data;\n    const o = cameraEid * 16;\n    return {\n        position: { x: d[o + 12], y: d[o + 13], z: d[o + 14] },\n        right: { x: d[o], y: d[o + 1], z: d[o + 2] },\n        up: { x: d[o + 4], y: d[o + 5], z: d[o + 6] },\n        forward: { x: -d[o + 8], y: -d[o + 9], z: -d[o + 10] },\n        fov: (Camera.fov[cameraEid] * Math.PI) / 180,\n    };\n}\n\nfunction collectEntityIds(state: State): number[] {\n    const ids: number[] = [];\n    for (const eid of state.query([Mesh, WorldTransform, Material])) {\n        if (Mesh.visible[eid] !== 1) continue;\n        ids.push(eid);\n    }\n    return ids;\n}\n\nfunction collectLights(state: State) {\n    const lights: Scene[\"lights\"] = [];\n\n    for (const eid of state.query([DirectionalLight])) {\n        const direction = normalize(\n            DirectionalLight.directionX[eid],\n            DirectionalLight.directionY[eid],\n            DirectionalLight.directionZ[eid]\n        );\n\n        const color = DirectionalLight.color[eid];\n\n        lights.push({\n            direction,\n            color: {\n                r: ((color >> 16) & 0xff) / 255,\n                g: ((color >> 8) & 0xff) / 255,\n                b: (color & 0xff) / 255,\n            },\n            intensity: DirectionalLight.intensity[eid],\n        });\n    }\n\n    return lights;\n}\n\nfunction collectAtmosphere(state: State): Scene[\"atmosphere\"] {\n    for (const eid of state.query([Atmosphere])) {\n        return {\n            sunDir: normalize(\n                Atmosphere.sunDirX[eid],\n                Atmosphere.sunDirY[eid],\n                Atmosphere.sunDirZ[eid]\n            ),\n            sunPower: Atmosphere.sunPower[eid],\n            zenith: {\n                r: Atmosphere.zenithR[eid],\n                g: Atmosphere.zenithG[eid],\n                b: Atmosphere.zenithB[eid],\n            },\n            horizon: {\n                r: Atmosphere.horizonR[eid],\n                g: Atmosphere.horizonG[eid],\n                b: Atmosphere.horizonB[eid],\n            },\n            sunRadius: Atmosphere.sunRadius[eid],\n            fogDensity: Atmosphere.fogDensity[eid],\n            fogColor: {\n                r: Atmosphere.fogColorR[eid],\n                g: Atmosphere.fogColorG[eid],\n                b: Atmosphere.fogColorB[eid],\n            },\n            fogHeight: Atmosphere.fogHeight[eid],\n        };\n    }\n\n    return createDefaultAtmosphere();\n}\n\nfunction collectTerrain(state: State) {\n    for (const eid of state.query([Terrain, WorldTransform, Material])) {\n        const heights = getTerrainHeights(eid);\n        if (!heights) continue;\n\n        const o = eid * 16;\n        return {\n            terrain: {\n                position: {\n                    x: WorldTransform.data[o + 12],\n                    y: WorldTransform.data[o + 13],\n                    z: WorldTransform.data[o + 14],\n                },\n                sizeX: Terrain.sizeX[eid],\n                sizeZ: Terrain.sizeZ[eid],\n                scale: Terrain.heightScale[eid],\n                resolution: Terrain.resolution[eid],\n                material: eid,\n            },\n            heights,\n        };\n    }\n\n    return {};\n}\n\nexport function collectScene(state: State, cameraEid: number): Scene {\n    const camera = collectCamera(cameraEid);\n    const entityIds = collectEntityIds(state);\n    const { terrain, heights } = collectTerrain(state);\n    const lights = collectLights(state);\n    const atmosphere = collectAtmosphere(state);\n\n    return {\n        camera,\n        entityIds,\n        transforms: WorldTransform,\n        shapes: Mesh.shape,\n        sizes: { x: Mesh.sizeX, y: Mesh.sizeY, z: Mesh.sizeZ },\n        albedo: { r: Material.albedoR, g: Material.albedoG, b: Material.albedoB },\n        roughness: Material.roughness,\n        metallic: Material.metallic,\n        terrain,\n        heights,\n        lights,\n        atmosphere,\n    };\n}\n","import type { State } from \"../../../core\";\nimport { Camera } from \"../camera\";\nimport type { Config, DebugMode } from \"../raytracing/model\";\n\nconst DebugModes: DebugMode[] = [\"color\", \"depth\", \"normal\", \"material\", \"hit\"];\n\nexport function collectConfig(\n    state: State,\n    cameraEid: number,\n    width: number,\n    height: number\n): Config {\n    const debug = DebugModes[Camera.debugMode[cameraEid]];\n\n    return {\n        width,\n        height,\n        reference: false,\n        debug,\n        near: Camera.near[cameraEid],\n        far: Camera.far[cameraEid],\n    };\n}\n","import type { State, System } from \"../../core\";\nimport { WorldTransform } from \"../transforms\";\nimport { Camera, RenderMode } from \"./camera\";\nimport { Render, type WebGPURenderContext } from \"./context\";\nimport { initRTHarness, type RTHarnessContext } from \"./raytracing/harness\";\nimport { buildRenderGraph, RenderMode as GraphRenderMode } from \"./graph/builder\";\nimport { executeGraph, deallocateResources } from \"./graph/executor\";\nimport { collectScene } from \"./adapter/scene\";\nimport { collectConfig } from \"./adapter/config\";\nimport { destroyBuffers, type RaycastBuffers } from \"./nodes/raycast\";\n\ninterface UnifiedRenderContext extends WebGPURenderContext {\n    rtHarness?: RTHarnessContext;\n}\n\nfunction findActiveCamera(state: State): number | null {\n    for (const eid of state.query([Camera, WorldTransform])) {\n        if (Camera.active[eid] === 1) {\n            return eid;\n        }\n    }\n    return null;\n}\n\nexport const RenderSystem: System = {\n    group: \"draw\",\n    last: true,\n\n    update(state: State) {\n        const render = Render.from(state);\n        const ctx = render?.context as UnifiedRenderContext | null;\n        if (!ctx) return;\n\n        const cameraEid = findActiveCamera(state);\n        if (cameraEid === null) return;\n\n        const width = ctx.gpu.canvas.width;\n        const height = ctx.gpu.canvas.height;\n\n        const renderMode = Camera.renderMode[cameraEid] ?? RenderMode.Raster;\n\n        let graph;\n        if (renderMode === RenderMode.Raytracing) {\n            if (!ctx.rtHarness) {\n                ctx.rtHarness = initRTHarness(ctx.gpu.device);\n            }\n\n            const scene = collectScene(state, cameraEid);\n            const config = collectConfig(state, cameraEid, width, height);\n\n            graph = buildRenderGraph({\n                state,\n                renderContext: ctx,\n                rtHarness: ctx.rtHarness,\n                rtScene: scene,\n                rtConfig: config,\n                renderMode: GraphRenderMode.Raytracing,\n            });\n        } else {\n            graph = buildRenderGraph({\n                state,\n                renderContext: ctx,\n                renderMode: GraphRenderMode.Raster,\n            });\n        }\n\n        if (!graph) return;\n\n        executeGraph(\n            graph,\n            ctx.gpu.device,\n            ctx.gpu.device.queue,\n            width,\n            height,\n            ctx.gpu.format,\n            ctx.gpu.context.getCurrentTexture().createView()\n        );\n\n        deallocateResources(graph);\n    },\n\n    dispose(state: State) {\n        const render = Render.from(state);\n        const ctx = render?.context as UnifiedRenderContext | null;\n        if (!ctx) return;\n\n        if (ctx.rtHarness?.buffers) {\n            destroyBuffers(ctx.rtHarness.buffers as RaycastBuffers);\n            ctx.rtHarness.buffers = null;\n            ctx.rtHarness.bvhCache = null;\n        }\n\n        ctx.uniformBuffer.destroy();\n        ctx.lightBuffer.destroy();\n        ctx.depthTexture?.destroy();\n\n        for (const [, geo] of ctx.geometries) {\n            geo.vertexBuffer.destroy();\n            geo.indexBuffer.destroy();\n        }\n        ctx.geometries.clear();\n\n        for (const [, buffers] of ctx.shapes) {\n            buffers.entityIdBuffer.destroy();\n            buffers.visibleEntityIdBuffer.destroy();\n            buffers.indirectBuffer.destroy();\n        }\n        ctx.shapes.clear();\n\n        ctx.matricesBuffer.destroy();\n\n        ctx.culling.uniformBuffer.destroy();\n        for (const buffer of ctx.culling.shapeAABBBuffers.values()) {\n            buffer.destroy();\n        }\n        ctx.culling.shapeAABBBuffers.clear();\n\n        ctx.postprocess.uniforms.destroy();\n        ctx.postprocess.sceneTarget?.texture.destroy();\n\n        if (render) {\n            render.context = null;\n        }\n    },\n};\n","import type { Plugin, State } from \"../../core\";\nimport { Render, initRenderContext } from \"./context\";\nimport { LightSyncSystem, AmbientLight, DirectionalLight } from \"./lighting\";\nimport { MeshSyncSystem, Mesh } from \"./mesh\";\nimport { CullingSystem } from \"./culling\";\nimport { RenderSystem } from \"./system\";\nimport { Camera } from \"./camera\";\nimport { Material } from \"./material\";\nimport { Atmosphere } from \"./atmosphere\";\nimport { Terrain } from \"./terrain\";\nimport { Tonemap, FXAA, Vignette } from \"./postprocess\";\n\nexport { Mesh, MeshShape } from \"./mesh\";\nexport { Camera, RenderMode, DebugMode } from \"./camera\";\nexport { Material } from \"./material\";\nexport { Atmosphere } from \"./atmosphere\";\nexport { Terrain, setTerrainHeights, clearTerrainHeights } from \"./terrain\";\nexport { AmbientLight, DirectionalLight } from \"./lighting\";\nexport { Render, type RenderState, type WebGPURenderContext } from \"./context\";\nexport { Tonemap, FXAA, Vignette } from \"./postprocess\";\n\nexport const RenderPlugin: Plugin = {\n    systems: [LightSyncSystem, MeshSyncSystem, CullingSystem, RenderSystem],\n    components: {\n        Mesh,\n        Camera,\n        Material,\n        Atmosphere,\n        Terrain,\n        AmbientLight,\n        DirectionalLight,\n        Tonemap,\n        FXAA,\n        Vignette,\n    },\n    async initialize(state: State) {\n        if (!state.canvas) {\n            throw new Error(\"RenderPlugin requires a canvas. Use State.new().withCanvas(canvas)\");\n        }\n        const context = await initRenderContext(state.canvas, state.gpu ?? undefined);\n        state.setResource(Render, { canvas: state.canvas, context });\n    },\n};\n","import { resource, type State, type System, type Plugin } from \"../../core\";\nimport type { InputState, MouseState } from \"../../core/input\";\nimport { Render, RenderPlugin } from \"../render\";\n\nexport type { InputState, MouseState };\nexport const Input = resource<InputState>(\"input\");\n\nconst keys = new Set<string>();\nconst keysPressed = new Set<string>();\nconst keysReleased = new Set<string>();\n\nconst mouse: MouseState = {\n    deltaX: 0,\n    deltaY: 0,\n    scrollDelta: 0,\n    left: false,\n    right: false,\n    middle: false,\n};\n\nconst inputState: InputState = {\n    mouse,\n    isKeyDown: (code: string) => keys.has(code),\n    isKeyPressed: (code: string) => keysPressed.has(code),\n    isKeyReleased: (code: string) => keysReleased.has(code),\n};\n\nlet canvas: HTMLCanvasElement | null = null;\n\nfunction handleKeyDown(e: KeyboardEvent): void {\n    if (!keys.has(e.code)) {\n        keysPressed.add(e.code);\n    }\n    keys.add(e.code);\n}\n\nfunction handleKeyUp(e: KeyboardEvent): void {\n    keys.delete(e.code);\n    keysReleased.add(e.code);\n}\n\nfunction handleMouseDown(e: MouseEvent): void {\n    if (e.target !== canvas) return;\n    if (e.button === 0) mouse.left = true;\n    if (e.button === 1) mouse.middle = true;\n    if (e.button === 2) mouse.right = true;\n}\n\nfunction handleMouseUp(e: MouseEvent): void {\n    if (e.button === 0) mouse.left = false;\n    if (e.button === 1) mouse.middle = false;\n    if (e.button === 2) mouse.right = false;\n}\n\nfunction handleMouseMove(e: MouseEvent): void {\n    mouse.deltaX += e.movementX;\n    mouse.deltaY += e.movementY;\n}\n\nfunction handleWheel(e: WheelEvent): void {\n    if (e.target !== canvas) return;\n    mouse.scrollDelta += e.deltaY;\n    e.preventDefault();\n}\n\nfunction handleContextMenu(e: Event): void {\n    if (e.target === canvas) {\n        e.preventDefault();\n    }\n}\n\nfunction resetFrameState(): void {\n    keysPressed.clear();\n    keysReleased.clear();\n    mouse.deltaX = 0;\n    mouse.deltaY = 0;\n    mouse.scrollDelta = 0;\n}\n\nfunction clearAllState(): void {\n    keys.clear();\n    keysPressed.clear();\n    keysReleased.clear();\n    mouse.deltaX = 0;\n    mouse.deltaY = 0;\n    mouse.scrollDelta = 0;\n    mouse.left = false;\n    mouse.right = false;\n    mouse.middle = false;\n}\n\nexport const InputSystem: System = {\n    group: \"simulation\",\n\n    setup(state: State) {\n        const render = Render.from(state);\n        if (!render?.canvas) return;\n        canvas = render.canvas;\n\n        window.addEventListener(\"keydown\", handleKeyDown);\n        window.addEventListener(\"keyup\", handleKeyUp);\n        canvas.addEventListener(\"mousedown\", handleMouseDown);\n        window.addEventListener(\"mouseup\", handleMouseUp);\n        canvas.addEventListener(\"mousemove\", handleMouseMove);\n        canvas.addEventListener(\"wheel\", handleWheel, { passive: false });\n        canvas.addEventListener(\"contextmenu\", handleContextMenu);\n\n        state.setResource(Input, inputState);\n    },\n\n    dispose(state: State) {\n        if (canvas) {\n            window.removeEventListener(\"keydown\", handleKeyDown);\n            window.removeEventListener(\"keyup\", handleKeyUp);\n            canvas.removeEventListener(\"mousedown\", handleMouseDown);\n            window.removeEventListener(\"mouseup\", handleMouseUp);\n            canvas.removeEventListener(\"mousemove\", handleMouseMove);\n            canvas.removeEventListener(\"wheel\", handleWheel);\n            canvas.removeEventListener(\"contextmenu\", handleContextMenu);\n            canvas = null;\n        }\n\n        clearAllState();\n        state.deleteResource(Input);\n    },\n};\n\nconst InputResetSystem: System = {\n    group: \"draw\",\n    last: true,\n\n    update() {\n        resetFrameState();\n    },\n};\n\nexport const InputPlugin: Plugin = {\n    systems: [InputSystem, InputResetSystem],\n    dependencies: [RenderPlugin],\n    initialize(state: State) {\n        const render = Render.from(state);\n        if (!render?.canvas) {\n            throw new Error(\"InputPlugin requires RenderPlugin to be initialized first\");\n        }\n    },\n};\n","export type EasingFn = (t: number) => number;\n\nconst linear: EasingFn = (t) => t;\n\nconst easeInQuad: EasingFn = (t) => t * t;\nconst easeOutQuad: EasingFn = (t) => t * (2 - t);\nconst easeInOutQuad: EasingFn = (t) => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t);\n\nconst easeInCubic: EasingFn = (t) => t * t * t;\nconst easeOutCubic: EasingFn = (t) => --t * t * t + 1;\nconst easeInOutCubic: EasingFn = (t) =>\n    t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n\nconst easeInQuart: EasingFn = (t) => t * t * t * t;\nconst easeOutQuart: EasingFn = (t) => 1 - --t * t * t * t;\nconst easeInOutQuart: EasingFn = (t) => (t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t);\n\nconst easeInQuint: EasingFn = (t) => t * t * t * t * t;\nconst easeOutQuint: EasingFn = (t) => 1 + --t * t * t * t * t;\nconst easeInOutQuint: EasingFn = (t) =>\n    t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\n\nconst easeInSine: EasingFn = (t) => 1 - Math.cos((t * Math.PI) / 2);\nconst easeOutSine: EasingFn = (t) => Math.sin((t * Math.PI) / 2);\nconst easeInOutSine: EasingFn = (t) => -(Math.cos(Math.PI * t) - 1) / 2;\n\nconst easeInExpo: EasingFn = (t) => (t === 0 ? 0 : Math.pow(2, 10 * t - 10));\nconst easeOutExpo: EasingFn = (t) => (t === 1 ? 1 : 1 - Math.pow(2, -10 * t));\nconst easeInOutExpo: EasingFn = (t) =>\n    t === 0\n        ? 0\n        : t === 1\n          ? 1\n          : t < 0.5\n            ? Math.pow(2, 20 * t - 10) / 2\n            : (2 - Math.pow(2, -20 * t + 10)) / 2;\n\nconst easeInCirc: EasingFn = (t) => 1 - Math.sqrt(1 - t * t);\nconst easeOutCirc: EasingFn = (t) => Math.sqrt(1 - --t * t);\nconst easeInOutCirc: EasingFn = (t) =>\n    t < 0.5\n        ? (1 - Math.sqrt(1 - 4 * t * t)) / 2\n        : (Math.sqrt(1 - (-2 * t + 2) * (-2 * t + 2)) + 1) / 2;\n\nconst easeInBack: EasingFn = (t) => {\n    const c = 1.70158;\n    return (c + 1) * t * t * t - c * t * t;\n};\nconst easeOutBack: EasingFn = (t) => {\n    const c = 1.70158;\n    return 1 + (c + 1) * Math.pow(t - 1, 3) + c * Math.pow(t - 1, 2);\n};\nconst easeInOutBack: EasingFn = (t) => {\n    const c = 1.70158 * 1.525;\n    return t < 0.5\n        ? (Math.pow(2 * t, 2) * ((c + 1) * 2 * t - c)) / 2\n        : (Math.pow(2 * t - 2, 2) * ((c + 1) * (t * 2 - 2) + c) + 2) / 2;\n};\n\nconst easeInElastic: EasingFn = (t) =>\n    t === 0\n        ? 0\n        : t === 1\n          ? 1\n          : -Math.pow(2, 10 * t - 10) * Math.sin((t * 10 - 10.75) * ((2 * Math.PI) / 3));\nconst easeOutElastic: EasingFn = (t) =>\n    t === 0\n        ? 0\n        : t === 1\n          ? 1\n          : Math.pow(2, -10 * t) * Math.sin((t * 10 - 0.75) * ((2 * Math.PI) / 3)) + 1;\nconst easeInOutElastic: EasingFn = (t) =>\n    t === 0\n        ? 0\n        : t === 1\n          ? 1\n          : t < 0.5\n            ? -(Math.pow(2, 20 * t - 10) * Math.sin((20 * t - 11.125) * ((2 * Math.PI) / 4.5))) / 2\n            : (Math.pow(2, -20 * t + 10) * Math.sin((20 * t - 11.125) * ((2 * Math.PI) / 4.5))) /\n                  2 +\n              1;\n\nconst easeOutBounce: EasingFn = (t) => {\n    const n1 = 7.5625;\n    const d1 = 2.75;\n    if (t < 1 / d1) return n1 * t * t;\n    if (t < 2 / d1) return n1 * (t -= 1.5 / d1) * t + 0.75;\n    if (t < 2.5 / d1) return n1 * (t -= 2.25 / d1) * t + 0.9375;\n    return n1 * (t -= 2.625 / d1) * t + 0.984375;\n};\nconst easeInBounce: EasingFn = (t) => 1 - easeOutBounce(1 - t);\nconst easeInOutBounce: EasingFn = (t) =>\n    t < 0.5 ? (1 - easeOutBounce(1 - 2 * t)) / 2 : (1 + easeOutBounce(2 * t - 1)) / 2;\n\nexport const EASING_FUNCTIONS: readonly EasingFn[] = [\n    linear,\n    easeInQuad,\n    easeOutQuad,\n    easeInOutQuad,\n    easeInCubic,\n    easeOutCubic,\n    easeInOutCubic,\n    easeInQuart,\n    easeOutQuart,\n    easeInOutQuart,\n    easeInQuint,\n    easeOutQuint,\n    easeInOutQuint,\n    easeInSine,\n    easeOutSine,\n    easeInOutSine,\n    easeInExpo,\n    easeOutExpo,\n    easeInOutExpo,\n    easeInCirc,\n    easeOutCirc,\n    easeInOutCirc,\n    easeInBack,\n    easeOutBack,\n    easeInOutBack,\n    easeInElastic,\n    easeOutElastic,\n    easeInOutElastic,\n    easeInBounce,\n    easeOutBounce,\n    easeInOutBounce,\n] as const;\n\nconst EASING_INDEX: Record<string, number> = {\n    linear: 0,\n    \"ease-in-quad\": 1,\n    \"ease-out-quad\": 2,\n    \"ease-in-out-quad\": 3,\n    \"ease-in-cubic\": 4,\n    \"ease-out-cubic\": 5,\n    \"ease-in-out-cubic\": 6,\n    \"ease-in-quart\": 7,\n    \"ease-out-quart\": 8,\n    \"ease-in-out-quart\": 9,\n    \"ease-in-quint\": 10,\n    \"ease-out-quint\": 11,\n    \"ease-in-out-quint\": 12,\n    \"ease-in-sine\": 13,\n    \"ease-out-sine\": 14,\n    \"ease-in-out-sine\": 15,\n    \"ease-in-expo\": 16,\n    \"ease-out-expo\": 17,\n    \"ease-in-out-expo\": 18,\n    \"ease-in-circ\": 19,\n    \"ease-out-circ\": 20,\n    \"ease-in-out-circ\": 21,\n    \"ease-in-back\": 22,\n    \"ease-out-back\": 23,\n    \"ease-in-out-back\": 24,\n    \"ease-in-elastic\": 25,\n    \"ease-out-elastic\": 26,\n    \"ease-in-out-elastic\": 27,\n    \"ease-in-bounce\": 28,\n    \"ease-out-bounce\": 29,\n    \"ease-in-out-bounce\": 30,\n};\n\nexport function getEasingIndex(name: string): number {\n    return EASING_INDEX[name] ?? 0;\n}\n\nexport function getEasing(index: number): EasingFn {\n    return EASING_FUNCTIONS[index] ?? linear;\n}\n","import { Pair } from \"bitecs\";\nimport { setTraits } from \"../../core/component\";\nimport type { State, ParseContext } from \"../../core\";\nimport { ChildOf } from \"../../core/hierarchy\";\nimport { Tween, TweenState, ensureResolved, captureFromValue } from \"./tween\";\n\nexport const Pause = {\n    duration: [] as number[],\n};\n\nsetTraits(Pause, {\n    defaults: () => ({ duration: 0.5 }),\n});\n\nexport const SequenceState = {\n    IDLE: 0,\n    PLAYING: 1,\n    COMPLETE: 2,\n} as const;\n\nexport const Sequence = {\n    state: [] as number[],\n    elapsed: [] as number[],\n};\n\nsetTraits(Sequence, {\n    defaults: () => ({\n        state: SequenceState.IDLE,\n        elapsed: 0,\n    }),\n});\n\nexport function finalizeSequences(_state: State, _context: ParseContext): void {}\n\nfunction getChildrenSorted(state: State, parentEid: number): number[] {\n    const children: number[] = [];\n    for (const childEid of state.query([Pair(ChildOf.relation, parentEid)])) {\n        children.push(childEid);\n    }\n    return children.sort((a, b) => a - b);\n}\n\nexport function computeTweenDelays(state: State, seqEid: number): void {\n    const children = getChildrenSorted(state, seqEid);\n    let cumulativeDelay = 0;\n\n    for (const childEid of children) {\n        if (state.hasComponent(childEid, Pause)) {\n            cumulativeDelay += Pause.duration[childEid] ?? 0;\n        } else if (state.hasComponent(childEid, Tween)) {\n            Tween.delay[childEid] = cumulativeDelay;\n        }\n    }\n}\n\nfunction updateSequencePlayheads(state: State, dt: number): void {\n    for (const seqEid of state.query([Sequence])) {\n        if (Sequence.state[seqEid] !== SequenceState.PLAYING) continue;\n\n        const prevElapsed = Sequence.elapsed[seqEid] ?? 0;\n        const elapsed = prevElapsed + dt;\n        Sequence.elapsed[seqEid] = elapsed;\n\n        for (const childEid of state.query([Pair(ChildOf.relation, seqEid), Tween])) {\n            if (Tween.state[childEid] !== TweenState.IDLE) continue;\n\n            const delay = Tween.delay[childEid] ?? 0;\n            const shouldStart = elapsed >= delay;\n            const wasStarted = prevElapsed >= delay;\n\n            if (shouldStart) {\n                captureFromValue(state, childEid);\n                Tween.state[childEid] = TweenState.PLAYING;\n                Tween.elapsed[childEid] = wasStarted ? 0 : elapsed - delay - dt;\n            }\n        }\n    }\n}\n\nfunction ensureSequenceResolved(state: State, seqEid: number): void {\n    const tweens: { eid: number; endTime: number }[] = [];\n\n    for (const childEid of state.query([Pair(ChildOf.relation, seqEid), Tween])) {\n        if (\n            Tween.state[childEid] === TweenState.COMPLETE &&\n            Tween.elapsed[childEid] >= Tween.duration[childEid]\n        ) {\n            continue;\n        }\n        const delay = Tween.delay[childEid] ?? 0;\n        const duration = Tween.duration[childEid] ?? 0;\n        tweens.push({ eid: childEid, endTime: delay + duration });\n    }\n\n    tweens.sort((a, b) => a.endTime - b.endTime);\n\n    for (const { eid } of tweens) {\n        Tween.state[eid] = TweenState.COMPLETE;\n        ensureResolved(state, eid);\n    }\n}\n\nfunction ensureSequencesResolved(state: State): void {\n    for (const seqEid of state.query([Sequence])) {\n        if (Sequence.state[seqEid] === SequenceState.COMPLETE) {\n            ensureSequenceResolved(state, seqEid);\n        }\n    }\n}\n\nfunction checkSequenceCompletion(state: State): void {\n    for (const seqEid of state.query([Sequence])) {\n        if (Sequence.state[seqEid] !== SequenceState.PLAYING) continue;\n\n        let allComplete = true;\n        let hasChildren = false;\n\n        for (const childEid of state.query([Pair(ChildOf.relation, seqEid), Tween])) {\n            hasChildren = true;\n            if (Tween.state[childEid] !== TweenState.COMPLETE) {\n                allComplete = false;\n                break;\n            }\n        }\n\n        if (hasChildren && allComplete) {\n            Sequence.state[seqEid] = SequenceState.COMPLETE;\n        }\n    }\n}\n\nexport function updateSequences(state: State, dt: number): void {\n    updateSequencePlayheads(state, dt);\n}\n\nexport { ensureSequencesResolved, checkSequenceCompletion };\n","import {\n    defineRelation,\n    type State,\n    type System,\n    type ParseContext,\n    type Plugin,\n} from \"../../core\";\nimport { setTraits } from \"../../core/component\";\nimport { registerPostLoadHook } from \"../../core/xml/loader\";\nimport { getEasingIndex, getEasing } from \"./easing\";\nimport {\n    Sequence,\n    Pause,\n    updateSequences,\n    ensureSequencesResolved,\n    checkSequenceCompletion,\n} from \"./sequence\";\n\nfunction parseTweenAttrs(attrs: Record<string, string>): Record<string, string> {\n    if (attrs._value) {\n        const parsed: Record<string, string> = {};\n        for (const part of attrs._value.split(\";\")) {\n            const colonIdx = part.indexOf(\":\");\n            if (colonIdx === -1) continue;\n            const key = part.slice(0, colonIdx).trim();\n            const value = part.slice(colonIdx + 1).trim();\n            if (key && value) parsed[key] = value;\n        }\n        return parsed;\n    }\n    return attrs;\n}\n\nexport const TweenState = {\n    IDLE: 0,\n    PLAYING: 1,\n    COMPLETE: 2,\n} as const;\n\nexport const Tween = {\n    state: [] as number[],\n    from: [] as number[],\n    to: [] as number[],\n    duration: [] as number[],\n    elapsed: [] as number[],\n    delay: [] as number[],\n    easingIndex: [] as number[],\n};\n\nsetTraits(Tween, {\n    defaults: () => ({\n        state: TweenState.IDLE,\n        from: 0,\n        to: 0,\n        duration: 1,\n        elapsed: 0,\n        delay: 0,\n        easingIndex: 0,\n    }),\n    adapter: (attrs: Record<string, string>, state: State, context: ParseContext) => {\n        const parsed = parseTweenAttrs(attrs);\n        const result: Record<string, number> = {};\n\n        if (parsed.duration) result.duration = parseFloat(parsed.duration);\n        if (parsed.delay) result.delay = parseFloat(parsed.delay);\n        if (parsed.easing) result.easingIndex = getEasingIndex(parsed.easing);\n\n        if (parsed.target) {\n            setupTweenFromXml(state, context, parsed, context.currentEid);\n        }\n\n        return result;\n    },\n});\n\nexport const TweenTarget = defineRelation(\"tween-target\", {\n    exclusive: true,\n});\n\ninterface ParsedTargetPath {\n    readonly entity: string;\n    readonly component: string;\n    readonly field: string;\n}\n\nfunction parseTargetPath(path: string): ParsedTargetPath | null {\n    if (!path.startsWith(\"@\")) return null;\n\n    const rest = path.slice(1);\n    const firstDot = rest.indexOf(\".\");\n    if (firstDot === -1) return null;\n\n    const entity = rest.slice(0, firstDot);\n    const fieldPath = rest.slice(firstDot + 1);\n    const dotIndex = fieldPath.lastIndexOf(\".\");\n    if (dotIndex === -1) return null;\n\n    return {\n        entity,\n        component: fieldPath.slice(0, dotIndex),\n        field: fieldPath.slice(dotIndex + 1),\n    };\n}\n\ninterface PendingTween {\n    readonly tweenEid: number;\n    readonly target: string;\n    readonly to: string;\n}\n\nlet pendingXmlTweens: PendingTween[] = [];\n\nfunction setupTweenFromXml(\n    _state: State,\n    _context: ParseContext,\n    attrs: Record<string, string>,\n    tweenEid: number\n): void {\n    pendingXmlTweens.push({\n        tweenEid,\n        target: attrs.target,\n        to: attrs.to,\n    });\n}\n\nexport function finalizePendingTweens(state: State, context: ParseContext): void {\n    for (const pending of pendingXmlTweens) {\n        const parsed = parseTargetPath(pending.target);\n        if (!parsed) continue;\n\n        const targetEid = context.getEntityByName(parsed.entity);\n        if (targetEid === null) continue;\n\n        const binding = state.bindFieldAccessor(pending.tweenEid, parsed.component, parsed.field);\n        if (!binding) continue;\n\n        state.addRelation(pending.tweenEid, TweenTarget, targetEid);\n\n        Tween.to[pending.tweenEid] = parseFloat(pending.to);\n    }\n    pendingXmlTweens = [];\n}\n\nexport function captureFromValue(state: State, tweenEid: number): void {\n    const targets = state.getRelationTargets(tweenEid, TweenTarget);\n    const targetEid = targets.length > 0 ? targets[0] : -1;\n    const binding = state.getFieldAccessor(tweenEid);\n\n    if (binding && targetEid >= 0) {\n        Tween.from[tweenEid] = binding.get(targetEid) ?? 0;\n    }\n}\n\nexport function ensureResolved(state: State, tweenEid: number): void {\n    const elapsed = Tween.elapsed[tweenEid];\n    const duration = Tween.duration[tweenEid];\n\n    if (elapsed >= duration) return;\n\n    const targets = state.getRelationTargets(tweenEid, TweenTarget);\n    const targetEid = targets.length > 0 ? targets[0] : -1;\n    const binding = state.getFieldAccessor(tweenEid);\n\n    if (binding && targetEid >= 0) {\n        Tween.from[tweenEid] = binding.get(targetEid) ?? 0;\n        binding.set(targetEid, Tween.to[tweenEid]);\n    }\n\n    Tween.elapsed[tweenEid] = duration;\n}\n\nfunction updateTweens(state: State, dt: number): void {\n    for (const tweenEid of state.query([Tween])) {\n        const tweenState = Tween.state[tweenEid];\n\n        if (tweenState === TweenState.COMPLETE) {\n            ensureResolved(state, tweenEid);\n            continue;\n        }\n\n        if (tweenState !== TweenState.PLAYING) continue;\n\n        const targets = state.getRelationTargets(tweenEid, TweenTarget);\n        const targetEid = targets.length > 0 ? targets[0] : -1;\n        const binding = state.getFieldAccessor(tweenEid);\n\n        if (Tween.elapsed[tweenEid] === 0 && binding && targetEid >= 0) {\n            Tween.from[tweenEid] = binding.get(targetEid) ?? 0;\n        }\n\n        Tween.elapsed[tweenEid] += dt;\n\n        const elapsed = Tween.elapsed[tweenEid];\n        const duration = Tween.duration[tweenEid];\n        const rawProgress = Math.min(elapsed / duration, 1);\n\n        const easingFn = getEasing(Tween.easingIndex[tweenEid]);\n        const easedProgress = easingFn(rawProgress);\n\n        const from = Tween.from[tweenEid];\n        const to = Tween.to[tweenEid];\n        const value = from + (to - from) * easedProgress;\n\n        if (binding && targetEid >= 0) {\n            binding.set(targetEid, value);\n        }\n\n        if (rawProgress >= 1) {\n            Tween.state[tweenEid] = TweenState.COMPLETE;\n        }\n    }\n}\n\nexport interface TweenOptions {\n    readonly to: number;\n    readonly duration?: number;\n    readonly easing?: string;\n}\n\nexport function createTween(\n    state: State,\n    targetEid: number,\n    fieldPath: string,\n    options: TweenOptions\n): number | null {\n    const parsed = state.resolveFieldPath(fieldPath);\n    if (!parsed) return null;\n\n    const tweenEid = state.addEntity();\n    state.addComponent(tweenEid, Tween);\n\n    const binding = state.bindFieldAccessor(tweenEid, parsed.component, parsed.field);\n    if (!binding) {\n        state.removeEntity(tweenEid);\n        return null;\n    }\n\n    state.addRelation(tweenEid, TweenTarget, targetEid);\n\n    Tween.to[tweenEid] = options.to;\n    Tween.duration[tweenEid] = options.duration ?? 1;\n    Tween.elapsed[tweenEid] = 0;\n    Tween.easingIndex[tweenEid] = getEasingIndex(options.easing ?? \"linear\");\n\n    return tweenEid;\n}\n\nexport const TweenSystem: System = {\n    group: \"simulation\",\n\n    update(state: State) {\n        const dt = state.time.deltaTime;\n\n        ensureSequencesResolved(state);\n        updateSequences(state, dt);\n        updateTweens(state, dt);\n        checkSequenceCompletion(state);\n    },\n};\n\nexport const TweenPlugin: Plugin = {\n    systems: [TweenSystem],\n    components: { Tween, Sequence, Pause },\n    relations: [TweenTarget],\n    initialize() {\n        registerPostLoadHook(finalizePendingTweens);\n    },\n};\n","import type { Loading } from \"../../core\";\n\ninterface Theme {\n    bg: string;\n    track: string;\n    bar: string;\n}\n\nconst dark: Theme = { bg: \"#1a1a1a\", track: \"#333\", bar: \"#E8A86B\" };\nconst light: Theme = { bg: \"#f5f5f5\", track: \"#ddd\", bar: \"#B87654\" };\n\nconst LOGO_SVG = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 80 80\">\n  <defs>\n    <radialGradient id=\"baseGradient\" cx=\"35%\" cy=\"30%\" r=\"70%\" fx=\"25%\" fy=\"20%\">\n      <stop offset=\"0%\" stop-color=\"#F5D4B8\"/>\n      <stop offset=\"45%\" stop-color=\"#E8A86B\"/>\n      <stop offset=\"100%\" stop-color=\"#B87654\"/>\n    </radialGradient>\n  </defs>\n  <g transform=\"rotate(35 40.0 40.0)\">\n    <path d=\"M40.0,2 C44.0,10 66.0,28 66.0,46 C66.0,60 48.0,70 40.0,78 C32.0,70 14.0,60 14.0,46 C14.0,28 36.0,10 40.0,2 Z\" fill=\"url(#baseGradient)\"/>\n    <path d=\"M40.0,6 C37.0,14 22.0,28 20.0,44 C20.0,52 28.0,62 36.0,70 C34.0,58 26.0,46 26.0,38 C26.0,26 38.0,12 40.0,6 Z\" fill=\"#B87654\" opacity=\"0.45\"/>\n    <path d=\"M40.0,6 C43.0,14 58.0,28 60.0,44 C60.0,52 52.0,62 44.0,70 C46.0,58 54.0,46 54.0,38 C54.0,26 42.0,12 40.0,6 Z\" fill=\"#B87654\" opacity=\"0.35\"/>\n    <path d=\"M40.0,8 C40.0,20 40.0,50 40.0,72\" stroke=\"#B87654\" stroke-width=\"1\" stroke-opacity=\"0.4\" fill=\"none\" stroke-linecap=\"round\"/>\n    <path d=\"M40.0,78 C48.0,70 66.0,60 66.0,46 C61.0,58 44.0,70 40.0,73 Z\" fill=\"#B87654\"/>\n    <path d=\"M40.0,2 C36.0,10 14.0,28 14.0,46 C19.0,30 41.0,8 40.0,7 Z\" fill=\"#F5D4B8\" opacity=\"0.7\"/>\n    <path d=\"M40.0,2 C44.0,10 66.0,28 66.0,46 C66.0,60 48.0,70 40.0,78 C32.0,70 14.0,60 14.0,46 C14.0,28 36.0,10 40.0,2 Z\" fill=\"none\" stroke=\"#6B4230\" stroke-width=\"2\"/>\n  </g>\n</svg>`;\n\nfunction createOverlay(canvas: HTMLCanvasElement, bg: string): HTMLDivElement {\n    const overlay = document.createElement(\"div\");\n    overlay.style.cssText = `\n        position: absolute;\n        inset: 0;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        background: ${bg};\n        z-index: 1000;\n    `;\n\n    const parent = canvas.parentElement;\n    if (parent) {\n        if (getComputedStyle(parent).position === \"static\") {\n            parent.style.position = \"relative\";\n        }\n        parent.appendChild(overlay);\n    }\n\n    return overlay;\n}\n\nfunction createProgressBar(theme: Theme): { track: HTMLDivElement; bar: HTMLDivElement } {\n    const track = document.createElement(\"div\");\n    track.style.cssText = `\n        width: 200px;\n        height: 4px;\n        background: ${theme.track};\n        border-radius: 2px;\n        overflow: hidden;\n    `;\n\n    const bar = document.createElement(\"div\");\n    bar.style.cssText = `\n        width: 0%;\n        height: 100%;\n        background: ${theme.bar};\n        transition: width 0.15s ease-out;\n    `;\n    track.appendChild(bar);\n\n    return { track, bar };\n}\n\nfunction shallotLoading(canvas: HTMLCanvasElement, theme: Theme): Loading {\n    let overlay: HTMLDivElement | null = null;\n    let bar: HTMLDivElement | null = null;\n\n    return {\n        show() {\n            overlay = createOverlay(canvas, theme.bg);\n\n            const logo = document.createElement(\"div\");\n            logo.innerHTML = LOGO_SVG;\n            logo.style.cssText = \"width: 64px; height: 64px; margin-bottom: 24px;\";\n            overlay.appendChild(logo);\n\n            const progressBar = createProgressBar(theme);\n            bar = progressBar.bar;\n            overlay.appendChild(progressBar.track);\n\n            return () => {\n                overlay?.remove();\n                overlay = null;\n                bar = null;\n            };\n        },\n\n        update(progress) {\n            if (bar) bar.style.width = `${progress * 100}%`;\n        },\n    };\n}\n\nfunction minimalLoading(canvas: HTMLCanvasElement, theme: Theme): Loading {\n    let overlay: HTMLDivElement | null = null;\n    let bar: HTMLDivElement | null = null;\n\n    return {\n        show() {\n            overlay = createOverlay(canvas, theme.bg);\n            const progressBar = createProgressBar(theme);\n            bar = progressBar.bar;\n            overlay.appendChild(progressBar.track);\n\n            return () => {\n                overlay?.remove();\n                overlay = null;\n                bar = null;\n            };\n        },\n\n        update(progress) {\n            if (bar) bar.style.width = `${progress * 100}%`;\n        },\n    };\n}\n\nexport const shallotDark = (canvas: HTMLCanvasElement): Loading => shallotLoading(canvas, dark);\nexport const shallotLight = (canvas: HTMLCanvasElement): Loading => shallotLoading(canvas, light);\nexport const minimalDark = (canvas: HTMLCanvasElement): Loading => minimalLoading(canvas, dark);\nexport const minimalLight = (canvas: HTMLCanvasElement): Loading => minimalLoading(canvas, light);\n\nexport { shallotDark as canvasLoading };\n","import type { Plugin } from \"../core/plugin\";\nimport { StateBuilder } from \"../core/state\";\nimport { TransformsPlugin } from \"./transforms\";\nimport { RenderPlugin } from \"./render\";\nimport { InputPlugin } from \"./input\";\nimport { canvasLoading } from \"./loading\";\n\nexport const DEFAULT_PLUGINS: readonly Plugin[] = [TransformsPlugin, RenderPlugin, InputPlugin];\n\nStateBuilder.defaultPlugins = DEFAULT_PLUGINS;\nStateBuilder.loading = canvasLoading;\n","import { setTraits } from \"../../core/component\";\nimport { lookAt, type State, type System, type Plugin } from \"../../core\";\nimport { Transform } from \"../../standard/transforms\";\nimport { Input, InputPlugin } from \"../../standard/input\";\n\nconst Tau = Math.PI * 2;\n\nexport const Orbit = {\n    target: [] as number[],\n    yaw: [] as number[],\n    pitch: [] as number[],\n    distance: [] as number[],\n    targetYaw: [] as number[],\n    targetPitch: [] as number[],\n    targetDistance: [] as number[],\n    minPitch: [] as number[],\n    maxPitch: [] as number[],\n    minDistance: [] as number[],\n    maxDistance: [] as number[],\n    smoothness: [] as number[],\n    sensitivity: [] as number[],\n    zoomSpeed: [] as number[],\n};\n\nsetTraits(Orbit, {\n    defaults: () => ({\n        target: 0,\n        yaw: 0,\n        pitch: Math.PI / 6,\n        distance: 8,\n        targetYaw: 0,\n        targetPitch: Math.PI / 6,\n        targetDistance: 10,\n        minPitch: -Math.PI / 2 + 0.01,\n        maxPitch: Math.PI / 2 - 0.01,\n        minDistance: 1,\n        maxDistance: 25,\n        smoothness: 0.3,\n        sensitivity: 0.005,\n        zoomSpeed: 0.025,\n    }),\n});\n\nfunction clamp(value: number, min: number, max: number): number {\n    return Math.max(min, Math.min(max, value));\n}\n\nfunction smoothLerp(smoothness: number, dt: number): number {\n    return 1 - Math.pow(1 - smoothness, dt * 60);\n}\n\nfunction normalizeAngle(a: number): number {\n    return ((a % Tau) + Tau) % Tau;\n}\n\nfunction angleDiff(from: number, to: number): number {\n    const diff = normalizeAngle(to - from);\n    return diff > Math.PI ? diff - Tau : diff;\n}\n\nexport const OrbitSystem: System = {\n    group: \"simulation\",\n\n    update(state: State) {\n        const input = Input.from(state);\n        const dt = state.time.deltaTime;\n\n        for (const eid of state.query([Orbit, Transform])) {\n            const sensitivity = Orbit.sensitivity[eid];\n            const zoomSpeed = Orbit.zoomSpeed[eid];\n            const minPitch = Orbit.minPitch[eid];\n            const maxPitch = Orbit.maxPitch[eid];\n            const minDistance = Orbit.minDistance[eid];\n            const maxDistance = Orbit.maxDistance[eid];\n            const smoothness = Orbit.smoothness[eid];\n\n            if (input?.mouse.right) {\n                Orbit.targetYaw[eid] -= input.mouse.deltaX * sensitivity;\n                Orbit.targetPitch[eid] = clamp(\n                    Orbit.targetPitch[eid] + input.mouse.deltaY * sensitivity,\n                    minPitch,\n                    maxPitch\n                );\n            }\n\n            if (input && input.mouse.scrollDelta !== 0) {\n                const currentDistance = Orbit.targetDistance[eid];\n                const distanceScale = Math.max(0.3, currentDistance * 0.08);\n                const zoomDelta = input.mouse.scrollDelta * zoomSpeed * distanceScale;\n                Orbit.targetDistance[eid] = clamp(\n                    currentDistance + zoomDelta,\n                    minDistance,\n                    maxDistance\n                );\n            }\n\n            const t = smoothLerp(smoothness, dt);\n            Orbit.yaw[eid] += angleDiff(Orbit.yaw[eid], Orbit.targetYaw[eid]) * t;\n            Orbit.pitch[eid] += (Orbit.targetPitch[eid] - Orbit.pitch[eid]) * t;\n            Orbit.distance[eid] += (Orbit.targetDistance[eid] - Orbit.distance[eid]) * t;\n\n            const yaw = Orbit.yaw[eid];\n            const pitch = Orbit.pitch[eid];\n            const distance = Orbit.distance[eid];\n\n            let targetX = 0,\n                targetY = 0,\n                targetZ = 0;\n            const targetEid = Orbit.target[eid];\n            if (targetEid && state.hasComponent(targetEid, Transform)) {\n                targetX = Transform.posX[targetEid];\n                targetY = Transform.posY[targetEid];\n                targetZ = Transform.posZ[targetEid];\n            }\n\n            const camX = targetX + distance * Math.cos(pitch) * Math.sin(yaw);\n            const camY = targetY + distance * Math.sin(pitch);\n            const camZ = targetZ + distance * Math.cos(pitch) * Math.cos(yaw);\n\n            Transform.posX[eid] = camX;\n            Transform.posY[eid] = camY;\n            Transform.posZ[eid] = camZ;\n\n            const rotation = lookAt(camX, camY, camZ, targetX, targetY, targetZ);\n            Transform.quatX[eid] = rotation.x;\n            Transform.quatY[eid] = rotation.y;\n            Transform.quatZ[eid] = rotation.z;\n            Transform.quatW[eid] = rotation.w;\n        }\n    },\n};\n\nexport const OrbitPlugin: Plugin = {\n    systems: [OrbitSystem],\n    components: { Orbit },\n    dependencies: [InputPlugin],\n};\n","import { setTraits } from \"../../core/component\";\n\nexport const Line = {\n    offsetX: [] as number[],\n    offsetY: [] as number[],\n    offsetZ: [] as number[],\n    color: [] as number[],\n    thickness: [] as number[],\n    opacity: [] as number[],\n    visible: [] as number[],\n    arrowStart: [] as number[],\n    arrowEnd: [] as number[],\n    arrowSize: [] as number[],\n};\n\nsetTraits(Line, {\n    defaults: () => ({\n        offsetX: 1,\n        offsetY: 0,\n        offsetZ: 0,\n        color: 0xffffff,\n        thickness: 2,\n        opacity: 1,\n        visible: 1,\n        arrowStart: 0,\n        arrowEnd: 0,\n        arrowSize: 12,\n    }),\n});\n","import { setTraits } from \"../../core/component\";\n\nexport const Text = {\n    fontSize: [] as number[],\n    color: [] as number[],\n    opacity: [] as number[],\n    visible: [] as number[],\n    dirty: [] as number[],\n};\n\nsetTraits(Text, {\n    defaults: () => ({\n        fontSize: 1,\n        color: 0xffffff,\n        opacity: 1,\n        visible: 1,\n        dirty: 1,\n    }),\n});\n"],"file":"component-B847rBOH.js"}