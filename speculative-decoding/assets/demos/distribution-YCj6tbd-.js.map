{"version":3,"file":"distribution-YCj6tbd-.js","sources":["../../../demos/distribution.ts"],"sourcesContent":["import {\n  State,\n  TransformsPlugin,\n  RenderPlugin,\n  TweenPlugin,\n  minimalLight,\n} from '@multiplekex/shallot';\nimport { OrbitPlugin, LinesPlugin, TextPlugin } from '@multiplekex/shallot/extras';\nimport {\n  createStepPlugin,\n  setupCanvas,\n  setupScrollPassthrough,\n  setupDemo,\n} from '@blog-components/sequence';\nimport { ProbabilityDistributionPlugin, ProbabilityDistribution, setDistributionProbabilities } from '../src';\n\nconst STEPS = [\n  { title: 'Compare Distributions', description: 'The <span class=\"term-draft-model\">draft</span> and <span class=\"term-target-model\">target</span> models produce different probability distributions.' },\n  { title: 'Guaranteed Acceptance', description: 'The <span style=\"color: #14b8a6\">minimum</span> of the two distributions represents probability mass that will always be accepted.' },\n  { title: 'Excess Draft', description: 'Where <span class=\"term-draft-model\">draft</span> exceeds <span class=\"term-target-model\">target</span>, tokens may be <span class=\"term-reject\">rejected</span> with probability proportional to the excess.' },\n  { title: 'Rejection & Resampling', description: 'When rejected, we <span class=\"term-residual\">resample</span> from the residualâ€”the probability mass where <span class=\"term-target-model\">target</span> exceeds <span class=\"term-draft-model\">draft</span>.' },\n  { title: 'Exact Target Distribution', description: 'The <span style=\"color: #14b8a6\">guaranteed acceptance</span> plus <span class=\"term-residual\">residual resampling</span> recovers the exact <span class=\"term-target-model\">target</span> distribution.' },\n];\n\nconst BAR_COUNT = 10;\n\nconst targetProbs = [0.05, 0.12, 0.08, 0.35, 0.15, 0.08, 0.05, 0.04, 0.05, 0.03];\nconst draftProbs =  [0.08, 0.10, 0.15, 0.20, 0.12, 0.10, 0.08, 0.07, 0.06, 0.04];\n\nasync function init(): Promise<void> {\n  const canvas = document.getElementById('canvas') as HTMLCanvasElement;\n  if (!canvas) return;\n\n  setupCanvas(canvas);\n  setupScrollPassthrough(canvas);\n  window.addEventListener('resize', () => setupCanvas(canvas));\n\n  const state = await State.new()\n    .withCanvas(canvas)\n    .withLoading(minimalLight(canvas))\n    .withPlugins(\n      TransformsPlugin,\n      RenderPlugin,\n      OrbitPlugin,\n      LinesPlugin,\n      TextPlugin,\n      TweenPlugin,\n      createStepPlugin(),\n      ProbabilityDistributionPlugin\n    )\n    .withScene('../scenes/distribution.scene')\n    .build();\n\n  const probBarsEids = [...state.query([ProbabilityDistribution])];\n  const probBarsEid = probBarsEids[0];\n\n  if (probBarsEid !== undefined) {\n    ProbabilityDistribution.barCount[probBarsEid] = BAR_COUNT;\n    setDistributionProbabilities(probBarsEid, targetProbs, draftProbs);\n  }\n\n  setupDemo(canvas, state, STEPS);\n}\n\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', init);\n} else {\n  init();\n}\n"],"names":["STEPS","BAR_COUNT","targetProbs","draftProbs","init","canvas","setupCanvas","setupScrollPassthrough","state","State","minimalLight","TransformsPlugin","RenderPlugin","OrbitPlugin","LinesPlugin","TextPlugin","TweenPlugin","createStepPlugin","ProbabilityDistributionPlugin","probBarsEid","ProbabilityDistribution","setDistributionProbabilities","setupDemo"],"mappings":"gQAgBA,MAAMA,EAAQ,CACZ,CAAE,MAAO,wBAAyB,YAAa,uJAAA,EAC/C,CAAE,MAAO,wBAAyB,YAAa,oIAAA,EAC/C,CAAE,MAAO,eAAgB,YAAa,+MAAA,EACtC,CAAE,MAAO,yBAA0B,YAAa,+MAAA,EAChD,CAAE,MAAO,4BAA6B,YAAa,0MAAA,CACrD,EAEMC,EAAY,GAEZC,EAAc,CAAC,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAI,EACzEC,EAAc,CAAC,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAI,EAE/E,eAAeC,GAAsB,CACnC,MAAMC,EAAS,SAAS,eAAe,QAAQ,EAC/C,GAAI,CAACA,EAAQ,OAEbC,EAAYD,CAAM,EAClBE,EAAuBF,CAAM,EAC7B,OAAO,iBAAiB,SAAU,IAAMC,EAAYD,CAAM,CAAC,EAE3D,MAAMG,EAAQ,MAAMC,EAAM,IAAA,EACvB,WAAWJ,CAAM,EACjB,YAAYK,EAAaL,CAAM,CAAC,EAChC,YACCM,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAAA,EACAC,CAAA,EAED,UAAU,8BAA8B,EACxC,MAAA,EAGGC,EADe,CAAC,GAAGX,EAAM,MAAM,CAACY,CAAuB,CAAC,CAAC,EAC9B,CAAC,EAE9BD,IAAgB,SAClBC,EAAwB,SAASD,CAAW,EAAIlB,EAChDoB,EAA6BF,EAAajB,EAAaC,CAAU,GAGnEmB,EAAUjB,EAAQG,EAAOR,CAAK,CAChC,CAEI,SAAS,aAAe,UAC1B,SAAS,iBAAiB,mBAAoBI,CAAI,EAElDA,EAAA"}